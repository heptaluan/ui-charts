!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).d3Chart={})}(this,(function(t){"use strict";function e(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*Math.PI,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,a=t,o=e,r=i;Math.abs(r-o-2*Math.PI)<=1e-5&&(r-=1e-5);var l={x:Math.cos(o-Math.PI/2)*a,y:Math.sin(o-Math.PI/2)*a},s={x:Math.cos(r-Math.PI/2)*a,y:Math.sin(r-Math.PI/2)*a},u=0,c=0,h=1;Math.abs(r-o)>=Math.PI&&(c=1),void 0!==n?h=isNaN(Number(n))?1:Number(n):void 0===n&&Math.abs(r+o)/2>Math.PI/2&&Math.abs(r+o)/2<Math.PI/2*3&&(h=0);var d=h?"M"+l.x+" "+l.y+"A"+_()+" "+s.x+" "+s.y:"M"+s.x+" "+s.y+"A"+_()+" "+l.x+" "+l.y;function _(){return a+" "+a+" "+u+" "+c+" "+h+" "}return d}function i(t){return"none"!==t.style("display")?t.node().getBBox():{x:0,y:0,width:0,height:0}}function n(t){t.style("display","block")}function a(t){t.style("display","none")}function o(t,e,i){t.attr("transform","translate("+e+","+i+")")}function r(t){var e=t+Math.floor(1e9*Math.random()).toString(32)+Date.now().toString(32);return null==document.getElementById(e)?e:r(t)}function l(t){return t.filter((function(t){return!1!==t.active}))}function s(t,e,i,n){var a=Math.min(t,e)/2,o=t/2,r=e/2,l=0;if(Math.abs(n-i)<=Math.PI/2){var s=Math.min(n,i),u=Math.max(n,i);a=Math.min(t,e),s>=0&&u<=Math.PI/2?(o=(t-a)/2,r=(e-a)/2+a,l=1):s>=Math.PI/2&&u<=Math.PI?(o=(t-a)/2,r=(e-a)/2,l=2):s>=Math.PI&&u<=3*Math.PI/2?(o=(t-a)/2+a,r=(e-a)/2,l=3):s>=3*Math.PI/2&&u<=2*Math.PI&&(o=(t-a)/2+a,r=(e-a)/2+a,l=4)}return{radius:a,cx:o,cy:r,quadrant:l}}function u(t){var e=t.split(/[\-\/]/);if(3!==e.length)return t;if(e[0].length<4){var i=d3.range(4-e[0].length).map((function(){return 0})).join("");e[0]=i+e[0]}return 1===e[1].length&&(e[1]="0"+e[1]),1===e[2].length&&(e[2]="0"+e[2]),e.join("-")}function c(t,e){var i=window.location.href;return void 0===e&&(e=!/\/#\//.test(i)),e?i+t:t}function h(t,e){var i=/[^\u4e00-\u9fa5\w-]/gi;return e=null==e||i.test(e)?"-":e,t.toString().replace(i,e)}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.abs(parseFloat(t))||e}function _(t){for(var e=t.x,i=void 0===e?0:e,n=t.y,a=void 0===n?0:n,o=t.width,r=void 0===o?100:o,l=t.height,s=void 0===l?100:l,u=t.cornerRadius,c=void 0===u?0:u,h=t.roundCorners,d=void 0===h?[0,1,2,3]:h,_=i,f=a,p=i+r,y=a+s,x=Math.min(Math.min(r,s)/2,c),g=x+" "+x+" 0 0 1",v=["L"+_+" "+f,"L"+p+" "+f,"L"+p+" "+y,"L"+_+" "+y],m=["A"+g+" "+(_+x)+" "+f,"A"+g+" "+p+" "+(f+x),"A"+g+" "+(p-x)+" "+y,"A"+g+" "+_+" "+(y-x)],b=[],S=0;S<=3;S++){var k=d.includes(S)?m[S]:v[S];b.push(k)}return"\n    M"+_+" "+(f+x)+"\n    "+b[0]+"\n    H"+(p-x)+"\n    "+b[1]+"\n    V"+(y-x)+"\n    "+b[2]+"\n    H"+(_+x)+"\n    "+b[3]+"\n    Z\n  "}function f(t){var e=t.x,i=void 0===e?0:e,n=t.y,a=void 0===n?0:n,o=t.width,r=void 0===o?100:o,l=t.height,s=void 0===l?100:l,u=t.cornerRadius,c=void 0===u?0:u,h=t.roundCorners,d=void 0===h?[0,1,2,3]:h,_=t.type,f=void 0===_?"normal":_,p=i,y=a,x=i+r,g=a+s;if(Array.isArray(c)){var v=0,m=0,b=0,S=0;0==c.length||c.length<4?(v=0,m=0,b=0,S=0):(v=isNaN(Math.min("horizontal"==f?s:r,c[0]))?0:Math.min("horizontal"==f?s:r,c[0]),m=isNaN(Math.min("horizontal"==f?s:r,c[1]))?0:Math.min("horizontal"==f?s:r,c[1]),b=isNaN(Math.min("horizontal"==f?s:r,c[2]))?0:Math.min("horizontal"==f?s:r,c[2]),S=isNaN(Math.min("horizontal"==f?s:r,c[3]))?0:Math.min("horizontal"==f?s:r,c[3]));for(var k=["L"+p+" "+y,"L"+x+" "+y,"L"+x+" "+g,"L"+p+" "+g],w=["A"+(v+" "+v+" 0 0 1")+" "+(p+v)+" "+y,"A"+(m+" "+m+" 0 0 1")+" "+x+" "+(y+m),"A"+(S+" "+S+" 0 0 1")+" "+(x-S)+" "+g,"A"+(b+" "+b+" 0 0 1")+" "+p+" "+(g-b)],C=[],O=0;O<=3;O++){var F=d.includes(O)?w[O]:k[O];C.push(F)}return"\n    M"+p+" "+(y+v)+"\n    "+C[0]+"\n    H"+(x-m)+"\n    "+C[1]+"\n    V"+(g-S)+"\n    "+C[2]+"\n    H"+(p+b)+"\n    "+C[3]+"\n    Z\n  "}for(var L=Math.min("horizontal"==f?s:r,c),P=L+" "+L+" 0 0 1",A=["L"+p+" "+y,"L"+x+" "+y,"L"+x+" "+g,"L"+p+" "+g],W=["A"+P+" "+(p+L)+" "+y,"A"+P+" "+x+" "+(y+L),"A"+P+" "+(x-L)+" "+g,"A"+P+" "+p+" "+(g-L)],z=[],M=0;M<=3;M++){var D=d.includes(M)?W[M]:A[M];z.push(D)}return"\n    M"+p+" "+(y+L)+"\n    "+z[0]+"\n    H"+(x-L)+"\n    "+z[1]+"\n    V"+(g-L)+"\n    "+z[2]+"\n    H"+(p+L)+"\n    "+z[3]+"\n    Z\n  "}function p(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"start",a={x:0,y:0},o={x:0,y:0},r={x:0,y:0},l={x:0,y:0};return"start"==i?(a={x:t.x,y:t.y},o={x:t.x+t.width,y:t.y+t.height}):(a={x:t.x-t.width,y:t.y},o={x:t.x,y:t.y+t.height}),"start"==n?(r={x:e.x,y:e.y},l={x:e.x+e.width,y:e.y+e.height}):(r={x:e.x-e.width,y:e.y},l={x:e.x,y:e.y+e.height}),!(a.x>l.x||r.x>o.x||a.y>l.y||r.y>o.y)}function y(t){var e=t-90;e<0&&(e+=360);var i={x1:50,x2:50,y1:0,y2:100},n=50/45;return e>=0&&e<=45?(i.x1=50+n*e,i.x2=50-n*e,i.y1=0,i.y2=100):e>45&&e<=135?(i.x1=100,i.x2=0,i.y1=n*(e-45),i.y2=100-n*(e-45)):e>135&&e<=225?(i.x1=100-n*(e-135),i.x2=n*(e-135),i.y1=100,i.y2=0):e>225&&e<=315?(i.x1=0,i.x2=100,i.y1=100-n*(e-225),i.y2=n*(e-225)):e>315&&e<=360?(i.x1=n*(e-315),i.x2=100-n*(e-315),i.y1=0,i.y2=100):(i.x1=50,i.x2=50,i.y1=0,i.y2=100),i}function x(t){return new Function("return "+t)()}var g=Math.sqrt(50);function v(t,e,i){var n,a,o,r,l=-1,s=t,u=e;if(i=+i,(t=+t)===(e=+e)&&i>0)return[t];if((n=e<t)&&(a=t,t=e,e=a),0===(r=function(t,e,i){var n=(e-t)/Math.max(0,i),a=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,a);return a>=0?(o>=g?10:o>=4.6?5:o>=2.6?3:o>=1.6?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(o>=g?10:o>=4.6?5:o>=2.6?3:o>=1.6?2:1)}(t,e,i))||!isFinite(r))return[];if(r>0){for(t=Math.ceil(t/r),e=Math.floor(e/r),o=new Array(a=Math.ceil(e-t+1));++l<a;)o[l]=s+l*r;o[Math.ceil(e-t)]<u&&(o[Math.ceil(e-t+1)]=s+Math.ceil(e-t+1)*r)}else{for(r=-r,t=Math.ceil(t*r),e=Math.floor(e*r),o=new Array(a=Math.ceil(e-t+1));++l<a;)o[l]=s+l/r;o[Math.ceil(e-t)]<u&&(o[Math.ceil(e-t+1)]=s+Math.ceil(e-t+1)/r)}return n&&o.reverse(),o}var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},S=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),k=function t(e,i,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,i);if(void 0===a){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in a)return a.value;var r=a.get;return void 0!==r?r.call(n):void 0},w=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},C=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},O=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(n=(r=l.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},F=function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)},L=function(){function t(){b(this,t),this.elem=null,this._pos=[0,0],this._show=!0,this.id=r("")}return S(t,[{key:"update",value:function(){}},{key:"show",value:function(){return n(this.elem),this._show=!0,this}},{key:"hide",value:function(){return a(this.elem),this._show=!1,this}},{key:"width",value:function(){return i(this.elem).width}},{key:"height",value:function(){return i(this.elem).height}},{key:"translate",value:function(t,e){return arguments.length?(this.pos=[t,e],o(this.elem,t,e),this):this.pos}},{key:"isShow",get:function(){return this._show}}]),t}();function P(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments[2];return!t.length||t[0].length<(i||2)||e.some((function(e){return void 0===t[0][e]}))}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.slice(1).some((function(t){return!isNaN(parseFloat(t[e]))}))}function W(t,e){var i=0,n=1;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n))return[];var a=[],o=t[0][i],r=t[0][n];return t.slice(1).forEach((function(t,e){parseFloat(t[n]);var l=t[i];""!=t[i]&&null!=t[i]&&null!=t[i]||(l="$-"+e);var s=!0;""!=t[i]&&null!=t[i]&&null!=t[i]||""!=t[n]&&null!=t[n]&&null!=t[n]||(s=!1),a.push({name:l,dataScreen:s,showLegend:l!="$-"+e,value:""==t[n]||isNaN(parseFloat(t[n]))||null==t[n]||null==t[n]?0:parseFloat(t[n]),nameLabel:o,valueLabel:r})})),a.forEach((function(t,e){t.key=h(t.name)+"-"+e,t.index=e})),a}function z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(1===e.length)return t;var i=e.filter((function(t){return"objCol"===t.function||"vCol"===t.function&&t.configurable})).map((function(t){return t.index})),n=t.map((function(t){return t.filter((function(t,e){return i.indexOf(e)>=0}))}));return n}function M(t,e){var i=0,n=!1,a=[];if(e.forEach((function(t){"objCol"===t.function?(i=t.index,n=t.isLegend):"vCol"===t.function&&0==t.configurable&&a.push(t.index)})),P(t,[i],2))return[];for(var o=z(t,e),r={},l=[],s=o.length,u=o[0],c=[],d=[],_=1;_<s;_++)d.push(o[_].length);d.sort((function(t,e){return e-t}));for(var f=0;f<s;f++)for(var p=0;p<d[0];p++)c.push(isNaN(parseFloat(o[f][p])));if(0==c.filter((function(t,e){return 0==t})).length)return[];if(n){for(var y=[],x=1;x<s;x++)y.push(o[x].length);y.sort((function(t,e){return e-t}));for(var g=1;g<s;g++){var v=o[g],m=v[i];if(""!=m&&null!=m&&null!=m||(m="$-"+g),m){for(var b={name:m,dataScreen:!0,showLegend:m!="$-"+g,data:[]},S=0;S<y[0];S++){var k=u[S];""!=k&&null!=k&&null!=k||(k="&-"+S),S!==i&&b.data.push({name:k,subName:m,showAxisText:k!="&-"+S,value:""==v[S]||isNaN(parseFloat(v[S]))||null==v[S]||null==v[S]?0:parseFloat(v[S]),tooltipValueShow:!isNaN(parseFloat(v[S]))})}l.push(b)}}}else{for(var w=[],C=1;C<s;C++)w.push(o[C].length);w.sort((function(t,e){return e-t}));for(var O=1;O<w[0];O++)if(O!==i){var F=u[O];""!=u[O]&&null!=u[O]&&null!=u[O]||(F="$-"+O);var L="";L=1==O?"rainfall":2==O?"volume":"",r[F+"-"+O]={name:F,dataScreen:!0,showLegend:F!="$-"+O,type:L,data:[]}}for(var A=1;A<s;A++){var W=o[A],M=W[i];if(""!=M&&null!=M&&null!=M||(M="&-"+A),M)for(var D=0;D<w[0];D++){var R=u[D];""!=u[D]&&null!=u[D]&&null!=u[D]||(R="$-"+D),D!==i&&R&&r[R+"-"+D].data.push({name:M,showAxisText:M!="&-"+A,value:""==W[D]||isNaN(parseFloat(W[D]))||null==W[D]||null==W[D]?0:parseFloat(W[D]),tooltipValueShow:!isNaN(parseFloat(W[D]))})}}for(var N in r)l.push(r[N])}return l.forEach((function(t,e){t.key=h(t.name)+"-"+e})),l}function D(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"sans-serif",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"50%",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"middle",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"...",s=t.append("text").style("text-anchor",r).style("font-size",n+"px").style("font-family",a).attr("dy","0.35em");return s.append("textPath").attr("startOffset",o).attr("xlink:href",(function(){return"#"+e.attr("id")})).text((function(){var t=e.node().getTotalLength();return X(i,t,n,a,l)})),s}function R(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sans-serif";if(null==t||null==t||""==t)return 0;var n=d3.select("defs");n.empty()&&(n=d3.select("svg").append("defs"));var a=n.append("text").style("font-size",e+"px").style("font-family",i).text(String(t)),o=a.node().getComputedTextLength();return a.remove(),o}function N(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"sans-serif",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"normal",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"1.2",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=d3.select("defs");s.empty()&&(s=d3.select("svg").append("defs"));var u=s.append("text").attr("y",.9*n).style("font-size",n+"px").style("font-family",a).style("font-weight",o).style("letter-spacing",l).text(String(t)).each((function(i,a){for(var o=[],l=[],s=[],u=[],c=[],h=[],d=[],_=[],f=[],p=[],y=[],x=[],g=[],v=[],m=[],b=[],S=[],k=[],w=[],C=[],O=[],F=[],L=[],P=String(t),A=/[a-z0-9]+[a-z0-9]+/gi,W=/[a-z0-9]+[\.|,][a-z0-9]+/gi,z=/[\u4e00-\u9fa5a-zA-Z0-9]+[`~!@#$%^&*()_+<>?:"{},.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+/gi,M=/[0-9]+/gi,D=/[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]+[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]/gi,R=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi,N=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+)[%。\，\-；\; ]+/gi,T=/([\u4e00-\u9fa5]|[a-zA-Z]+)[-][0-9]+/gi,B=/^(%|。|\，|\-|\;| )+/gi,G=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]+([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9])/gi,X=/[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi;o=A.exec(P);)l.push(o.index+1),g.push(A.lastIndex);for(;o=W.exec(P);)s.push(o.index+1),v.push(W.lastIndex);for(;o=z.exec(P);)u.push(o.index+1),m.push(z.lastIndex);for(;o=M.exec(P);)c.push(o.index+1),b.push(M.lastIndex);for(;o=D.exec(P);)h.push(o.index+1),S.push(D.lastIndex);for(;o=R.exec(P);)d.push(o.index+1),k.push(R.lastIndex);for(;o=N.exec(P);)if(isNaN(o[0].indexOf("-")))_.push(o.index+1),w.push(N.lastIndex);else{for(var j=!0;T.exec(P);)j=!1;j&&(_.push(o.index+1),w.push(N.lastIndex))}for(;o=T.exec(P);)isNaN(o[0].indexOf("-"))||f.push(o.index+o[0].indexOf("-")+1),C.push(T.lastIndex);for(;o=B.exec(P);)p.push(o.index+1),O.push(P.length);for(;o=G.exec(P);)y.push(o.index+1),F.push(P.length);for(;o=X.exec(P);)x.push(o.index+1),L.push(P.length);for(var I,Y=d3.select(this),H=Y.text().split("").reverse(),E=[],V=0,$=0,q=+Y.attr("x"),U=+Y.attr("y"),Z=Y.text(null).append("tspan").attr("x",q).attr("y",U);I=H.pop();){E.push(I),Z.text(E.join(""));var Q=!0;if(l.length>0)for(var K=0;K<l.length;K++)$>=l[K]&&$<g[K]&&(Q=!1);if(s.length>0)for(var J=0;J<s.length;J++)$>=s[J]&&$<v[J]&&(Q=!1);if(u.length>0)for(var tt=0;tt<u.length;tt++)$>=u[tt]&&$<m[tt]&&(Q=!1);if(c.length>0)for(var et=0;et<c.length;et++)$>=c[et]&&$<b[et]&&(Q=!1);if(h.length>0)for(var it=0;it<h.length;it++)$>=h[it]&&$<S[it]&&(Q=!1);if(d.length>0)for(var nt=0;nt<d.length;nt++)$>=d[nt]&&$<k[nt]&&(Q=!1);if(_.length>0)for(var at=0;at<_.length;at++)$>=_[at]&&$<w[at]&&(Q=!1);if(f.length>0)for(var ot=0;ot<f.length;ot++)$>=f[ot]&&$<C[ot]&&(Q=!1);if(p.length>0)for(var rt=0;rt<p.length;rt++)$>=p[rt]&&$<O[rt]&&(Q=!1);if(y.length>0)for(var lt=0;lt<y.length;lt++)$>=y[lt]&&$<F[lt]&&(Q=!1);if(x.length>0)for(var st=0;st<x.length;st++)$>=x[st]&&$<L[st]&&(Q=!1);Q&&Z.node().getComputedTextLength()>e&&(0==$||++V,E.pop(),Z.text(E.join("")),E=[I],Z=Y.append("tspan").attr("x",q).attr("y",V*parseFloat(.9*n*r)+U).text(I)),$++}})),c=u.selectAll("tspan").nodes().filter((function(t){return""!=d3.select(t).text()})).length,h=c*parseFloat(n)+(c-1)*(r-1)*parseFloat(n)+(r-1)*parseFloat(n);return u.remove(),h}function T(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"sans-serif",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"normal",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"1.2",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=d3.select("defs");s.empty()&&(s=d3.select("svg").append("defs"));var u=s.append("text").attr("y",.9*n).style("font-size",n+"px").style("font-family",a).style("font-weight",o).style("letter-spacing",l).text(String(t)).each((function(i,a){for(var o=[],l=[],s=[],u=[],c=[],h=[],d=[],_=[],f=[],p=[],y=[],x=[],g=[],v=[],m=[],b=[],S=[],k=[],w=[],C=[],O=[],F=[],L=[],P=String(t),A=/[a-z0-9]+[a-z0-9]+/gi,W=/[a-z0-9]+[\.|,][a-z0-9]+/gi,z=/[\u4e00-\u9fa5a-zA-Z0-9]+[`~!@#$%^&*()_+<>?:"{},.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+/gi,M=/[0-9]+/gi,D=/[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]+[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]/gi,R=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi,N=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+)[%。\，\-；\; ]+/gi,T=/([\u4e00-\u9fa5]|[a-zA-Z]+)[-][0-9]+/gi,B=/^(%|。|\，|\-|\;| )+/gi,G=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]+([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9])/gi,X=/[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi;o=A.exec(P);)l.push(o.index+1),g.push(A.lastIndex);for(;o=W.exec(P);)s.push(o.index+1),v.push(W.lastIndex);for(;o=z.exec(P);)u.push(o.index+1),m.push(z.lastIndex);for(;o=M.exec(P);)c.push(o.index+1),b.push(M.lastIndex);for(;o=D.exec(P);)h.push(o.index+1),S.push(D.lastIndex);for(;o=R.exec(P);)d.push(o.index+1),k.push(R.lastIndex);for(;o=N.exec(P);)if(isNaN(o[0].indexOf("-")))_.push(o.index+1),w.push(N.lastIndex);else{for(var j=!0;T.exec(P);)j=!1;j&&(_.push(o.index+1),w.push(N.lastIndex))}for(;o=T.exec(P);)isNaN(o[0].indexOf("-"))||f.push(o.index+o[0].indexOf("-")+1),C.push(T.lastIndex);for(;o=B.exec(P);)p.push(o.index+1),O.push(P.length);for(;o=G.exec(P);)y.push(o.index+1),F.push(P.length);for(;o=X.exec(P);)x.push(o.index+1),L.push(P.length);for(var I,Y=d3.select(this),H=Y.text().split("").reverse(),E=[],V=0,$=0,q=+Y.attr("x"),U=+Y.attr("y"),Z=Y.text(null).append("tspan").attr("x",q).attr("y",U);I=H.pop();){E.push(I),Z.text(E.join(""));var Q=!0;if(l.length>0)for(var K=0;K<l.length;K++)$>=l[K]&&$<g[K]&&(Q=!1);if(s.length>0)for(var J=0;J<s.length;J++)$>=s[J]&&$<v[J]&&(Q=!1);if(u.length>0)for(var tt=0;tt<u.length;tt++)$>=u[tt]&&$<m[tt]&&(Q=!1);if(c.length>0)for(var et=0;et<c.length;et++)$>=c[et]&&$<b[et]&&(Q=!1);if(h.length>0)for(var it=0;it<h.length;it++)$>=h[it]&&$<S[it]&&(Q=!1);if(d.length>0)for(var nt=0;nt<d.length;nt++)$>=d[nt]&&$<k[nt]&&(Q=!1);if(_.length>0)for(var at=0;at<_.length;at++)$>=_[at]&&$<w[at]&&(Q=!1);if(f.length>0)for(var ot=0;ot<f.length;ot++)$>=f[ot]&&$<C[ot]&&(Q=!1);if(p.length>0)for(var rt=0;rt<p.length;rt++)$>=p[rt]&&$<O[rt]&&(Q=!1);if(y.length>0)for(var lt=0;lt<y.length;lt++)$>=y[lt]&&$<F[lt]&&(Q=!1);if(x.length>0)for(var st=0;st<x.length;st++)$>=x[st]&&$<L[st]&&(Q=!1);Q&&Z.node().getComputedTextLength()>e&&(0==$||++V,E.pop(),Z.text(E.join("")),E=[I],Z=Y.append("tspan").attr("x",q).attr("y",V*parseFloat(.9*n*r)+U).text(I)),$++}})),c=u.node().getBBox().width;return u.remove(),c}function B(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sans-serif",n=d3.select("defs");n.empty()&&(n=d3.select("svg").append("defs"));var a=n.append("text").attr("y",.9*e).style("font-size",e+"px").style("font-family",i).text(String(t)).each((function(t,i){for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),h=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),h.text(r.join("")),h.node().getComputedTextLength()>0&&(0==s||++l,r.pop(),h.text(r.join("")),r=[n],h=a.append("tspan").attr("x",u).attr("y",l*parseFloat(.9*e*1.1)+c).text(n)),s++})),o=a.selectAll("tspan").nodes().filter((function(t){return""!=d3.select(t).text()})).length,r=o*parseFloat(e)+(o-1)*(1.1-1)*parseFloat(e)+(1.1-1)*parseFloat(e);return a.remove(),r}function G(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sans-serif";return Math.ceil(d3.max(t,(function(t){return R(t,e,i)})))}function X(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(R(t,i,n)<=e)return t;if(R(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(R((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}function j(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}function I(t,e,i,n,a){var o=e,r="pos";if((o<=-360||o>=360)&&(o=e%360),"竖排"==n?o>=-90&&o<=90?o=o:(o>90&&o<=270?(o-=180,r="rev"):o>270&&o<=360&&(o-=360),o<-90&&o>=-270?(o+=180,r="rev"):o<-270&&o>=-360&&(o+=360)):o<-180?o=o%180+180:o>180&&(o=o%180-180),"top"===a){var l=o%180==0?"middle":o>0?"end":"start";if("横排"==n&&0==o)return{x:t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:-8-.2*t,anchor:l,angle:o,flag:r};if(o<=0)return o<-90?{x:t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:t*Math.cos(Math.abs(o)*Math.PI/180)-8,anchor:l,angle:o,flag:r}:{x:t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:-8,anchor:l,angle:o,flag:r};if(o>0)return o>90?{x:-t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:t*Math.cos(Math.abs(o)*Math.PI/180)-8,anchor:l,angle:o,flag:r}:{x:-t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:-8,anchor:l,angle:o,flag:r}}else{var s=o%180==0?"middle":o>0?"start":"end";if("横排"==n&&(180==o||-180==o))return{x:t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:8+.2*t,anchor:s,angle:o,flag:r};if(o<=0)return o<-90?{x:t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:8,anchor:s,angle:o,flag:r}:{x:t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:8+t*Math.cos(Math.abs(o)*Math.PI/180),anchor:s,angle:o,flag:r};if(o>0)return o>90?{x:-t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:8,anchor:s,angle:o,flag:r}:{x:-t*Math.sin(Math.abs(o)*Math.PI/180)/2,y:8+t*Math.cos(Math.abs(o)*Math.PI/180),anchor:s,angle:o,flag:r}}}function Y(t,e,i,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",r=i,l="end";if("横排"==n?(l=90==Math.abs(r)?"middle":"start",Math.abs(r)>90&&(l="end"),"left"==a&&(l=90==Math.abs(r)?"middle":"end",Math.abs(r)>90&&(l="start"))):(l=r%180==0?"middle":r>0?"end":"start","left"==a&&(l=r%180==0?"middle":r>0?"start":"end")),"横排"==n)return"left"==a?90==r?{y:-t*Math.sin(Math.abs(r)*Math.PI/180)/2,x:.8*-t-3,anchor:l,angle:r}:-90==r?{y:-t*Math.sin(Math.abs(r)*Math.PI/180)/2,x:-3,anchor:l,angle:r}:180==Math.abs(r)?{y:t*Math.cos(Math.abs(r)*Math.PI/180)/1.8,x:-3,anchor:l,angle:r}:r>0&&r<90?{y:t*Math.cos(Math.abs(r)*Math.PI/180)/2,x:-t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}:r<0&&r>-180?{y:-t*Math.sin(Math.abs(r)*Math.PI/180)/2,x:-3,anchor:l,angle:r}:r>90&&r<180?{y:t*Math.cos(Math.abs(r)*Math.PI/180),x:-t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}:{y:0,x:0,anchor:l,angle:r}:90==r?{y:-t*Math.sin(Math.abs(r)*Math.PI/180)/2,x:3,anchor:l,angle:r}:-90==r?{y:-t*Math.sin(Math.abs(r)*Math.PI/180)/2,x:.8*t+3,anchor:l,angle:r}:180==Math.abs(r)?{y:-t/1.5,x:t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}:r>0&&r<180?{y:-t*Math.sin(Math.abs(r)*Math.PI/180)/2,x:3,anchor:l,angle:r}:r<0&&r>-90?{y:t*Math.cos(Math.abs(r)*Math.PI/180)/2,x:t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}:r<-90&&r>-180?{y:t*Math.cos(Math.abs(r)*Math.PI/180),x:t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}:{y:0,x:0,anchor:l,angle:r};var s=B(o,t,e)-.5*t,u=t,c=Math.abs(Math.sin(Math.abs(r)*Math.PI/180)),h=Math.abs(Math.cos(Math.abs(r)*Math.PI/180)),d=u*h+s*c,_=s*h+u*c;if("left"==a)if(l=Math.abs(r)>90?"start":90==Math.abs(r)?"middle":"end",r>=0){if(0==r)return{y:t-_/2,x:-11-t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r};if(90==r)return{y:0,x:-8-t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r};if(r>0&&r<180)return{y:t*Math.cos(Math.abs(r)*Math.PI/180),x:-8-t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r};if(180==r)return{y:_/2-t,x:-11-t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}}else{if(r<0&&r>-90)return{y:-_+t,x:-8-d+t*Math.abs(Math.cos(Math.abs(r)*Math.PI/180)),anchor:l,angle:r};if(-90==r)return{y:0,x:-8-d+t*Math.abs(Math.cos(Math.abs(r)*Math.PI/180)),anchor:l,angle:r};if(r<-90&&r>-180)return{y:_-t,x:-8-d+t*Math.abs(Math.cos(Math.abs(r)*Math.PI/180)),anchor:l,angle:r};if(-180==r)return{y:_/2-t,x:-11,anchor:l,angle:r}}else if(l=Math.abs(r)>90?"end":90==Math.abs(r)?"middle":"start",r>=0){if(0==r)return{y:-_/2+t,x:8,anchor:l,angle:r};if(r>90&&r<180)return{y:_-t,x:8+d-t*Math.abs(Math.cos(Math.abs(r)*Math.PI/180)),anchor:l,angle:r};if(180==r)return{y:_/2-t,x:11,anchor:l,angle:r};if(r>0&&r<90)return{y:-_+t,x:8+d-t*Math.abs(Math.cos(Math.abs(r)*Math.PI/180)),anchor:l,angle:r};if(90==r)return{y:-_+t*Math.sin(Math.abs(r)*Math.PI/180),x:11+d-t*Math.sin(Math.abs(r)*Math.PI/180)/2,anchor:l,angle:r}}else{if(-90==r)return{y:0,x:8+t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r};if(r<0&&r>-180)return{y:t*Math.cos(Math.abs(r)*Math.PI/180),x:8+t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r};if(-180==r)return{y:_/2-t,x:11+t*Math.sin(Math.abs(r)*Math.PI/180),anchor:l,angle:r}}}function H(t,e){if("null"===t||null===t||isNaN(t))return t="-";var i=Math.round(t*Math.pow(10,e))/Math.pow(10,e);if(-1===i.toString().indexOf(".")){var n=void 0;n=0===e?"":".";for(var a=0;a<e;a++)n+="0";return(i+=n).toString()}var o=i.toString().indexOf("."),r=i.toString().substr(o+1,i.toString().length);if(r.toString().length<e)for(var l=0;l<e-r.toString().length;l++)i+="0";return i.toString()}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1000.00",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==t||null==t)return"";if(isNaN(t))return t;var n=t;null!=i&&(n=H(parseFloat(t),parseFloat(i)));var a="",o=".";"1,000.00"==e?(a=",",o="."):"1000,00"==e?(a="",o=","):"1.000,00"==e?(a=".",o=","):"1 000.00"==e?(a=" ",o="."):"1 000,00"==e?(a=" ",o=","):(a="",o=".");var r=String(n).split(".");return r[0]=r[0].replace(new RegExp("(\\d)(?=(\\d{3})+$)","ig"),"$1"+a),r.join(o)}function V(t,e,i){return t.map((function(t){return function(t,e,i){var n=void 0;if("number"==typeof t){var a=e.theme&&e.theme.colors;n=a&&a[t%a.length]||i&&i.colors[t]||"#000"}else n=q(t);return n}(t,e,i)}))}function $(t,e){return t.forEach((function(t,i){t.color=e[i],t.color_special=e[i+1]})),t.filter((function(t,e){return 1==t.dataScreen}))}function q(t){if("[object Object]"===Object.prototype.toString.call(t))return null;if(t&&/\[/.test(t))return t;if(t&&/#/.test(t)){if(String(t).length<8)return null==t||null==t?t:t.constructor===Object?null:t;return function(t,e){for(var i="rgba(",n=[],a=1;a<t.length;a+=2)n.push(parseInt("0x"+t.slice(a,a+2)));return n.forEach((function(t){i+=t+", "})),i+=e+")"}(String(t).slice(0,7),(parseInt("0x"+String(t).slice(7,9))/255).toFixed(2))}return null==t||null==t?t:t.constructor===Object?null:t}function U(t,e){if(t)return t.match(/(\d(\.\d+)?)+/g)[e]}var Z="legend-group",Q=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","legend"),i.group=i.elem.append("g"),i._data=[],i._shapeType="circle",i._shapeWidth=12,i._shapeHeight=12,i._shapeStroke="none",i._rowGap=6,i._colGap=20,i._innerGap=6,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._limitedWidth=400,i._horizontalAlign="center",i._onClick=function(){},i._each=function(){},i._orient="horizontal",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,n=Math.max(t._shapeHeight,t._fontSize),a=t._limitedWidth-t._shapeWidth-t._innerGap,r=0,l=0;t.elem.selectAll(".legend-group").remove();var s=e.append("g").attr("class",Z),u=[];t._data.forEach((function(i,o){if(-1==u.indexOf(i.name)){u.push(i.name);var c=X(i.name?i.name:"",a,t._fontSize,t._fontFamily),h=t._shapeWidth+t._innerGap+R(c,t._fontSize,t._fontFamily);if("vertical"===t._orient)t._legendItem(i,s,0,l,o),l=l+n+t._rowGap;else{var d=r+h+t._colGap;d>t._limitedWidth&&(r=0,d=h+t._colGap,l+=n+t._rowGap,s=e.append("g").attr("class",Z)),t._legendItem(i,s,r,l,o),r=d}}}));var c=i(e).width;return"center"===t._horizontalAlign?e.call(o,t._limitedWidth/2-c/2,0):"left"===t._horizontalAlign?e.call(o,0,0):"right"===t._horizontalAlign&&e.call(o,t._limitedWidth-c,0),t}},{key:"_shapeElem",value:function(t){var e=void 0;return(e="rect"===this._shapeType?t.append("rect").attr("width",this._shapeWidth).attr("height",this._shapeHeight):t.append("circle").attr("cx",this._shapeWidth/2).attr("cy",this._shapeHeight/2).attr("r",Math.min(this._shapeWidth,this._shapeHeight)/2)).attr("class","legend-shape"),e}},{key:"_legendItem",value:function(t,e,i,n,a){var r=this,l=e.append("g").datum(t).attr("class","legend-item").call(o,i,n).on("click",this._onClick).each(this._each);return this._shapeElem(l).style("fill",(function(e){if(t.color&&/\[/.test(t.color)){var i=(v=t.color,new Function("return "+v)()),n=[],o=!0,s=!1,u=void 0;try{for(var h,d=i[Symbol.iterator]();!(o=(h=d.next()).done);o=!0){var _=h.value,f=[],p=_.split(":");f.push(q(p[0])),f.push(p[1]),n.push(f)}}catch(t){s=!0,u=t}finally{try{!o&&d.return&&d.return()}finally{if(s)throw u}}var x=n.concat(),g=x.pop();return l.append("linearGradient").attr("id",r.id+"-legend-index-"+a).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(x).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+r.id+"-legend-index-"+a)+")"}return t.color;var v})),l.append("text").attr("x",this._shapeWidth+this._innerGap).attr("y",this._shapeHeight/2).attr("dy","0.35em").style("text-anchor","start").style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("fill",this._fontColor).text(X(t.name?t.name:"",this._limitedWidth-this._shapeWidth-this._innerGap,this._fontSize,this._fontFamily)),l}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}},{key:"shapeWidth",value:function(t){return arguments.length?(this._shapeWidth=t,this):this._shapeWidth}},{key:"shapeHeight",value:function(t){return arguments.length?(this._shapeHeight=t,this):this._shapeHeight}},{key:"rowGap",value:function(t){return arguments.length?(this._rowGap=t,this):this._rowGap}},{key:"colGap",value:function(t){return arguments.length?(this._colGap=t,this):this._colGap}},{key:"innerGap",value:function(t){return arguments.length?(this._innerGap=t,this):this._innerGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"onClick",value:function(t){return arguments.length?(this._onClick=t,this):this._onClick}},{key:"each",value:function(t){return arguments.length?(this._each=t,this):this._each}}]),e}(L),K=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("text"),i._text="",i._fontSize=24,i._fontFamily="noto",i._fontWeight="normal",i._color="#000",i._textAnchor="middle",i._dy="1em",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;return t.elem.attr("dy","1em").style("fill",t._color).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("font-weight",t._fontWeight).style("text-anchor",t._textAnchor).each((function(){for(var e,i=d3.select(this),n=t._text.split("").reverse(),a=[],o=0,r=+i.attr("x"),l=+i.attr("y"),s=i.text(null).append("tspan").attr("x",r).attr("y",l);e=n.pop();)a.push(e),s.text(a.join("")),s.node().getComputedTextLength()>t._width&&(++o,a.pop(),s.text(a.join("")),a=[e],s=i.append("tspan").attr("x",r).attr("y",o*parseFloat(1.3*t._fontSize)+parseFloat(t._fontSize)+l).text(e))})),t}},{key:"text",value:function(t){return arguments.length?(this._text=t,this):this._text}},{key:"color",value:function(t){return arguments.length?(this._color=t,this):this._color}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontWeight",value:function(t){return arguments.length?(this._fontWeight=t,this):this._fontWeight}},{key:"textAnchor",value:function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"dy",value:function(t){return arguments.length?(this._dy=t,this):this._dy}}]),e}(L),J=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","unit-group"),i._text="",i._fontSize=24,i._fontFamily="noto",i._fontWeight="normal",i._color="#000",i._textAnchor="middle",i._dy="1em",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;return t.elem.selectAll("text").remove(),t.elem.append("text").attr("dy",t._dy).style("fill",t._color).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("font-weight",t._fontWeight).style("text-anchor",t._textAnchor).text(t._text),t}},{key:"text",value:function(t){return arguments.length?(this._text=t,this):this._text}},{key:"color",value:function(t){return arguments.length?(this._color=t,this):this._color}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontWeight",value:function(t){return arguments.length?(this._fontWeight=t,this):this._fontWeight}},{key:"textAnchor",value:function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor}},{key:"dy",value:function(t){return arguments.length?(this._dy=t,this):this._dy}}]),e}(L),tt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","source-group"),i._text="",i._fontSize=24,i._fontFamily="noto",i._fontWeight="normal",i._color="#000",i._textAnchor="middle",i._dy="1em",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;return t.elem.selectAll("text").remove(),t.elem.append("text").attr("dy",t._dy).style("fill",t._color).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("font-weight",t._fontWeight).style("text-anchor",t._textAnchor).text(t._text),t}},{key:"text",value:function(t){return arguments.length?(this._text=t,this):this._text}},{key:"color",value:function(t){return arguments.length?(this._color=t,this):this._color}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontWeight",value:function(t){return arguments.length?(this._fontWeight=t,this):this._fontWeight}},{key:"textAnchor",value:function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor}},{key:"dy",value:function(t){return arguments.length?(this._dy=t,this):this._dy}}]),e}(L),et=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=t._groups?t:d3.select(t);return i.elem=n.append("div").attr("class","chart-tooltip").style("position","absolute").style("pointer-events","none").style("-moz-user-select","none").style("-webkit-user-select","none").style("-ms-user-select","none").style("user-select","none"),"static"!=n.style("position")&&"initial"!=n.style("position")||n.style("position","relative"),i._data=[],i._x=0,i._y=0,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#fff",i._backgroundColor="rgba(0,0,0,0.7)",i._borderRadius=5,i._padding={top:5,right:8,bottom:5,left:8},i._textAlign="left",i._locked=!1,i._scale=1,i._scaleValue=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._fontSize;if(t._locked)return t;t._scaleValue="function"==typeof t._scale?t._scale():t._scale,t.elem.style("background-color",t._backgroundColor).style("border-radius",t._borderRadius+"px").style("font-size",e+"px").style("font-family",t._fontFamily).style("color",t._fontColor).style("letter-spacing","0px").style("text-align",t._textAlign).style("padding",t._padding.top+"px "+t._padding.right+"px "+t._padding.bottom+"px "+t._padding.left+"px");var i=t.elem.selectAll("div").data(t._data);i.exit().remove();var n=i.enter().append("div").attr("class","tooltip-row").style("white-space","nowrap");n.append("span").attr("class","tooltip-color-circle"),n.append("span").attr("class","tooltip-text");var a=n.merge(i);return a.select(".tooltip-color-circle").style("width","0px").style("height","0px").style("border-radius","50%").style("display","inline-block").style("margin","0px").style("vertical-align","middle").filter((function(t){return t.color})).style("width",e+"px").style("height",e+"px").style("background",(function(t){if(t.color&&/\[/.test(t.color)){var e=(f=t.color,new Function("return "+f)()),i=[],n=!0,a=!1,o=void 0;try{for(var r,l=e[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var s=r.value,u=[],c=s.split(":");u.push(q(c[0])),u.push(c[1]),i.push(u)}}catch(t){a=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}var h=i.concat(),d=h.pop(),_="linear-gradient("+(90+parseFloat(d[1]))+"deg,";return h.forEach((function(t,e){_+=t[0],_+=" ",_+=100*t[1]+"%",e<h.length-1&&(_+=",")})),_+=")"}return t.color;var f})).style("margin-right","3px"),a.select(".tooltip-text").text((function(t){return t.text})).style("vertical-align","middle"),this}},{key:"move",value:function(t){var e=this;if(e._locked||!e.isShow)return e;var i=e._scaleValue||1,n=0,a=0,o=e.elem,r=o.node().parentNode,l=o.node().getBoundingClientRect(),s=r.getBoundingClientRect(),u=t||d3.mouse(r);return a=u[0]+l.width+8>s.width?u[0]-o.node().offsetWidth-8:u[0]+8,n=u[1]+l.height+5>s.height?u[1]-o.node().offsetHeight-0:u[1]+0,o.transition().duration(10).style("top",n/i+"px").style("left",a/i+"px"),e}},{key:"show",value:function(){return this._locked||(n(this.elem),this._show=!0),this}},{key:"hide",value:function(){return this._locked||(a(this.elem),this._show=!1),this}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"lock",value:function(t){return arguments.length?(this._locked=t,this):this._locked}},{key:"scale",value:function(t){return arguments.length?(this._scale=t,this):this._scale}}]),e}(L),it=function(){function t(e,i){b(this,t),this._blockData=e,this._projectTheme=i,this._dataSrc=e.dataSrc,this._blockTheme=e.theme,this._props=e.props,this._columnMap=this._props.map,this._legend=this._props.legend,this._font=this._props.font,this._axis=this._props.axis,this._paddings=this._props.paddings,this._title=this._props.titleDisplay,this._label=this._props.label,this._display=this._props.display,this._animation=this._props.animation,this._unitDisplay=this._props.unitDisplay,this._sourceDisplay=this._props.sourceDisplay,this._numberFormat=this._props.numberFormat,this._dataSolveFunc=W}return S(t,[{key:"dataSolveFunc",value:function(t){return arguments.length&&"function"==typeof t?(this._dataSolveFunc=t,this):this._dataSolveFunc}},{key:"generateColorList",value:function(t){var e=this._props.colors.type,i=V(this._props.colors.list,this._blockData,this._projectTheme);if(!t)return i;var n=i;switch(e){case"linear":var a=i.slice(0,2),o=d3.scaleLinear().domain([0,t-1]).range(a);n=d3.range(t).map((function(t,e){return o(e)}));break;case"single":n=d3.range(t).map((function(){return i[0]}));break;default:if(n=i.slice(0),i.length<t){var r=i.length;do{n.push(i[r%i.length]),r++}while(r<t)}}return n}},{key:"HexToRGBA",value:function(t){if("[object Object]"===Object.prototype.toString.call(t))return null;if(t&&/\[/.test(t))return t;if(t&&/#/.test(t)){if(t.length<8)return null==t||null==t?t:t.constructor===Object?null:t;return function(t,e){for(var i="rgba(",n=[],a=1;a<t.length;a+=2)n.push(parseInt("0x"+t.slice(a,a+2)));return n.forEach((function(t){i+=t+", "})),i+=e+")"}(t.slice(0,7),(parseInt("0x"+t.slice(7,9))/255).toFixed(2))}return null==t||null==t?t:t.constructor===Object?null:t}},{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return $(t,this.generateColorList(t.length))}},{key:"dataType",get:function(){var t="2d";if("cross-table"===this._dataSrc.dataType)t="cross-table";else{var e=this._dataSrc.data;t=e[1]?"2sheet":e[0].length+"d"}return t}},{key:"width",get:function(){return parseFloat(this._props.size.width)-2}},{key:"height",get:function(){return parseFloat(this._props.size.height)-2}},{key:"font",get:function(){return null==this._font?null:{fontSize:this._font.fontSize||this._blockData.theme.fonts.fontSize||12,color:this.HexToRGBA(this._font.color)||this._blockData.theme.fonts.fontColor||"#000",fontFamily:this._font.fontFamily||this._blockData.theme.fonts.fontFamily||"sans-serif"}}},{key:"display",get:function(){return Object.assign({},this._props.display)}},{key:"animation",get:function(){return Object.assign({},this._props.animation)}},{key:"unitDisplay",get:function(){return Object.assign({},this._props.unitDisplay)}},{key:"sourceDisplay",get:function(){return Object.assign({},this._props.sourceDisplay)}},{key:"axisCopy",get:function(){return Object.assign({},this._props.axis)}},{key:"timerControl",get:function(){return Object.assign({},this._props.timerControl)}},{key:"pictures",get:function(){return Object.assign({},this._props.pictures)}},{key:"table",get:function(){return Object.assign({},this._props.table)}},{key:"paddings",get:function(){return{top:this._paddings&&this._paddings.top||20,bottom:this._paddings&&this._paddings.bottom||23,left:this._paddings&&this._paddings.left||24,right:this._paddings&&this._paddings.right||24}}},{key:"legend",get:function(){return null==this._legend?null:{show:!1!==this._legend.show,xPosition:this._legend.xPosition,yPosition:this._legend.yPosition,styleOptions:this._legend.styleOptions,style:this._legend.style,lineHeight:this._legend.lineHeight,color:this.HexToRGBA(this._legend.color),fontFamily:this._legend.fontFamily,fontSize:this._legend.fontSize}}},{key:"tooltipShow",get:function(){return this._props.tooltip}},{key:"axis",get:function(){return this._axis?{color:this.HexToRGBA(this._axis.color)||this._blockTheme.axis.color,x:this._axis.x,y:this._axis.y,y1:this._axis.y1}:{color:"ccc",x:null,y:null,y1:null}}},{key:"polarAxis",get:function(){return this._axis?{color:this.HexToRGBA(this._axis.color)||this._blockTheme.axis.color,x:this._axis.circular||{},y:this._axis.radial||{}}:{color:"ccc",x:null,y:null}}},{key:"label",get:function(){return Object.assign({},this._props.label)}},{key:"grid",get:function(){if(!this._axis)return{showX:!0,showY:!0,color:"#ccc",gridLineWidth:0,gridLineStyle:null};var t=this._axis.grid;return{showX:null==t?null:"all"===t.show||"x"===t.show,showY:null==t?null:"all"===t.show||"y"===t.show,color:null==t?null:this.HexToRGBA(t.color)||this._blockTheme.grid&&this._blockTheme.grid.color||"#ccc",gridLineWidth:null==t?null:0==t.gridLineWidth||t.gridLineWidth?t.gridLineWidth:1,gridLineStyle:null==t?null:t.lineStyle?t.lineStyle:null}}},{key:"backgroundColor",get:function(){return this._props.backgroundColor||"transparent"}},{key:"colors",get:function(){return this._props.colors}},{key:"title",get:function(){var t=this._title||{};return{show:!1!==t.show,text:t.text||"",xPosition:t.xPosition||"center",yPosition:t.yPosition||"top",fontSize:t.fontSize||24,color:this.HexToRGBA(t.color)||"#000",fontFamily:t.fontFamily||"noto",lineHeight:t.lineHeight||10,totalHeight:t.totalHeight||39}}},{key:"numberFormat",get:function(){if(!this._numberFormat)return{style:"1000.00",decimalPlaces:null};var t=this._numberFormat||{};return{style:t.style||"1000.00",decimalPlaces:t.decimalPlaces}}}]),t}(),nt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t._groups?t.append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("version","1.1"):d3.select(t).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("version","1.1"),i.defs=i.elem.append("defs"),i.group=i.elem.append("g").attr("class","svg-group"),i.mainGroup=i.group.append("g").attr("class","main-group"),i.title=new K(i.group),i.unitText=new J(i.group),i.sourceText=new tt(i.group),i.legend=new Q(i.group),i.tooltip=new et(t),i.labelTextClass="chart-label-text",i._data=[],i._width=400,i._height=400,i._backgroundColor=null,i._fontSize=12,i._fontColor="#000",i._fontFamily="sans-serif",i._transition=!1,i._duration=0,i._legendShow=!0,i._legendX="center",i._legendY="bottom",i._titleShow=!0,i._titleText="",i._titleX="center",i._titleY="top",i._titleFontSize=24,i._titleColor="#000",i._titleFontFamily="sans-serif",i._unitWord="",i._sourceWord="",i._marginTop=20,i._marginRight=24,i._marginBottom=23,i._marginLeft=24,i._gapPadding=15,i._titlePadding=10,i._unitPadding=15,i._sourcePadding=15,i._sortValue=0,i._sortedDataCopy=null,i._dataType="2d",i._tooltipShow=!0,i.tableTrans=0,i}return w(e,t),S(e,[{key:"_init",value:function(){var t=window.location.hostname,e="U2FsdGVkX1/u6EfnJcBwjl1lkrkHd1SLbqY/JBKMPPGUREtzJjAbYQ==";if(null==window.userId){var i=locked(t);"421aa90e079fa326b6494f812ad13e79"!=i&&"e5a748477660158b28c438af2cee80f6"!=i&&"31c49882abd53548158d8da55e154557"!=i&&"1c7d17e20b0caf276ddafea04a974399"!=i&&"68952600154b32fe212054caf039ee18"!=i&&"dycharts.com"!=t&&"dydata.io"!=t||this.update()}else{var n=locked(e);window.userId==n&&this.update()}return String.prototype.cestqui=function(){return e},this}},{key:"update",value:function(){return this._timeScale=1,this._interrupt=!1,this._DynamicInterrupt=!0,this._titlePadding=this._unitWord&&this._unitShow?this._titlePadding:15,this.styleSvg(),this.sortData(),this.removeLabelText(),this.updateTitle(),this.updateUnit(),this.updateSource(),this.updateLegend(),this.getTableTrans(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateTitle",value:function(){var t=this,e=t.title;if(!t._titleShow)return e.hide();var i="center"===t._titleX?"middle":"left"===t._titleX?"start":"end";e.text(t._titleText).color(t._titleColor).fontSize(t._titleFontSize).fontFamily(t._titleFontFamily).fontWeight("bold").textAnchor(i).dy("1em").width(t.widthOfNoMargin),e.update(),e.show();var n=this._titleText&&this._titleShow?Math.floor(this.title.height()-.25*this._titleFontSize+this._titlePadding):0,a=this._titleText&&this._titleShow?this._totalHeight+this._titlePadding:0,o=this._titleText&&this._titleShow?Math.floor(this.title.height()-.25*this._titleFontSize):0;(new RegExp("^方正[一-龥]+$").test(t._titleFontFamily)||"站酷高端黑"==t._titleFontFamily)&&(n=this._titleText&&this._titleShow?Math.floor(this.title.height()-.05*this._titleFontSize+this._titlePadding):0,o=this._titleText&&this._titleShow?Math.floor(this.title.height()-.05*this._titleFontSize):0);this._height;this.hideHeight=n,this.elem.attr("totalHeight",o)}},{key:"updateUnit",value:function(){var t=this,e=t.unitText;if(!t._unitShow)return e.hide();if(""==t._unitWord)return e.hide();var i="center"===t._unitX?"middle":"left"===t._unitX?"start":"end";e.text(t._unitWord).color(t._unitFontColor).fontSize(t._unitFontSize).fontFamily(t._unitFontFamily).textAnchor(i).dy("1em"),e.update(),e.show(),this.hideUnitHeight=this._unitWord&&this._unitShow?1.125*parseFloat(this._unitFontSize):0}},{key:"updateSource",value:function(){var t=this,e=t.sourceText;if(!t._sourceShow)return e.hide();if(""==t._sourceWord)return e.hide();var i="center"===t._sourceX?"middle":"left"===t._sourceX?"start":"end";e.text(t._sourceWord).color(t._sourceFontColor).fontSize(t._sourceFontSize).fontFamily(t._sourceFontFamily).textAnchor(i).dy("1em"),e.update(),e.show(),this.hideSourceHeight=this._sourceWord&&this._sourceShow?1.125*parseFloat(this._sourceFontSize):0}},{key:"updateLegend",value:function(){var t=this,e=t.legend,i=this._width-this._marginLeft-this._marginRight;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(i).fontSize(t._legendFontSize).fontFamily(t._legendFontFamily).fontColor(t._legendFontColor).horizontalAlign(t._legendX).each((function(t){var e=!1===t.active;d3.select(this).classed("clicked",e).style("opacity",e?.5:1)})),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"updateCore",value:function(){}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateCore()}},{key:"onInterruptChange",value:function(){}},{key:"onDurationChange",value:function(t){this._duration=this._timeDuration,this._timeScale=t||1,this._duration=this._timeDuration*this._timeScale,this.updateCore()}},{key:"onClearTimer",value:function(){}},{key:"removeLabelText",value:function(){this.elem.selectAll("."+this.labelTextClass).remove()}},{key:"styleSvg",value:function(){this.elem.attr("width",this._width).attr("height",this._height).style("background-color",this._backgroundColor).style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("letter-spacing","0px").style("user-select","none"),this.group.call(o,this._marginLeft,this._marginTop)}},{key:"layout",value:function(){var t=this.title,e=this.unitText,i=this.sourceText,n=this.legend,a=this.mainGroup,r=this._titleText&&this._titleShow?this.title.height()-.25*this._titleFontSize:0;(new RegExp("^方正[一-龥]+$").test(this._titleFontFamily)||"站酷高端黑"==this._titleFontFamily)&&(r=this._titleText&&this._titleShow?this.title.height()-.05*this._titleFontSize:0);var l=this._unitWord&&this._unitShow?1.125*parseFloat(this._unitFontSize):0,s=this._sourceWord&&this._sourceShow?1.125*parseFloat(this._sourceFontSize):0,u=n.height(),c=this.heightOfMainGroup,h=this._titleText&&this._titleShow?this._titlePadding:0,d=this._unitWord&&this._unitShow?this._unitPadding:0,_=this._sourceWord&&this._sourceShow?this._sourcePadding:0,f=this._legendShow&&0!=u?this._gapPadding:0,p="top",y="bottom",x=this._titleY,g=this._legendY;x!==p&&x!==y&&(x=p),g!==p&&g!==y&&(g=y);var v=0,m=0,b=0,S=0,k=0,w=this._titleText&&this._titleShow?.15*this._titleFontSize:0,C=this._unitWord&&this._unitShow?.1*this._unitFontSize:0,O=this._sourceWord&&this._sourceShow?.15*this._sourceFontSize:0,F=this._legendShow&&0!=u?.25*this._legendFontSize+(1.125*this._legendFontSize/2-6):0;x===p&&g===p?(v=-w,b=(k=(S=(m=r+h-w-C)+l+d+C+(this._legendShow&&0!=u?1.125*this._legendFontSize/2-6:0))+u+f-F)+c+_-O):x===y&&g===y?(m=-C,v=(b=(S=(k=l+d+C)+c+f+(this._legendShow&&0!=u?1.125*this._legendFontSize/2-6:0))+u+_-F-O)+s+h-w):x===p&&g===y?(v=-w,b=(S=(k=(m=r+h-w-C)+l+d+C)+c+f+(this._legendShow&&0!=u?1.125*this._legendFontSize/2-6:0))+u+_-F-O):(S=this._legendShow&&0!=u?1.125*this._legendFontSize/2-6:0,v=(b=(k=(m=u+f-(this._legendShow&&0!=u?.25*this._legendFontSize:0)-C)+l+d+C)+c+_-O)+s+h-w);var L=this._width-this._marginLeft-this._marginRight,P="center"===this._titleX?L/2:"left"===this._titleX?0:L,A="center"===this._unitX?L/2:"left"===this._unitX?0:L,W="center"===this._sourceX?L/2:"left"===this._sourceX?0:L;t.translate(P,v),e.translate(A,m),i.translate(W,b),n.translate(0,S),a.call(o,0,k),this.tableTrans=k}},{key:"getTableTrans",value:function(){this.title,this.unitText,this.sourceText;var t=this.legend,e=(this.mainGroup,this._titleText&&this._titleShow?this.title.height()-.25*this._titleFontSize:0);(new RegExp("^方正[一-龥]+$").test(this._titleFontFamily)||"站酷高端黑"==this._titleFontFamily)&&(e=this._titleText&&this._titleShow?this.title.height()-.05*this._titleFontSize:0);var i=this._unitWord&&this._unitShow?1.125*parseFloat(this._unitFontSize):0,n=(this._sourceWord&&this._sourceShow&&parseFloat(this._sourceFontSize),t.height()),a=this.heightOfMainGroup,o=this._titleText&&this._titleShow?this._titlePadding:0,r=this._unitWord&&this._unitShow?this._unitPadding:0,l=(this._sourceWord&&this._sourceShow&&this._sourcePadding,this._legendShow&&0!=n?this._gapPadding:0),s="top",u="bottom",c=this._titleY,h=this._legendY;c!==s&&c!==u&&(c=s),h!==s&&h!==u&&(h=u);var d=0,_=this._titleText&&this._titleShow?.15*this._titleFontSize:0,f=this._unitWord&&this._unitShow?.1*this._unitFontSize:0,p=(this._sourceWord&&this._sourceShow&&this._sourceFontSize,this._legendShow&&0!=n?.25*this._legendFontSize+(1.125*this._legendFontSize/2-6):0);c===s&&h===s?d=e+o-_-f+i+r+f+(this._legendShow&&0!=n?1.125*this._legendFontSize/2-6:0)+n+l-p:c===u&&h===u?(-f,d=i+r+f,this._legendShow&&0!=n&&this._legendFontSize):c===s&&h===u?(d=e+o-_-f+i+r+f,this._legendShow&&0!=n&&this._legendFontSize):(this._legendShow&&0!=n?1.125*this._legendFontSize/2-6:0,d=n+l-(this._legendShow&&0!=n?.25*this._legendFontSize:0)-f+i+r+f),this.tableTrans=d}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"backgroundColor",value:function(t){return arguments.length?(this._backgroundColor=t,this):this._backgroundColor}},{key:"legendShow",value:function(t){return arguments.length?(this._legendShow=t,this):this._legendShow}},{key:"legendX",value:function(t){return arguments.length?(this._legendX=t,this):this._legendX}},{key:"legendY",value:function(t){return arguments.length?(this._legendY=t,this):this._legendY}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"gapPadding",value:function(t){return arguments.length?(this._gapPadding=parseFloat(t),this):this._gapPadding}},{key:"unitPadding",value:function(t){return arguments.length?(this._unitPadding=parseFloat(t),this):this._unitPadding}},{key:"sourcePadding",value:function(t){return arguments.length?(this._sourcePadding=parseFloat(t),this):this._sourcePadding}},{key:"marginTop",value:function(t){return arguments.length?(this._marginTop=parseFloat(t),this):this._marginTop}},{key:"marginRight",value:function(t){return arguments.length?(this._marginRight=parseFloat(t),this):this._marginRight}},{key:"marginBottom",value:function(t){return arguments.length?(this._marginBottom=parseFloat(t),this):this._marginBottom}},{key:"marginLeft",value:function(t){return arguments.length?(this._marginLeft=parseFloat(t),this):this._marginLeft}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"sortValue",value:function(t){return arguments.length?(this._sortValue=parseFloat(t),this):this._sortValue}},{key:"dataType",value:function(t){return arguments.length?(this._dataType=t,this):this._dataType}},{key:"tooltipShow",value:function(t){return arguments.length?(this._tooltipShow=t,this):this._tooltipShow}},{key:"titleShow",value:function(t){return arguments.length?(this._titleShow=t,this):this._titleShow}},{key:"titleText",value:function(t){return arguments.length?(this._titleText=t,this):this._titleText}},{key:"titleColor",value:function(t){return arguments.length?(this._titleColor=t,this):this._titleColor}},{key:"titleFontSize",value:function(t){return arguments.length?(this._titleFontSize=t,this):this._titleFontSize}},{key:"titleFontFamily",value:function(t){return arguments.length?(this._titleFontFamily=t,this):this._titleFontFamily}},{key:"titleX",value:function(t){return arguments.length?(this._titleX=t,this):this._titleX}},{key:"titleY",value:function(t){return arguments.length?(this._titleY=t,this):this._titleY}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"colors",value:function(t){return arguments.length?(this._colors=t,this):this._colors}},{key:"titlePadding",value:function(t){return arguments.length?(this._titlePadding=t,this):this._titlePadding}},{key:"unitPadding",value:function(t){return arguments.length?(this._unitPadding=t,this):this._unitPadding}},{key:"sourcePadding",value:function(t){return arguments.length?(this._sourcePadding=t,this):this._sourcePadding}},{key:"legendFontFamily",value:function(t){return arguments.length?(this._legendFontFamily=t,this):this._legendFontFamily}},{key:"legendFontSize",value:function(t){return arguments.length?(this._legendFontSize=parseFloat(t),this):this._legendFontSize}},{key:"legendFontColor",value:function(t){return arguments.length?(this._legendFontColor=t,this):this._legendFontColor}},{key:"totalHeight",value:function(t){return arguments.length?(this._totalHeight=parseFloat(t),this):this._totalHeight}},{key:"countOfLabel",value:function(t){return arguments.length?(this._countOfLabel=parseFloat(t),this):this._countOfLabel}},{key:"timeDuration",value:function(t){return arguments.length?(this._timeDuration=parseFloat(t),this):this._timeDuration}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"sortData",value:function(){var t=this._data.slice(0),e=this._sortValue,i=this._dataType,n=t.map((function(t){return t.color})),a=void 0;"cross-table"===i?(t.forEach((function(t){t.sum=d3.sum(t.data,(function(t){return t.value}))})),a=1===e?function(t,e){return t.sum-e.sum}:-1===e?function(t,e){return e.sum-t.sum}:null):a=1===e?function(t,e){return t.value-e.value}:-1===e?function(t,e){return e.value-t.value}:null,this._sortedDataCopy=a?t.sort(a).map((function(t,e){return t.color=n[e],t})):t}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=W;switch(i.dataType){case"cross-table":n=M;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){this.data(t.data).backgroundColor(t.backgroundColor).width(t.width).height(t.height).colorList(t._blockTheme.colors).colors(t.colors),this.fontFamily(t.font?t.font.fontFamily:"阿里巴巴普惠体 常规").fontSize(t.font?t.font.fontSize:14).fontColor(t.font?t.font.color:"#000"),this.titleShow(t.title.show).titleText(t.title.text).titleColor(t.title.color).titleFontFamily(t.title.fontFamily).titleFontSize(t.title.fontSize).titleX(t.title.xPosition).titleY(t.title.yPosition).titlePadding(parseFloat(t.title.lineHeight||10)).totalHeight(parseFloat(t.title.totalHeight||39)),this.legendShow(t.legend.show).legendX(t.legend.xPosition).legendY(t.legend.yPosition).gapPadding(parseFloat(t.legend.lineHeight||15)).legendFontFamily(t.legend.fontFamily||"Noto Sans").legendFontSize(parseFloat(t.legend.fontSize||14)).legendFontColor(t.legend.color||"#545454"),this.tooltipShow(t.tooltipShow),this.dataType(t.dataType),this.unitPadding(parseFloat(t.unitDisplay.bottomLineHeight||15)).sourcePadding(parseFloat(t.sourceDisplay.topLineHeight||15)).marginTop(t.paddings?parseFloat(t.paddings.top||20):20).marginBottom(t.paddings?parseFloat(t.paddings.bottom||23):23).marginLeft(t.paddings?parseFloat(t.paddings.left||24):24).marginRight(t.paddings?parseFloat(t.paddings.right||24):24),this.timeDuration(t._animation&&t._animation.duration||0),this.numberStyle(t.numberFormat.style).decimalPlaces(t.numberFormat.decimalPlaces)}},{key:"setSelfOption",value:function(t){}},{key:"setOption",value:function(t,e,i){var n=this.buildOption(t,e);this._interrupt=!1,this._DynamicInterrupt=!0,this.setPublicOption(n),this.setSelfOption(n),this.group.attr("opacity",1),this._init()}},{key:"setInsertOption",value:function(t,e,i){var n=this.buildOption(t,e);this._interrupt=!1,this._DynamicInterrupt=!0,this.setPublicOption(n),this.setSelfOption(n),this._transition=!1,this.group.attr("opacity",0),this._init()}},{key:"widthOfNoMargin",get:function(){var t=this._width-this._marginLeft-this._marginRight;return t>0?t:0}},{key:"heightOfNoMargin",get:function(){this._titleText&&this._titleShow&&Math.floor(this.title.height()-.25*this._titleFontSize+this._titlePadding),this._titleText&&this._titleShow&&(this._totalHeight,this._titlePadding);(new RegExp("^方正[一-龥]+$").test(this._titleFontFamily)||"站酷高端黑"==this._titleFontFamily)&&(this._titleText&&this._titleShow&&Math.floor(this.title.height()-.05*this._titleFontSize+this._titlePadding));var t=this._height-this._marginTop-this._marginBottom;return t>0?t:0}},{key:"heightOfMainGroup",get:function(){var t=this._titleText&&this._titleShow?this.title.height()-.4*this._titleFontSize+this._titlePadding:0;(new RegExp("^方正[一-龥]+$").test(this._titleFontFamily)||"站酷高端黑"==this._titleFontFamily)&&(t=this._titleText&&this._titleShow?this.title.height()-.2*this._titleFontSize+this._titlePadding:0);var e=this._unitWord&&this._unitShow?1.125*parseFloat(this._unitFontSize)+this._unitPadding:0,i=this._sourceWord&&this._sourceShow?1.125*parseFloat(this._sourceFontSize)+this._sourcePadding:0,n=this._legendShow&&0!=this.legend.height()?this.legend.height()+(0==this.legend.height()?0:this._gapPadding)-.3*this._legendFontSize:0,a=this.heightOfNoMargin-n-t-e-i;return a>0?a:0}},{key:"activeData",get:function(){return l(this.sortedDataCopy)}},{key:"sortedDataCopy",get:function(){return this._sortedDataCopy}}]),e}(L),at=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g"),i.group=i.elem.append("g"),i._data=[],i._transition=!1,i._duration=0,i._onTransitionStart=function(){},i._onTransitionEnd=function(){},i._onMouseover=function(){},i._onMousemove=function(){},i._onMouseout=function(){},i}return w(e,t),S(e,[{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"onTransitionStart",value:function(t){return arguments.length?(this._onTransitionStart="function"==typeof t?t:function(){},this):this._onTransitionStart}},{key:"onTransitionEnd",value:function(t){return arguments.length?(this._onTransitionEnd="function"==typeof t?t:function(){},this):this._onTransitionEnd}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),e}(L),ot=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","pie"),i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._innerRadius=0,i._outerRadius=0,i._startAngle=0,i._endAngle=2*Math.PI,i._cornerRadius=0,i._padAngle=.01,i._padRadius=null,i._sortMethod=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove(),t.group.attr("stroke-linejoin","round"),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}})),t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius).padAngle(t._padAngle).padRadius(t._padRadius),t.pieFunc.value((function(t){return Math.abs(t.value)})).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod);var n=t.pieFunc(e);if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var a=t.group.selectAll("path").data(n);a.exit().remove(),a.merge(a.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._areaBorderWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).transition().duration(0).ease(d3.easeLinear).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(0==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var o=t.group.selectAll("path").data(n);o.exit().remove();var r=o.merge(o.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._areaBorderWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?r.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):r.transition().duration((function(i,n){return function(i){for(var n=0,a=0;a<i;a++)n=e[a].percent/100;return n*(t._transition?.9*t._duration:0)}(n+1)})).ease(d3.easeLinear).delay((function(i,n){return t._transition?t._startDelay+function(i){for(var n=0,a=0;a<i;a++)n+=e[a].percent/100;return n*(t._transition?.9*t._duration:0)}(n):0})).attrTween("d",(function(e){var i=d3.interpolate(e.startAngle,e.endAngle);return function(n){return e.endAngle=i(n),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(1==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var l=t.group.selectAll("path").data(n);l.exit().remove();var s=l.merge(l.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._areaBorderWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?s.transition().duration(0).delay(0).ease(d3.easeCubicOut).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeCubicOut).attrTween("d",(function(e){var i=d3.interpolate(e.startAngle,e.endAngle);return function(n){return e.endAngle=i(n),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(2==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var u=t.group.selectAll("path").data(n);u.exit().remove();var h=u.merge(u.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._areaBorderWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?h.transition().duration(0).delay(0).ease(d3.easeLinear).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):h.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("d",(function(e){e.innerRadius=0;var i=d3.interpolate({startAngle:0,endAngle:0},e);return function(e){return t.arcFunc(i(e))}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(3==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var d=t.group.selectAll("path").data(n);d.exit().remove();var _=d.merge(d.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._areaBorderWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?_.transition().duration(0).delay(0).ease(d3.easeLinear).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):_.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("d",(function(e){var i=d3.interpolateNumber(t._innerRadius,t._outerRadius);return function(n){var a=i(n);return t.arcFunc.outerRadius(a),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}if(t.group.selectAll(".pie-texts").remove(),t.group.selectAll(".pie-percents").remove(),t.group.selectAll(".pie-numbers").remove(),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none");else if(1==t._positionOptions.indexOf(t._positionChoice)){var f=t.group.append("g").selectAll("g").data(n);f.exit().remove(),f.enter().append("g").attr("class","pie-text-groups").merge(f).each((function(e,i){d3.select(this).append("g").attr("class","pie-texts").append("text").text(t._limitWidth?X(e.data.name,t._limitWidth,t._fontSize,t._fontFamily):e.data.name).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]-1.3*t._fontSize})).style("opacity",(function(){return-1!=String(e.data.name).indexOf("$-")?0:1})),d3.select(this).append("g").attr("class","pie-percents").append("text").text(t._limitWidth?X(E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._limitWidth,t._fontSize,t._fontFamily):E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return z(t)[0]})).attr("y",(function(t){return z(t)[1]})),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(t._limitWidth?X(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._limitWidth,t._fontSize,t._fontFamily):E(e.data.value,t._numberStyle,t._decimalPlaces)).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]+1.3*t._fontSize}))})),1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(t){return z(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(t){return z(t)[1]})),t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(t){return z(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-texts text").style("display","none")):2==t._contentChoice.length&&(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","none")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return z(t)[0]})).attr("y",(function(e){return z(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-texts text").style("display","none")))}t._interrupt?t.group.selectAll(".pie-text-groups").style("opacity",1):t.group.selectAll(".pie-text-groups").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._duration?t._startDelay+.9*t._duration:0})).style("opacity",1);for(var g=t.group.selectAll(".pie-text-groups"),v=[],m=[],b=0;b<g._groups[0].length;b++){m.push(b);for(var S=b+1;S<g._groups[0].length;S++){p(i(d3.select(g._groups[0][b])),i(d3.select(g._groups[0][S])))&&(v.push(b),d3.select(g._groups[0][b]).style("visibility","hidden"))}}for(var k=new Set(v),w=Array.from(k),C=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(w,m),O=0;O<w.length;O++){for(var F=[],L=0;L<C.length;L++){var P=i(d3.select(g._groups[0][w[O]])),A=i(d3.select(g._groups[0][C[L]]));if(F.push(p(P,A)),p(P,A)){if(w[O]==C[L])continue;d3.select(g._groups[0][w[O]]).style("visibility","hidden")}}0==F.filter((function(t){return 1==t})).length&&C.push(w[O])}for(var W=0;W<C.length;W++)d3.select(g._groups[0][C[W]]).style("visibility","visible");function z(e){var i=t._outerRadius*(t._innerRadiusRatio?t._innerRadiusRatio+(1-t._innerRadiusRatio)/2:.7),n=(e.startAngle+e.endAngle)/2-Math.PI/2;return[Math.cos(n)*i,Math.sin(n)*i]}return t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"limitWidth",value:function(t){return arguments.length?(this._limitWidth=t,this):this._limitWidth}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),rt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","pie-text"),i._stroke="#fff",i._strokeWidth=1,i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._radius=0,i._cornerRadius=0,i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t._data;t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius).padAngle(t._padAngle).padRadius(t._padRadius),t.pieFunc.value((function(t){return Math.abs(t.value)})).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod),t.group.selectAll("*").remove();var e=t.pieFunc(t._data),i=t.group.selectAll("g.pie-text-group").data(e);i.exit().remove();var n=i.enter().append("g").attr("class","pie-text-group");n.append("g");var a=i.merge(n).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?a.select("g").transition().duration(0).delay(0).ease(d3.easeLinear).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):a.select("g").transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay+.1*t._duration:0).ease(d3.easeLinear).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),lt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","outside-text-polygon"),i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._innerRadius=0,i._outerRadius=0,i._startAngle=0,i._endAngle=2*Math.PI,i._cornerRadius=0,i._padAngle=0,i._padRadius=null,i._suffix="",i._areaBorderColor="#fff",i._areaBorderWidth=1,i._sortMethod=null,i._type="normal",i._areaType="normal",i._numberStyle="1000.00",i._decimalPlaces=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=d3.max(t._data,(function(t){return Math.abs(t.value)})),a=t._outerRadius,o=d3.scaleLinear().domain([0,n]).range([t._innerRadius,a]);t.group.selectAll("*").remove();var r=t.group;e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-pie-out-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),"normal"==t._type?t.pieFunc.value((function(t){return+t.value})).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod):(t.pieFunc.value(1).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod),"area"==t._sizeType&&(o=d3.scaleSqrt().domain([0,n]).range([t._innerRadius,a])));var l=t.pieFunc(t._data);function s(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function u(e){var i="normal"==t._type?t._outerRadius:o(Math.abs(e.data.value)),n=(e.startAngle+e.endAngle)/2-Math.PI/2;return[Math.cos(n)*i,Math.sin(n)*i]}r.selectAll(".half-texts").remove(),r.selectAll(".half-percent").remove(),r.selectAll(".half-numbers").remove(),r.selectAll("g").remove();var h=r.append("g").selectAll("g").data(l);h.exit().remove(),h.enter().append("g").attr("class","pie-texts").merge(h).each((function(e,i){d3.select(this).append("g").attr("class","half-texts").append("text").text(t._limitWidth?X(e.data.name,t._limitWidth,t._fontSize,t._fontFamily):e.data.name).attr("dy","-0.6em").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){var i=u(e);return"normal"==t._areaType?1.2*i[0]+.1*t._outerRadius*(s(e)>Math.PI?-1:1):"half"==t._areaType?1.2*i[0]+.1*t._outerRadius*(s(e)<0?-1:1):void 0})).attr("y",(function(t){return 1.2*u(t)[1]})).style("opacity",(function(){return-1!=String(e.data.name).indexOf("$-")?0:1})).transition().duration(0).ease(d3.easeLinear).styleTween("text-anchor",(function(e){this._current=this._current||e;var i=d3.interpolate(this._current,e);return this._current=i(0),function(e){var n=i(e);return"normal"==t._areaType?s(n)<Math.PI||s(n)==Math.PI?"start":"end":"half"==t._areaType?s(n)>0||0==s(n)?"start":"end":void 0}})),d3.select(this).append("g").attr("class","half-percent").append("text").text(t._limitWidth?X(E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._limitWidth,t._fontSize,t._fontFamily):E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%").attr("dy","0.4em").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){var i=u(e);return"normal"==t._areaType?1.2*i[0]+.1*t._outerRadius*(s(e)>Math.PI?-1:1):"half"==t._areaType?1.2*i[0]+.1*t._outerRadius*(s(e)<0?-1:1):void 0})).attr("y",(function(t){return 1.2*u(t)[1]})).transition().duration(0).ease(d3.easeLinear).styleTween("text-anchor",(function(e){this._current=this._current||e;var i=d3.interpolate(this._current,e);return this._current=i(0),function(e){var n=i(e);return"normal"==t._areaType?s(n)<Math.PI||s(n)==Math.PI?"start":"end":"half"==t._areaType?s(n)>0||0==s(n)?"start":"end":void 0}})),d3.select(this).append("g").attr("class","half-numbers").append("text").text(t._limitWidth?X(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._limitWidth,t._fontSize,t._fontFamily):E(e.data.value,t._numberStyle,t._decimalPlaces)).attr("dy","1.4em").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){var i=u(e);return"normal"==t._areaType?1.2*i[0]+.1*t._outerRadius*(s(e)>Math.PI?-1:1):"half"==t._areaType?1.2*i[0]+.1*t._outerRadius*(s(e)<0?-1:1):void 0})).attr("y",(function(t){return 1.2*u(t)[1]})).transition().duration(0).ease(d3.easeLinear).styleTween("text-anchor",(function(e){this._current=this._current||e;var i=d3.interpolate(this._current,e);return this._current=i(0),function(e){var n=i(e);return"normal"==t._areaType?s(n)<Math.PI||s(n)==Math.PI?"start":"end":"half"==t._areaType?s(n)>0||0==s(n)?"start":"end":void 0}}))})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){return 1.2*u(e)[0]+.1*t._outerRadius*(s(e)>Math.PI?-1:1)})).attr("y",(function(t){return 1.2*u(t)[1]}));var d=t.group.selectAll("polyline").data(l);d.exit().remove(),d.merge(d.enter().append("polyline")).style("stroke",(function(e,i){return/\[/.test(e.data.color)?"url("+c("#"+t.id+"-pie-out-index-"+i)+")":e.data.color})).style("fill","none").transition().duration(0).ease(d3.easeLinear).attrTween("points",(function(e){this._current=this._current||e;var i=d3.interpolate(this._current,e);return this._current=i(0),function(e){var n=i(e),a=u(n);return"normal"==t._areaType?[a,1.2*a[0],1.2*a[1],1.2*a[0]+.1*t._outerRadius*(s(n)>Math.PI?-1:1),1.2*a[1]]:"half"==t._areaType?[a,1.2*a[0],1.2*a[1],1.2*a[0]+.1*t._outerRadius*(s(n)<0?-1:1),1.2*a[1]]:void 0}}));r.selectAll(".half-texts text").nodes(),r.selectAll(".half-percent text").nodes(),r.selectAll(".half-numbers text").nodes(),r.selectAll("polyline").nodes();0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length||-1==t._positionOptions.indexOf(t._positionChoice)?(r.selectAll(".half-texts text").style("display","none"),r.selectAll(".half-percent text").style("display","none"),r.selectAll(".half-numbers text").style("display","none"),r.selectAll("polyline").style("display","none")):0!=t._positionOptions.indexOf(t._positionChoice)&&2!=t._positionOptions.indexOf(t._positionChoice)||(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".half-texts text").style("display","block").attr("dy","0.3em"),r.selectAll(".half-percent text").style("display","none"),r.selectAll(".half-numbers text").style("display","none"),r.selectAll("polyline").style("display","block")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".half-percent text").style("display","block").attr("dy","0.3em"),r.selectAll(".half-texts text").style("display","none"),r.selectAll(".half-numbers text").style("display","none"),r.selectAll("polyline").style("display","block")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".half-numbers text").style("display","block").attr("dy","0.3em"),r.selectAll(".half-percent text").style("display","none"),r.selectAll(".half-texts text").style("display","none"),r.selectAll("polyline").style("display","block")):2==t._contentChoice.length&&(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".half-texts text").style("display","block").attr("dy","-0.1em"),r.selectAll(".half-percent text").style("display","block").attr("dy","0.9em"),r.selectAll(".half-numbers text").style("display","none"),r.selectAll("polyline").style("display","block")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".half-texts text").style("display","block").attr("dy","-0.1em"),r.selectAll(".half-numbers text").style("display","block").attr("dy","0.9em"),r.selectAll(".half-percent text").style("display","none"),r.selectAll("polyline").style("display","block")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".half-percent text").style("display","block").attr("dy","-0.1em"),r.selectAll(".half-numbers text").style("display","block").attr("dy","0.9em"),r.selectAll(".half-texts text").style("display","none"),r.selectAll("polyline").style("display","block")))),t._interrupt?(r.selectAll(".pie-texts").style("opacity",1),r.selectAll("polyline").style("opacity",1)):(r.selectAll(".pie-texts").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1),r.selectAll("polyline").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1));for(var _=r.selectAll(".pie-texts"),f=r.selectAll("polyline"),g=[],v=[],m=0;m<_._groups[0].length;m++){v.push(m);for(var b=m+1;b<_._groups[0].length;b++){var S=s(d3.select(_._groups[0][m])._groups[0][0].__data__),k=s(d3.select(_._groups[0][b])._groups[0][0].__data__),w=d3.select(_._groups[0][m])._groups[0][0].__data__.data.value||0,C=d3.select(_._groups[0][b])._groups[0][0].__data__.data.value||0,O="start",F="start";"normal"==t._areaType?(O=S<Math.PI||S==Math.PI?"start":"end",F=k<Math.PI||k==Math.PI?"start":"end"):"half"==t._areaType&&(O=S>0||0==S?"start":"end",F=k>0||0==k?"start":"end"),p(i(d3.select(_._groups[0][m])),i(d3.select(_._groups[0][b])),O,F)&&(w<C?(g.push(m),d3.select(_._groups[0][m]).style("visibility","hidden"),d3.select(f._groups[0][m]).style("visibility","hidden")):(g.push(b),d3.select(_._groups[0][b]).style("visibility","hidden"),d3.select(f._groups[0][b]).style("visibility","hidden")))}}for(var L=new Set(g),P=Array.from(L),A=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(P,v),W=0;W<P.length;W++){for(var z=[],M=0;M<A.length;M++){var D=s(_._groups[0][P[W]].__data__),R=s(_._groups[0][A[M]].__data__),N=_._groups[0][P[W]].__data__.data.value||0,T=_._groups[0][A[M]].__data__.data.value||0,B="start",G="start";"normal"==t._areaType?(B=D<Math.PI||D==Math.PI?"start":"end",G=R<Math.PI||R==Math.PI?"start":"end"):"half"==t._areaType&&(B=D>0||0==D?"start":"end",G=R>0||0==R?"start":"end");var j=i(d3.select(_._groups[0][P[W]])),I=i(d3.select(_._groups[0][A[M]]));if(z.push(p(j,I,B,G)),p(j,I,B,G)){if(P[W]==A[M])continue;N<T?(d3.select(_._groups[0][P[W]]).style("visibility","hidden"),d3.select(f._groups[0][P[W]]).style("visibility","hidden")):(d3.select(_._groups[0][P[M]]).style("visibility","hidden"),d3.select(f._groups[0][P[M]]).style("visibility","hidden"))}}0==z.filter((function(t){return 1==t})).length&&A.push(P[W])}for(var Y=0;Y<A.length;Y++)d3.select(_._groups[0][A[Y]]).style("visibility","visible"),d3.select(f._groups[0][A[Y]]).style("visibility","visible");return t}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"values",value:function(t){return arguments.length?(this._values=t,this):this._values}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"areaType",value:function(t){return arguments.length?(this._areaType=t,this):this._areaType}},{key:"level",value:function(t){return arguments.length?(this._level=t,this):this._level}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"sizeType",value:function(t){return arguments.length?(this._sizeType=t,this):this._sizeType}},{key:"limitWidth",value:function(t){return arguments.length?(this._limitWidth=t,this):this._limitWidth}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),st=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","round-corner-donut-chart"),e.core=e.pie=new ot(e.mainGroup),e.lineText=new lt(e.mainGroup),e.pieText=new rt(e.mainGroup),e._innerRadius=0,e._padAngle=.01,e._startAngle=0,e._endAngle=2*Math.PI,e._labelRadiusRatio=.87,e._innerRadiusRatio=.75,e._cornerRadius=10,e._areaBorderColor="#fff",e._areaBorderWidth=0,e._fillOpacity=1,e._labelShow=!0,e._positionOptions=["外部","内部"],e._positionChoice="内部",e._contentOption=["名称","百分比","数值"],e._contentChoice=["名称"],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["轮子","百叶窗","折扇","径向展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){for(var t=this,i=t.pie,n=t.lineText,a=t.pieText,o=t.widthOfNoMargin,r=(t.legend.height(),[]),l=0;l<t.activeData.length;l++)r.push(parseFloat(t.activeData[l].value));for(var u=0,h=0;h<t.activeData.length;h++)u+=parseFloat(t.activeData[h].value);for(var d=0;d<t.activeData.length;d++)t.activeData[d].percent=-1==String(t.activeData[d].value/u*100).indexOf(".")?parseFloat(t.activeData[d].value/u*100):parseFloat((t.activeData[d].value/u*100).toFixed(2));var _=t.activeData,f=.88*t.heightOfMainGroup,p=.88*t.widthOfNoMargin;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)f=.88*t.heightOfMainGroup,p=.88*t.widthOfNoMargin;else if(0==t._labelShow||1==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice))f=.88*t.heightOfMainGroup,p=.88*t.widthOfNoMargin;else{var g=[];if(0==t._positionOptions.indexOf(t._positionChoice))if(1==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0]))for(var v=0;v<_.length;v++)g.push(_[v].name);else if(1==t._contentOption.indexOf(t._contentChoice[0]))for(var m=0;m<_.length;m++)g.push(E(_[m].percent,t._numberStyle,t._decimalPlaces)+"%");else if(2==t._contentOption.indexOf(t._contentChoice[0]))for(var b=0;b<_.length;b++)g.push(E(_[b].value,t._numberStyle,t._decimalPlaces)+t._suffix)}else if(2==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var S=0;S<_.length;S++)g.push(_[S].name),g.push(E(_[S].percent,t._numberStyle,t._decimalPlaces)+"%");else if(0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var k=0;k<_.length;k++)g.push(_[k].name),g.push(E(_[k].value,t._numberStyle,t._decimalPlaces)+t._suffix);else if(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))for(var w=0;w<_.length;w++)g.push(E(_[w].value,t._numberStyle,t._decimalPlaces)+t._suffix),g.push(E(_[w].percent,t._numberStyle,t._decimalPlaces)+"%")}else for(var C=0;C<_.length;C++)g.push(_[C].name),g.push(E(_[C].value,t._numberStyle,t._decimalPlaces)+t._suffix),g.push(E(_[C].percent,t._numberStyle,t._decimalPlaces)+"%");var O=G(g,t._textLabel.fontSize,t._textLabel.fontFamily);O>.4*t.widthOfNoMargin&&(O=.4*t.widthOfNoMargin),f=.74*t.heightOfMainGroup,p=.83*t.widthOfNoMargin-2*O}var F=t._startAngle,L=t._endAngle,P=s(p,f,F,L),A=P.radius,W=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*A:0),z=t.defs;z.selectAll("filter").remove();var M=z.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_roundDonut").attr("filterUnits","objectBoundingBox");if(M.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),M.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),M.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),M.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),M.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t._areaBorderColor&&/\[/.test(t._areaBorderColor)){var R=x(t._areaBorderColor),N=[],T=!0,B=!1,X=void 0;try{for(var j,I=R[Symbol.iterator]();!(T=(j=I.next()).done);T=!0){var Y=j.value,H=[],V=Y.split(":");H.push(q(V[0])),H.push(V[1]),N.push(H)}}catch(t){B=!0,X=t}finally{try{!T&&I.return&&I.return()}finally{if(B)throw X}}var $=N.concat(),U=$.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(U[1]).x1+"%").attr("y1",y(U[1]).y1+"%").attr("x2",y(U[1]).x2+"%").attr("y2",y(U[1]).y2+"%").selectAll("stop").data($).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(t.activeData).innerRadius(W).outerRadius(A).cornerRadius(t._cornerRadius).areaBorderColor(/\[/.test(t._areaBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._areaBorderColor).areaBorderWidth(t._areaBorderWidth).startAngle(F).endAngle(L).padAngle(t._padAngle).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,n){d3.select(this).transition().duration(30).attrTween("d",(function(){var t=d3.interpolateNumber(A,1.05*A);return function(n){var a=t(n);return i.arcFunc.outerRadius(a),i.arcFunc(e)}}));var a=[{text:""+(e.data.name=="$-"+n?"":e.data.name),color:e.data.color},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().duration(30).attrTween("d",(function(){var t=d3.interpolateNumber(1.05*A,A);return function(n){var a=t(n);return i.arcFunc.outerRadius(a),i.arcFunc(e)}})),t.tooltip.hide()})),a.data(t.activeData).innerRadius(W).outerRadius(A).startAngle(F).endAngle(L).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).onTransitionEnd((function(i,n){var a=d3.select(this.parentNode),o="arc-path-"+i.data.key.replace(/\s*/g,"")+"-"+t.id,r=e(A*t._labelRadiusRatio,i.startAngle+.025+parseFloat(t._padAngle)/2,i.endAngle-.025-parseFloat(t._padAngle)/2),l=t.defs.select("#"+o).empty()?t.defs.append("path").attr("d",r).attr("id",o):t.defs.select("#"+o).attr("d",r);0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length?t.group.selectAll(".chart-label-text").style("display","none"):1==t._positionOptions.indexOf(t._positionChoice)&&(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,i.data.name=="$-"+n?"":i.data.name,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):1==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentOption.indexOf(t._contentChoice[0])&&D(a,l,E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,(i.data.name=="$-"+n?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,(i.data.name=="$-"+n?"":i.data.name+"  ")+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==t._contentChoice.length&&D(a,l,(i.data.name=="$-"+n?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"))}));var Z=P.cx+(o-p)/2,Q=t.heightOfMainGroup/2;null!=t._labelShow&&(0!=t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(n.data(t.activeData).innerRadius(W).outerRadius(A).cornerRadius(t._cornerRadius).startAngle(F).endAngle(L).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).values(r).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.lineText.translate(Z||0,Q).update(),t.group.select(".outside-text-polygon").attr("display","block")):0!=t._labelShow&&1!=t._positionOptions.indexOf(t._positionChoice)&&-1!=t._positionOptions.indexOf(t._positionChoice)||t.group.select(".outside-text-polygon").attr("display","none")),t.pie.translate(Z||0,Q).update(),a.translate(Z,Q).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this.innerRadiusRatio(d(0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(d(0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._areaBorderWidth)).areaBorderColor(q(e.borderColor)||"").padAngle(0==parseFloat(e.gapPercentage)||e.gapPercentage?e.gapPercentage/10:this._padAngle),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),i}(nt),ut=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","pie-chart"),e.core=e.pie=new ot(e.mainGroup),e.lineText=new lt(e.mainGroup),e.pieText=new rt(e.mainGroup),e._innerRadius=0,e._cornerRadius=null,e._padAngle=0,e._startAngle=0,e._endAngle=2*Math.PI,e._labelRadiusRatio=.8,e._innerRadiusRatio=null,e._areaBorderWidth=1,e._areaBorderColor="#fff",e._fillOpacity=1,e._labelShow=!1,e._positionOptions=["内部径向","内部水平","外部"],e._positionChoice="内部径向",e._contentOption=["名称","百分比","数值"],e._contentChoice=["名称"],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["轮子","百叶窗","折扇","径向展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){for(var t=this,i=t.pie,n=t.lineText,a=t.pieText,o=t.widthOfNoMargin,r=(t.legend.height(),[]),l=0;l<t.activeData.length;l++)r.push(parseFloat(t.activeData[l].value));for(var u=0,h=0;h<t.activeData.length;h++)u+=parseFloat(t.activeData[h].value);for(var d=0;d<t.activeData.length;d++)t.activeData[d].percent=-1==String(t.activeData[d].value/u*100).indexOf(".")?parseFloat(t.activeData[d].value/u*100):parseFloat((t.activeData[d].value/u*100).toFixed(2));var _=t.activeData.sort((function(t,e){return e.index-t.index}));_.unshift(_[_.length-1]),_.pop(_[_.length-1]);var f=.88*t.heightOfMainGroup,p=.88*t.widthOfNoMargin;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)f=.88*t.heightOfMainGroup,p=.88*t.widthOfNoMargin;else if(0==t._labelShow||0==t._positionOptions.indexOf(t._positionChoice)||1==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice))f=.88*t.heightOfMainGroup,p=.88*t.widthOfNoMargin;else{var g=[];if(2==t._positionOptions.indexOf(t._positionChoice))if(1==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0]))for(var v=0;v<_.length;v++)g.push(_[v].name);else if(1==t._contentOption.indexOf(t._contentChoice[0]))for(var m=0;m<_.length;m++)g.push(E(_[m].percent,t._numberStyle,t._decimalPlaces)+"%");else if(2==t._contentOption.indexOf(t._contentChoice[0]))for(var b=0;b<_.length;b++)g.push(E(_[b].value,t._numberStyle,t._decimalPlaces)+t._suffix)}else if(2==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var S=0;S<_.length;S++)g.push(_[S].name),g.push(E(_[S].percent,t._numberStyle,t._decimalPlaces)+"%");else if(0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var k=0;k<_.length;k++)g.push(_[k].name),g.push(E(_[k].value,t._numberStyle,t._decimalPlaces)+t._suffix);else if(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))for(var w=0;w<_.length;w++)g.push(E(_[w].value,t._numberStyle,t._decimalPlaces)+t._suffix),g.push(E(_[w].percent,t._numberStyle,t._decimalPlaces)+"%")}else for(var C=0;C<_.length;C++)g.push(_[C].name),g.push(E(_[C].value,t._numberStyle,t._decimalPlaces)+t._suffix),g.push(E(_[C].percent,t._numberStyle,t._decimalPlaces)+"%");var O=G(g,t._textLabel.fontSize,t._textLabel.fontFamily);O>.4*t.widthOfNoMargin&&(O=.4*t.widthOfNoMargin),f=.74*t.heightOfMainGroup,p=.83*t.widthOfNoMargin-2*O}var F=t._startAngle,L=t._endAngle,P=s(p,f,F,L),A=P.radius,W=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*A:0),z=t.defs;z.selectAll("filter").remove();var M=z.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_pie").attr("filterUnits","objectBoundingBox");if(M.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),M.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),M.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),M.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),M.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t._areaBorderColor&&/\[/.test(t._areaBorderColor)){var R=x(t._areaBorderColor),N=[],T=!0,B=!1,X=void 0;try{for(var j,I=R[Symbol.iterator]();!(T=(j=I.next()).done);T=!0){var Y=j.value,H=[],V=Y.split(":");H.push(q(V[0])),H.push(V[1]),N.push(H)}}catch(t){B=!0,X=t}finally{try{!T&&I.return&&I.return()}finally{if(B)throw X}}var $=N.concat(),U=$.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(U[1]).x1+"%").attr("y1",y(U[1]).y1+"%").attr("x2",y(U[1]).x2+"%").attr("y2",y(U[1]).y2+"%").selectAll("stop").data($).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(_).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).innerRadius(W).outerRadius(A).innerRadiusRatio(t._innerRadiusRatio).cornerRadius(t._cornerRadius).areaBorderColor(/\[/.test(t._areaBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._areaBorderColor).areaBorderWidth(t._areaBorderWidth).fillOpacity(t._fillOpacity).startAngle(F).endAngle(L).padAngle(t._padAngle).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,n){d3.select(this).transition().duration(30).attrTween("d",(function(){var t=d3.interpolateNumber(A,1.05*A);return function(n){var a=t(n);return i.arcFunc.outerRadius(a),i.arcFunc(e)}}));var a=[{text:""+(-1!=String(e.data.name).indexOf("$-")?"":e.data.name),color:e.data.color},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().duration(30).attrTween("d",(function(){var t=d3.interpolateNumber(1.05*A,A);return function(n){var a=t(n);return i.arcFunc.outerRadius(a),i.arcFunc(e)}})),t.tooltip.hide()})),a.data(_).innerRadius(W).outerRadius(A).startAngle(F).endAngle(L).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).onTransitionEnd((function(i,n){var a=d3.select(this.parentNode),o="arc-path-"+i.data.key.replace(/\s*/g,"")+"-"+t.id,r=e(A*t._labelRadiusRatio,i.startAngle+.025,i.endAngle-.025),l=t.defs.select("#"+o).empty()?t.defs.append("path").attr("d",r).attr("id",o):t.defs.select("#"+o).attr("d",r);0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||1==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length?t.group.selectAll(".chart-label-text").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)&&(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,-1!=String(i.data.name).indexOf("$-")?"":i.data.name,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):1==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentOption.indexOf(t._contentChoice[0])&&D(a,l,E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,(-1!=String(i.data.name).indexOf("$-")?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,(-1!=String(i.data.name).indexOf("$-")?"":i.data.name+"  ")+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==t._contentChoice.length&&D(a,l,(-1!=String(i.data.name).indexOf("$-")?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"))}));var Z=P.cx+(o-p)/2,Q=t.heightOfMainGroup/2;if(null!=t._labelShow)if(0!=t._labelShow&&2==t._positionOptions.indexOf(t._positionChoice)){var K=t.activeData.sort((function(t,e){return e.index-t.index}));K.unshift(K[K.length-1]),K.pop(K[K.length-1]),n.data(K).innerRadius(W).outerRadius(A).cornerRadius(t._cornerRadius).startAngle(F).endAngle(L).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).values(r).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.lineText.translate(Z||0,Q).update(),t.group.selectAll(".outside-text-polygon").attr("display","block")}else 0!=t._labelShow&&0!=t._positionOptions.indexOf(t._positionChoice)&&1!=t._positionOptions.indexOf(t._positionChoice)&&-1!=t._positionOptions.indexOf(t._positionChoice)||t.group.selectAll(".outside-text-polygon").attr("display","none");t.pie.translate(Z||0,Q).update(),a.translate(Z,Q).update()}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this.innerRadiusRatio(d(0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(d(0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._areaBorderWidth)).areaBorderColor(q(e.borderColor)||"").padAngle(0==parseFloat(e.gapPercentage)||e.gapPercentage?e.gapPercentage/10:this._padAngle),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),i}(nt),ct=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._padAngle=0,i._labelRadiusRatio=.8,i._labelRadiusRatio=.8,i._innerRadiusRatio=null,i._areaBorderWidth=1,i._areaBorderColor="#fff",i._fillOpacity=1,i._cornerRadius=10,i._labelShow=!0,i._positionOptions=["内部径向","内部水平","外部"],i._positionChoice="内部",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["轮子","百叶窗","折扇","径向展开"],i._moveStyle="径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this.innerRadiusRatio(d(0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(d(0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._areaBorderWidth)).areaBorderColor(q(e.borderColor)||"").padAngle(0==parseFloat(e.gapPercentage)||e.gapPercentage?e.gapPercentage/10:this._padAngle),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),e}(ut),ht=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","wave-circle"),i._radius=50,i._value=60,i._clipId=r("wave-clip"),i._waveCount=3,i._waveColor="#178BCA",i._outerCircleColor=null,i._minValue=0,i._maxValue=100,i._circleThickness=.05,i._circleFillGap=.05,i._waveHeightRatio=.05,i._waveRiseTime=1500,i._waveAnimateTime=1e4,i._waveRise=!0,i._textSize=.5,i._textSuffix="%",i._textColor="#045681",i._waveTextColor="#A4DBf8",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._radius,i=t._radius,n=t._circleThickness*t._radius,a=t._circleFillGap*t._radius,r=t._radius-n-a,l=(t._textSize,t._radius,2*t._radius/t._waveCount),s=5*t._waveCount+1,u=l*s,h=t._waveHeightRatio*t._radius,d=Number(t.value)<t._minValue?t._minValue:Number(t.value)>t._maxValue?t._maxValue:Number(t.value);if(t._isDefault){var _=function(t,e,i){var n=d3.scaleLinear().clamp(!1).domain([0,1]),a=d3.hsl(t);return 1===e?a.l-=.08:(n.range([a.l-Math.min(.4,.08*e)/2,a.l+Math.min(.4,.08*e)/2]),a.l=n(i)),a};t.group=this.elem.append("g"),t._outerDonut=this.group.append("path"),t._innerCircle=this.group.append("path"),t._textElem=this.group.append("text"),t._clipTextElem=this.group.append("text"),t._numberElem=this.group.append("text"),t._clipNumberElem=this.group.append("text"),t._waveClip=this.group.append("defs").append("clipPath"),t._waveClipPath=this._waveClip.append("path");var f="single"==t._type?t._icon:t._svgArr,p=Math.min((2*t._radius-4)/f.width,(2*t._radius-4)/f.height),g=[],v=[];t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+p+")"),t.group.append("path").attr("class","icon").attr("d",f.path).attr("transform","scale("+p+")");var m=t.group.select(".icon-test").node().getBBox(),b=t.group.select(".icon").node().getBBox(),S=f.width*p,k=f.height*p;if(g.push((b.x-m.x)*p),v.push((b.y-m.y)*p),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove(),t._waveColor&&/\[/.test(t._waveColor)){var w=x(t._waveColor),C=[],O=!0,F=!1,L=void 0;try{for(var P,A=w[Symbol.iterator]();!(O=(P=A.next()).done);O=!0){var W=P.value,z=[],M=W.split(":");z.push(q(M[0])),z.push(M[1]),C.push(z)}}catch(t){F=!0,L=t}finally{try{!O&&A.return&&A.return()}finally{if(F)throw L}}var D=C.concat(),R=D.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+t._index).attr("x1",y(R[1]).x1+"%").attr("y1",y(R[1]).y1+"%").attr("x2",y(R[1]).x2+"%").attr("y2",y(R[1]).y2+"%").selectAll("stop").data(D).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}for(var N=d3.scaleLinear().range([k,-h]).domain([0,1])(parseFloat(d)/(t._maxValue-t._minValue))*(1/p),T=[],B=0;B<100;B++){var G=B*(s*Math.PI*2)/100,X=Math.sin(G);T.push({x:G,y:X})}var j=d3.scaleLinear().domain([0,2*Math.PI*s]).range([0,u]),I=d3.scaleLinear().domain([-1,1]).range([0,h]),Y=d3.area().x((function(t){return j(t.x)})).y0((function(t){return I(t.y)})).y1((function(t){return k+h}));t._waveClip.attr("id",t._clipId).call(o,0,N),t._waveClipPath.datum(T).attr("d",Y),t._outerDonut.attr("d",f.path).style("fill",/\[/.test(t._waveColor)?"url("+c("#"+t.id+"-index-"+t._index)+")":t._waveColor).attr("stroke-width",2/p).attr("stroke",t._outerCircleColor||(/\[/.test(t._waveColor)?"url("+c("#"+t.id+"-index-"+t._index)+")":t._waveColor)).attr("transform","translate("+((2*e-S)/2-g[0])+", "+-v[0]+") scale("+p+")").attr("clip-path","url("+c("#"+t._clipId)+")"),t._innerCircle.attr("d",f.path).style("fill","none").attr("stroke-width",2/p).attr("stroke",t._outerCircleColor||(/\[/.test(t._waveColor)?"url("+c("#"+t.id+"-index-"+t._index)+")":t._waveColor)).attr("transform","translate("+((2*e-S)/2-g[0])+", "+-v[0]+") scale("+p+")"),t.group.selectAll(".text-defs").remove();var H=t.group.append("defs").attr("class","text-defs").append("clipPath");H.attr("id",t._clipId+"_text").call(o,0,N*p);var V=H.append("path").datum(T).attr("d",Y);"内部"==t._textPositionChoice&&"内部"==t._numberPositionChoice?(t._numberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._fontSize).attr("dy",t._textShow?.85*t._fontSize+2.5:"0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor])})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).style("display",t._labelShow&&t._numberShow?"block":"none"),t._clipNumberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy",t._textShow?.85*t._fontSize+2.5:"0.35em").attr("font-size",t._fontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor];return _(q(i),2,3)})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).attr("clip-path","url("+c("#"+t._clipId+"_text")+")").style("display",t._labelShow&&t._numberShow?"block":"none"),t._textElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._textFontSize).attr("dy",t._numberShow?"-2.5":"0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor])})).style("font-family",t._textFontFamily).text(t._textValue).style("display",t._labelShow&&t._textShow?"block":"none"),t._clipTextElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy",t._numberShow?"-2.5":"0.35em").attr("font-size",t._textFontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor];return _(q(i),2,3)})).style("font-family",t._textFontFamily).text(t._textValue).attr("clip-path","url("+c("#"+t._clipId+"_text")+")").style("display",t._labelShow&&t._textShow?"block":"none")):"内部"==t._textPositionChoice?(t._textElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._textFontSize).attr("dy","0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor])})).style("font-family",t._textFontFamily).text(t._textValue).style("display",t._labelShow&&t._textShow?"block":"none"),t._clipTextElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy","0.35em").attr("font-size",t._textFontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor];return _(q(i),2,3)})).style("font-family",t._textFontFamily).text(t._textValue).attr("clip-path","url("+c("#"+t._clipId+"_text")+")").style("display",t._labelShow&&t._textShow?"block":"none")):"内部"==t._numberPositionChoice&&(t._numberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._fontSize).attr("dy","0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor])})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).style("display",t._labelShow&&t._numberShow?"block":"none"),t._clipNumberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy","0.35em").attr("font-size",t._fontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor];return _(q(i),2,3)})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).attr("clip-path","url("+c("#"+t._clipId+"_text")+")").style("display",t._labelShow&&t._numberShow?"block":"none")),function(){if(t._interrupt)t._waveClip.call(o,0,N),"内部"==t._textPositionChoice&&"内部"==t._numberPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue),t._numberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix),t._clipNumberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix)):"内部"==t._textPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue)):"内部"==t._numberPositionChoice&&(t._numberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix),t._clipNumberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix));else{var e=d3.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear),i=function(){var e=this,i=d3.interpolate(t._minValue,E(t.value,t._numberStyle,t._decimalPlaces));return function(n){e.textContent=E(i(n),t._numberStyle,2)+t._textSuffix,1==n&&(e.textContent=E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix)}};t._waveClip.call(o,0,2*t._radius*(1/p)).transition(e).call(o,0,N),H.call(o,0,2*t._radius).transition(e).call(o,0,N*p),"内部"==t._textPositionChoice&&"内部"==t._numberPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue),t._numberElem.text("0"+t._textSuffix).transition(e).tween("text",i),t._clipNumberElem.text("0"+t._textSuffix).transition(e).tween("text",i)):"内部"==t._textPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue)):"内部"==t._numberPositionChoice&&(t._numberElem.text("0"+t._textSuffix).transition(e).tween("text",i),t._clipNumberElem.text("0"+t._textSuffix).transition(e).tween("text",i))}}(),function e(){t._waveClipPath.attr("transform","translate("+((-u+2*t._radius)*(1/p)+g[0]*(1/p))+","+v[0]*(1/p)+") scale("+1/p+")").transition().duration(t._waveAnimateTime).ease(d3.easeLinear).attr("transform","translate("+g[0]*(1/p)+","+v[0]*(1/p)+") scale("+1/p+")").on("end",e),V.attr("transform","translate("+(-u+4*t._radius)+",0)").transition().duration(t._waveAnimateTime).ease(d3.easeLinear).attr("transform","translate("+2*-t._radius+",0)").on("end",e)}(),t.elem.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}else{var $=function(t,e,i){var n=d3.scaleLinear().clamp(!1).domain([0,1]),a=d3.hsl(t);return 1===e?a.l-=.08:(n.range([a.l-Math.min(.4,.08*e)/2,a.l+Math.min(.4,.08*e)/2]),a.l=n(i)),a};if(t.group=this.elem.append("g"),t._outerDonut=this.group.append("path"),t._innerCircle=this.group.append("circle"),t._textElem=this.group.append("text"),t._clipTextElem=this.group.append("text"),t._numberElem=this.group.append("text"),t._clipNumberElem=this.group.append("text"),t._waveClip=this.group.append("defs").append("clipPath"),t._waveClipPath=this._waveClip.append("path"),t._waveColor&&/\[/.test(t._waveColor)){var U=x(t._waveColor),Z=[],Q=!0,K=!1,J=void 0;try{for(var tt,et=U[Symbol.iterator]();!(Q=(tt=et.next()).done);Q=!0){var it=tt.value,nt=[],at=it.split(":");nt.push(q(at[0])),nt.push(at[1]),Z.push(nt)}}catch(t){K=!0,J=t}finally{try{!Q&&et.return&&et.return()}finally{if(K)throw J}}var ot=Z.concat(),rt=ot.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+t._index).attr("x1",y(rt[1]).x1+"%").attr("y1",y(rt[1]).y1+"%").attr("x2",y(rt[1]).x2+"%").attr("y2",y(rt[1]).y2+"%").selectAll("stop").data(ot).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}for(var lt=d3.scaleLinear().range([2*t._radius-2*n-2*a+2*h,h]).domain([0,1])(d/(t._maxValue-t._minValue)),st=[],ut=0;ut<100;ut++){var ct=ut*(s*Math.PI*2)/100,ht=Math.sin(ct);st.push({x:ct,y:ht})}var dt=d3.scaleLinear().domain([0,2*Math.PI*s]).range([0,u]),_t=d3.scaleLinear().domain([-1,1]).range([0,h]),ft=d3.area().x((function(t){return dt(t.x)})).y0((function(t){return _t(t.y)})).y1((function(e){return 2*t._radius-2*n-2*a+h}));t._waveClip.attr("id",t._clipId).call(o,0,lt),t._waveClipPath.datum(st).attr("d",ft),t._outerDonut.attr("d",d3.arc().startAngle(0).endAngle(2*Math.PI).innerRadius(t._radius-n).outerRadius(t._radius)).style("fill",/\[/.test(t._waveColor)?"url("+c("#"+t.id+"-index-"+t._index)+")":t._waveColor).call(o,e,i),t._innerCircle.attr("cx",e).attr("cy",i).attr("r",r).style("fill",/\[/.test(t._waveColor)?"url("+c("#"+t.id+"-index-"+t._index)+")":t._waveColor).attr("clip-path","url("+c("#"+t._clipId)+")"),"内部"==t._textPositionChoice&&"内部"==t._numberPositionChoice?(t._numberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._fontSize).attr("dy",t._textShow?.85*t._fontSize+2.5:"0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor])})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).style("display",t._labelShow&&t._numberShow?"block":"none"),t._clipNumberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy",t._textShow?.85*t._fontSize+2.5:"0.35em").attr("font-size",t._fontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor];return $(q(i),2,3)})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).attr("clip-path","url("+c("#"+t._clipId)+")").style("display",t._labelShow&&t._numberShow?"block":"none"),t._textElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._textFontSize).attr("dy",t._numberShow?"-2.5":"0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor])})).style("font-family",t._textFontFamily).text(t._textValue).style("display",t._labelShow&&t._textShow?"block":"none"),t._clipTextElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy",t._numberShow?"-2.5":"0.35em").attr("font-size",t._textFontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor];return $(q(i),2,3)})).style("font-family",t._textFontFamily).text(t._textValue).attr("clip-path","url("+c("#"+t._clipId)+")").style("display",t._labelShow&&t._textShow?"block":"none")):"内部"==t._textPositionChoice?(t._textElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._textFontSize).attr("dy","0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor])})).style("font-family",t._textFontFamily).text(t._textValue).style("display",t._labelShow&&t._textShow?"block":"none"),t._clipTextElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy","0.35em").attr("font-size",t._textFontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._textFontColor))?t._textFontColor:t._colorList[t._textFontColor];return $(q(i),2,3)})).style("font-family",t._textFontFamily).text(t._textValue).attr("clip-path","url("+c("#"+t._clipId)+")").style("display",t._labelShow&&t._textShow?"block":"none")):"内部"==t._numberPositionChoice&&(t._numberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("font-size",t._fontSize).attr("dy","0.35em").style("fill",(function(e){return q(isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor])})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).style("display",t._labelShow&&t._numberShow?"block":"none"),t._clipNumberElem.attr("x",e).attr("y",i).attr("text-anchor","middle").attr("dy","0.35em").attr("font-size",t._fontSize).style("fill",(function(e){var i=isNaN(parseFloat(t._fontColor))?t._fontColor:t._colorList[t._fontColor];return $(q(i),2,3)})).style("font-family",t._fontFamily).text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix).attr("clip-path","url("+c("#"+t._clipId)+")").style("display",t._labelShow&&t._numberShow?"block":"none")),function(){if(t._interrupt)t._waveClip.call(o,0,lt),"内部"==t._textPositionChoice&&"内部"==t._numberPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue),t._numberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix),t._clipNumberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix)):"内部"==t._textPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue)):"内部"==t._numberPositionChoice&&(t._numberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix),t._clipNumberElem.text(E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix));else{var e=d3.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear),i=function(){var e=this,i=d3.interpolate(t._minValue,E(t.value,t._numberStyle,t._decimalPlaces));return function(n){e.textContent=E(i(n),t._numberStyle,2)+t._textSuffix,1==n&&(e.textContent=E(t.value,t._numberStyle,t._decimalPlaces)+t._textSuffix)}};t._waveClip.call(o,0,2*t._radius).transition(e).call(o,0,lt),"内部"==t._textPositionChoice&&"内部"==t._numberPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue),t._numberElem.text("0"+t._textSuffix).transition(e).tween("text",i),t._clipNumberElem.text("0"+t._textSuffix).transition(e).tween("text",i)):"内部"==t._textPositionChoice?(t._textElem.text(t._textValue),t._clipTextElem.text(t._textValue)):"内部"==t._numberPositionChoice&&(t._numberElem.text("0"+t._textSuffix).transition(e).tween("text",i),t._clipNumberElem.text("0"+t._textSuffix).transition(e).tween("text",i))}}(),function e(){t._waveClipPath.attr("transform","translate("+(-u+4*t._radius)+",0)").transition().duration(t._waveAnimateTime).ease(d3.easeLinear).attr("transform","translate("+2*-t._radius+",0)").on("end",e)}(),t.elem.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}return t}},{key:"value",value:function(t){return arguments.length?(this.value=t,this):this.value}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"waveColor",value:function(t){return arguments.length?(this._waveColor=t,this):this._waveColor}},{key:"waveCount",value:function(t){return arguments.length?(this._waveCount=t,this):this._waveCount}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"numberShow",value:function(t){return arguments.length?(this._numberShow=t,this):this._numberShow}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"svgArr",value:function(t){return arguments.length?(this._svgArr=t,this):this._svgArr}},{key:"index",value:function(t){return arguments.length?(this._index=t,this):this._index}},{key:"isDefault",value:function(t){return arguments.length?(this._isDefault=t,this):this._isDefault}},{key:"textPositionChoice",value:function(t){return arguments.length?(this._textPositionChoice=t,this):this._textPositionChoice}},{key:"numberPositionChoice",value:function(t){return arguments.length?(this._numberPositionChoice=t,this):this._numberPositionChoice}},{key:"textValue",value:function(t){return arguments.length?(this._textValue=t,this):this._textValue}},{key:"textShow",value:function(t){return arguments.length?(this._textShow=t,this):this._textShow}},{key:"textFontSize",value:function(t){return arguments.length?(this._textFontSize=t,this):this._textFontSize}},{key:"textFontColor",value:function(t){return arguments.length?(this._textFontColor=t,this):this._textFontColor}},{key:"textFontFamily",value:function(t){return arguments.length?(this._textFontFamily=t,this):this._textFontFamily}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(L),dt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","wave-circle-chart"),i._circleMargin=0,i._labelMargin=5,i._maxCountOfOneLine=5,i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._labelShow=!0,i._textLabel={show:!0,color:"#545454",fontFamily:"阿里巴巴普惠体 常规",fontSize:14,positionOptions:["外部居上","内部","外部居下"],positionChoice:"外部居下"},i._numberLabel={show:!0,color:"#545454",fontFamily:"阿里巴巴普惠体 常规",fontSize:28,positionOptions:["外部居上","内部","外部居下"],positionChoice:"内部"},i._textPositionChoice="外部居下",i._numberPositionChoice="内部",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="",i._endPause=0,i._interrupt=!1,i._type="single",i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=e.length,n=[],a=[];if(t._pictures)if("single"==t._type){var r=t.group.append("foreignObject").attr("class","path-container");if(t._svgList[0]){r.html(t._svgList[0]).attr("class","svgIcon");var l=t.group.select(".svgIcon svg path").attr("d"),s=(t.group.select(".svgIcon").selectAll("svg").select("path").node().getBBox(),t.group.append("path").attr("d",l).attr("class","icon"),t.group.select(".icon").node().getBBox()),u="default"!=t.group.select(".svgIcon svg").attr("wave-distinguish");a.push(u),t._icon.path=l,t._icon.width=s.width,t._icon.height=s.height}t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}else for(var c=0;c<t._svgList.length;c++){var h=t.group.append("foreignObject"),d={};if(t._svgList[c]){h.html(t._svgList[c]).attr("class","svgIcon");var _=t.group.select(".svgIcon svg path").attr("d"),f=(t.group.select(".svgIcon").selectAll("svg").select("path").node().getBBox(),t.group.append("path").attr("d",_).attr("class","icon"),t.group.select(".icon").node().getBBox()),p="default"!=t.group.select(".svgIcon svg").attr("wave-distinguish");a.push(p),d.path=_,d.width=f.width,d.height=f.height}else d.path="",d.width=1e-4,d.height=1e-4;n.push(d),t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}var y=t.widthOfNoMargin,x=t.heightOfMainGroup,g=Math.min(t._maxCountOfOneLine,i),v=Math.ceil(i/g),m=y/g,b=x/v,S=0;"内部"!=t._textPositionChoice&&(S=t._labelShow&&t._textLabel.show?parseFloat(t._textLabel.fontSize)+2*t._labelMargin:0);var k=0;"内部"!=t._numberPositionChoice&&(k=t._labelShow&&t._numberLabel.show?parseFloat(t._numberLabel.fontSize)+2*t._labelMargin:0);var w=b-S-k,C=(Math.min(m,w)-2*t._circleMargin)/2*.9,O=t._label?t._numberLabel.fontSize:.5*C,F=t.defs;F.selectAll("filter").remove();var L=F.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_wave_circles").attr("filterUnits","objectBoundingBox");L.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",2).attr("result","blurredAlpha"),L.append("feOffset").attr("in","blurredAlpha").attr("dx",0).attr("dy",1).attr("result","offsetBlurredAlpha"),L.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),L.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),L.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll("*").remove();var P=t.mainGroup.selectAll("g.wave-circle-item").data(e,(function(t){return t.name}));if(P.exit().remove(),e.length){var A=P.enter().append("g").attr("class","wave-circle-item");A.append("g"),A.append("text").attr("class",t.labelTextClass),A.append("text").attr("class","chart-number-text"),A.append("rect").attr("class","clip-area-rect");var W=A.merge(P),z=t._circleMargin+w/2-C;if("外部居上"==t._textPositionChoice&&"外部居上"==t._numberPositionChoice?z=t._circleMargin+w/2-C+(S+k):"外部居上"==t._textPositionChoice?z=t._circleMargin+w/2-C+S:"外部居上"==t._numberPositionChoice&&(z=t._circleMargin+w/2-C+k),W.select("g").call(o,t._circleMargin+m/2-C,z).each((function(e,i){d3.select(this).selectAll("*").remove();var o=new ht(d3.select(this));o.radius(C).waveColor(e.color).index(i).value(null==t._decimalPlaces?-1==String(e.value).indexOf(".")?parseFloat(e.value):parseFloat(e.value).toFixed(2):e.value).textValue(e.showLegend?X(e.name,m,t._textLabel.fontSize,t._textLabel.fontFamily):"").transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).icon(t._icon).type(t._type).svgArr("single"==t._type?n[0]:n[i]).isDefault(!!t._pictures&&("single"==t._type?a[0]:a[i])).fontSize(O).fontColor(t._numberLabel.color).fontFamily(t._numberLabel.fontFamily).numberShow(t._numberLabel.show).textFontSize(t._textLabel.fontSize).textFontColor(t._textLabel.color).textFontFamily(t._textLabel.fontFamily).textShow(t._textLabel.show).labelShow(t._labelShow).colorList(t._colorList).textPositionChoice(t._textPositionChoice).numberPositionChoice(t._numberPositionChoice).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){var n=[{text:e.name+": "+E(e.value,t._numberStyle,t._decimalPlaces)+"%",color:e.color}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide()})),o.update()})),"外部居下"==t._textPositionChoice){var M=0;"外部居上"==t._numberPositionChoice&&t._numberLabel.show&&(M=k),W.select("."+this.labelTextClass).call(o,m/2,2*t._circleMargin+w/2+C+t._labelMargin+M).attr("dy","0.85em").style("text-anchor","middle").style("fill",(function(e){return q(isNaN(parseFloat(t._textLabel.color))?t._textLabel.color:t._colorList[t._textLabel.color])})).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).style("display",t._labelShow&&t._textLabel.show?"block":"none").text((function(e){return e.showLegend?X(e.name,m,t._textLabel.fontSize,t._textLabel.fontFamily):""}))}else if("外部居上"==t._textPositionChoice){var D=0;"外部居上"==t._numberPositionChoice&&t._numberLabel.show&&(D=t._labelMargin),W.select("."+this.labelTextClass).call(o,m/2,t._labelMargin+w/2-C+D).attr("dy","0.85em").style("text-anchor","middle").style("fill",(function(e){return q(isNaN(parseFloat(t._textLabel.color))?t._textLabel.color:t._colorList[t._textLabel.color])})).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).style("display",t._labelShow&&t._textLabel.show?"block":"none").text((function(e){return e.showLegend?X(e.name,m,t._textLabel.fontSize,t._textLabel.fontFamily):""}))}if("外部居下"==t._numberPositionChoice){var R=0;"外部居下"==t._textPositionChoice&&t._textLabel.show&&(R=t._labelMargin),W.select(".chart-number-text").call(o,m/2,2*t._circleMargin+w/2+C+S+t._labelMargin-R).attr("dy","0.85em").style("text-anchor","middle").style("fill",(function(e){return q(isNaN(parseFloat(t._numberLabel.color))?t._numberLabel.color:t._colorList[t._numberLabel.color])})).style("font-size",O).style("font-family",t._numberLabel.fontFamily).style("display",t._labelShow&&t._numberLabel.show?"block":"none").text((function(e){return X(E(e.value,t._numberStyle,t._decimalPlaces)+"%",m,O,t._numberLabel.fontFamily)}))}else if("外部居上"==t._numberPositionChoice){var N=S;"外部居下"==t._textPositionChoice&&t._textLabel.show&&(N=0),W.select(".chart-number-text").call(o,m/2,t._labelMargin+w/2-C+N).attr("dy","0.85em").style("text-anchor","middle").style("fill",(function(e){return q(isNaN(parseFloat(t._numberLabel.color))?t._numberLabel.color:t._colorList[t._numberLabel.color])})).style("font-size",O).style("font-family",t._numberLabel.fontFamily).style("display",t._labelShow&&t._numberLabel.show?"block":"none").text((function(e){return X(E(e.value,t._numberStyle,t._decimalPlaces)+"%",m,O,t._numberLabel.fontFamily)}))}W.select(".clip-area-rect").attr("width",m).attr("height",b).attr("opacity",0).on("mouseover",(function(e,i){var n=[{text:e.name+": "+E(e.value,t._numberStyle,t._decimalPlaces)+"%",color:e.color}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).on("mousemove",(function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).on("mouseout",(function(e){t.tooltip.hide()}));var T=i%g,B=(Math.ceil(i/g)-1)*g;W.attr("transform",(function(t,e){var i=e%g*m,n=Math.floor(e/g)*b;return T&&e>=B&&(i=y/T*(e%g+.5)-m/2),"translate("+i+","+n+")"}))}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"removeLabelText",value:function(){}},{key:"maxCountOfOneLine",value:function(t){return arguments.length?(this._maxCountOfOneLine=t,this):this._maxCountOfOneLine}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.label,n=t.unitDisplay,a=t.sourceDisplay,o=t.display,r=t.pictures;0!==Object.getOwnPropertyNames(r).length&&(this._pictures=r||null,this._type=r?r.type:"single",this._svgList=r?r.svglist:null),0!==Object.getOwnPropertyNames(o).length&&(this._maxCountOfOneLine=o.IconsPerRow?o.IconsPerRow:this._maxCountOfOneLine),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._label=!!i,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._textPositionChoice=this._textLabel.positionChoice?this._textLabel.positionChoice:"外部居下",this._numberPositionChoice=this._numberLabel.positionChoice?this._numberLabel.positionChoice:"内部")}}]),e}(nt),_t=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","rose-pie"),e._stroke="#fff",e._strokeWidth=1,e._startAngle=0,e._endAngle=2*Math.PI,e._totalAngle=2*Math.PI,e._sortMethod=null,e._suffix="",e._radius=0,e._cornerRadius=0,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e._rotateDirection="clockwise",e._barWidthPercent="1",e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t._startAngle,o=t._endAngle,r=t._innerRadius,l=t.group,s=t._radius,u=d3.max(n,(function(t){return Math.abs(t.value)})),h=t._maxValue||u,d=[0,1.1*h];if(t._isPolar)if(null==t._count)d=v(0,h,Math.ceil(s/t._themeFontSize/3));else if(d=[],0!=t._count){var _=h-0,f=t._count,g=Math.ceil(Math.abs(_/t._count)),m=Math.ceil((s-t._innerRadius)/t._themeFontSize*2),b=d3.tickStep(0,h,m);t._count<b&&(g=Math.ceil(Math.abs(_/b)),f=b),h+=g;for(var S=0;S<g+1;S++)d.push(0+S*f)}else d.push(0);var k=d3.scaleLinear().domain([d3.min(d),d3.max(d)]).range([t._innerRadius,s]);t.group.selectAll("*").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var w=t.arcFunc.innerRadius((function(t){return k(0)})).outerRadius((function(t){return k(Math.abs(t.data.value))})).cornerRadius(t._cornerRadius),C=t.pieFunc.value(1).startAngle(a).endAngle(o).padAngle((1-t._barWidthPercent)*(o-a)/(0==n.length?1:n.length)).sort(t._sortMethod),O=d3.arc().innerRadius(t._innerRadius).outerRadius(s).startAngle(a).endAngle(o);if(t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("path").attr("d",O()),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove(),t.group.selectAll("g.arc-group").remove();var F=t.group.append("g").attr("clip-path","").selectAll("g.arc-group").data(C(n));F.exit().remove();var L=F.enter().append("g").attr("class","arc-group");L.append("path"),F.merge(L).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).select("path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).attr("d",(function(t){return w(t)})).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(0==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove(),t.group.selectAll("g.arc-group").remove();var P=t.group.append("g").attr("clip-path","").selectAll("g.arc-group").data(C(n));P.exit().remove();var A=P.enter().append("g").attr("class","arc-group");A.append("path");var W=P.merge(A).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?W.select("path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).transition().duration(0).delay(0).ease(d3.easeCubicOut).attr("d",(function(t){return w(t)})):W.select("path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).transition().duration(t._transition?.8*t._duration:0).delay(t._transition?t._startDelay+.1*t._duration:0).ease(d3.easeCubicOut).attrTween("d",(function(t){var e=d3.interpolateNumber(k(0),k(Math.abs(t.data.value)));return function(i){var n=e(i);return w.outerRadius(n),w(t)}}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove(),t.group.selectAll("g.arc-group").remove();var z=t.group.append("g").attr("clip-path","").selectAll("path").data(C(n));z.exit().remove();var M=z.merge(z.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?M.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(t){return w(t)})):M.transition().duration((function(e,i){return t._transition?function(e){for(var i=0,a=0;a<e;a++)i=n[a].percent/100;return i*(t._transition?.8*t._duration:0)}(i+1):0})).ease(d3.easeLinear).delay((function(e,i){return t._transition?function(e){for(var i=0,a=0;a<e;a++)i+=n[a].percent/100;return i*(t._transition?.8*t._duration:0)}(i)+t._startDelay+.1*t._duration:0})).attrTween("d",(function(t){var e=d3.interpolate(t.startAngle,t.endAngle);return function(i){return t.endAngle=e(i),w(t)}}))}else if(2==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove(),t.group.selectAll("g.arc-group").remove();var N=t.group.append("g").attr("clip-path","").selectAll("path").data(C(n));N.exit().remove();var T=N.merge(N.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?T.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(t){return w(t)})):T.transition().duration((function(e,i){return t._transition?function(e){for(var i=0,a=0;a<e;a++)i=n[a].percent/100;return i*(t._transition?.8*t._duration:0)}(i+1):0})).ease(d3.easeLinear).delay((function(e,i){return t._transition?function(e){for(var i=0,a=e;a<n.length;a++)i+=n[a].percent/100;return i*(t._transition?.8*t._duration:0)}(i+1)+t._startDelay+.1*t._duration:0})).attrTween("d",(function(t){var e=d3.interpolate(t.endAngle,t.startAngle);return function(i){return t.startAngle=e(i),w(t)}}))}if(t._interrupt?t.group.append("g").selectAll("g").data(C(n)).enter().append("g").transition().duration(0).delay(0).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):t.group.append("g").selectAll("g").data(C(n)).enter().append("g").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.1*t._duration:0).on("start",t._onTransitionStart).on("end",t._onTransitionEnd),t.group.selectAll(".pie-texts").remove(),t.group.selectAll(".pie-percents").remove(),t.group.selectAll(".pie-numbers").remove(),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none");else if(1==t._positionOptions.indexOf(t._positionChoice)){var B=t.group.append("g").selectAll("g").data(C(n));B.exit().remove(),B.enter().append("g").attr("class","pie-text-groups").merge(B).each((function(e,i){d3.select(this).append("g").attr("class","pie-texts").append("text").text(e.data.name).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]-1.3*t._fontSize})),d3.select(this).append("g").attr("class","pie-percents").append("text").text(e.data.percent+"%").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(t){return Dt(t)[1]})),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(e.data.value).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]+1.3*t._fontSize}))})),1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(t){return Dt(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(t){return Dt(t)[1]})),t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(t){return Dt(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-texts text").style("display","none")):2==t._contentChoice.length&&(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","none")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return Dt(t)[0]})).attr("y",(function(e){return Dt(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-texts text").style("display","none")))}var G=t.group.append("g").attr("class","rose-pie-xAxis");G.append("path").attr("class","rose-pie-xAxis").attr("d",(function(i,n){return"内部"==t._axisPositonChoice?e(r-.5*t._xAxisLineWidth,a,o):e(s-.5*t._xAxisLineWidth,a,o)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?G.style("opacity",1):G.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);var I=t.group.selectAll(".tick-lines").data(o-a<2*Math.PI?d3.range(n.length+1):d3.range(n.length)),Y=(o-a)/(n.length>0?n.length:1);I.exit().remove();var H=I.enter().append("line").attr("class","tick-lines").merge(I).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=a+Y*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?s:r)})).attr("y1",(function(e,i){var n=a+Y*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?s:r)})).attr("x2",(function(e,i){var n=a+Y*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?s+5:r-5)})).attr("y2",(function(e,i){var n=a+Y*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?s+5:r-5)})),E=[],V=void 0;if(V="外部"==t._axisPositonChoice?s+5:r-5,n.length>0)for(var $=0;$<n.length;$++){var Z=V*Math.sin(a+$*Y),Q=-V*Math.cos(a+$*Y);E.push({x:Z,y:Q})}else E=[{x:V*Math.sin(a),y:-V*Math.cos(a)},{x:V*Math.sin(o),y:-V*Math.cos(o)}];t.group.selectAll(".tick-text").remove();var K=t.group.append("g").selectAll("text").data(E);K.exit().remove();var J=K.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice)if(Math.abs(o-a)==Math.PI/2){if("水平"==t._xLabelDirection)return X(n[i].name,.4*t._mainWidth,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(n[i].name,.4*t._mainHeight,t._themeFontSize,t._themeFontFamily)}else{if("水平"==t._xLabelDirection){var l=Math.cos(a+Y*(i+.5)-Math.PI/2)*(s+10),u=(Math.abs(o-a)==Math.PI/2?t._mainWidth:t._mainWidth/2)-Math.abs(l);return X(n[i].name,u,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var c=Math.sin(a+Y*(i+.5)-Math.PI/2)*(s+10),h=(Math.abs(o-a)==Math.PI/2?t._mainHeight:t._mainHeight/2)-Math.abs(c);return j(n[i].name,h,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection)return X(n[i].name,(r-10)/2,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(n[i].name,(r-10)/2,t._themeFontSize,t._themeFontFamily)}})).attr("x",(function(e,i){var n=a+Y*(i+.5);return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(s+10):Math.cos(n-Math.PI/2)*(r-10)})).attr("y",(function(e,i){var n=a+Y*(i+.5);return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(s+10):Math.sin(n-Math.PI/2)*(r-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)J.attr("transform",(function(e,i){var n=a+Y*(i+.5);return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:0)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var tt=t.group.append("g").selectAll("text").data(E);tt.exit().remove();var et=tt.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(a+Y*(e+.5))/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?et.text((function(e,i){var a=.4*Math.min(t._mainWidth,t._mainHeight);return X(n[i].name,a,t._themeFontSize,t._themeFontFamily)})).attr("x",s+5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(s+5)+",0)":null})):et.text((function(e,i){var a=r-5-parseFloat(t._themeFontSize)>0?r-5-parseFloat(t._themeFontSize):0;return X(n[i].name,a,t._themeFontSize,t._themeFontFamily)})).attr("x",r-5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(r-5)+",0)":null}))}else{l.selectAll(".tick-text").remove();var it=t.group.selectAll("g.text-group").data(E);it.exit().remove();it.enter().append("g").attr("class","text-group").merge(it).each((function(i,o){d3.select(this);var l=s+10;"内部"==t._axisPositonChoice&&(l=r-10-t._themeFontSize);var u=d3.select(this.parentNode),c="arc-path-"+o+"-"+t.id,h=e(l+.6*t._themeFontSize,a+Y*o+.015,a+Y*(o+1)-.015),d=t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);if(n.length>0){D(u,d,n[o].name,t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none");d3.select(this).select("path"),d.node().getTotalLength(),R(n[o].name,t._themeFontSize,t._themeFontFamily)}}))}1==t._interrupt?(H.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),J.style("opacity",1).style("display",t._showX?"block":"none")):(H.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),J.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var nt=0;nt<n.length;nt++){var at=(nt+.5)*Y+a;"外部"==t._axisPositonChoice?0==at||at==Math.PI?d3.select(l.selectAll(".tick-text").nodes()[nt]).attr("text-anchor","middle"):at>Math.PI||at<0&&at>-Math.PI?d3.select(l.selectAll(".tick-text").nodes()[nt]).attr("text-anchor","end"):d3.select(l.selectAll(".tick-text").nodes()[nt]).attr("text-anchor","start"):at>0&&at<Math.PI?d3.select(l.selectAll(".tick-text").nodes()[nt]).attr("text-anchor","end"):at>Math.PI&&at<2*Math.PI?d3.select(l.selectAll(".tick-text").nodes()[nt]).attr("text-anchor","start"):d3.select(l.selectAll(".tick-text").nodes()[nt]).attr("text-anchor","middle")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var ot=t.group.selectAll(".tick-text"),rt=[],lt=[],st=0;st<ot._groups[0].length;st++){lt.push(st);for(var ut=st+1;ut<ot._groups[0].length;ut++){p(i(d3.select(ot._groups[0][st])),i(d3.select(ot._groups[0][ut])))&&(rt.push(st),d3.select(ot._groups[0][st]).style("opacity","0"))}}for(var ct=new Set(rt),ht=Array.from(ct),dt=Mt(ht,lt),_t=0;_t<ht.length;_t++){for(var ft=[],pt=0;pt<dt.length;pt++){var yt=i(d3.select(ot._groups[0][ht[_t]])),xt=i(d3.select(ot._groups[0][dt[pt]]));if(ft.push(p(yt,xt)),p(yt,xt)){if(ht[_t]==dt[pt])continue;d3.select(ot._groups[0][ht[_t]]).remove()}}0==ft.filter((function(t){return 1==t})).length&&dt.push(ht[_t])}for(var gt=0;gt<dt.length;gt++)d3.select(ot._groups[0][dt[gt]]).style("opacity","1")}for(var vt=t.group.selectAll(".pie-text-groups"),mt=[],bt=[],St=0;St<vt._groups[0].length;St++){bt.push(St);for(var kt=St+1;kt<vt._groups[0].length;kt++){p(i(d3.select(vt._groups[0][St])),i(d3.select(vt._groups[0][kt])))&&(mt.push(St),d3.select(vt._groups[0][St]).style("opacity","0"))}}for(var wt=new Set(mt),Ct=Array.from(wt),Ot=Mt(Ct,bt),Ft=0;Ft<Ct.length;Ft++){for(var Lt=[],Pt=0;Pt<Ot.length;Pt++){var At=i(d3.select(vt._groups[0][Ct[Ft]])),Wt=i(d3.select(vt._groups[0][Ot[Pt]]));if(Lt.push(p(At,Wt)),p(At,Wt)){if(Ct[Ft]==Ot[Pt])continue;d3.select(vt._groups[0][Ct[Ft]]).style("opacity","0")}}0==Lt.filter((function(t){return 1==t})).length&&Ot.push(Ct[Ft])}for(var zt=0;zt<Ot.length;zt++)d3.select(vt._groups[0][Ot[zt]]).style("opacity","1");function Mt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}function Dt(t){var e=.7*k(Math.abs(t.data.value)),i=(t.startAngle+t.endAngle)/2-Math.PI/2;return[Math.cos(i)*e,Math.sin(i)*e]}}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}}]),n}(at),ft=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rose-text"),i._stroke="#fff",i._strokeWidth=1,i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._suffix="",i._range=[],i._radius=0,i._cornerRadius=0,i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._rotateDirection="clockwise",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._startAngle,n=t._endAngle,a=t._radius,o=d3.max(e,(function(t){return Math.abs(t.value)})),r=t._maxValue||o,l=[0,1.1*r];if(t._isPolar)if(null==t._count)l=v(0,r,Math.ceil(a/t._themeFontSize/3));else if(l=[],0!=t._count){var s=r-0,u=t._count,c=Math.ceil(Math.abs(s/t._count)),h=Math.ceil((a-t._innerRadius)/t._themeFontSize*2),d=d3.tickStep(0,r,h);t._count<d&&(c=Math.ceil(Math.abs(s/d)),u=d),r+=c;for(var _=0;_<c+1;_++)l.push(0+_*u)}else l.push(0);var f=d3.scaleLinear().domain([d3.min(l),d3.max(l)]).range([t._innerRadius,a]);t.group.interrupt().selectAll("*").interrupt(),t.group.selectAll("*").remove();t.arcFunc.innerRadius(t._innerRadius).outerRadius((function(t){return f(Math.abs(t.data.value))})).cornerRadius(t._cornerRadius);var p=t.pieFunc.value(1).startAngle(i).endAngle(n).sort(t._sortMethod),y=d3.arc().innerRadius(t._innerRadius).outerRadius(a).startAngle(i).endAngle(n);t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-text-"+t.id).append("path").attr("d",y());var x=t.group.append("g").attr("clip-path","").selectAll("g.arc-text-group").data(p(e));x.exit().remove();var g=x.enter().append("g").attr("class","arc-text-group");g.append("g");var m=x.merge(g).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?m.select("g").transition().duration(0).delay(0).ease(d3.easeLinear).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):m.select("g").transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay+.1*t._duration:0).ease(d3.easeLinear).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}}]),e}(at),pt=function(t){function e(){b(this,e);var t=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._showX=!0,t._showY=!0,t._stroke="#ccc",t._strokeDasharray="2 2",t}return w(e,t),S(e,[{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}}]),e}(L),yt="donut-grid-arc-path",xt="donut-grid-line",gt=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.elem=t.append("g").attr("class","donut-polar-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=5,e}return w(i,t),S(i,[{key:"update",value:function(){var t=this,i=t._startAngle,n=t._endAngle,a=t._radius,o=t._innerRadius,r=t.group.style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray);!function(){if(!t._showX)return void r.selectAll("."+yt).remove();var l=t._donutCount,s=r.selectAll("."+yt).data(isNaN(Number(l))?l:d3.range(l));s.exit().remove(),s.enter().append("path").attr("class",yt).merge(s).attr("d",(function(t,r){var s=Math.abs(t);return isNaN(Number(l))||(s=o+(a-o)/l*(r+1)),e(s,i,n)})),isNaN(Number(l))&&Math.round(Math.abs(l[l.length-1]))!=Math.round(a)&&(r.selectAll(".fixed-donut-grid-arc-path").remove(),r.append("path").attr("class","fixed-"+yt).attr("d",e(a,i,n)))}(),function(){if(!t._showY)return void r.selectAll("."+xt).remove();var e=t._sectorCount||1,l=(n-i)/e,s=r.selectAll("."+xt).data(d3.range(e+1));s.exit().remove(),s.enter().append("line").attr("class",xt).merge(s).attr("x1",(function(t,e){var n=i+l*e;return Math.cos(n-Math.PI/2)*o})).attr("y1",(function(t,e){var n=i+l*e;return Math.sin(n-Math.PI/2)*o})).attr("x2",(function(t,e){var n=i+l*e;return Math.cos(n-Math.PI/2)*a})).attr("y2",(function(t,e){var n=i+l*e;return Math.sin(n-Math.PI/2)*a}))}()}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}}]),i}(pt),vt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=null,i._gridStroke="#ccc",i._gridStrokeDasharray="3 3",i._gridShowX=!0,i._gridShowY=!0,i._gridLineWidth=1,i}return w(e,t),S(e,[{key:"gridStroke",value:function(t){return arguments.length?(this._gridStroke=t,this):this._gridStroke}},{key:"gridStrokeDasharray",value:function(t){return arguments.length?(this._gridStrokeDasharray=t,this):this._gridStrokeDasharray}},{key:"gridShowX",value:function(t){return arguments.length?(this._gridShowX=t,this):this._gridShowX}},{key:"gridShowY",value:function(t){return arguments.length?(this._gridShowY=t,this):this._gridShowY}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}},{key:"gridLineStyle",value:function(t){return arguments.length?(this._gridLineStyle=t,this):this._gridLineStyle}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.grid;this.gridStroke(i.color).gridShowX(i.showX).gridShowY(i.showY),this.gridLineWidth(0==parseFloat(i.gridLineWidth)?0:i.gridLineWidth||1),this.gridLineStyle(i.gridLineStyle);var n="3 3";i.gridLineStyle?"line"==i.gridLineStyle?n="0,0":"dashline"==i.gridLineStyle?n="4,4":"dottedline"==i.gridLineStyle&&(n="2,4"):n="3 3",this.gridStrokeDasharray(n)}}]),e}(nt),mt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","radial-axis"),i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._suffix="",i._range=[],i._radius=0,i._rotateDirection="clockwise",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=(e._data,e._startAngle,e._endAngle,e._maxValue),n=e._radius;e.group.interrupt().selectAll("*").interrupt(),e.group.selectAll("*").remove(),e._startAngle>Math.PI/2&&e._startAngle<1.5*Math.PI&&(parseFloat(e._yLabelAngle)<=0?e._yLabelAngle=parseFloat(e._yLabelAngle)+180:e._yLabelAngle=parseFloat(e._yLabelAngle)-180);var a=[0,1.1*i],o=e.group;if(e._isPolar){if(null==e._count)a=v(0,i,Math.ceil(n/e._themeFontSize/3));else if(a=[],0!=e._count){var r=i-0,l=e._count,s=Math.ceil(Math.abs(r/e._count)),u=Math.ceil((n-e._innerRadius)/e._themeFontSize*2),c=d3.tickStep(0,i,u);e._count<c&&(s=Math.ceil(Math.abs(r/c)),l=c),i+=s;for(var h=0;h<s+1;h++)a.push(0+h*l)}else a.push(0);var d=[];a.forEach((function(t){var e=String(t).indexOf(".")+1,i=String(t).length-e;d.push(i)})),d=d.filter((function(t){return t<=8})),a=a.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(d)&&(t=parseFloat(t).toFixed(d3.max(d)))}return t}))}var _=a.map((function(i){return E(i,e._numberStyle,e._decimalPlaces)+t._suffix})),f=d3.scaleLinear().domain([d3.min(a),d3.max(a)]).range([-e._innerRadius,-n]),p=(d3.max(a,(function(t){return R(t,e._themeFontSize,e._themeFontFamily)})),e._themeFontSize),y=[];if("横排"==e._yLabelDirection){_=_.map((function(t){return X(t,n,e._themeFontSize,e._themeFontFamily)}));var x=d3.max(_,(function(t){return R(t,e._themeFontSize,e._themeFontFamily)}))||0,g=e._themeFontSize,m=Math.abs(Math.sin(Math.abs(e._yLabelAngle)*Math.PI/180)),b=Math.abs(Math.cos(Math.abs(e._yLabelAngle)*Math.PI/180));_.forEach((function(t){var i=R(t,e._themeFontSize,e._themeFontFamily)/(90==Math.abs(e._yLabelAngle)?2:1);y.push(g*b+i*m)})),p=g*b+x*m}else{_=_.map((function(t){return j(t,n,e._themeFontSize,e._themeFontFamily)}));var S=d3.max(_,(function(t){return B(t,e._themeFontSize,e._themeFontFamily)}))||0,k=e._themeFontSize,w=Math.abs(Math.sin(Math.abs(e._yLabelAngle)*Math.PI/180)),C=Math.abs(Math.cos(Math.abs(e._yLabelAngle)*Math.PI/180));_.forEach((function(t){var i=B(t,e._themeFontSize,e._themeFontFamily)/(Math.abs(e._yLabelAngle)%180==0?2:1);y.push(i*C+k*w)})),p=S*C+k*w}var O=(n-e._innerRadius)/a.length;Math.min(.9*e._mainWidth,.9*e._mainHeight);if("clockwise"==e._rotateDirection?"横排"==e._yLabelDirection?e._yLabelAngle:e._yLabelAngle<=0&&e._yLabelAngle>-90||e._yLabelAngle>90&&e._yLabelAngle:"横排"==e._yLabelDirection?e._yLabelAngle:e._yLabelAngle>=0&&e._yLabelAngle<90||e._yLabelAngle<-90&&e._yLabelAngle,e._isPolar&&null==e._count&&p>O){var F=Math.ceil(p/O);a=a.filter((function(t,e){return e%F==0})),_=_.filter((function(t,e){return e%F==0})),y=y.filter((function(t,e){return e%F==0}))}e._polarCount=a.map((function(t){return f(t)}));var L=d3.axisRight().tickSizeOuter(-.5).tickValues(a).scale(f);"clockwise"==e._rotateDirection&&(L=d3.axisLeft().tickSizeOuter(-.5).tickValues(a).scale(f));var P=o.append("g").attr("class","polar-axis").style("font-size",e._themeFontSize).style("font-family",e._themeFontFamily).call(L);1==e._interrupt?P.style("opacity",1):P.style("opacity",0).transition().duration(e._transition?.1*e._duration:0).delay(e._transition?e._startDelay:0).style("opacity",1),o.select(".polar-axis").attr("transform","rotate("+180*e._startAngle/Math.PI+")"),o.selectAll(".polar-axis .tick line").style("stroke",e._axisLineStrokeY).style("stroke-width",e._yAxisLineWidth).style("display",e._yAxisShow?"block":"none"),"横排"==e._yLabelDirection?(o.selectAll(".polar-axis .tick text").remove(),o.selectAll(".polar-axis .tick").append("text").text((function(t,e){return _[e]})).attr("transform",(function(t,i){var n=Y(e._themeFontSize,e._themeFontFamily,e._yLabelAngle,e._yLabelDirection,"clockwise"==e._rotateDirection?"left":"right"),a="clockwise"==e._rotateDirection?-8:8,o=.4*e._themeFontSize;return"translate("+(a+n.x)+","+(o+n.y)+")rotate("+e._yLabelAngle+")"})).style("font-size",e._themeFontSize).style("font-family",e._themeFontFamily).style("fill",e._themeFontColor).style("text-anchor",Y(e._themeFontSize,e._themeFontFamily,e._yLabelAngle,e._yLabelDirection,"clockwise"==e._rotateDirection?"left":"right").anchor).style("display",e._showY?"block":"none")):(o.selectAll(".polar-axis .tick text").remove(),o.selectAll(".polar-axis .tick").append("text").text((function(t,e){return _[e]})).each((function(t,i){for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),h=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),h.text(r.join("")),h.node().getComputedTextLength()>0&&(0==s||++l,r.pop(),h.text(r.join("")),r=[n],h=a.append("tspan").attr("x",u).attr("y",l*parseFloat(.9*e._themeFontSize*1.2)+c).text(n)),s++})).attr("transform",(function(t,i){var n=Y(e._themeFontSize,e._themeFontFamily,e._yLabelAngle,e._yLabelDirection,"clockwise"==e._rotateDirection?"left":"right",_[i]);return"translate("+n.x+","+n.y+")rotate("+e._yLabelAngle+")"})).style("font-size",e._themeFontSize).style("font-family",e._themeFontFamily).style("fill",e._themeFontColor).style("text-anchor",(function(t,i){return Y(e._themeFontSize,e._themeFontFamily,e._yLabelAngle,e._yLabelDirection,"clockwise"==e._rotateDirection?"left":"right",_[i]).anchor})).style("display",e._showY?"block":"none")),o.select(".polar-axis path").style("stroke",e._axisLineStrokeY).style("stroke-width",e._yAxisLineWidth).style("display",e._yAxisShow?"block":"none"),e.tickValues=a}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=parseFloat(t),this):this._maxValue}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),bt=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","rose-chart"),e.core=e.rose=new _t(e.mainGroup),e.grid=new gt(e.mainGroup),e.roseText=new ft(e.mainGroup),e.radialAxis=new mt(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._labelRadiusRatio=.8,e._innerRadiusRatio=0,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e._rotateDirection="clockwise",e._barWidthPercent="1",e._fillOpacity=1,e._labelShow=!1,e._textLabelShow=!1,e._positionOptions=["内部","外部"],e._textPositionChoice="内部",e._numberPositionChoice="内部",e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["径向展开","顺时针展开","逆时针展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);t._fontCopy?t._fontFamily:t._textLabel.fontFamily;var e=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,i=(t._fontCopy?t._fontColor:q(t._textLabel.color),t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,t._labelShow?t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize:0),n=(t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),t.rose),a=t.grid,o=t.roseText,r=t.radialAxis;function l(t,e){return"1st"==t?1==e?0:.5*Math.PI:"2nd"==t?1==e?.5*Math.PI:Math.PI:"3rd"==t?1==e?Math.PI:1.5*Math.PI:"4th"==t?1==e?1.5*Math.PI:2*Math.PI:1==e?0:.5*Math.PI}var u=t._displayQuadrant?l(t._displayQuadrant,1):t._startAngle,h=t._displayQuadrant?l(t._displayQuadrant,2):t._endAngle,d=t.widthOfNoMargin,_=t.heightOfMainGroup,f=(t._fontSize,.88*d),p=.88*_,g=d3.max(t.activeData,(function(t){return Math.abs(t.value)}))||1,v=0,m=s(f,p,u,h),b=g+t._yLabelSuffix,S=t.activeData.map((function(t){return t.name}))||"",k=void 0,w=void 0,C=void 0,O=void 0,F=void 0,L=0,P=0;"横排"==t._yLabelDirection&&1==t._yTickShow?(C=R(b,t._fontSize,t._fontFamily)||0,L=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180)),P=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180))):"竖排"==t._yLabelDirection&&1==t._yTickShow?(C=B(b,t._fontSize,t._fontFamily)||0,L=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),P=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180))):C=0,"1st"==t._displayQuadrant||"3rd"==t._displayQuadrant?(k=L*C<.4*f?L*C:.4*f,w=0):"2nd"!=t._displayQuadrant&&"4th"!=t._displayQuadrant||(k=P*C<.4*f?P*C:.4*f,w=0),"水平"==t._xLabelDirection&&1==t._xTickShow?(O=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),F=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(O=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),F=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(O=t._fontSize,F=t._fontSize):(O=0,F=0),O=O<.4*f?O:.4*f,F=F<.4*p?F:.4*p,v=Math.abs(h-u)==Math.PI/2&&"外部"==t._axisPositonChoice?Math.min(f-O-k,p-F-w):"外部"==t._axisPositonChoice?Math.min(f/2-O,p/2-F):.88*Math.min(d,_)/2;var A=d3.scaleLinear().domain([0,v]).range([0,g]);"外部"==t._textPositionChoice&&"外部"==t._numberPositionChoice?g=A(parseFloat(v)+parseFloat(1.1*e)+parseFloat(1.1*i)+6):"外部"==t._textPositionChoice?g=A(parseFloat(v)+parseFloat(1.1*e)+6):"外部"==t._numberPositionChoice&&(g=A(parseFloat(v)+parseFloat(1.1*i)+6));for(var W=v,z=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*v:0),M=0,D=0;D<t.activeData.length;D++)M+=t.activeData[D].value;for(var N=0;N<t.activeData.length;N++)t.activeData[N].percent=parseFloat(t.activeData[N].value/M*100).toFixed(1);if(t._stroke&&/\[/.test(t._stroke)){var T=x(t._stroke),G=[],X=!0,j=!1,I=void 0;try{for(var Y,H=T[Symbol.iterator]();!(X=(Y=H.next()).done);X=!0){var V=Y.value,$=[],U=V.split(":");$.push(q(U[0])),$.push(U[1]),G.push($)}}catch(t){j=!0,I=t}finally{try{!X&&H.return&&H.return()}finally{if(j)throw I}}var Z=G.concat(),Q=Z.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(Q[1]).x1+"%").attr("y1",y(Q[1]).y1+"%").attr("x2",y(Q[1]).x2+"%").attr("y2",y(Q[1]).y2+"%").selectAll("stop").data(Z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(t.activeData).radius(v).innerRadius(z).startAngle(u).endAngle(h).rotateDirection(t._rotateDirection).cornerRadius(t._cornerRadius).barWidthPercent(t._barWidthPercent).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).fillOpacity(t._fillOpacity).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).count(t._yCountOfLabel).isPolar(t._isPolar).range(t._yRange).showX(t._xTickShow).xAxisShow(t._xAxisShow).xAxisLineWidth(t._xAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).mainWidth(f).mainHeight(p).axisPositonChoice(t._axisPositonChoice).defs(t.defs).maxValue(g).onMouseover((function(e,i){d3.select(this).transition().style("opacity",.8);var n=[{text:""+(e.data.name=="$-"+i?"":e.data.name),color:e.data.color},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().style("opacity",1),t.tooltip.hide()}));var K=t.defs;K.selectAll("filter").remove();var J=K.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_rose").attr("filterUnits","objectBoundingBox");J.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),J.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),J.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),J.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),J.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),o.data(t.activeData).radius(v).innerRadius(z).startAngle(u).endAngle(h).cornerRadius(t._cornerRadius).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).strokeWidth(t._strokeWidth).rotateDirection(t._rotateDirection).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).themeFontSize(t._fontSize).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).maxValue(g).onTransitionEnd(t.activeData.length>0?t._onTransitionEnd():"");var tt=u,et=h,it="clockwise",nt=t._yLabelAngle;"2nd"!=t._displayQuadrant&&"4th"!=t._displayQuadrant||(tt=h,et=u,it="counterclockwise"),"2nd"!=t._displayQuadrant&&"3rd"!=t._displayQuadrant||(nt=parseFloat(t._yLabelAngle)<=0?parseFloat(t._yLabelAngle)+180:parseFloat(t._yLabelAngle)-180),r.data(t.activeData).radius(v).innerRadius(z).startAngle(tt).endAngle(et).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(it).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(nt).mainWidth(d).mainHeight(_).suffix(t._yLabelSuffix).maxValue(g).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var at=d/2,ot=_/2,rt=m.quadrant;if(Math.abs(h-u)==Math.PI/2)switch(rt){case 4:at=(d-(v+k+O))/2+v+O,ot=(_-(v+w+F))/2+v+F;break;case 1:at=(d-(v+k+O))/2+k,ot=(_-(v+w+F))/2+v+F;break;case 2:at=(d-(v+k+O))/2,ot=(_-(v+w+F))/2+w;break;case 3:at=(d-(v+k+O))/2+v+O,ot=(_-(v+w+F))/2}n.translate(at,ot).update(),o.translate(at,ot).update(),r.translate(at,ot).update(),a.donutCount(t._isPolar?r._polarCount:6).sectorCount(t.activeData.length).startAngle(u).endAngle(h).radius(W).innerRadius(z).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),a.translate(at,ot).update();var lt=t.mainGroup.selectAll(".donut-grid-arc-path").nodes();lt.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(lt[0]).remove():t._xAxisShow&&(t._isPolar&&Math.round(Math.abs(r._polarCount[r._polarCount.length-1]))==Math.round(v)?d3.select(lt[lt.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"_onTransitionEnd",value:function(){var t=this,i=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,n=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,a=t._fontCopy?t._fontColor:q(t._textLabel.color),o=t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,r=t._labelShow?t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize:0,l=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color);function u(t,e){return"1st"==t?1==e?0:.5*Math.PI:"2nd"==t?1==e?.5*Math.PI:Math.PI:"3rd"==t?1==e?Math.PI:1.5*Math.PI:"4th"==t?1==e?1.5*Math.PI:2*Math.PI:1==e?0:.5*Math.PI}var c=t._displayQuadrant?u(t._displayQuadrant,1):t._startAngle,h=t._displayQuadrant?u(t._displayQuadrant,2):t._endAngle,d=s(.88*t.widthOfNoMargin,.88*t.heightOfMainGroup,c,h).radius-.55*n-6;t._innerRadius||t._innerRadiusRatio&&t._innerRadiusRatio;return function(s,u){var c=t.roseText.arcFunc.outerRadius()(s),h=d3.select(this.parentNode),d=s.startAngle,_=s.endAngle;if("内部"==t._textPositionChoice){var f="arc-path-text-"+s.data.key+"-"+t.id,p=e(c-n/2-6,d+.015,_-.015);D(h,t.defs.select("#"+f).empty()?t.defs.append("path").attr("d",p).attr("id",f):t.defs.select("#"+f).attr("d",p),s.data.name.toString(),n,i).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(a)).style("font-size",n).style("font-family",i).style("display",t._textLabelShow?"block":"none")}else if("外部"==t._textPositionChoice){var y="arc-path-text-"+s.data.key+"-"+t.id,x=e(c+n/2+6+("内部"==t._numberPositionChoice?0:1.1*r),d+.015,_-.015);D(h,t.defs.select("#"+y).empty()?t.defs.append("path").attr("d",x).attr("id",y):t.defs.select("#"+y).attr("d",x),s.data.name.toString(),n,i).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(a)).style("font-size",n).style("font-family",i).style("display",t._textLabelShow?"block":"none")}if("内部"==t._numberPositionChoice){var g="arc-path-"+s.data.key+"-"+t.id,v=e(c-.9*r/2-6-("外部"==t._textPositionChoice?0:1.1*n),d+.015,_-.015);D(h,t.defs.select("#"+g).empty()?t.defs.append("path").attr("d",v).attr("id",g):t.defs.select("#"+g).attr("d",v),E(s.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,r,o).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(l)).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}else if("外部"==t._numberPositionChoice){var m="arc-path-"+s.data.key+"-"+t.id,b=e(c+.9*r/2+6,d+.015,_-.015);D(h,t.defs.select("#"+m).empty()?t.defs.append("path").attr("d",b).attr("id",m):t.defs.select("#"+m).attr("d",b),E(s.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,r,o).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(l)).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setPublicOption",this).call(this,t);var e=t.polarAxis,n=e.x||{},a=e.y||{};this.axisLineStroke(q(e.color)).axisLineStrokeX(q(n.axisColor)||q(e.color)).axisLineStrokeY(q(a.axisColor)||q(e.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:"",this._textPositionChoice=i.textLabel&&i.textLabel.positionChoice?i.textLabel.positionChoice:this._textPositionChoice,this._numberPositionChoice=i.numberLabel&&i.numberLabel.positionChoice?i.numberLabel.positionChoice:this._numberPositionChoice),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._cornerRadius=0==e.cornerRadius||e.cornerRadius?d(e.cornerRadius):this._cornerRadius,this._stroke=e.areaBorderColor?q(e.areaBorderColor):"",this._strokeWidth=0==e.areaBorderWidth||e.areaBorderWidth?d(e.areaBorderWidth):this._areaBorderWidth,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?d(e.barWidthPercent):this._barWidthPercent,this._innerRadiusRatio=0==e.innerRadiusRatio||e.barWidthPercent?d(e.innerRadiusRatio):this._innerRadiusRatio,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}}]),i}(vt),St=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._cornerRadius=0,i._stroke="#fff",i._strokeWidth=1,i._fillOpacity=1,i._labelShow=!1,i._textLabelShow=!1,i._positionOptions=["内部","外部"],i._textPositionChoice="内部",i._numberPositionChoice="内部",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["径向展开","顺时针展开","逆时针展开"],i._moveStyle="径向展开",i._endPause=0,i._interrupt=!1,i._cornerRadius="2",i._areaBorderWidth="1",i._areaBorderColor="#FFFFFF",i._barWidthPercent="1",i._displayQuadrant="4th",i._fillOpacity="1",i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:"",this._textPositionChoice=i.textLabel&&i.textLabel.positionChoice?i.textLabel.positionChoice:this._textPositionChoice,this._numberPositionChoice=i.numberLabel&&i.numberLabel.positionChoice?i.numberLabel.positionChoice:this._numberPositionChoice),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._cornerRadius=0==e.cornerRadius||e.cornerRadius?d(e.cornerRadius):this._cornerRadius,this._stroke=e.areaBorderColor?q(e.areaBorderColor):"",this._strokeWidth=0==e.areaBorderWidth||e.areaBorderWidth?d(e.areaBorderWidth):this._areaBorderWidth,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._displayQuadrant=e.displayQuadrant?e.displayQuadrant:this._displayQuadrant,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}}]),e}(bt),kt="icon-bar-group",wt="icon-bar-clip-path",Ct="icon-bar-back-rect",Ot="icon-bar-back-group",Ft="icon-bar-front-group",Lt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","icon-bar"),i.defs=i.elem.append("defs"),i._width=400,i._height=400,i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._backFill="#ccc",i._countOfOneRow=20,i._padding=2,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove();var i=t._width,n=t._height;if(e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),"single"==t._type){var a=t._icon,r=t._countOfOneRow,l=t._padding,s=e.length,u=d3.max(e,(function(t){return parseFloat(t.value)})),h=i/r,d=n/Math.max(1,s),_=Math.min((h-2*l)/a.width,(d-2*l)/a.height)*t._iconScale*1,f=[],p=[];t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+_+")"),t.group.append("path").attr("class","icon").attr("d",a.path).attr("transform","scale("+_+")");t.group.select(".icon-test").node().getBoundingClientRect(),t.group.select(".icon").node().getBoundingClientRect();var g=t.group.select(".icon-test").node().getBBox(),v=t.group.select(".icon").node().getBBox(),m=a.width*_,b=a.height*_;f.push((v.x-g.x)*_),p.push((v.y-g.y)*_),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove();var S=function(t){return u>=r?r*t.value/u:t.value},k=t.defs,w="icon-"+t.id;k.select("#"+w).empty()&&k.append("path").attr("id",w).attr("d",a.path),k.selectAll("."+wt).remove();var C=k.selectAll("."+wt).data(e,(function(t){return t.name}));C.exit().remove();var O=C.enter().append("clipPath").attr("class",wt).attr("id",(function(e,i){return"icon-clip-"+i+"-"+t.id}));O.append("rect"),t._interrupt?O.merge(C).select("rect").attr("x",0).attr("y",-1).attr("height",d).attr("width",(function(t){return Math.round(S(t))*h})):O.merge(C).select("rect").attr("x",0).attr("y",-1).attr("width",0).attr("height",d).transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("width",(function(t){return Math.round(S(t))*h}));var F=t.group.selectAll("."+kt).data(e,(function(t){return t.key}));F.exit().remove(),F.selectAll("*").remove();var L=F.enter().append("g").attr("class",kt).merge(F).attr("transform",(function(t,e){return"translate(0, "+d*e+")"})).each(t._onTransitionStart).each(t._onTransitionEnd).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),P=L.append("rect").attr("class",Ct),A=L.append("g").attr("class",Ot).attr("opacity",0).call(o,0,(d-b)/2),W=L.append("g").attr("class",Ft).call(o,0,(d-b)/2).attr("clip-path",(function(e,i){return"url("+c("#icon-clip-"+i+"-"+t.id)+")"}));P.attr("width",i).attr("height",d).style("opacity",0);A.selectAll("g").data(d3.range(r)).enter().append("g").append("path").attr("d",a.path).style("fill",t._backFill).attr("transform",(function(t,e){return"translate("+(h*e+(h-m)/2-f[0])+","+-p[0]+") scale("+_+")"}));W.each((function(e,i){d3.select(this).selectAll("g").data((function(t){return d3.range(Math.round(S(t)))})).enter().append("g").append("path").attr("d",a.path).attr("transform",(function(t,e){return"translate("+(h*e+(h-m)/2-f[0])+","+-p[0]+") scale("+_+")"})).style("stroke",t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",(t._borderWidth||0)/_).style("fill",(function(n,a){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i,n){if(e.color&&/#/.test(e.color))return t._fillOpacity;var a=U(e.color,3)||1;return t._fillOpacity*a}))}))}else{for(var z=t._svgArr,M=t._icon,D=t._countOfOneRow,R=t._padding,N=e.length,T=d3.max(e,(function(t){return parseFloat(t.value)})),B=i/D,G=n/Math.max(1,N),X=Math.min((B-2*R)/M.width,(G-2*R)/M.height)*t._iconScale*1,j=(M.height,[]),I=[],Y=[],H=[],E=[],V=0;V<z.length;V++){var $=Math.min((B-2*R)/z[V].width,(G-2*R)/z[V].height)*t._iconScale*1;t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+$+")"),t.group.append("path").attr("class","icon").attr("d",z[V].path).attr("transform","scale("+$+")");t.group.select(".icon-test").node().getBoundingClientRect(),t.group.select(".icon").node().getBoundingClientRect();var Z=t.group.select(".icon-test").node().getBBox(),Q=t.group.select(".icon").node().getBBox();j.push($),I.push(z[V].width*$),Y.push(z[V].height*$),H.push((Q.x-Z.x)*$),E.push((Q.y-Z.y)*$),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove()}var K=function(t){return T>=D?D*t.value/T:t.value},J=t.defs,tt="icon-"+t.id;J.select("#"+tt).empty()&&J.append("path").attr("id",tt).attr("d",M.path),J.selectAll("."+wt).remove();var et=J.selectAll("."+wt).data(e,(function(t){return t.name}));et.exit().remove();var it=et.enter().append("clipPath").attr("class",wt).attr("id",(function(e,i){return"icon-clip-"+i+"-"+t.id}));it.append("rect"),t._interrupt?it.merge(et).select("rect").attr("x",0).attr("y",-1).attr("height",G).attr("width",(function(t){return Math.round(K(t))*B})):it.merge(et).select("rect").attr("x",0).attr("y",-1).attr("width",0).attr("height",G).transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("width",(function(t){return Math.round(K(t))*B}));var nt=t.group.selectAll("."+kt).data(e,(function(t){return t.key}));nt.exit().remove(),nt.selectAll("*").remove();var at=nt.enter().append("g").attr("class",kt).merge(nt).attr("transform",(function(t,e){return"translate(0, "+G*e+")"})).each(t._onTransitionStart).each(t._onTransitionEnd).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),ot=at.append("rect").attr("class",Ct),rt=at.append("g").attr("class",Ot).attr("opacity",0).attr("transform",(function(t,e){return"translate(0,"+(G-Y[e])/2+")"})),lt=at.append("g").attr("class",Ft).attr("transform",(function(t,e){return"translate(0,"+(G-Y[e])/2+")"})).attr("clip-path",(function(e,i){return"url("+c("#icon-clip-"+i+"-"+t.id)+")"}));ot.attr("width",i).attr("height",G).style("opacity",0);rt.each((function(e,i){d3.select(this).selectAll("g").data(d3.range(D)).enter().append("g").append("path").attr("d",z[i].path).style("fill",t._backFill).attr("transform",(function(t,e){return"translate("+(B*e+(B-I[i])/2-H[i])+","+-E[i]+") scale("+j[i]+")"}))}));lt.each((function(e,i){d3.select(this).selectAll("g").data((function(t){return d3.range(Math.round(K(t)))})).enter().append("g").append("path").attr("d",z[i].path).attr("transform",(function(t,e){return"translate("+(B*e+(B-I[i])/2-H[i])+","+-E[i]+") scale("+j[i]+")"})).style("stroke-width",(t._borderWidth||0)/j[i]).style("stroke",t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("fill",(function(n,a){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i,n){if(e.color&&/#/.test(e.color))return t._fillOpacity;var a=U(e.color,3)||1;return t._fillOpacity*a}))}))}return t}},{key:"backFill",value:function(t){return arguments.length?(this._backFill=t,this):this._backFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"svgArr",value:function(t){return arguments.length?(this._svgArr=t,this):this._svgArr}},{key:"iconScale",value:function(t){return arguments.length?(this._iconScale=t,this):this._iconScale}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}}]),e}(at),Pt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","icon-bar-chart"),i.core=i.iconBar=new Lt(i.mainGroup),i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._iconBackFill="#ccc",i._iconPadding=2,i._innerPadding=5,i._iconScale=1,i._countOfOneRow=20,i._borderWidth=0,i._borderColor=null,i._fillOpacity=1,i._labelShow=!1,i._textLabelShow=!0,i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",suffix:""},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i._type="single",i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.iconBar,i=t.tooltip,n=t.activeData,a=t.widthOfNoMargin,o=t.heightOfMainGroup,r=[];if(t._pictures)if("single"==t._type){var l=t.group.append("foreignObject").attr("class","path-container");if(t._svgList[0]){l.html(t._svgList[0]).attr("class","svgIcon");var s=t.group.select(".svgIcon svg path").attr("d"),u=(t.group.append("path").attr("d",s).attr("class","icon"),t.group.select(".icon").node().getBBox());t._icon.path=s,t._icon.width=u.width,t._icon.height=u.height}t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}else for(var h=0;h<t._svgList.length;h++){var d=t.group.append("foreignObject"),_={};if(t._svgList[h]){d.html(t._svgList[h]).attr("class","svgIcon");var f=t.group.select(".svgIcon svg path").attr("d"),p=(t.group.append("path").attr("d",f).attr("class","icon"),t.group.select(".icon").node().getBBox());_.path=f,_.width=p.width,_.height=p.height}else _.path="",_.width=1e-4,_.height=1e-4;r.push(_),t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}else{var x=t.group.append("foreignObject").attr("class","path-container");if(t._icon.path){x.html(t._icon.path).attr("class","svgIcon");var g=t._icon.path,v=(t.group.append("path").attr("d",g).attr("class","icon"),t.group.select(".icon").node().getBBox());t._icon.path=g,t._icon.width=v.width,t._icon.height=v.height}t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}t._fontSize;var m=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,b=t._fontCopy?t._fontSize:t._textLabel.fontSize,S=t._fontCopy?t._fontColor:q(t._textLabel.color),k=t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,w=t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize,C=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),O=.25*a,F=n.length?d3.max(n,(function(t,e){return R(t.name=="$-"+e?"":t.name,b,m)})):0,L=t._textLabelShow?Math.min(O,F):0,P=n.length?d3.max(n,(function(e){return R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,w,k)})):0,A=t._labelShow?Math.min(O,P):0;function W(t){return new Function("return "+t)()}if(t.group.selectAll(".hover-gradient").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=W(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("class","hover-gradient").attr("id",t.id+"-hover-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var z=W(t._borderColor),M=[],D=!0,N=!1,T=void 0;try{for(var B,G=z[Symbol.iterator]();!(D=(B=G.next()).done);D=!0){var j=B.value,I=[],Y=j.split(":");I.push(q(Y[0])),I.push(Y[1]),M.push(I)}}catch(t){N=!0,T=t}finally{try{!D&&G.return&&G.return()}finally{if(N)throw T}}var H=M.concat(),V=H.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(V[1]).x1+"%").attr("y1",y(V[1]).y1+"%").attr("x2",y(V[1]).x2+"%").attr("y2",y(V[1]).y2+"%").selectAll("stop").data(H).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).width(t.widthOfNoMargin-L-A-2*t._innerPadding).height(o).backFill(t._iconBackFill).countOfOneRow(t._countOfOneRow).iconScale(t._iconScale).borderWidth(t._borderWidth).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).icon(t._icon).padding(t._iconPadding).type(t._type).svgArr(r).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt),e.translate(L+t._innerPadding,0).onMouseover((function(e,n){var a=[{text:""+(e.name=="$-"+n?"":e.name),color:e.color},{text:e.valueLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];i.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this).select(".icon-bar-front-group").selectAll("path").style("stroke","#000")})).onMousemove((function(t,e){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e,n){i.hide(),d3.select(this).select(".icon-bar-front-group").selectAll("path").style("stroke",/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-hover-index-"+n)+")":e.color))})).onTransitionStart((function(i,n){var a=d3.select(this),o=t.heightOfMainGroup/e.data().length;if(a.append("text").attr("class",t.labelTextClass).attr("x",-t._innerPadding).attr("y",o/2).attr("dy","0.35em").style("text-anchor","end").style("fill",S).style("font-size",b).style("font-family",m).text(X(i.name=="$-"+n?"":i.name,L,b,m)),t._labelShow){var r=a.append("text").attr("class",t.labelTextClass).attr("x",t.widthOfNoMargin-L-A-t._innerPadding).attr("y",o/2).attr("dy","0.35em").style("text-anchor","start").style("fill",C).style("font-size",w).style("font-family",k).text(X(E(i.value,t._numberStyle,t._decimalPlaces)+t._suffix,A,w,k));t._interrupt?r.style("opacity",1):r.style("opacity",0).transition().duration(t._transition?1e3*t._duration*.1:0).delay((function(e,i){return t._transition?1e3*t._duration*.9+1e3*t._startDelay:0})).style("opacity",1)}})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.pictures,l=t.font;this._fontCopy=l,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=l?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!l||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(e).length&&(this._iconScale=0==e.iconScale||e.iconScale?e.iconScale:this._iconScale,this._countOfOneRow=0==e.IconsPerRow||e.IconsPerRow?e.IconsPerRow:this._countOfOneRow,this._borderWidth=0==e.iconBorderWidth||e.iconBorderWidth?e.iconBorderWidth:this._borderWidth,this._borderColor=e.iconBorderColor?q(e.iconBorderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(r).length&&(this._pictures=r||null,this._type=r?r.type:"single",this._svgList=r?r.svglist:null),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}},{key:"iconBackFill",value:function(t){return arguments.length?(this._iconBackFill=t,this):this._iconBackFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"iconPadding",value:function(t){return arguments.length?(this._iconPadding=t,this):this._iconPadding}}]),e}(nt),At="radial-bar-group",Wt=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radial-bar"),e.arcFunc=d3.arc(),e._innerRadius=0,e._outerRadius=100,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data;t.group.interrupt().selectAll("*").interrupt(),t.group.selectAll("*").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t._outerRadius,o=t._innerRadius,r=t._startAngle,l=t._endAngle,s=t._lineRatio,u=t.group,h=t.arcFunc,d=n.length,_=d3.max(n,(function(t){return Math.abs(t.value)})),f=d3.max(n,(function(t){return Math.abs(t.value)})),g=[];if(t._isPolar){if(null==t._count)g=v(0,_,6);else if(g=[],0!=t._count){var m=_-0,b=t._count,S=Math.ceil(Math.abs(m/t._count)),k=Math.ceil(2*a/t._themeFontSize),w=d3.tickStep(0,_,k);t._count<w&&(S=Math.ceil(Math.abs(m/w)),b=w),_+=S;for(var C=0;C<S+1;C++)g.push(0+C*b)}else g.push(0);var O=[];g.forEach((function(t){var e=String(t).indexOf(".")+1,i=String(t).length-e;O.push(i)})),O=O.filter((function(t){return t<=8})),g=g.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(O)&&(t=parseFloat(t).toFixed(d3.max(O)))}return t}))}g=g.filter((function(t){return t<f})),d>0&&g.push(f),"counterclockwise"==t._rotateDirection&&g.reverse();var F=(a-o)/d,L=Math.max(F*s,t._minLineWidth),P=d3.scaleLinear().domain([g[0],g[g.length-1]]).range([r,l]),A=[],W=[];g.forEach((function(e){A.push(P(e)),W.push(E(e,t._numberStyle,t._decimalPlaces))})),t._sector=A;for(var z=[],M=0;M<A.length-1;M++)z.push(A[M+1]-A[M]);"counterclockwise"==t._rotateDirection?z.unshift(z[0]):z.push(z[z.length-1]);var N=function(t,e){return o+F*(e+.5)},T=d3.scaleLinear().domain([0,f]).range([r,l]),G=function(t){return T(Math.abs(t))};h.innerRadius((function(t,e){return N(0,e)-L/2})).outerRadius((function(t,e){return N(0,e)+L/2})).startAngle("counterclockwise"==t._rotateDirection?function(t){return G(t.value)}:r).endAngle("counterclockwise"==t._rotateDirection?l:function(t){return G(t.value)}).cornerRadius(t._cornerRadius);var I=n.length?n.map((function(t){return t.name})).concat([""]):[];t._startAngle>Math.PI/2&&t._startAngle<1.5*Math.PI&&(parseFloat(t._yLabelAngle)<=0?t._yLabelAngle=parseFloat(t._yLabelAngle)+180:t._yLabelAngle=parseFloat(t._yLabelAngle)-180);var H=I,V=H,$=d3.scalePoint().domain(I).range([a-o,0]),Z=(d3.max(H,(function(e){return R(e,t._themeFontSize,t._themeFontFamily)})),t._themeFontSize),Q=[];if("横排"==t._yLabelDirection){V=V.map((function(e){return X(e,a,t._themeFontSize,t._themeFontFamily)}));var K=d3.max(V,(function(e){return R(e,t._themeFontSize,t._themeFontFamily)}))||0,J=t._themeFontSize,tt=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),et=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180));V.forEach((function(e){var i=R(e,t._themeFontSize,t._themeFontFamily)/(90==Math.abs(t._yLabelAngle)?2:1);Q.push(J*et+i*tt)})),Z=J*et+K*tt}else{V=V.map((function(e){return j(e,a,t._themeFontSize,t._themeFontFamily)}));var it=d3.max(V,(function(e){return B(e,t._themeFontSize,t._themeFontFamily)}))||0,nt=t._themeFontSize,at=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),ot=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180));V.forEach((function(e){var i=B(e,t._themeFontSize,t._themeFontFamily)/(Math.abs(t._yLabelAngle)%180==0?2:1);Q.push(i*ot+nt*at)})),Z=it*ot+nt*at}var rt=a/H.length;Math.min(.9*t._mainWidth,.9*t._mainHeight);if("clockwise"==t._rotateDirection?"横排"==t._yLabelDirection?t._yLabelAngle:t._yLabelAngle<=0&&t._yLabelAngle>-90||t._yLabelAngle>90&&t._yLabelAngle:"横排"==t._yLabelDirection?t._yLabelAngle:t._yLabelAngle>=0&&t._yLabelAngle<90||t._yLabelAngle<-90&&t._yLabelAngle,t._polarCount=H.length-1>0?H.length-1:0,Z>rt){var lt=Math.ceil(Z/rt);H=H.filter((function(t,e){return e%lt==0})),V=V.filter((function(t,e){return e%lt==0})),Q=Q.filter((function(t,e){return e%lt==0})),t._polarCount=H.length-1>0?H.length-1:0}var st=d3.axisRight().tickSizeOuter(-.5).tickValues(H).scale($);"clockwise"==t._rotateDirection&&(st=d3.axisLeft().tickSizeOuter(-.5).tickValues(H).scale($));var ut=u.append("g").attr("class","radial-bar-axis");ut.append("path").attr("class","radial-bar-xAxis").attr("d",e(a,t._startAngle,t._endAngle)).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?ut.style("opacity",1):ut.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);var ct=(l-r)/8,ht=u.selectAll(".radial-bar-lines").data(g);ht.exit().remove();var dt=ht.enter().append("line").attr("class","radial-bar-lines").merge(ht).style("fill","none").style("stroke",t._axisLineStrokeX).attr("x1",(function(t,e){var i=A[e];return Math.cos(i-Math.PI/2)*a})).attr("y1",(function(t,e){var i=A[e];return Math.sin(i-Math.PI/2)*a})).attr("x2",(function(t,e){var i=A[e];return Math.cos(i-Math.PI/2)*(a+5)})).attr("y2",(function(t,e){var i=A[e];return Math.sin(i-Math.PI/2)*(a+5)})),_t=u.selectAll("."+At).data(n,(function(t){return t.key}));_t.exit().remove();var ft=_t.enter().append("g").attr("class",At);ft.append("path").attr("class","arc-path"),t._showMark&&ft.append("circle").attr("class","mark-circle");var pt=ft.merge(_t).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),yt=[],xt=a+10;if(n.length>0)for(var gt=0;gt<A.length;gt++){var vt=xt*Math.sin(A[gt]),mt=-xt*Math.cos(A[gt]);yt.push({x:vt,y:mt})}else yt=[];u.selectAll(".tick-text").remove();var bt=u.append("g").selectAll(".tick-text").data(yt);bt.exit().remove();var St=bt.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0){if("水平"==t._xLabelDirection){var o=Math.cos(A[i]-Math.PI/2)*(a+10),r=t._mainWidth/2-Math.abs(o);return X(W[i]+t._xLabelSuffix,r,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var l=Math.sin(A[i]-Math.PI/2)*(a+10),s=t._mainHeight/2-Math.abs(l);return W[i]+t._xLabelSuffix==void 0?"":j(W[i]+t._xLabelSuffix,s,t._themeFontSize,t._themeFontFamily)}}})).attr("x",(function(t,e){var i=A[e];return Math.cos(i-Math.PI/2)*(a+10)})).attr("y",(function(t,e){var i=A[e];return Math.sin(i-Math.PI/2)*(a+10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)St.attr("transform",(function(e,i){var n=A[i];return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,0)":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+.5*t._themeFontSize+")":"translate(0,"+.8*t._themeFontSize+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var kt=t.group.append("g").selectAll("text").data(yt);kt.exit().remove(),kt.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*A[e]/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none").text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(W[i]+t._xLabelSuffix,n,t._themeFontSize,t._themeFontFamily)})).attr("x",a+10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*A[e]/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*A[e]/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(a+10)+",0)":null})).style("display",t._showX?"block":"none")}else{u.selectAll(".tick-text").remove();var wt=t.group.selectAll("g.text-group").data(yt);wt.exit().remove();wt.enter().append("g").attr("class","text-group").merge(wt).each((function(i,o){var r=a+10,l=A[o],s=d3.select(this.parentNode),u="arc-path-"+o+"-"+t.id,c=e(r+.5*t._themeFontSize,l-(t._isPolar?z[o]:ct)/2+.015,l+(t._isPolar?z[o]:ct)/2-.015),h=t._defs.select("#"+u).empty()?t._defs.append("path").attr("d",c).attr("id",u):t._defs.select("#"+u).attr("d",c);n.length>0&&D(s,h,W[o]+t._xLabelSuffix,t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none")}))}1==t._interrupt?(dt.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),St.style("opacity",1).style("display",t._showX?"block":"none")):(dt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),St.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));var Ct=u.selectAll("text").nodes();Math.abs(t._startAngle-t._endAngle)>=2*Math.PI&&("周向"!=t._xLabelDirection&&"径向"!=t._xLabelDirection||("clockwise"==t._rotateDirection?d3.select(Ct[Ct.length-1]).remove():d3.select(Ct[0]).remove()));var Ot=u.append("g").attr("class","radial-bar-axisY").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).call(st);1==t._interrupt?Ot.style("opacity",1):Ot.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1),u.select(".radial-bar-axisY").attr("transform","translate(-0.5, "+-a+") rotate("+180*("counterclockwise"==t._rotateDirection?t._endAngle:t._startAngle)/Math.PI+" 0.5 "+a+")"),u.selectAll(".radial-bar-axisY .tick line").style("stroke",t._axisLineStrokeY).style("stroke-width",t._yAxisLineWidth).style("display",t._yAxisShow?"block":"none"),"横排"==t._yLabelDirection?(u.selectAll(".radial-bar-axisY .tick text").remove(),u.selectAll(".radial-bar-axisY .tick").append("text").text((function(t,e){return V[e]})).attr("transform",(function(e,i){var r=Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right"),l="clockwise"==t._rotateDirection?-8:8,s=.4*t._themeFontSize;return"translate("+(l+r.x)+","+(s+r.y-.5*(a-o)/(n.length||1))+")rotate("+t._yLabelAngle+")"})).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("text-anchor",Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right").anchor).style("display",t._showY?"block":"none")):(u.selectAll(".radial-bar-axisY .tick text").remove(),u.selectAll(".radial-bar-axisY .tick").append("text").text((function(t,e){return V[e]})).each((function(e,i){for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),h=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),h.text(r.join("")),h.node().getComputedTextLength()>0&&(0==s||++l,r.pop(),h.text(r.join("")),r=[n],h=a.append("tspan").attr("x",u).attr("y",l*parseFloat(.9*t._themeFontSize*1.2)+c).text(n)),s++})).attr("transform",(function(e,i){var r=Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right",V[i]);return"translate("+r.x+","+(r.y-.5*(a-o)/(n.length||1))+")rotate("+t._yLabelAngle+")"})).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("text-anchor",(function(e,i){return Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right",V[i]).anchor})).style("display",t._showY?"block":"none")),u.select(".radial-bar-axisY path").style("stroke",t._axisLineStrokeY).style("stroke-width",t._yAxisLineWidth).style("display",t._yAxisShow?"block":"none");for(var Ft=0;Ft<A.length;Ft++){var Lt=A[Ft];0==Lt||Lt==Math.PI?d3.select(u.selectAll(".tick-text").nodes()[Ft]).attr("text-anchor","middle"):Lt>Math.PI||Lt<0&&Lt>-Math.PI?d3.select(u.selectAll(".tick-text").nodes()[Ft]).attr("text-anchor","end"):d3.select(u.selectAll(".tick-text").nodes()[Ft]).attr("text-anchor","start")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var Pt=t.group.selectAll(".tick-text"),Wt=[],zt=[],Mt=0;Mt<Pt._groups[0].length;Mt++){zt.push(Mt);for(var Dt=Mt+1;Dt<Pt._groups[0].length;Dt++){p(i(d3.select(Pt._groups[0][Mt])),i(d3.select(Pt._groups[0][Dt])))&&(Wt.push(Mt),d3.select(Pt._groups[0][Mt]).style("opacity","0"))}}for(var Rt=new Set(Wt),Nt=Array.from(Rt),Tt=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(Nt,zt),Bt=0;Bt<Nt.length;Bt++){for(var Gt=[],Xt=0;Xt<Tt.length;Xt++){var jt=i(d3.select(Pt._groups[0][Nt[Bt]])),It=i(d3.select(Pt._groups[0][Tt[Xt]]));if(Gt.push(p(jt,It)),p(jt,It)){if(Nt[Bt]==Tt[Xt])continue;d3.select(Pt._groups[0][Nt[Bt]]).remove()}}0==Gt.filter((function(t){return 1==t})).length&&Tt.push(Nt[Bt])}for(var Yt=0;Yt<Tt.length;Yt++)d3.select(Pt._groups[0][Tt[Yt]]).style("opacity","1")}function Ht(e,i){if("counterclockwise"==t._rotateDirection){var n=d3.interpolate(l,G(f-e.value));return function(t){return h.startAngle(n(t)),h(e,i)}}var a=d3.interpolate(r,G(e.value));return function(t){return h.endAngle(a(t)),h(e,i)}}t._interrupt?(t._showMark?pt.select("circle").attr("cx",(function(e,i){return N(0,i)*Math.cos(G("counterclockwise"==t._rotateDirection?f-e.value:e.value)-Math.PI/2)})).attr("cy",(function(e,i){return N(0,i)*Math.sin(G("counterclockwise"==t._rotateDirection?f-e.value:e.value)-Math.PI/2)})).attr("r",t._markRadius).style("fill",(function(e,i){return t._endPointFillColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke",(function(e,i){return t._endPointBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._endPointBorderWidth).style("opacity",1):pt.select("circle").style("opacity",0),pt.select("path").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._areaBorderWidth).attr("d",(function(t,e){return h({value:0},e)})).interrupt().transition().duration(0).delay(0).ease(d3.easeCubicOut).attrTween("d",Ht).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)):(t._showMark?pt.select("circle").attr("cx",(function(e,i){return N(0,i)*Math.cos(G("counterclockwise"==t._rotateDirection?f-e.value:e.value)-Math.PI/2)})).attr("cy",(function(e,i){return N(0,i)*Math.sin(G("counterclockwise"==t._rotateDirection?f-e.value:e.value)-Math.PI/2)})).attr("r",t._markRadius).style("fill",(function(e,i){return t._endPointFillColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke",(function(e,i){return t._endPointBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._endPointBorderWidth).style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1):pt.select("circle").style("opacity",0),pt.select("path").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._areaBorderWidth).attr("d",(function(t,e){return h({value:0},e)})).interrupt().transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeCubicOut).attrTween("d",Ht).on("start",t._onTransitionStart).on("end",t._onTransitionEnd))}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"lineRatio",value:function(t){return arguments.length?(this._lineRatio=t,this):this._lineRatio}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"showMark",value:function(t){return arguments.length?(this._showMark=t,this):this._showMark}},{key:"markRadius",value:function(t){return arguments.length?(this._markRadius=t,this):this._markRadius}},{key:"minLineWidth",value:function(t){return arguments.length?(this._minLineWidth=t,this):this._minLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"xLabelSuffix",value:function(t){return arguments.length?(this._xLabelSuffix=t,this):this._xLabelSuffix}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),zt="donut-grid-arc-path",Mt="donut-grid-line",Dt=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.elem=t.append("g").attr("class","donut-polar-grid"),e.group=e.elem.append("g"),e._outerRadius=100,e._innerRadius=38,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=0,e._xGridClose=!0,e._gridLineWidth=1,e}return w(i,t),S(i,[{key:"update",value:function(){var t=this,i=t._outerRadius,n=t._innerRadius,a=(t._gridLineWidth,t._xMove,t._startAngle),o=t._endAngle,r=t._radiusValues,l=t.group.style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray);!function(){if(!t._showX)return void l.selectAll("."+zt).remove();var s=t._donutCount;if(r){var u=l.selectAll("."+zt).data(r);u.exit().remove(),u.enter().append("path").attr("class",zt).merge(u).attr("d",(function(t,i){return e(Math.abs(t),a,o)}))}else{var c=l.selectAll("."+zt).data(d3.range(s+1));c.exit().remove(),c.enter().append("path").attr("class",zt).merge(c).attr("d",(function(t,r){return e(n+(i-n)/s*r,a,o)}))}}(),function(){var e=t._sectorCount||0;if(!t._showY)return void l.selectAll(".donut-grid-line").remove();var r=(o-a)/e,s=(Math.abs(t._endAngle-t._startAngle),l.selectAll(".donut-grid-line").data(isNaN(Number(e))?e:d3.range(e+1)));s.exit().remove(),s.enter().append("line").attr("class",Mt).merge(s).attr("x1",(function(t,i){var o=isNaN(Number(e))?e[i]:a+r*i;return Math.cos(o-Math.PI/2)*n})).attr("y1",(function(t,i){var o=isNaN(Number(e))?e[i]:a+r*i;return Math.sin(o-Math.PI/2)*n})).attr("x2",(function(t,n){var o=isNaN(Number(e))?e[n]:a+r*n;return Math.cos(o-Math.PI/2)*i})).attr("y2",(function(t,n){var o=isNaN(Number(e))?e[n]:a+r*n;return Math.sin(o-Math.PI/2)*i}))}()}},{key:"radiusValues",value:function(t){return arguments.length?(this._radiusValues=t,this):this._radiusValues}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=parseFloat(t),this):this._gridLineWidth}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=t,this):this._sectorCount}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=parseFloat(t),this):this._innerRadius}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=parseFloat(t),this):this._endAngle}},{key:"xGridClose",value:function(t){return arguments.length?(this._endAngle=t,this):this._xGridClose}}]),i}(pt),Rt=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","radial-bar-chart"),e.core=e.radialBar=new Wt(e.mainGroup),e.grid=new Dt(e.mainGroup),e._innerRadiusRatio=.1,e._showMark=!1,e._lineRatio=.7,e._cornerRadius=0,e._areaBorderWidth="0",e._areaBorderColor=null,e._startAngle=0,e._totalAngle=1.5*Math.PI,e._fillOpacity=1,e._rotateDirection="clockwise",e._minLineWidth=0,e._markRadius=10,e._endPointBorderWidth="1",e._endPointBorderColor="#FFFFFF",e._endPointFillColor=null,e._labelShow=!0,e._textLabelShow=!0,e._positionOptions=["内部居右","外部","内部居左"],e._positionChoice="内部居右",e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["内部居右","外部","内部居左"],positionChoice:"内部居右"},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveStyle="同步顺时针",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){for(var t,e=this,i=e.tooltip,n=e.radialBar,a=e.grid,o=e.widthOfNoMargin,r=e.heightOfMainGroup,l=void 0,s=void 0,u=d3.max(e.activeData,(function(t){return Math.abs(t.value)})),h=[],d=0;d<9;d++){var _=Math.round(u/8*d*10)/10;h.push(E(_,e._numberStyle,e._decimalPlaces))}"水平"==e._xLabelDirection&&1==e._xTickShow?(l=d3.max(h.map((function(t){return R(t+e._xLabelSuffix,e._fontSize,e._fontFamily)}))),s=e._fontSize):"径向"==e._xLabelDirection&&1==e._xTickShow?(l=d3.max(h.map((function(t){return R(t+e._xLabelSuffix,e._fontSize,e._fontFamily)}))),s=d3.max(h.map((function(t){return R(t+e._xLabelSuffix,e._fontSize,e._fontFamily)})))):"周向"==e._xLabelDirection&&1==e._xTickShow?(l=e._fontSize,s=e._fontSize):(l=0,s=0),l=l<.4*o*.88?l:.4*o*.88,s=s<.4*r*.88?s:.4*r*.88;var f=(t=Math.min(.88*o/2-l,.88*r/2-s))*e._innerRadiusRatio,p=[];if("linear"==e._colors.type){var g=[q(isNaN(parseFloat(e._colors.list[0]))?e._colors.list[0]:e._colorList[e._colors.list[0]]),q(isNaN(parseFloat(e._colors.list[1]))?e._colors.list[1]:e._colorList[e._colors.list[1]])],v=d3.scaleLinear().domain([e.activeData.length-1,0]).range(g);p=function(t){for(var e,i,n=t.length,a=0;a<n-1;a++){e=a;for(var o=a+1;o<n;o++)t[o].value<t[e].value&&(e=o);i=t[a],t[a]=t[e],t[e]=i}return t}(e.activeData).map((function(t,e){return t.color=v(e),t}))}else p=e.activeData.sort((function(t,e){return t.value-e.value}));var m="counterclockwise"==e._rotateDirection?e._startAngle-e._totalAngle:e._startAngle,b="counterclockwise"==e._rotateDirection?e._startAngle:e._startAngle+e._totalAngle,S=e.defs;S.selectAll("filter").remove();var k=S.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_radialbar").attr("filterUnits","objectBoundingBox");if(k.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),k.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),k.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),k.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),k.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),e.mainGroup.selectAll(".linear-gradient").remove(),e._areaBorderColor&&/\[/.test(e._areaBorderColor)){var w=x(e._areaBorderColor),C=[],O=!0,F=!1,L=void 0;try{for(var P,A=w[Symbol.iterator]();!(O=(P=A.next()).done);O=!0){var W=P.value,z=[],M=W.split(":");z.push(q(M[0])),z.push(M[1]),C.push(z)}}catch(t){F=!0,L=t}finally{try{!O&&A.return&&A.return()}finally{if(F)throw L}}var D=C.concat(),N=D.pop();e.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",e.id+"-main-border-index-0").attr("x1",y(N[1]).x1+"%").attr("y1",y(N[1]).y1+"%").attr("x2",y(N[1]).x2+"%").attr("y2",y(N[1]).y2+"%").selectAll("stop").data(D).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(e._endPointBorderColor&&/\[/.test(e._endPointBorderColor)){var T=x(e._endPointBorderColor),B=[],G=!0,X=!1,j=void 0;try{for(var I,Y=T[Symbol.iterator]();!(G=(I=Y.next()).done);G=!0){var H=I.value,V=[],$=H.split(":");V.push(q($[0])),V.push($[1]),B.push(V)}}catch(t){X=!0,j=t}finally{try{!G&&Y.return&&Y.return()}finally{if(X)throw j}}var U=B.concat(),Z=U.pop();e.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",e.id+"-main-border-index-1").attr("x1",y(Z[1]).x1+"%").attr("y1",y(Z[1]).y1+"%").attr("x2",y(Z[1]).x2+"%").attr("y2",y(Z[1]).y2+"%").selectAll("stop").data(U).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(e._endPointFillColor&&/\[/.test(e._endPointFillColor)){var Q=x(e._endPointFillColor),K=[],J=!0,tt=!1,et=void 0;try{for(var it,nt=Q[Symbol.iterator]();!(J=(it=nt.next()).done);J=!0){var at=it.value,ot=[],rt=at.split(":");ot.push(q(rt[0])),ot.push(rt[1]),K.push(ot)}}catch(t){tt=!0,et=t}finally{try{!J&&nt.return&&nt.return()}finally{if(tt)throw et}}var lt=K.concat(),st=lt.pop();e.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",e.id+"-main-border-index-2").attr("x1",y(st[1]).x1+"%").attr("y1",y(st[1]).y1+"%").attr("x2",y(st[1]).x2+"%").attr("y2",y(st[1]).y2+"%").selectAll("stop").data(lt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(p).innerRadius(f).outerRadius(t).startAngle(m).endAngle(b).fillOpacity(e._fillOpacity).areaBorderWidth(e._areaBorderWidth).areaBorderColor(/\[/.test(e._areaBorderColor)?"url("+c("#"+e.id+"-main-border-index-0")+")":e._areaBorderColor).rotateDirection(e._rotateDirection).lineRatio(e._lineRatio).endPointBorderWidth(e._endPointBorderWidth).endPointBorderColor(/\[/.test(e._endPointBorderColor)?"url("+c("#"+e.id+"-main-border-index-1")+")":e._endPointBorderColor).endPointFillColor(/\[/.test(e._endPointFillColor)?"url("+c("#"+e.id+"-main-border-index-2")+")":e._endPointFillColor).cornerRadius(e._cornerRadius).showMark(e._showMark).markRadius(e._markRadius).minLineWidth(e._minLineWidth).transition(e._transition).duration(1e3*e._duration).easeStyle(e._easeStyle).startDelay(1e3*parseFloat(e._startDelay)).moveStyle(e._moveStyle).endPause(e._endPause).interrupt(e._interrupt).mainWidth(o).mainHeight(r).defs(e.defs).xLabelSuffix(e._xLabelSuffix).showX(e._xTickShow).showY(e._yTickShow).xAxisShow(e._xAxisShow).yAxisShow(e._yAxisShow).xAxisLineWidth(e._xAxisLineWidth).yAxisLineWidth(e._yAxisLineWidth).axisLineStrokeX(e._axisLineStrokeX).axisLineStrokeY(e._axisLineStrokeY).themeFontSize(e._fontSize).themeFontColor(e._fontColor).themeFontFamily(e._fontFamily).yLabelDirection(e._yLabelDirection).yLabelAngle(e._yLabelAngle).xLabelDirection(e._xLabelDirection).count(e._xCountOfLabel).isPolar(e._isPolar).numberStyle(e._numberStyle).decimalPlaces(e._decimalPlaces).onMouseover((function(t,n){d3.select(this).style("opacity",.8);var a=[{text:""+(t.showLegend?t.name:""),color:t.color},{text:t.valueLabel+": "+E(t.value,e._numberStyle,e._decimalPlaces)}];i.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){d3.select(this).style("opacity",1),i.hide()})).onTransitionStart(e._onTransitionStart()).onTransitionEnd(e._onTransitionEnd()),n.translate(o/2,r/2).update(),a.outerRadius(t).innerRadius(f).donutCount(p.length).sectorCount(e._isPolar?e.radialBar._sector:8).startAngle(m).endAngle(b).showX(e._gridShowX).showY(e._gridShowY).stroke(e._gridStroke).strokeDasharray(e._gridStrokeDasharray).gridLineWidth(e._gridLineWidth),0==!p.length&&a.translate(o/2,r/2).update();var ut=e.mainGroup.selectAll(".donut-grid-line").nodes();ut.length>0&&e.activeData.length>0&&(e._totalAngle>=2*Math.PI?e._yAxisShow?(d3.select(ut[0]).remove(),d3.select(ut[ut.length-1]).remove()):"clockwise"==e._rotateDirection?d3.select(ut[0]).remove():d3.select(ut[ut.length-1]).remove():e._yAxisShow&&("clockwise"==e._rotateDirection?d3.select(ut[0]).remove():d3.select(ut[ut.length-1]).remove()));var ct=e.mainGroup.selectAll(".donut-grid-arc-path").nodes();ct.length>0&&e.activeData.length>0&&e._xAxisShow&&(d3.select(ct[ct.length-1]).remove(),e.mainGroup.select(".fixed-donut-grid-arc-path").remove())}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=[];if("linear"==t._colors.type){var i=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],n=d3.scaleLinear().domain([t.activeData.length-1,0]).range(i);(e=function(t){for(var e,i,n=t.length,a=0;a<n-1;a++){e=a;for(var o=a+1;o<n;o++)t[o].value<t[e].value&&(e=o);i=t[a],t[a]=t[e],t[e]=i}return t}(t.activeData).map((function(t,e){return t.color=n(e),t})).filter((function(t,e){return 1==t.showLegend}))).reverse()}else e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"lineRatio",value:function(t){return arguments.length?(this._lineRatio=t,this):this._lineRatio}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"showMark",value:function(t){return arguments.length?(this._showMark=t,this):this._showMark}},{key:"markRadius",value:function(t){return arguments.length?(this._markRadius=t,this):this._markRadius}},{key:"minLineWidth",value:function(t){return arguments.length?(this._minLineWidth=t,this):this._minLineWidth}},{key:"_onTransitionStart",value:function(){var t=this,e=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,i=t._fontCopy?t._fontSize:t._textLabel.fontSize,n=t._fontCopy?t._fontColor:q(t._textLabel.color);return function(a,o){var r=d3.select(this.parentNode.parentNode),l=t.radialBar.arcFunc,s=(l.innerRadius()(a,o)+l.outerRadius()(a,o))/2,u=String(a.name).split("").length*i*1.147,c=t._startAngle,h="counterclockwise"==t._rotateDirection;function d(t,e){var n=void 0,a=void 0;switch(t){case 0:n=e?"5px":"-5px",a=-s;break;case.5*Math.PI:n=s-.5*i,a=e?parseFloat(i)+2:parseFloat(i)-u-2;break;case Math.PI:n=e?"-5px":"5px",a=s;break;case 1.5*Math.PI:n=-s-.5*i,a=e?parseFloat(i)-u-2:parseFloat(i)+2;break;default:n=e?"5px":"-5px",a=-s}return{x:n,y:a}}var _=r.append("text").attr("class",t.labelTextClass).attr("x",d(c,h).x).attr("y",(function(t,e){return d(c,h).y})).attr("dy",0==c||c==Math.PI?"0.35em":"0").style("text-anchor",(function(){return 0==c?h?"start":"end":c==Math.PI&&h?"end":"start"})).style("fill",n).style("font-size",i).style("font-family",e).style("display",t._textLabelShow?"block":"none");0==c||c==Math.PI?_.text(a.showLegend?a.name:""):_.text(a.showLegend?a.name:"").each((function(t,e){for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),h=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),h.text(r.join("")),h.node().getComputedTextLength()>i&&(0==s||++l,r.pop(),h.text(r.join("")),r=[n],h=a.append("tspan").attr("x",u).attr("y",l*parseFloat(.9*i*1.2)+c).text(n)),s++}))}}},{key:"_onTransitionEnd",value:function(){var t=this;t.group.selectAll(".radial-bar-texts").remove();var i=t.activeData,n=(d3.max(i,(function(t){return Math.abs(t.value)})),t.widthOfNoMargin),a=t.heightOfMainGroup,o=t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,r=t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize,l=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),s=Math.min(n,a)/2,u=s*t._innerRadiusRatio;return function(n,a){var c=d3.select(this.parentNode.parentNode),h=t.radialBar.arcFunc,d=(h.innerRadius()(n,a)+h.outerRadius()(n,a))/2,_=h.startAngle()(n,a),f=h.endAngle()(n,a),p="counterclockwise"==t._rotateDirection,y=void 0;y=p?Math.abs(_%(2*Math.PI))>=Math.PI/2&&Math.abs(_%(2*Math.PI))<3*Math.PI/2:Math.abs(f%(2*Math.PI))>=Math.PI/2&&Math.abs(f%(2*Math.PI))<3*Math.PI/2;var x="arc-path-"+n.key+"-"+t.id;if(0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice)t.group.selectAll(".radial-bar-texts").style("display","none");else if(0==t._positionOptions.indexOf(t._positionChoice)){var g=e(d,p?_+.05:_,p?f:f-.05,!y);D(c,t.defs.select("#"+x).empty()?t.defs.append("path").attr("d",g).attr("id",x):t.defs.select("#"+x).attr("d",g),X(E(n.value,t._numberStyle,t._decimalPlaces)+t._suffix,Math.abs(f-_)*(u+a*((s-u)/(i.length>0?i.length:1))),r,o),r,o,p?y?"100%":"0%":y?"0%":"100%").attr("class","radial-bar-texts").style("text-anchor",p?y?"end":"start":y?"start":"end").style("pointer-events","none").style("fill",l).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}else if(1==t._positionOptions.indexOf(t._positionChoice)){var v=e(d,p?_-Math.PI:f,p?_:f+Math.PI,!y);D(c,t.defs.select("#"+x).empty()?t.defs.append("path").attr("d",v).attr("id",x):t.defs.select("#"+x).attr("d",v),E(n.value,t._numberStyle,t._decimalPlaces)+t._suffix,r,o,p?y?"5%":"95%":y?"95%":"5%").attr("class","radial-bar-texts").style("text-anchor",p?y?"start":"end":y?"end":"start").style("pointer-events","none").style("fill",l).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}else if(2==t._positionOptions.indexOf(t._positionChoice)){y=p?Math.abs(f%(2*Math.PI))>Math.PI/2&&Math.abs(f%(2*Math.PI))<=3*Math.PI/2:Math.abs(_%(2*Math.PI))>=Math.PI/2&&Math.abs(_%(2*Math.PI))<3*Math.PI/2;var m=e(d,p?f-Math.PI:_,p?f:_+Math.PI,!y);D(c,t.defs.select("#"+x).empty()?t.defs.append("path").attr("d",m).attr("id",x):t.defs.select("#"+x).attr("d",m),E(n.value,t._numberStyle,t._decimalPlaces)+t._suffix,r,o,p?y?"0%":"100%":y?"100%":"0%").attr("class","radial-bar-texts").attr("dx",p?y?t._fontSize/2:-t._fontSize/2:y?-t._fontSize/2:t._fontSize/2).style("text-anchor",p?y?"start":"end":y?"end":"start").style("pointer-events","none").style("fill",l).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}}}},{key:"setSelfOption",value:function(t){var e=t.grid,i=t.display,n=t.label,a=t.animation,o=t.unitDisplay,r=t.sourceDisplay;t.font;this._fontCopy=null!=n.display&&null!=n.display,0!==Object.getOwnPropertyNames(e).length&&(this._gridStroke=e.color?q(e.color):this._gridStroke,this._gridLineStyle=e.gridLineStyle?e.gridLineStyle:this._gridLineStyle,this._gridLineWidth=0==e.gridLineWidth||e.gridLineWidth?d(e.gridLineWidth):this._gridLineWidth,this._showX=e.showX?e.showX:this._showX,this._showY=e.showY?e.showY:this._showY),0!==Object.getOwnPropertyNames(n).length&&(this._labelShow=this._fontCopy?n?n.display:this._labelShow:n.numberLabel?n.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(n.textLabel?n.textLabel.show:this._textLabelShow),this._positionChoice=this._fontCopy?n.positionChoice?n.positionChoice:this._positionChoice:n.numberLabel.positionChoice?n.numberLabel.positionChoice:this._positionChoice,this._textLabel=n.textLabel?n.textLabel:this._textLabel,this._numberLabel=n.numberLabel?n.numberLabel:this._numberLabel,this._suffix=n.numberLabel&&n.numberLabel.suffix?n.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(a).length&&(this._transition=a?a.transition:this._transition,this._easeStyle=a.easeStyle?a.easeStyle:this._easeStyle,this._duration=a?a.duration:this._duration,this._startDelay=a?a.startDelay:this._startDelay,this._moveStyle=a.moveStyle?a.moveStyle:this._moveStyle,this._endPause=a.endPause?a.endPause:this._endPause),0!==Object.getOwnPropertyNames(o).length&&(this._unitShow=o?o.show:this._unitShow,this._unitWord=o?o.text:this._unitWord,this._unitFontSize=o.fontSize?o.fontSize:this._unitSize,this._unitFontColor=o.color?q(o.color):this._unitColor,this._unitFontFamily=o.fontFamily?o.fontFamily:this._unitFamily,this._unitX=o.xPosition?o.xPosition:this._unitX,this._unitY=o.yPosition?o.yPosition:this._unitY),0!==Object.getOwnPropertyNames(r).length&&(this._sourceShow=r?r.show:this._sourceShow,this._sourceWord=r?r.text:this._sourceWord,this._sourceFontSize=r.fontSize?r.fontSize:this._sourceSize,this._sourceFontColor=r.color?q(r.color):this._sourceColor,this._sourceFontFamily=r.fontFamily?r.fontFamily:this._sourceFamily,this._sourceX=r.xPosition?r.xPosition:this._sourceX,this._sourceY=r.yPosition?r.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._areaBorderWidth=0==i.borderWidth||i.borderWidth?d(i.borderWidth):this._areaBorderWidth,this._areaBorderColor=i.borderColor?q(i.borderColor):"",this._lineRatio=0==i.barWidthPercent||i.barWidthPercent?d(i.barWidthPercent):this._lineRatio,this._cornerRadius=0==i.barCornerRadius||i.barCornerRadius?d(i.barCornerRadius):this._cornerRadius,this._startAngle=0==i.startAngleChoice||i.startAngleChoice?d(i.startAngleChoice)*(Math.PI/180):this._startAngle,this._totalAngle=0==i.totalAngle||i.totalAngle?d(i.totalAngle)*(Math.PI/180):this._totalAngle,this._fillOpacity=0==i.fillOpacity||i.fillOpacity?d(i.fillOpacity):this._fillOpacity,this._rotateDirection=i.rotateDirection?i.rotateDirection:this._rotateDirection)}},{key:"setPublicOption",value:function(t){k(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setPublicOption",this).call(this,t);var e=t.polarAxis,n=e.x||{},a=e.y||{};this.axisLineStroke(q(e.color)).axisLineStrokeX(q(n.axisColor)||q(e.color)).axisLineStrokeY(q(a.axisColor)||q(e.color)).xTickShow(!(0!=n.labelShow&&!n.labelShow)&&n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").xLabelSuffix(n.labelSuffix?n.labelSuffix:"").xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90),this.isPolar(!!n.labelDirection)}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"xCountOfLabel",value:function(t){return arguments.length?(this._xCountOfLabel=t,this):this._xCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"xLabelSuffix",value:function(t){return arguments.length?(this._xLabelSuffix=t,this):this._xLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}}]),i}(vt),Nt=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","radial-line-chart"),e._isRadialLine=!0,e._showMark=!0,e._innerRadiusRatio=.2,e._lineRatio=0,e._minLineWidth=0,e._markRadius=3.5,e._endPointBorderWidth="0",e._endPointBorderColor="#FFFFFF",e._endPointFillColor=null,e._startAngle=0,e._endAngle=1.5*Math.PI,e._rotateDirection="clockwise",e._labelShow=!0,e._textLabelShow=!0,e._positionOptions=["内部居右","外部","内部居左"],e._positionChoice="内部居右",e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveStyle="同步顺时针",e._endPause=0,e}return w(i,t),S(i,[{key:"_onTransitionEnd",value:function(){var t=this,i=t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,n=t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize,a=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color);return function(o,r){var l=d3.select(this.parentNode.parentNode),s=t.radialBar.arcFunc,u=(s.innerRadius()(o,r)+s.outerRadius()(o,r))/2,c=s.startAngle()(o,r),h=s.endAngle()(o,r),d="counterclockwise"==t._rotateDirection,_=void 0;_=d?Math.abs(c%(2*Math.PI))>Math.PI/2&&Math.abs(c%(2*Math.PI))<3*Math.PI/2:Math.abs(h%(2*Math.PI))>Math.PI/2&&Math.abs(h%(2*Math.PI))<3*Math.PI/2;var f="arc-path-"+o.key+"-"+t.id,p=e(u,d?c-Math.PI:h,d?c:h+Math.PI,!_);D(l,t.defs.select("#"+f).empty()?t.defs.append("path").attr("d",p).attr("id",f):t.defs.select("#"+f).attr("d",p),E(o.value,t._numberStyle,t._decimalPlaces)+t._suffix,n,i,d?_?"5%":"95%":_?"95%":"5%").attr("class","radial-bar-texts").style("text-anchor",d?_?"start":"end":_?"end":"start").style("pointer-events","none").style("fill",a).style("font-size",n).style("font-family",i).style("display",t._labelShow?"block":"none")}}},{key:"setSelfOption",value:function(t){t.axis;var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._lineRatio=0,this._minLineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._minLineWidth,this._markRadius=0==e.endPointRadius||e.endPointRadius?d(e.endPointRadius):this._markRadius,this._endPointBorderWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?d(e.endPointBorderWidth):this._endPointBorderWidth,this._endPointBorderColor=e.endPointBorderColor?q(e.endPointBorderColor):"",this._endPointFillColor=e.endPointFillColor?q(e.endPointFillColor):"",this._startAngle=0==e.startAngleChoice||e.startAngleChoice?d(e.startAngleChoice)*(Math.PI/180):this._startAngle,this._totalAngle=0==e.totalAngle||e.totalAngle?d(e.totalAngle)*(Math.PI/180):this._totalAngle,this._rotateDirection=e.rotateDirection?e.rotateDirection:this._rotateDirection)}}]),i}(Rt),Tt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.xAxis=null,i.yAxis=null,i.yAxisDoubleY=null,i.xScale=null,i.yScale=null,i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._xRange=null,i._yRange=null,i._xDomain=null,i._yDomain=null,i._clipShow=null,i._xTitle="",i._yTitle="",i._axisLineStroke=null,i._xTickShow=!0,i._yTickShow=!0,i}return w(e,t),S(e,[{key:"update",value:function(){return this._interrupt=!1,this._DynamicInterrupt=!0,this._titlePadding=this._unitWord&&this._unitShow?this._titlePadding:15,this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this._axisPositonChoiceX&&"上面"==this._axisPositonChoiceX?this._legendShow&&0!=this.legend.height()?this._gapPadding=this._xTitle&&"top"==this._legendY?8:this._gapPadding:this._gapPadding=0:this._legendShow&&0!=this.legend.height()?this._gapPadding=this._xTitle&&"bottom"==this._legendY?8:this._gapPadding:this._gapPadding=0,this.updateTitle(),this.updateUnit(),this.updateSource(),this.updateAxis(),this.updateCore(),this.updateScale(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(2*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"updateScale",value:function(){}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=void 0;if(e.length){var o=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),r=1.15*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}));a=o<0?r<=0?[o,0]:[o,r]:[0,r]}else a=[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"xRange",value:function(t){return arguments.length?(this._xRange=t,this):this._xRange}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"clipShow",value:function(t){return arguments.length?(this._clipShow=t,this):this._clipShow}},{key:"clipShowX",value:function(t){return arguments.length?(this._clipShowX=t,this):this._clipShowX}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"yLeftTickShow",value:function(t){return arguments.length?(this._yLeftTickShow=t,this):this._yLeftTickShow}},{key:"yRightTickShow",value:function(t){return arguments.length?(this._yRightTickShow=t,this):this._yRightTickShow}},{key:"yLeftName",value:function(t){return arguments.length?(this._yLeftName=t,this):this._yLeftName}},{key:"yLeftTitle",value:function(t){return arguments.length?(this._yLeftTitle=t,this):this._yLeftTitle}},{key:"yRightName",value:function(t){return arguments.length?(this._yRightName=t,this):this._yRightName}},{key:"yRightTitle",value:function(t){return arguments.length?(this._yRightTitle=t,this):this._yRightTitle}},{key:"yRightRange",value:function(t){return arguments.length?(this._yRightRange=t,this):this._yRightRange}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"times",value:function(t){return arguments.length?(this._times=t,this):this._times}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"axisPositonChoiceX",value:function(t){return arguments.length?(this._axisPositonChoiceX=t,this):this._axisPositonChoiceX}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"xLabelAngle",value:function(t){return arguments.length?(this._xLabelAngle=parseFloat(t),this):this._xLabelAngle}},{key:"xCountOfLabel",value:function(t){return arguments.length?(this._xCountOfLabel=parseFloat(t),this):this._xCountOfLabel}},{key:"xLabelSuffix",value:function(t){return arguments.length?(this._xLabelSuffix=t,this):this._xLabelSuffix}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=parseFloat(t),this):this._yLabelAngle}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=parseFloat(t),this):this._yCountOfLabel}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.heightOfMainGroup-t;return e>0?e:0}}]),e}(vt),Bt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","axis"),i.group=i.elem.append("g"),i.axisFunc=null,i._orient="bottom",i._type="category",i._scaleFunc=null,i._tickSize=5,i._tickPadding=3,i._tickCount=null,i._tickFormat=null,i._minTickDistance=null,i._axisLineShow=!0,i._tickShow=!0,i._title="",i._titleShow=!0,i._titlePadding=5,i._fontSize=12,i._fontColor="#000",i._fontFamily="sans-serif",i._lineStroke="#000",i._transition=!0,i._duration=500,i._labelDirection="自动",i._labelAngle=-45,i._countOfLabel=8,i._labelSuffix="",i._numberStyle="1000.00",i._decimalPlaces=null,i._tickValues=[],i._tickValueTexts=[],i}return w(e,t),S(e,[{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"scaleFunc",value:function(t){return arguments.length?(this._scaleFunc=t,this):this._scaleFunc}},{key:"tickSize",value:function(t){return arguments.length?(this._tickSize=t,this):this._tickSize}},{key:"tickPadding",value:function(t){return arguments.length?(this._tickPadding=t,this):this._tickPadding}},{key:"tickFormat",value:function(t){return arguments.length?(this._tickFormat=t,this):this._tickFormat}},{key:"tickCount",value:function(t){return arguments.length?(this._tickCount=t,this):this._tickValues.length||this._tickCount}},{key:"minTickDistance",value:function(t){return arguments.length?(this._minTickDistance=t,this):this._minTickDistance}},{key:"tickLineShow",value:function(t){return arguments.length?(this._tickLineShow=t,this):this._tickLineShow}},{key:"axisLineShow",value:function(t){return arguments.length?(this._axisLineShow=t,this):this._axisLineShow}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}},{key:"titlePadding",value:function(t){return arguments.length?(this._titlePadding=t,this):this._titlePadding}},{key:"titleShow",value:function(t){return arguments.length?(this._titleShow=t,this):this._titleShow}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"xRange",value:function(t){return arguments.length?(this._xRange=t,this):this._xRange}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"lineStroke",value:function(t){return arguments.length?(this._lineStroke=t,this):this._lineStroke}},{key:"tickLabelShow",value:function(t){return arguments.length?(this._tickLabelShow=t,this):this._tickLabelShow}},{key:"tickShow",value:function(t){return arguments.length?(this._tickShow=t,this):this._tickShow}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"labelDirection",value:function(t){return arguments.length?(this._labelDirection=t,this):this._labelDirection}},{key:"labelAngle",value:function(t){return arguments.length?(this._labelAngle=t,this):this._labelAngle}},{key:"countOfLabel",value:function(t){return arguments.length?(this._countOfLabel=t,this):this._countOfLabel}},{key:"labelSuffix",value:function(t){return arguments.length?(this._labelSuffix=t,this):this._labelSuffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"titleHeight",get:function(){return this._title&&this._titleShow?1.25*this._fontSize+this._titlePadding:0}},{key:"tickLocations",get:function(){var t=this;return this._tickValues.map((function(e){return t._scaleFunc(e)}))}}]),e}(L),Gt="axis-group",Xt="x-title",jt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-x-line"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i._chartType,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=void 0;(s=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(.5).tickPadding(t._tickPadding).tickFormat(t._tickFormat);var u=n.select(".axis-group").empty()?n.append("g").attr("class",Gt):n.select(".axis-group"),c=t._labelAngle;"自动"==t._labelDirection&&(c=r),u.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).call(s).on("start",(function(i,n){u.selectAll(".tick text").remove(),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),"竖排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i,n){var a=B(l[n],t._fontSize,t._fontFamily)-t._fontSize,o=I(t._fontSize,c,0,t._labelDirection,e),r=Math.sin(Math.abs(o.angle)*Math.PI/180)*a,s=Math.cos(Math.abs(o.angle)*Math.PI/180)*a;return"top"==e?"translate("+(o.x+(o.angle<0?-r+(-90==o.angle?a/2:0):r-(90==o.angle?a/2:0)))+","+(o.y-s)+")":"translate("+(o.x+(o.angle<0?-(-90==o.angle?a/2:0):90==o.angle?a/2:0))+","+o.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).each((function(i,n){var o=d3.select(this),r=o.text().split("").reverse();"rev"==I(t._fontSize,c,0,t._labelDirection,e).flag&&(r=o.text().split(""));for(var l,s=[],u=0,h=0,d=+o.attr("x"),_=+o.attr("y"),f=o.text(null).append("tspan").attr("x",d).attr("y",_);l=r.pop();)s.push(l),f.text(s.join("")),f.node().getComputedTextLength()>0&&(0==h||++u,s.pop(),f.text(s.join("")),s=[l],f=o.append("tspan").attr("x",d).attr("y",u*parseFloat(.9*a*1.2)+_).text(l)),h++})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"横排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,t._labelDirection,e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"自动"==t._labelDirection&&u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,"横排",e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).style("text-anchor",(function(i){return I(t._fontSize,c,0,"横排",e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,"横排",e).angle+")"}))}));var h=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)})),d=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove(),d3.selectAll(d).remove();var _=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var f=n.select(".x-title").empty()?n.append("g").attr("class",Xt):n.select(".x-title"),p=f.select("text").empty()?f.append("text"):f.select("text");l.length,d3.max(l,(function(e){return R(e,a,t._fontFamily)}));"top"===e?(f.call(o,_/2+Math.abs(i.range()[0]),-(this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0))),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",-6-.2*a).text(t._title)):(f.call(o,_/2+Math.abs(i.range()[0]),this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",a+6).text(t._title))}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0,o=0,r=0,l=!1,s=t._scaleFunc.range()[0],u=t._scaleFunc.range()[1];function c(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a,t._tickTextWidth=o,t._rotateFlag=l,t._axisStart=s,t._axisEnd=u}var h=t._scaleFunc,d=t._type,_=t._fontSize,f=(t._minTickDistance,t._allowedMaxTextHeight);if("自动"==t._labelDirection){var p=Math.abs(h.range()[0]-h.range()[1]),y=void 0,x=void 0;if(e="category"===d?h.domain():h.ticks(t._tickCount),"number"===d&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0])),i=e,"number"===d||"histogram"==t._chartType){for(var g=[],v=0;v<e.length;v++)"pyramid"==t._chartType?g.push(E(Math.abs(e[v]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):g.push(E(e[v],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=g}if(function(){var l=!1;if(y=p/e.length,"number"===d||"histogram"==t._chartType){for(var s=[],u=0;u<e.length;u++)"pyramid"==t._chartType?s.push(E(Math.abs(e[u]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):s.push(E(e[u],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=s}return(x=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0)<.8*y&&(n=0,a=0==x?0:1.125*_,o=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,r=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,t._tickShow||(o=0),c(),l=!0),l}())return t;n="top"===t._orient?45:-45,n=I(t._fontSize,n,0,"横排",t._orient).angle;var m=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0,b=m?_:0,S=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),k=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),w=m*k+b*S,C=b*k+m*S;if(x=w,C<f)a=C,i=i,o=w,r=w,t._tickShow||(o=0),l=!1;else{a=f,i=i.map((function(e){return X(e,a/S,_,t._fontFamily)}));var O=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,F=O*k+b*S;o=F,r=F,a=b*k+O*S,t._tickShow||(o=0),l=!0}var L=(p-r)/e.length;if("category"===d&&2*_>L){var P=Math.ceil(2*_/L);e=e.filter((function(t,e){return e%P==0})),i=i.filter((function(t,e){return e%P==0}))}var A=[],W=0;return"category"===d&&(W=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,n){var a=R(i[n],t._fontSize,t._fontFamily)||0;a=a*k+b*S,A.push(h(e)-a+W)})),s=t._tickShow&&e.length>0?d3.min(A):s,c(),t}if("横排"==t._labelDirection){var z=Math.abs(h.range()[0]-h.range()[1]);e="category"===d?h.domain():h.ticks(t._tickCount),"number"===d&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var M=[];if("number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var D=h.domain()[0],N=(Math.abs(parseFloat(D))>1?Math.round(parseFloat(D)):D)||0,T=h.domain()[1]||1;if(0!=t._countOfLabel){var G=T-N,j=t._countOfLabel,Y=Math.ceil(Math.abs(G/t._countOfLabel)),H=Math.ceil(z/_*2),V=d3.tickStep(N,T,H);t._countOfLabel<V&&(Y=Math.ceil(Math.abs(G/V)),j=V),T+=Y;for(var $=0;$<Y+1;$++)M.push(N+$*j)}else M.push(N);"number"===d&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||M.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||M.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(M[M.length-1]>t._xRange[1]&&M.pop(),M.push(t._xRange[1]))),M=Array.from(new Set(M))),0!=t._countOfLabel&&h.domain([d3.min(M),d3.max(M)]);var q=[];M.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;q.push(i)}})),q=q.filter((function(t){return t<=8})),M=M.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(q)&&(t=parseFloat(t).toFixed(d3.max(q)))}return t}))}if(i=e,"number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=M),"number"==d||"histogram"==t._chartType){for(var U=[],Z=0;Z<e.length;Z++)"pyramid"==t._chartType?U.push(E(Math.abs(e[Z]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):U.push(E(e[Z],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=U}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var Q=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0,K=Q?_:0,J=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,tt=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),et=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),it=Q*et+K*tt,nt=K*et+Q*tt;if(nt<f)a=nt,i=i,o=it,r=it,t._tickShow||(o=0),l=!0;else{a=f,i=i.map((function(e){return X(e,a/tt,_,t._fontFamily)}));var at=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,ot=at*et+K*tt;o=ot,r=ot,a=K*et+at*tt,t._tickShow||(o=0),l=!0}J%180!=0&&90!=Math.abs(n)||(o/=2,r/=2);var rt=(z-r)/e.length;if(("category"===d||null==t._countOfLabel)&&r*(J%180==0||90==Math.abs(n)?2:1)>rt){var lt=Math.ceil(r*(J%180==0||90==Math.abs(n)?2:1)*1.2/rt);e=e.filter((function(t,e){return e%lt==0})),i=i.filter((function(t,e){return e%lt==0}))}if("top"==t._orient){var st=1.05;(n>90||n<0&&n>-90)&&(st=-1.05);var ut=[],ct=[],ht=0;if("category"===d&&(ht=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*et+K*tt,J%180!=0&&90!=Math.abs(n)||(o/=2),ut.push(h(e)-o*st+ht),ct.push(h(e)-o*st+ht)})),s=t._tickShow&&e.length>0?d3.min(ut):s,u=t._tickShow&&e.length>0?d3.max(ct):u,n%180==0||90==Math.abs(n)){var dt=[],_t=[];e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*et+K*tt,J%180!=0&&90!=Math.abs(n)||(o/=2),dt.push(h(e)-o+ht),_t.push(h(e)+o+ht)})),s=t._tickShow&&e.length>0?d3.min(dt):s,u=t._tickShow&&e.length>0?d3.max(_t):u}}else{var ft=-1.05;(n>90||n<0&&n>-90)&&(ft=1.05);var pt=[],yt=[],xt=0;if("category"===d&&(xt=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*et+K*tt,J%180!=0&&90!=Math.abs(n)||(o/=2),pt.push(h(e)-o*ft+xt),yt.push(h(e)-o*ft+xt)})),s=t._tickShow&&e.length>0?d3.min(pt):s,u=t._tickShow&&e.length>0?d3.max(yt):u,n%180==0||90==Math.abs(n)){var gt=[],vt=[];e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*et+K*tt,J%180!=0&&90!=Math.abs(n)||(o/=2),gt.push(h(e)-o+xt),vt.push(h(e)+o+xt)})),s=t._tickShow&&e.length>0?d3.min(gt):s,u=t._tickShow&&e.length>0?d3.max(vt):u}}return c(),t}if("竖排"==t._labelDirection){var mt,bt=Math.abs(h.range()[0]-h.range()[1]);e="category"===d?h.domain():h.ticks(t._tickCount),"number"===d&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var St=[];if("number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var kt=h.domain()[0],wt=(Math.abs(parseFloat(kt))>1?Math.round(parseFloat(kt)):kt)||0,Ct=h.domain()[1]||1;if(0!=t._countOfLabel){var Ot=Ct-wt,Ft=t._countOfLabel,Lt=Math.ceil(Math.abs(Ot/t._countOfLabel)),Pt=Math.ceil(bt/_*2),At=d3.tickStep(wt,Ct,Pt);t._countOfLabel<At&&(Lt=Math.ceil(Math.abs(Ot/At)),Ft=At),Ct+=Lt;for(var Wt=0;Wt<Lt+1;Wt++)St.push(wt+Wt*Ft)}else St.push(wt);"number"===d&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||St.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||St.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(St[St.length-1]>t._xRange[1]&&St.pop(),St.push(t._xRange[1]))),St=Array.from(new Set(St))),0!=t._countOfLabel&&h.domain([d3.min(St),d3.max(St)]);var zt=[];St.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;zt.push(i)}})),zt=zt.filter((function(t){return t<=8})),St=St.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(zt)&&(t=parseFloat(t).toFixed(d3.max(zt)))}return t}))}if(i=e,"number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=St),"number"==d||"histogram"==t._chartType){for(var Mt=[],Dt=0;Dt<e.length;Dt++)"pyramid"==t._chartType?Mt.push(E(Math.abs(e[Dt]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):Mt.push(E(e[Dt],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=Mt}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var Rt=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,Nt=Rt?_:0,Tt=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,Bt=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),Gt=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),Xt=Nt*Gt+Rt*Bt,jt=Rt*Gt+Nt*Bt;if(mt=Xt,jt<f)a=jt,i=i,o=Xt,r=Xt,t._tickShow||(o=0),l=!0;else{a=f,i=i.map((function(e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}(e,a/Gt,_,t._fontFamily)}));var It=d3.max(i,(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,Yt=Nt*Gt+It*Bt;o=Yt,r=Yt,a=It*Gt+Nt*Bt,t._tickShow||(o=0),l=!0}0==Tt&&(o/=2,r/=2),90==Math.abs(Tt)&&(a=0==mt?0:_,o/=2,r/=2);var Ht=(bt-r)/e.length;if(("category"===d||null==t._countOfLabel)&&r*(0==Math.abs(Tt)||90==Math.abs(Tt)?2:1)>Ht){var Et=Math.ceil(r*(0==Math.abs(Tt)||90==Math.abs(Tt)?2:1)*1.2/Ht);e=e.filter((function(t,e){return e%Et==0})),i=i.filter((function(t,e){return e%Et==0}))}if("top"==t._orient){var Vt=1.05;n>0&&n<90&&(Vt=-1.05);var $t=[],qt=[],Ut=0;if("category"===d&&(Ut=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Nt*Gt+o*Bt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),$t.push(h(e)-o*Vt+Ut),qt.push(h(e)-o*Vt+Ut)})),s=t._tickShow&&e.length>0?d3.min($t):s,u=t._tickShow&&e.length>0?d3.max(qt):u,0==Math.abs(n)||90==Math.abs(n)){var Zt=[],Qt=[];e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Nt*Gt+o*Bt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Zt.push(h(e)-o+Ut),Qt.push(h(e)+o+Ut)})),s=t._tickShow&&e.length>0?d3.min(Zt):s,u=t._tickShow&&e.length>0?d3.max(Qt):u}}else{var Kt=-1.05;n>0&&n<90&&(Kt=1.05);var Jt=[],te=[],ee=0;if("category"===d&&(ee=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Nt*Gt+o*Bt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Jt.push(h(e)-o*Kt+ee),te.push(h(e)-o*Kt+ee)})),s=t._tickShow&&e.length>0?d3.min(Jt):s,u=t._tickShow&&e.length>0?d3.max(te):u,0==Math.abs(n)||90==Math.abs(n)){var ie=[],ne=[];e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Nt*Gt+o*Bt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),ie.push(h(e)-o+ee),ne.push(h(e)+o+ee)})),s=t._tickShow&&e.length>0?d3.min(ie):s,u=t._tickShow&&e.length>0?d3.max(ne):u}}return c(),t}}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"chartType",value:function(t){return arguments.length?(this._chartType=t,this):this._chartType}},{key:"height",get:function(){var t=this,e=this._scaleFunc,i=(Math.abs(e.range()[0]-e.range()[1]),this._tickValueTexts.length,d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),0);return this.isShow&&(i=this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.125*this._fontSize:0)),i}}]),e}(Bt),It="axis-group",Yt="y-title",Ht=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-line"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i._countOfLabel=null,i._labelSuffix="",i._picPadding=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=e._orient,n=e._scaleFunc,a=e.group,r=e._fontSize,l=e._tickValueTexts,s=void 0;s=e.axisFunc="right"===i?d3.axisRight(n):d3.axisLeft(n);var u=null;"number"===e._type&&e._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(u=d3.format("d")),s.tickValues(e._tickValues).tickSizeInner(e._tickSize).tickSizeOuter(-.5).tickPadding(e._tickPadding).tickFormat(u);var c=a.select(".axis-group").empty()?a.append("g").attr("class",It):a.select(".axis-group");c.transition().duration(e._transition?e._duration:0).ease(d3.easeLinear).call(s).on("start",(function(){c.selectAll(".tick text").remove(),c.selectAll(".tick").filter((function(t,i){return-1!=e._tickValues.indexOf(t)})).append("text").style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).style("display",e._tickShow?"block":"none").attr("dx",(function(t,e){return-8})).attr("dy",.4*r).text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})),c.selectAll(".tick line").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none"),c.select("path").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none")}));var h=e.group.selectAll(".axis-y-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)||"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove();var d=Math.abs(n.range()[0]-n.range()[1]);if(e._titleShow&&e._title){var _=a.select(".y-title").empty()?a.append("g").attr("class",Yt):a.select(".y-title"),f=_.select("text").empty()?_.append("text"):_.select("text"),p=(R(e._title,r,e._fontFamily),d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})));_.call(o,-(this._tickShow?(p?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0!=parseFloat(e._yAxisLineWidth)&&e._yAxisLineWidth&&e._axisLineShow?5:0),d/2),f.attr("y",-9-e._picPadding).style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(e._title)}else a.select(".y-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);Math.abs(a.range()[0]-a.range()[1]);e="category"===o?a.domain():a.ticks(t._tickCount),"number"===o&&0!=t._yRange.length&&null!=t._yRange[0]&&t._yRange[0].constructor!==Object&&(t._yRange[0]==e[0]&&e.shift(),e.unshift(-1==String(t._yRange[0]).indexOf(".")?t._yRange[0]:t._yRange[0].toFixed(0)),e=Array.from(new Set(e)));new Array;var s=[];if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[0],c=(Math.abs(parseFloat(u))>1?Math.round(parseFloat(u)):u)||0,h=a.domain()[1]||1;if(0!=t._countOfLabel){var d=h-c,_=t._countOfLabel,f=Math.ceil(Math.abs(d/t._countOfLabel)),p=8*Math.ceil(t._tickCount),y=d3.tickStep(c,h,p);t._countOfLabel<y&&(f=Math.ceil(Math.abs(d/y)),_=y),h+=f;for(var x=0;x<f+1;x++)s.push(c+x*_)}else s.push(c);"number"===o&&0!=t._yRange.length&&(1==t._yRange.length?isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]):(isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]),isNaN(t._yRange[1])||null==t._yRange[1]||(s[s.length-1]>t._yRange[1]&&s.pop(),s.push(t._yRange[1]))),s=Array.from(new Set(s))),0!=t._countOfLabel&&a.domain([d3.min(s),d3.max(s)]);var g=[];s.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;g.push(i)}})),g=g.filter((function(t){return t<=8})),s=s.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(g)&&(t=parseFloat(t).toFixed(d3.max(g)))}return t}))}if(i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o){for(var v=[],m=0;m<e.length;m++)v.push(E(e[m],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=v}var b=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,r,t._fontFamily)}))||0;return b<=l?(i=i,n=b):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"picPadding",value:function(t){return arguments.length?(this._picPadding=parseFloat(t),this):this._picPadding}},{key:"width",get:function(){var t=this,e=d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),i=0;return this.isShow&&(i=this._tickShow?(e?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._titleShow&&this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0),i}}]),e}(Bt),Et=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("line").attr("class","guide-line"),i._x1=0,i._y1=0,i._x2=0,i._y2=100,i._stroke="#000",i._strokeDasharray="3 3",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;return t.elem.attr("x1",t._x1).attr("y1",t._y1).attr("x2",t._x2).attr("y2",t._y2).style("stroke",t._stroke).style("stroke-dasharray",t._strokeDasharray).style("pointer-events","none"),t}},{key:"x1",value:function(t){return arguments.length?(this._x1=t,this):this._x1}},{key:"y1",value:function(t){return arguments.length?(this._y1=t,this):this._y1}},{key:"x2",value:function(t){return arguments.length?(this._x2=t,this):this._x2}},{key:"y2",value:function(t){return arguments.length?(this._y2=t,this):this._y2}},{key:"x",value:function(t){return arguments.length?(this._x1=this._x2=t,this):[this._x1,this._x2]}},{key:"y",value:function(t){return arguments.length?(this._y1=this._y2=t,this):[this._y1,this._y2]}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}}]),e}(L),Vt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","scatter-plot"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=2,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data,n=t._xScale,a=t._yScale;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var o=e.selectAll("g").data(i,(function(t){return t.name}));o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").attr("class","scatter-plot").attr("cx",(function(t){return n(t.name)||0})).attr("cy",(function(t){return a(t.value)||0})).merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t){return n(t.name)||0})).attr("cy",(function(t){return a(t.value)||0}))}));for(var r=e.selectAll(".scatter-plot").nodes(),l=0;l<r.length;l++)""==r[l].__data__.value||isNaN(r[l].__data__.value)?d3.select(r[l]).style("opacity","0"):d3.select(r[l]).style("opacity","1");return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),e}(at),$t=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","overlap-area-plot"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._stroke=null,i._lineWidth=2,i._strokeDasharry="",i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)){var i=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0(t._yScale(0)).y1((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));n.curve(t._curve);var a=t.group;a.selectAll(".overlap-area").remove(),a.selectAll(".overlap").remove(),a.selectAll(".overlap-line").remove();var o=a.append("g").attr("class","overlap-area").selectAll("g").data(e,(function(t){return t.name}));o.exit().remove(),o.enter().append("g").merge(o).each((function(e,a){d3.select(this).append("g").append("path").attr("class","overlap").style("fill",(function(i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})).attr("d",i(e.data)),d3.select(this).append("g").append("path").attr("class","overlap-line").style("fill","none").style("stroke",/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color).style("stroke-width",t._lineWidth).style("stroke-opacity",1).style("stroke-dasharray",t._strokeDasharry).attr("d",n(e.data));var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.value)||0})).attr("r",t._radius)}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){var r=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0(t._yScale(0)).y1((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));r.curve(t._curve);var l=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));l.curve(t._curve);var s=t.group;s.selectAll(".overlap-area").remove(),s.selectAll(".overlap").remove(),s.selectAll(".overlap-line").remove();var u=s.append("g").attr("class","overlap-area").selectAll("g").data(e,(function(t){return t.name}));u.exit().remove();for(var h=[],d=0;d<e.length;d++){h[d]={},h[d].name=e[d].name,h[d].color=e[d].color,h[d].data=[];for(var _=0;_<e[d].data.length;_++)h[d].data[_]={},h[d].data[_].value=e[d].data[0].value,h[d].data[_].name=e[d].data[_].name}u.enter().append("g").merge(u).each((function(e,i){var n=d3.select(this).append("g").append("path").attr("class","overlap").style("fill",(function(n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})),a=d3.select(this).append("g").append("path").attr("class","overlap-line").style("fill","none").style("stroke",/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color).style("stroke-width",t._lineWidth).style("stroke-opacity",1).style("stroke-dasharray",t._strokeDasharry),o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var s=o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?(n.attr("d",r(e.data)),a.attr("d",l(e.data)),s.attr("cy",(function(e){return t._yScale(e.value)||0}))):(n.transition().duration(0).delay(t._transition?t._startDelay:0).attr("d",r(h[i].data)).transition().duration(t._transition?.9*t._duration:0).attr("d",r(e.data)),a.transition().duration(0).delay(t._transition?t._startDelay:0).attr("d",l(h[i].data)).transition().duration(t._transition?.9*t._duration:0).attr("d",l(e.data)),s.attr("cy",(function(e,n){return t._yScale(h[i].data[n].value)||0})).transition().duration(t._transition?.9*t._duration:0).attr("cy",(function(e){return t._yScale(e.value)||0})))}))}else if(2==t._moveOptions.indexOf(t._moveStyle)||3==t._moveOptions.indexOf(t._moveStyle)){var f=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0(t._yScale(0)).y1((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))})),p=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0(t._yScale(0)).y1(t._yScale(0)).defined((function(t){return!isNaN(parseFloat(t.value))}));f.curve(t._curve),p.curve(t._curve);var g=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))})),v=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y(t._yScale(0)).defined((function(t){return!isNaN(parseFloat(t.value))}));g.curve(t._curve),v.curve(t._curve);var m=t.group;m.selectAll(".overlap-area").remove(),m.selectAll(".overlap").remove(),m.selectAll(".overlap-line").remove();var b=m.append("g").attr("class","overlap-area").selectAll("g").data(e,(function(t){return t.name}));b.exit().remove(),2==t._moveOptions.indexOf(t._moveStyle)?b.enter().append("g").merge(b).each((function(i,n){var a=d3.select(this).append("g").append("path").attr("class","overlap").style("fill",(function(e){return i.color&&/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color&&/#/.test(i.color)?i.color:"rgb("+U(i.color,0)+","+U(i.color,1)+","+U(i.color,2)+")"})).style("fill-opacity",(function(e){if(i.color&&/#/.test(i.color))return t._fillOpacity;var n=U(i.color,3)||1;return t._fillOpacity*n})),o=d3.select(this).append("g").append("path").attr("class","overlap-line").style("fill","none").style("stroke",/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color).style("stroke-width",t._lineWidth).style("stroke-opacity",1).style("stroke-dasharray",t._strokeDasharry),r=d3.select(this).selectAll("circle").data(i.data);r.exit().remove();var l=r.enter().append("circle").attr("class","clip-scatter-plot").merge(r).style("fill",t._radiusFill||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color)).style("stroke",t._radiusStroke||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(0)})).attr("r",t._radius);t._interrupt?(a.attr("d",f(i.data)),o.attr("d",g(i.data)),l.attr("cy",(function(e){return t._yScale(e.value)||0}))):(a.attr("d",p(i.data)).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0).attr("d",f(i.data)),o.attr("d",v(i.data)).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0).attr("d",g(i.data)),l.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0).attr("cy",(function(e){return t._yScale(e.value)||0})))})):3==t._moveOptions.indexOf(t._moveStyle)&&b.enter().append("g").merge(b).each((function(e,i){var n=d3.select(this).append("g").append("path").attr("class","overlap").style("fill",(function(n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})),a=d3.select(this).append("g").append("path").attr("class","overlap-line").style("fill","none").style("stroke",/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color).style("stroke-width",t._lineWidth).style("stroke-opacity",1).style("stroke-dasharray",t._strokeDasharry),o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(0)})).attr("r",t._radius);t._interrupt?(n.attr("d",f(e.data)),a.attr("d",g(e.data)),r.attr("cy",(function(e){return t._yScale(e.value)||0}))):(n.attr("d",p(e.data)).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",f(e.data)),a.attr("d",v(e.data)).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",g(e.data)),r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("cy",(function(e){return t._yScale(e.value)||0})))}))}for(var S=t.group.selectAll(".clip-scatter-plot").nodes(),k=0;k<S.length;k++)""==S[k].__data__.value||isNaN(S[k].__data__.value)?d3.select(S[k]).style("visibility","hidden"):d3.select(S[k]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"radiusFill",value:function(t){return arguments.length?(this._radiusFill=t,this):this._radiusFill}},{key:"radiusStroke",value:function(t){return arguments.length?(this._radiusStroke=t,this):this._radiusStroke}},{key:"radiusWidth",value:function(t){return arguments.length?(this._radiusWidth=t,this):this._radiusWidth}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),qt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","area-stack-texts"),i._xScale=null,i._yScale=null,i._suffix="",i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll("*").remove();var a=t._xScale,o=t._yScale,r=n.selectAll("g").data(e,(function(t){return t.name}));r.exit().remove(),r.enter().append("g").attr("class","area-stack-text-group").merge(r).each((function(e){var i=d3.select(this).selectAll("text").data(e.data);i.exit().remove();var n=i.enter().append("text").attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return t.total?o(t.total)||0:o(t.value)||0})).merge(i).text((function(e){return isNaN(parseFloat(e.value))?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return t.total?o(t.total)||0:o(t.value)||0})).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?n.style("opacity",1):n.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)})),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".area-stack-text-group text").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".area-stack-text-group text").attr("dy",.4*-t._fontSize):1==t._positionOptions.indexOf(t._positionChoice)&&n.selectAll(".area-stack-text-group text").attr("dy",1.3*t._fontSize);for(var l=n.selectAll(".area-stack-text-group text"),s=[],u=[],c=0;c<l._groups[0].length;c++){u.push(c);for(var h=c+1;h<l._groups[0].length;h++){p(i(d3.select(l._groups[0][c])),i(d3.select(l._groups[0][h])))&&(s.push(c),d3.select(l._groups[0][c]).style("visibility","hidden"))}}for(var d=new Set(s),_=Array.from(d),f=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(_,u),y=0;y<_.length;y++){for(var x=[],g=0;g<f.length;g++){var v=i(d3.select(l._groups[0][_[y]])),m=i(d3.select(l._groups[0][f[g]]));if(x.push(p(v,m)),p(v,m)){if(_[y]==f[g])continue;d3.select(l._groups[0][_[y]]).style("visibility","hidden")}}0==x.filter((function(t){return 1==t})).length&&f.push(_[y])}for(var b=0;b<f.length;b++)d3.select(l._groups[0][f[b]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ut=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("clipPath").attr("id",i.id),i.rect=i.elem.append("rect"),i._width=100,i._height=100,i._transition=!1,i._duration=0,i._paddingVertical=[5,0],i._paddingHorizontal=[20,20],i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.rect,i=t._width,n=t._paddingVertical,a=t._paddingHorizontal;return e.attr("x",-i-a[0]).attr("y",-n[0]).attr("width",i+a[0]+a[1]).attr("height",t._height+n[0]+n[1]),e.transition().duration(t._transition?t._duration:0).attr("x",-a[0]),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"paddingVertical",value:function(t){return arguments.length?(this._paddingVertical=t,this):this._paddingVertical}},{key:"paddingHorizontal",value:function(t){return arguments.length?(this._paddingHorizontal=t,this):this._paddingHorizontal}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(L),Zt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("clipPath").attr("id",i.id),i.elem.selectAll("*").remove(),i.rect=i.elem.append("rect").attr("class","x"+i.id),i._width=100,i._height=100,i._transition=!1,i._duration=0,i._paddingVertical=[0,0],i._paddingHorizontal=[0,0],i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.rect,i=t._width,n=t._paddingVertical,a=t._paddingHorizontal;return e.attr("x",0).attr("y",0).attr("width",i+a[0]+a[1]).attr("height",t._height+n[0]+n[1]),e.transition().duration(t._transition?t._duration:0).attr("x",-a[0]),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"paddingVertical",value:function(t){return arguments.length?(this._paddingVertical=t,this):this._paddingVertical}},{key:"paddingHorizontal",value:function(t){return arguments.length?(this._paddingHorizontal=t,this):this._paddingHorizontal}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(L),Qt="grid-x-line",Kt="grid-y-line",Jt=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","plane-grid"),i.group=i.elem.append("g"),i._width=400,i._height=400,i._planeX=0,i._transHeight=0,i._transition=!1,i._duration=0,i._type="",i._xTickLocations=[],i._yTickLocations=[],i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._width,i=t._height,n=t.group.attr("class",t._type).style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray).style("pointer-events","none");!function(){if(!t._showX)return void n.selectAll(".grid-x-line").remove();var i=n.selectAll(".grid-x-line").data(t._yTickLocations);i.exit().remove(),i.enter().append("line").attr("class",Qt).merge(i).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x1",t._planeX).attr("y1",(function(t){return t+.5})).attr("x2",e).attr("y2",(function(t){return t+.5}))}(),function(){if(!t._showY)return void n.selectAll(".grid-y-line").remove();var e=n.selectAll(".grid-y-line").data(t._xTickLocations);e.exit().remove(),e.enter().append("line").attr("class",Kt).merge(e).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("y1",0).attr("x1",(function(t){return t})).attr("y2",i).attr("x2",(function(t){return t}))}()}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"planeX",value:function(t){return arguments.length?(this._planeX=parseFloat(t),this):this._planeX}},{key:"xTickLocations",value:function(t){return arguments.length?(this._xTickLocations=t,this):this._xTickLocations}},{key:"yTickLocations",value:function(t){return arguments.length?(this._yTickLocations=t,this):this._yTickLocations}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}}]),e}(pt),te=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem=t.append("g").attr("class","bands-overlay").style("opacity",0),i._data=[],i._bandHeight=100,i._bandWidth=50,i._bandX=0,i._type="",i._isScalePoint=!0,i._isDeformedBar=!1,i._isHorizontal=!1,i._onMouseover=function(){},i._onMousemove=function(){},i._onMouseout=function(){},i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.elem;t._type&&i.attr("tip","bottom");var n,a=t._bandWidth,o=t._bandHeight,r=t._isScalePoint,l=t._isDeformedBar,s=t._isHorizontal;n=l?-a/2:r?a/2:0;var u=i.selectAll("rect").data(e);return u.exit().remove(),u.enter().append("rect").attr("class",(function(t,e){return"band-"+e})).merge(u).attr("x",(function(e,i){return s?t._bandX:a*i-n+t._bandX})).attr("y",(function(t,e){return s?o*e-n:0})).attr("width",a>0?a:0).attr("height",o>0?o:0).style("fill","#000").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"bandWidth",value:function(t){return arguments.length?(this._bandWidth=t,this):this._bandWidth}},{key:"bandX",value:function(t){return arguments.length?(this._bandX=t,this):this._bandX}},{key:"bandHeight",value:function(t){return arguments.length?(this._bandHeight=t,this):this._bandHeight}},{key:"isScalePoint",value:function(t){return arguments.length?(this._isScalePoint=t,this):this._isScalePoint}},{key:"isDeformedBar",value:function(t){return arguments.length?(this._isDeformedBar=t,this):this._isDeformedBar}},{key:"isHorizontal",value:function(t){return arguments.length?(this._isHorizontal=t,this):this._isHorizontal}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),e}(L);function ee(t,e){var i=0,n=!1,a=[];if(e.forEach((function(t){"objCol"===t.function?(i=t.index,n=t.isLegend):"vCol"===t.function&&0==t.configurable&&a.push(t.index)})),P(t,[i],2))return[];for(var o=z(t,e),r={},l=[],s=o.length,u=o[0],c=[],d=[],_=1;_<s;_++)d.push(o[_].length);d.sort((function(t,e){return e-t}));for(var f=0;f<s;f++)for(var p=0;p<d[0];p++)c.push(isNaN(parseFloat(o[f][p])));if(0==c.filter((function(t,e){return 0==t})).length)return[];if(n){for(var y=[],x=1;x<s;x++)y.push(o[x].length);y.sort((function(t,e){return e-t}));for(var g=1;g<s;g++){var v=o[g],m=v[i];if(""!=m&&null!=m&&null!=m||(m="$-"+g),m){for(var b={name:m,dataScreen:!0,showLegend:m!="$-"+g,data:[]},S=0;S<y[0];S++){var k=u[S];""!=k&&null!=k&&null!=k||(k="&-"+S),S!==i&&b.data.push({name:k,showAxisText:k!="&-"+S,value:parseFloat(v[S])})}l.push(b)}}}else{for(var w=[],C=1;C<s;C++)w.push(o[C].length);w.sort((function(t,e){return e-t}));for(var O=1;O<w[0];O++)if(O!==i){var F=u[O];""!=u[O]&&null!=u[O]&&null!=u[O]||(F="$-"+O),r[F+"-"+O]={name:F,dataScreen:!0,showLegend:F!="$-"+O,data:[]}}for(var L=1;L<s;L++){var A=o[L],W=A[i];if(""!=W&&null!=W&&null!=W||(W="&-"+L),W)for(var M=0;M<w[0];M++){var D=u[M];""!=u[M]&&null!=u[M]&&null!=u[M]||(D="$-"+M),M!==i&&D&&r[D+"-"+M].data.push({name:W,showAxisText:W!="&-"+L,value:parseFloat(A[M])})}}for(var R in r)l.push(r[R])}return l.forEach((function(t,e){t.key=h(t.name)+"-"+e})),l}var ie=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","overlap-area-chart"),i.grid=new Jt(i.coreGroup),i.areaPlot=new $t(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new Vt(i.coreGroup),i.areaStackText=new qt(i.coreGroup),i.clipArea=new Ut(i.defs),i.AnimationArea=new Zt(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._yLabel="",i._xLabel="",i._sortValue=null,i._curve=d3.curveCardinal,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=0,i._fillOpacity=.7,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向展开","起波澜","纵向依次拉伸","纵向同步拉伸"],i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.areaPlot,a=t.guideScatter,r=t.areaStackText,l=t.tooltip,s=t.overlay,u=t.guideLine,h=t.clipArea,d=(t.AnimationArea,t.xScale),_=t.yScale,f=(t.xAxis._axisStart,t.xAxis._axisEnd),p=0;f>t.widthOfNoMargin-t.yAxis.width&&(p=f-(t.widthOfNoMargin-t.yAxis.width));var g=t.widthOfCore-p,v=t.heightOfCore,m=(Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),t.defs);m.selectAll("filter").remove();var b=m.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_stacklinear").attr("filterUnits","objectBoundingBox");if(b.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),b.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),b.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),b.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),b.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),i.width(g).height(v).planeX(d.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var S=x(t._strokeColor),k=[],w=!0,C=!1,O=void 0;try{for(var F,L=S[Symbol.iterator]();!(w=(F=L.next()).done);w=!0){var P=F.value,A=[],W=P.split(":");A.push(q(W[0])),A.push(W[1]),k.push(A)}}catch(t){C=!0,O=t}finally{try{!w&&L.return&&L.return()}finally{if(C)throw O}}var z=k.concat(),M=z.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(M[1]).x1+"%").attr("y1",y(M[1]).y1+"%").attr("x2",y(M[1]).x2+"%").attr("y2",y(M[1]).y2+"%").selectAll("stop").data(z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var D=x(t._fillColor),R=[],N=!0,T=!1,B=void 0;try{for(var G,X=D[Symbol.iterator]();!(N=(G=X.next()).done);N=!0){var j=G.value,I=[],Y=j.split(":");I.push(q(Y[0])),I.push(Y[1]),R.push(I)}}catch(t){T=!0,B=t}finally{try{!N&&X.return&&X.return()}finally{if(T)throw B}}var H=R.concat(),V=H.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(V[1]).x1+"%").attr("y1",y(V[1]).y1+"%").attr("x2",y(V[1]).x2+"%").attr("y2",y(V[1]).y2+"%").selectAll("stop").data(H).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).xScale(d).yScale(_).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).moveOptions(t._moveOptions).interrupt(t._interrupt).curve(t._curve).fillOpacity(t._fillOpacity).lineWidth(t._lineWidth).radius(t._endPointRadius).radiusFill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).radiusStroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).radiusWidth(t._strokeWidth),a.xScale(d).yScale(_).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),u.y1(0).y2(v).stroke("#c6c6c6").strokeDasharray("0 0"),s.data(d.domain()).isScalePoint(!0).bandX(d.range()[0]).bandWidth(d.step()).bandHeight(v).onMouseover((function(i,n){var o=i,r=[{text:o=="&-"+(n+1)?"":o}],s=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));s.push({key:e.key,name:e.name,color:e.color,data:n}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),l.data(r).update(),u.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+d(o)+",0)"),a.data(s).update(),l.move([d3.event.offsetX,d3.event.offsetY]).show(),u.show(),a.show()})).onMousemove((function(){l.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){l.hide(),u.hide(),a.hide()})),r.data(e).xScale(d).yScale(_).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(h.width(g).height(v).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+h.id)+")"),h.update()):(h.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),h.update()),a.elem.style("pointer-events","none");var $=t.group.selectAll(".overlap-area-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));if(d3.selectAll($).remove(),i.update(),s.update(),n.update(),r.update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))t.coreGroup.select(".overlap-area-plot").attr("clip-path","");else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)+d.range()[0]).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).attr("width",g+2*parseFloat(t._endPointRadius)-d.range()[0]),t.coreGroup.select(".overlap-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)+d.range()[0]).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",g+2*parseFloat(t._endPointRadius)-d.range()[0]),t.coreGroup.select(".overlap-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}else t.coreGroup.select(".overlap-area-plot").attr("clip-path","")}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(2*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.display,r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(o).length&&(this._lineWidth=0==o.lineWidth||o.lineWidth?d(o.lineWidth):this._lineWidth,this._curve=o.lineType?r[o.lineType]:d3.curveCardinal,this._endPointRadius=0==o.endPointRadius||o.endPointRadius?o.endPointRadius:this._endPointRadius,this._strokeWidth=0==o.endPointBorderWidth||o.endPointBorderWidth?o.endPointBorderWidth:this._strokeWidth,this._strokeColor=o.endPointBorderColor?q(o.endPointBorderColor):"",this._fillColor=o.endPointFillColor?q(o.endPointFillColor):"",this._fillOpacity=0==o.fillOpacity||o.fillOpacity?o.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}}]),e}(Tt),ne=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","animation-line-circle-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._lineWidth=2,i._strokeWidth=1,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._xScale,n=t._yScale,a=t.group;if(a.selectAll("*").remove(),t._curve==d3.curveCardinal&&a.attr("stroke-linecap","round"),t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){var o=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));o.curve(t._curve),a.selectAll("path").remove();var r=a.selectAll("path").data(e,(function(t){return t.key}));r.exit().remove();r.enter().append("path").merge(r).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return o(t.data)}));var l=a.append("g").selectAll("g").data(e,(function(t){return t.name}));l.exit().remove(),l.enter().append("g").merge(l).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n(t.value)||0})).attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var s=a.selectAll(".clip-scatter-plot").nodes(),u=0;u<s.length;u++)""==s[u].__data__.value||isNaN(s[u].__data__.value)?d3.select(s[u]).style("opacity","0"):d3.select(s[u]).style("opacity","1")}else if(2==t._moveOptions.indexOf(t._moveStyle)){var h=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));h.curve(t._curve),a.selectAll("path").remove();var d=a.selectAll("path").data(e,(function(t){return t.key}));d.exit().remove();var _=d.enter().append("path").merge(d).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return h(t.data)})).style("opacity",0);t._interrupt?_.style("opacity",1):_.transition().delay((function(i,n){return 0==n?t._transition?t._startDelay+.2*t._duration:0:n*(t._transition?.7*t._duration/e.length:0)+(t._transition?t._startDelay+.2*t._duration:0)})).duration(t._transition?.7*t._duration/e.length:0).style("opacity",1);var f=a.append("g").selectAll("g").data(e,(function(t){return t.name}));f.exit().remove(),f.enter().append("g").merge(f).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n.range()[0]}));t._interrupt?r.attr("cy",(function(t){return n(t.value)||0})):r.transition().duration(t._transition?.2*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attr("cy",(function(t){return n(t.value)||0})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var p=a.selectAll(".clip-scatter-plot").nodes(),g=0;g<p.length;g++)""==p[g].__data__.value||isNaN(p[g].__data__.value)?d3.select(p[g]).style("opacity","0"):d3.select(p[g]).style("opacity","1")}else if(1==t._moveOptions.indexOf(t._moveStyle)){a.selectAll("g").remove();var v=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));v.curve(t._curve),a.selectAll("path").remove();var m=a.selectAll("path").data(e,(function(t){return t.key}));m.exit().remove();var b=m.enter().append("path").merge(m).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return v(t.data)}));t._interrupt?b.attr("stroke-dasharray",t._strokeDasharry):b.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("stroke-dasharray",(function(){var t=this.getTotalLength(),e=d3.interpolateString("0,"+t,t+","+t);return function(t){return e(t)}})),a.selectAll("g").remove();var S=a.append("g").selectAll("g").data(e,(function(t){return t.name}));S.exit().remove(),S.enter().append("g").merge(S).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n(t.value)||0}));t._interrupt?r.attr("r",t._radius):r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("r",(function(){var e=d3.interpolate(0,t._radius);return function(t){return e(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var k=a.selectAll(".clip-scatter-plot").nodes(),w=0;w<k.length;w++)""==k[w].__data__.value||isNaN(k[w].__data__.value)?d3.select(k[w]).style("opacity","0"):d3.select(k[w]).style("opacity","1")}else if(0==t._moveOptions.indexOf(t._moveStyle)){a.selectAll("g").remove();var C=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));C.curve(t._curve),a.selectAll("path").remove();var O=a.selectAll("path").data(e,(function(t){return t.key}));O.exit().remove();var F=O.enter().append("path").merge(O).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry);t._interrupt?F.attr("d",(function(t){return C(t.data)})).attr("stroke-dasharray",t._strokeDasharry):F.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/e.length):0})).duration(0).attr("d",(function(t){return C(t.data)})).ease(d3.easeLinear).transition().duration(t._transition?.9*t._duration/e.length:0).attrTween("stroke-dasharray",(function(){var t=this.getTotalLength(),e=d3.interpolateString("0,"+t,t+","+t);return function(t){return e(t)}})),a.selectAll("g").remove();var L=a.append("g").selectAll("g").data(e,(function(t){return t.name}));L.exit().remove(),L.enter().append("g").merge(L).each((function(a,o){var r=d3.select(this).selectAll("circle").data(a.data);r.exit().remove();var l=r.enter().append("circle").attr("class","clip-scatter-plot").merge(r).style("fill",t._fill||(/\[/.test(a.color)?"url("+c("#"+t.id+"-index-"+o)+")":a.color)).style("stroke",t._stroke||(/\[/.test(a.color)?"url("+c("#"+t.id+"-index-"+o)+")":a.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n(t.value)||0}));t._interrupt?l.attr("r",t._radius):l.transition().duration(t._transition?.9*t._duration/e.length:0).delay((function(i,n){return t._transition?t._startDelay+o*(.9*t._duration/e.length):0})).ease(d3.easeLinear).attrTween("r",(function(){var e=d3.interpolate(0,t._radius);return function(t){return e(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var P=a.selectAll(".clip-scatter-plot").nodes(),A=0;A<P.length;A++)""==P[A].__data__.value||isNaN(P[A].__data__.value)?d3.select(P[A]).style("opacity","0"):d3.select(P[A]).style("opacity","1")}return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),ae=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-texts"),i._xScale=null,i._yScale=null,i._suffix="",i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll("*").remove();var a=t._xScale,o=t._yScale,r=n.selectAll("g").data(e,(function(t){return t.name}));r.exit().remove(),r.enter().append("g").attr("class","ranking-text-group").merge(r).each((function(e){var i=d3.select(this).selectAll("text").data(e.data);i.exit().remove();var n=i.enter().append("text").attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return t.total?o(t.total)||0:o(t.value)||0})).merge(i).text((function(e){return isNaN(parseFloat(e.value))?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return t.total?o(t.total)||0:o(t.value)||0})).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?n.style("opacity",1):n.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)})),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".ranking-text-group text").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".ranking-text-group text").attr("dy",.4*-t._fontSize):1==t._positionOptions.indexOf(t._positionChoice)&&n.selectAll(".ranking-text-group text").attr("dy",1.3*t._fontSize);for(var l=n.selectAll(".ranking-text-group text"),s=[],u=[],c=0;c<l._groups[0].length;c++){u.push(c);for(var h=c+1;h<l._groups[0].length;h++){p(i(d3.select(l._groups[0][c])),i(d3.select(l._groups[0][h])))&&(s.push(c),d3.select(l._groups[0][c]).style("visibility","hidden"))}}for(var d=new Set(s),_=Array.from(d),f=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(_,u),y=0;y<_.length;y++){for(var x=[],g=0;g<f.length;g++){var v=i(d3.select(l._groups[0][_[y]])),m=i(d3.select(l._groups[0][f[g]]));if(x.push(p(v,m)),p(v,m)){if(_[y]==f[g])continue;d3.select(l._groups[0][_[y]]).style("visibility","hidden")}}0==x.filter((function(t){return 1==t})).length&&f.push(_[y])}for(var b=0;b<f.length;b++)d3.select(l._groups[0][f[b]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=parseFloat(t),this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),oe=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","line-scatter-plot"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=2,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data,n=t._xScale,a=t._yScale;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-scatter-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var o=e.selectAll("g").data(i,(function(t){return t.name}));o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").attr("class","scatter-plot").attr("cx",(function(t){return n(t.name)+n.bandwidth()/2||0})).attr("cy",(function(t){return a(t.value)||0})).merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t){return n(t.name)+n.bandwidth()/2||0})).attr("cy",(function(t){return a(t.value)||0}))}));for(var r=e.selectAll(".scatter-plot").nodes(),l=0;l<r.length;l++)""==r[l].__data__.value||isNaN(r[l].__data__.value)?d3.select(r[l]).style("opacity","0"):d3.select(r[l]).style("opacity","1");return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),e}(at),re=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.linePlot=new ne(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new oe(i.coreGroup),i.stackText=new ae(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._showPoints=!0,i._curve=d3.curveCardinal,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#FFFFFF",i._fillColor="",i._endPointRadius=3.5,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["依次绘制","同时绘制","穿针引线"],i._moveStyle="穿针引线",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.linePlot,a=(t.scatterPlot,t.clipArea),r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.guideScatter,h=t.stackText,d=t.xScale,_=t.yScale,f=(t.xAxis._axisStart,t.xAxis._axisEnd),p=0;f>t.widthOfNoMargin-t.yAxis.width&&(p=f-(t.widthOfNoMargin-t.yAxis.width));var g=t.widthOfCore-p,v=t.heightOfCore,m=(Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),t.defs);m.selectAll("filter").remove();var b=m.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_line").attr("filterUnits","objectBoundingBox");if(b.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),b.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),b.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),b.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),b.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),i.width(g).height(v).planeX(d.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(0==t._yDomain[0]?t.yAxis.tickLocations.slice(1):t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var S=x(t._strokeColor),k=[],w=!0,C=!1,O=void 0;try{for(var F,L=S[Symbol.iterator]();!(w=(F=L.next()).done);w=!0){var P=F.value,A=[],W=P.split(":");A.push(q(W[0])),A.push(W[1]),k.push(A)}}catch(t){C=!0,O=t}finally{try{!w&&L.return&&L.return()}finally{if(C)throw O}}var z=k.concat(),M=z.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(M[1]).x1+"%").attr("y1",y(M[1]).y1+"%").attr("x2",y(M[1]).x2+"%").attr("y2",y(M[1]).y2+"%").selectAll("stop").data(z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var D=x(t._fillColor),R=[],N=!0,T=!1,B=void 0;try{for(var G,X=D[Symbol.iterator]();!(N=(G=X.next()).done);N=!0){var j=G.value,I=[],Y=j.split(":");I.push(q(Y[0])),I.push(Y[1]),R.push(I)}}catch(t){T=!0,B=t}finally{try{!N&&X.return&&X.return()}finally{if(T)throw B}}var H=R.concat(),V=H.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(V[1]).x1+"%").attr("y1",y(V[1]).y1+"%").attr("x2",y(V[1]).x2+"%").attr("y2",y(V[1]).y2+"%").selectAll("stop").data(H).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).xScale(d).yScale(_).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).curve(t._curve).radius(t._endPointRadius).stroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).fill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).lineWidth(t._lineWidth).strokeWidth(t._strokeWidth),s.y1(0).y2(v).stroke("#c6c6c6").strokeDasharray("0 0"),u.xScale(d).yScale(_).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),l.data(d.domain()).isScalePoint(!1).bandX(d.range()[0]).bandWidth(d.step()).bandHeight(v).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],l=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));l.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),r.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show(),s.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+(d(a)+d.bandwidth()/2)+",0)"),u.data(l).update().show()})).onMousemove((function(){r.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){r.hide(),s.hide(),u.hide()})),h.data(e).xScale(d).yScale(_).type("mix").fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(a.width(g).height(v).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+a.id)+")"),a.update()):(a.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),a.update()),u.elem.style("pointer-events","none");var $=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll($).remove(),l.update(),i.update(),n.update(),h.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),e}(Tt),le=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","step-line-chart"),i._showPoints=!1,i._curve=d3.curveStepAfter,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=0,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["依次绘制","同时绘制","穿针引线"],i._moveStyle="同时绘制",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveStepAfter,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"")}}]),e}(re);function se(t,e){return t.sourceLinks.length?t.depth:e-1}function ue(t){return function(){return t}}function ce(t,e){return de(t.source,e.source)||t.index-e.index}function he(t,e){return de(t.target,e.target)||t.index-e.index}function de(t,e){return t.y0-e.y0}function _e(t){return t.value}function fe(t){return t.index}function pe(t){return t.nodes}function ye(t){return t.links}function xe(t,e){var i=t.get(e);if(!i)throw new Error("missing: "+e);return i}function ge(t){var e=t.nodes,i=!0,n=!1,a=void 0;try{for(var o,r=e[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value,s=l.y0,u=s,c=!0,h=!1,d=void 0;try{for(var _,f=l.sourceLinks[Symbol.iterator]();!(c=(_=f.next()).done);c=!0){var p=_.value;p.y0=s+p.width/2,s+=p.width}}catch(t){h=!0,d=t}finally{try{!c&&f.return&&f.return()}finally{if(h)throw d}}var y=!0,x=!1,g=void 0;try{for(var v,m=l.targetLinks[Symbol.iterator]();!(y=(v=m.next()).done);y=!0){var b=v.value;b.y1=u+b.width/2,u+=b.width}}catch(t){x=!0,g=t}finally{try{!y&&m.return&&m.return()}finally{if(x)throw g}}}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}}function ve(){var t=0,e=0,i=1,n=1,a=24,o=8,r=void 0,l=fe,s=se,u=void 0,c=void 0,h=pe,d=ye,_=6;function f(){var t={nodes:h.apply(null,arguments),links:d.apply(null,arguments)};return p(t),y(t),x(t),g(t),v(t),ge(t),t}function p(t){var e=t.nodes,i=t.links,n=!0,a=!1,o=void 0;try{for(var r,s=e.entries()[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var u=r.value,h=O(u,2),d=h[0],_=h[1];_.index=d,_.sourceLinks=[],_.targetLinks=[]}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}var f=new Map(e.map((function(t,i){return[l(t,i,e),t]}))),p=!0,y=!1,x=void 0;try{for(var g,v=i.entries()[Symbol.iterator]();!(p=(g=v.next()).done);p=!0){var b=g.value,S=O(b,2),k=S[0],w=S[1];w.index=k;var C=w.source,F=w.target;"object"!==(void 0===C?"undefined":m(C))&&(C=w.source=xe(f,C)),"object"!==(void 0===F?"undefined":m(F))&&(F=w.target=xe(f,F)),C.sourceLinks.push(w),F.targetLinks.push(w)}}catch(t){y=!0,x=t}finally{try{!p&&v.return&&v.return()}finally{if(y)throw x}}if(null!=c){var L=!0,P=!1,A=void 0;try{for(var W,z=e[Symbol.iterator]();!(L=(W=z.next()).done);L=!0){var M=W.value,D=M.sourceLinks,R=M.targetLinks;D.sort(c),R.sort(c)}}catch(t){P=!0,A=t}finally{try{!L&&z.return&&z.return()}finally{if(P)throw A}}}}function y(t){var e=t.nodes,i=!0,n=!1,a=void 0;try{for(var o,r=e[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;l.value=void 0===l.fixedValue?Math.max(d3.sum(l.sourceLinks,_e),d3.sum(l.targetLinks,_e)):l.fixedValue}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}}function x(t){for(var e=t.nodes,i=e.length,n=new Set(e),a=new Set,o=0;n.size;){var r=!0,l=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var h=u.value;h.depth=o;var d=!0,_=!1,f=void 0;try{for(var p,y=h.sourceLinks[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var x=p.value.target;a.add(x)}}catch(t){_=!0,f=t}finally{try{!d&&y.return&&y.return()}finally{if(_)throw f}}}}catch(t){l=!0,s=t}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}if(++o>i)throw new Error("circular link");n=a,a=new Set}}function g(t){for(var e=t.nodes,i=e.length,n=new Set(e),a=new Set,o=0;n.size;){var r=!0,l=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var h=u.value;h.height=o;var d=!0,_=!1,f=void 0;try{for(var p,y=h.targetLinks[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var x=p.value.source;a.add(x)}}catch(t){_=!0,f=t}finally{try{!d&&y.return&&y.return()}finally{if(_)throw f}}}}catch(t){l=!0,s=t}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}if(++o>i)throw new Error("circular link");n=a,a=new Set}}function v(l){var c=function(e){var n=e.nodes,o=d3.max(n,(function(t){return t.depth}))+1,r=(i-t-a)/(o-1),l=isNaN(o)?[]:new Array(o),c=!0,h=!1,d=void 0;try{for(var _,f=n[Symbol.iterator]();!(c=(_=f.next()).done);c=!0){var p=_.value,y=Math.max(0,Math.min(o-1,Math.floor(s.call(null,p,o))));p.layer=y,p.x0=t+y*r,p.x1=p.x0+a,l[y]?l[y].push(p):l[y]=[p]}}catch(t){h=!0,d=t}finally{try{!c&&f.return&&f.return()}finally{if(h)throw d}}if(u){var x=!0,g=!1,v=void 0;try{for(var m,b=l[Symbol.iterator]();!(x=(m=b.next()).done);x=!0)m.value.sort(u)}catch(t){g=!0,v=t}finally{try{!x&&b.return&&b.return()}finally{if(g)throw v}}}return l}(l);r=Math.min(o,(n-e)/(d3.max(c,(function(t){return t.length}))-1)),function(t){var i=d3.min(t,(function(t){return(n-e-(t.length-1)*r)/d3.sum(t,_e)})),a=!0,o=!1,l=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var c=s.value,h=e,d=!0,_=!1,f=void 0;try{for(var p,y=c[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var x=p.value;x.y0=h,x.y1=h+x.value*i,h=x.y1+r;var g=!0,v=!1,m=void 0;try{for(var b,S=x.sourceLinks[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value;k.width=k.value*i}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}}}catch(t){_=!0,f=t}finally{try{!d&&y.return&&y.return()}finally{if(_)throw f}}h=(n-h+r)/(c.length+1);for(var w=0;w<c.length;++w){var C=c[w];C.y0+=h*(w+1),C.y1+=h*(w+1)}L(c)}}catch(t){o=!0,l=t}finally{try{!a&&u.return&&u.return()}finally{if(o)throw l}}}(c);for(var h=0;h<_;++h){var d=Math.pow(.99,h),f=Math.max(1-d,(h+1)/_);S(c,d,f),b(c,d,f)}}function b(t,e,i){for(var n=1,a=t.length;n<a;++n){var o=t[n],r=!0,l=!1,s=void 0;try{for(var c,h=o[Symbol.iterator]();!(r=(c=h.next()).done);r=!0){var d=c.value,_=0,f=0,p=!0,y=!1,x=void 0;try{for(var g,v=d.targetLinks[Symbol.iterator]();!(p=(g=v.next()).done);p=!0){var m=g.value,b=m.source,S=m.value*(d.layer-b.layer);_+=P(b,d)*S,f+=S}}catch(t){y=!0,x=t}finally{try{!p&&v.return&&v.return()}finally{if(y)throw x}}if(f>0){var w=(_/f-d.y0)*e;d.y0+=w,d.y1+=w,F(d)}}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}void 0===u&&o.sort(de),k(o,i)}}function S(t,e,i){for(var n=t.length-2;n>=0;--n){var a=t[n],o=!0,r=!1,l=void 0;try{for(var s,c=a[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var h=s.value,d=0,_=0,f=!0,p=!1,y=void 0;try{for(var x,g=h.sourceLinks[Symbol.iterator]();!(f=(x=g.next()).done);f=!0){var v=x.value,m=v.target,b=v.value*(m.layer-h.layer);d+=A(h,m)*b,_+=b}}catch(t){p=!0,y=t}finally{try{!f&&g.return&&g.return()}finally{if(p)throw y}}if(_>0){var S=(d/_-h.y0)*e;h.y0+=S,h.y1+=S,F(h)}}}catch(t){r=!0,l=t}finally{try{!o&&c.return&&c.return()}finally{if(r)throw l}}void 0===u&&a.sort(de),k(a,i)}}function k(t,i){var a=t.length>>1,o=t[a];C(t,o.y0-r,a-1,i),w(t,o.y1+r,a+1,i),C(t,n,t.length-1,i),w(t,e,0,i)}function w(t,e,i,n){for(;i<t.length;++i){var a=t[i],o=(e-a.y0)*n;o>1e-6&&(a.y0+=o,a.y1+=o),e=a.y1+r}}function C(t,e,i,n){for(;i>=0;--i){var a=t[i],o=(a.y1-e)*n;o>1e-6&&(a.y0-=o,a.y1-=o),e=a.y0-r}}function F(t){var e=t.sourceLinks,i=t.targetLinks;if(void 0===c){var n=!0,a=!1,o=void 0;try{for(var r,l=i[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){r.value.source.sourceLinks.sort(he)}}catch(t){a=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}var s=!0,u=!1,h=void 0;try{for(var d,_=e[Symbol.iterator]();!(s=(d=_.next()).done);s=!0){d.value.target.targetLinks.sort(ce)}}catch(t){u=!0,h=t}finally{try{!s&&_.return&&_.return()}finally{if(u)throw h}}}}function L(t){if(void 0===c){var e=!0,i=!1,n=void 0;try{for(var a,o=t[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var r=a.value,l=r.sourceLinks,s=r.targetLinks;l.sort(he),s.sort(ce)}}catch(t){i=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(i)throw n}}}}function P(t,e){var i=t.y0-(t.sourceLinks.length-1)*r/2,n=!0,a=!1,o=void 0;try{for(var l,s=t.sourceLinks[Symbol.iterator]();!(n=(l=s.next()).done);n=!0){var u=l.value,c=u.target,h=u.width;if(c===e)break;i+=h+r}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}var d=!0,_=!1,f=void 0;try{for(var p,y=e.targetLinks[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var x=p.value,g=x.source,v=x.width;if(g===t)break;i-=v}}catch(t){_=!0,f=t}finally{try{!d&&y.return&&y.return()}finally{if(_)throw f}}return i}function A(t,e){var i=e.y0-(e.targetLinks.length-1)*r/2,n=!0,a=!1,o=void 0;try{for(var l,s=e.targetLinks[Symbol.iterator]();!(n=(l=s.next()).done);n=!0){var u=l.value,c=u.source,h=u.width;if(c===t)break;i+=h+r}}catch(t){a=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(a)throw o}}var d=!0,_=!1,f=void 0;try{for(var p,y=t.sourceLinks[Symbol.iterator]();!(d=(p=y.next()).done);d=!0){var x=p.value,g=x.target,v=x.width;if(g===e)break;i-=v}}catch(t){_=!0,f=t}finally{try{!d&&y.return&&y.return()}finally{if(_)throw f}}return i}return f.update=function(t){return ge(t),t},f.nodeId=function(t){return arguments.length?(l="function"==typeof t?t:ue(t),f):l},f.nodeAlign=function(t){return arguments.length?(s="function"==typeof t?t:ue(t),f):s},f.nodeSort=function(t){return arguments.length?(u=t,f):u},f.nodeWidth=function(t){return arguments.length?(a=+t,f):a},f.nodePadding=function(t){return arguments.length?(o=r=+t,f):o},f.nodes=function(t){return arguments.length?(h="function"==typeof t?t:ue(t),f):h},f.links=function(t){return arguments.length?(d="function"==typeof t?t:ue(t),f):d},f.linkSort=function(t){return arguments.length?(c=t,f):c},f.size=function(a){return arguments.length?(t=e=0,i=+a[0],n=+a[1],f):[i-t,n-e]},f.extent=function(a){return arguments.length?(t=+a[0][0],i=+a[1][0],e=+a[0][1],n=+a[1][1],f):[[t,e],[i,n]]},f.iterations=function(t){return arguments.length?(_=+t,f):_},f}var me=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","sankey-plot"),i.sankeyFunc=ve(),i._width=400,i._height=400,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._sortByIndex=!0,i._onMouseoverLink=function(){},i._onMousemoveLink=function(){},i._onMouseoutLink=function(){},i._eventOnDrag=function(){},i._nodeColor=null,i._linkColor=null,i._nodeBorderWidth="1",i._nodeBorderColor="#cccccc",i._nodeWidth=0,i._nodeGap="0",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._width,i=t._height,n=t._data,a=t.sankeyFunc,r=t.group,l=t.sankeyFunc.nodeId((function(t){return t.key})).size([e,i]),s=l(n),u=s.nodes.map((function(t){return t.depth})),h=[],d=[],_=0,f=0;s.nodes.length>0&&(s.nodes.forEach((function(t){t.depth==d3.min(u)?h.push(t.name):t.depth==d3.max(u)&&d.push(t.name)})),h.length>0&&(_="居中"==t._positionChoice?(_=G(h,t._fontSize,t._fontFamily))>parseFloat(t._nodeWidth)?_-parseFloat(t._nodeWidth):0:G(h,t._fontSize,t._fontFamily)),d.length>0&&(f="居中"==t._positionChoice?(f=G(d,t._fontSize,t._fontFamily))>parseFloat(t._nodeWidth)?f-parseFloat(t._nodeWidth):0:G(d,t._fontSize,t._fontFamily))),"居中"!=t._positionChoice&&t._labelShow&&(_+=6,f+=6);var p=0;function g(t){if(t.length){if(1===t.length)return 1;var e={},i=0;return t.forEach((function(t){e[t]?e[t]+=1:e[t]=1,e[t]>i&&(i=e[t])})),i}}"外侧"==t._positionChoice?(p=_+f,r.call(o,_,0)):"居中"==t._positionChoice?(p=(_+f)/2,r.call(o,_/2,0)):(p=0,r.call(o,0,0));var v=(g(u)-1)*parseFloat(t._nodeGap),m=l.nodePadding()*(g(u)-1);e-=p,a.nodeId((function(t){return t.key})).size([e,i-v+m]);var b,S=parseFloat(t._nodeGap),k=a(n),w=k.nodes.filter((function(t){return t.sourceLinks.length||t.targetLinks.length})),C=d3.max(w.map((function(t){return t.depth}))),O=d3.max(k.links.map((function(t){return t.source.depth}))),F=parseFloat(t._nodeWidth),L=t._nodeBorderWidth?parseFloat(t._nodeBorderWidth):0;t._sortByIndex&&(b=d3.max(w,(function(t){return t.depth}))+1,d3.range(b).forEach((function(t){var e=w.filter((function(e){return e.depth===t})).sort((function(t,e){return t.index-e.index})),i=d3.min(e,(function(t){return t.y0}));e.forEach((function(t){var e=t.y1-t.y0;t.y0=i,t.y1=i+e,i+=e+S}))})),a.update(k)),t.group.selectAll("*").remove(),w.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+e.index).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),k.links.forEach((function(t,e){t.y0==t.y1&&(t.y0=t.y0-1e-5)}));var P=Array.from(new Set(w.map((function(t){return t.depth})))).length,A=d3.linkHorizontal().source((function(t,i){var n=void 0;if(O>0){var a=(e-F*P)/(P-1),o=parseInt(t.source.depth);n=F+o*(F+a)}else n=0+F+L;return[n,t.y0]})).target((function(t,i){var n=void 0;if(O>0){var a=(e-F*P)/(P-1);n=parseInt(t.target.depth)*(F+a)}else n=e-F-L;return[n,t.y1]})),W=(r.select(".links-group").empty()?r.append("g").attr("class","links-group").style("fill","none"):r.select(".links-group")).selectAll(".link").data(k.links);W.exit().remove();var z=W.enter().append("path").attr("class","link").merge(W).attr("d",(function(t,e){return A(t,e)})).style("stroke",(function(e){return t._linkColor||(/\[/.test(e.source.color)?"url("+c("#"+t.id+"-index-"+e.source.index)+")":e.source.color)})).style("stroke-width",(function(t){return Math.max(1,t.width)})).style("stroke-opacity",t._linkOpacity).on("mouseover",t._onMouseoverLink).on("mousemove",t._onMousemoveLink).on("mouseout",t._onMouseoutLink),M=(r.select(".nodes-group").empty()?r.append("g").attr("class","nodes-group"):r.select(".nodes-group")).selectAll(".node-group").data(w);M.exit().remove();var D=M.enter().append("g").attr("class","node-group");D.append("rect"),D.append("text");var R=D.merge(M).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);R.select("rect").attr("x",(function(t,i){if(C<=1)return 0==t.depth?L/2:e-F-L/2;var n=(e-F*P)/(P-1),a=parseInt(t.depth);return 0===a?L/2:a==P-1?a*(F+n)-L/2:a*(F+n)})).attr("y",(function(t){return t.y0})).attr("width",parseFloat(t._nodeWidth)<0?function(t){return Math.max(0,t.x1-t.x0)}:t._nodeWidth).attr("height",(function(t){return Math.max(0,t.y1-t.y0)})).style("fill",(function(e,i){return t._nodeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+e.index)+")":e.color)})).style("stroke",(function(e,i){return t._nodeBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+e.index)+")":e.color)})).style("stroke-width",t._nodeBorderWidth);var N=R.select("text").attr("x",(function(i){if(C>1){if("外侧"==t._positionChoice){var n=(e-F*P)/(P-1),a=parseInt(i.depth);return 0==a?-6-L:a==P-1?e+6+L/2:a*(F+n)-6-L/2}if("居中"==t._positionChoice){var o=(e-F*P)/(P-1);return parseInt(i.depth)*(F+o)+F/2}var r=(e-F*P)/(P-1),l=parseInt(i.depth);return 0==l?F+6+L/2:l*(F+r)-6-L/2}return"外侧"==t._positionChoice?0==i.depth?-6-L/2:e+6+L/2:"居中"==t._positionChoice?0==i.depth?F/2:e-F/2:0==i.depth?F+6+L/2:e-F-6-L/2})).attr("y",(function(t){return(t.y0+t.y1)/2})).attr("dy","0.35em").style("text-anchor",(function(e){return"外侧"==t._positionChoice?C>1?e.depth==C?"start":"end":0==e.depth?"end":"start":"居中"==t._positionChoice?"middle":0==e.depth?"start":"end"})).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("display",t._labelShow?"block":"none").text((function(e){return e.y1-e.y0+S<t._fontSize?"":e.name}));t._interrupt?N.style("opacity",1):N.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1);var T=d3.drag().on("start",(function(){d3.select(this).raise()})).on("drag",(function(e){var n=d3.event.dy,o=e.y1-e.y0;e.y0=Math.max(0,Math.min(e.y0+n,i-o)),e.y1=e.y0+o,d3.select(this).select("rect").attr("y",e.y0),d3.select(this).select("text").attr("y",(function(t){return(t.y0+t.y1)/2})),a.update(k),k.links.forEach((function(t,e){t.y0==t.y1&&(t.y0=t.y0-1e-5)})),z.attr("d",(function(t){return A(t)})),t._eventOnDrag()}));return R.style("cursor","move").call(T),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"linkOpacity",value:function(t){return arguments.length?(this._linkOpacity=t,this):this._linkOpacity}},{key:"onMouseoverLink",value:function(t){return arguments.length?(this._onMouseoverLink="function"==typeof t?t:function(){},this):this._onMouseoverLink}},{key:"onMousemoveLink",value:function(t){return arguments.length?(this._onMousemoveLink="function"==typeof t?t:function(){},this):this._onMousemoveLink}},{key:"onMouseoutLink",value:function(t){return arguments.length?(this._onMouseoutLink="function"==typeof t?t:function(){},this):this._onMouseoutLink}},{key:"eventOnDrag",value:function(t){return arguments.length?(this._eventOnDrag="function"==typeof t?t:function(){},this):this._eventOnDrag}},{key:"sortByIndex",value:function(t){return arguments.length?(this._sortByIndex=t,this):this._sortByIndex}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"nodeColor",value:function(t){return arguments.length?(this._nodeColor=t,this):this._nodeColor}},{key:"nodeGap",value:function(t){return arguments.length?(this._nodeGap=t,this):this._nodeGap}},{key:"linkColor",value:function(t){return arguments.length?(this._linkColor=t,this):this._linkColor}},{key:"nodeBorderWidth",value:function(t){return arguments.length?(this._nodeBorderWidth=t,this):this._nodeBorderWidth}},{key:"nodeBorderColor",value:function(t){return arguments.length?(this._nodeBorderColor=t,this):this._nodeBorderColor}},{key:"nodeWidth",value:function(t){return arguments.length?(this._nodeWidth=t,this):this._nodeWidth}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}}]),e}(at);function be(t,e){var i=0,n=1,a=2;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"targetCol"===t.function?n=t.index:"vCol"===t.function&&(a=t.index)})),P(t,[i,n,a])||!A(t,a))return{names:[],nodes:[],links:[],valueLabel:""};var o=[],r=[],l=[],s={},u={};return t.slice(1).forEach((function(t){var e=t[i],c=t[n],h=+t[a],d=e+"-s",_=c+"-t";u[e]||(l.push(e),u[e]=!0),u[c]||(l.push(c),u[c]=!0),s[d]||(o.push({name:e,key:d}),s[d]=!0),s[_]||(o.push({name:c,key:_}),s[_]=!0),h&&r.push({source:d,target:_,value:h})})),{names:l,nodes:o,links:r,valueLabel:t[0][a]}}function Se(t,e){var i=0,n=1,a=2;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"targetCol"===t.function?n=t.index:"vCol"===t.function&&(a=t.index)})),P(t,[i,n,a])||i===n||!A(t,a))return{names:[],nodes:[],links:[],valueLabel:""};for(var o=[],r=[],l=[],s={},u=function(e,u){var c=t[e],h=c[i],d=c[n],_=+c[a],f=h,p=d;if(!f||!p||null==_||null==_||function(t,e,i){if(e===i)return!0;if(t[e]&&t[e].ancestors.indexOf(t[i])>=0)return!0;return!1}(s,f,p))return"continue";s[f]||(o.push({name:h,key:f}),l.push(h),s[f]={ancestors:[],decendents:[]}),s[p]||(o.push({name:d,key:p}),l.push(d),s[p]={ancestors:[],decendents:[]});var y=s[f],x=s[p];[y].concat(F(y.ancestors)).forEach((function(t){var e;(e=t.decendents).push.apply(e,[x].concat(F(x.decendents)))})),[x].concat(F(x.decendents)).forEach((function(t){var e;(e=t.ancestors).push.apply(e,[y].concat(F(y.ancestors)))})),r.push({source:f,target:p,value:_})},c=1,h=t.length;c<h;c++)u(c);return{names:l,nodes:o,links:r,valueLabel:t[0][a]}}var ke=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=this.generateColorList(t.names.length),i=d3.scaleOrdinal().domain(t.names).range(e);return t.nodes.forEach((function(t){return t.color=i(t.name)})),t.legendData=t.names.map((function(t){return{name:t,color:i(t)}})),t}}]),e}(it),we=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","sankey-chart"),i.sankey=new me(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._nodeColor=null,i._linkColor=null,i._nodeBorderWidth="1",i._nodeBorderColor="black",i._nodeWidth=24,i._nodeGap=8,i._linkOpacity=.3,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._positionOptions=["内侧","外侧","居中"],i._positionChoice="内侧",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["内侧","外侧","居中"],positionChoice:"内侧"},i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.sankey,i=t.tooltip,n=(t.AnimationArea,t._data.valueLabel),a=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,o=!!t._fontCopy||t._textLabel.show,r=o?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,l=t._fontCopy?t._fontColor:q(t._textLabel.color),s=t.defs;s.selectAll("filter").remove();var u=s.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_sankey").attr("filterUnits","objectBoundingBox");if(u.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),u.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),u.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),u.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),u.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".linear-gradient").remove(),t._nodeColor&&/\[/.test(t._nodeColor)){var h=x(t._nodeColor),d=[],_=!0,f=!1,p=void 0;try{for(var g,v=h[Symbol.iterator]();!(_=(g=v.next()).done);_=!0){var m=g.value,b=[],S=m.split(":");b.push(q(S[0])),b.push(S[1]),d.push(b)}}catch(t){f=!0,p=t}finally{try{!_&&v.return&&v.return()}finally{if(f)throw p}}var k=d.concat(),w=k.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(w[1]).x1+"%").attr("y1",y(w[1]).y1+"%").attr("x2",y(w[1]).x2+"%").attr("y2",y(w[1]).y2+"%").selectAll("stop").data(k).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._nodeBorderColor&&/\[/.test(t._nodeBorderColor)){var C=x(t._nodeBorderColor),O=[],F=!0,L=!1,P=void 0;try{for(var A,W=C[Symbol.iterator]();!(F=(A=W.next()).done);F=!0){var z=A.value,M=[],D=z.split(":");M.push(q(D[0])),M.push(D[1]),O.push(M)}}catch(t){L=!0,P=t}finally{try{!F&&W.return&&W.return()}finally{if(L)throw P}}var R=O.concat(),N=R.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(N[1]).x1+"%").attr("y1",y(N[1]).y1+"%").attr("x2",y(N[1]).x2+"%").attr("y2",y(N[1]).y2+"%").selectAll("stop").data(R).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._linkColor&&/\[/.test(t._linkColor)){var T=x(t._linkColor),B=[],G=!0,X=!1,j=void 0;try{for(var I,Y=T[Symbol.iterator]();!(G=(I=Y.next()).done);G=!0){var H=I.value,V=[],$=H.split(":");V.push(q($[0])),V.push($[1]),B.push(V)}}catch(t){X=!0,j=t}finally{try{!G&&Y.return&&Y.return()}finally{if(X)throw j}}var U=B.concat(),Z=U.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-2").attr("x1",y(Z[1]).x1+"%").attr("y1",y(Z[1]).y1+"%").attr("x2",y(Z[1]).x2+"%").attr("y2",y(Z[1]).y2+"%").selectAll("stop").data(U).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}(e.data(t.activeData).width(t.widthOfNoMargin).height(.96*t.heightOfMainGroup).nodeColor(/\[/.test(t._nodeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._nodeColor).linkColor(/\[/.test(t._linkColor)?"url("+c("#"+t.id+"-main-border-index-2")+")":t._linkColor).linkOpacity(t._linkOpacity).nodeBorderWidth(t._nodeBorderWidth).nodeBorderColor(/\[/.test(t._nodeBorderColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._nodeBorderColor).nodeWidth(t._nodeWidth).nodeGap(t._nodeGap).fontSize(r).fontFamily(a).fontColor(l).labelShow(o).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).positionChoice(t._positionChoice).onMouseover((function(a){var o=Math.max(d3.sum(a.sourceLinks,(function(t){return t.value})),d3.sum(a.targetLinks,(function(t){return t.value}))),r=[{color:a.color,text:a.name},{text:n+"："+E(o,t._numberStyle,t._decimalPlaces)}];e.elem.selectAll(".link").filter((function(t){return t.source===a||t.target===a})).style("stroke-opacity",1),i.data(r).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(n){i.hide(),e.elem.selectAll(".link").filter((function(t){return t.source===n||t.target===n})).style("stroke-opacity",t._linkOpacity)})).onMouseoverLink((function(e){var n=[{text:e.source.name+" → "+e.target.name+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];d3.select(this).style("stroke-opacity",1),i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemoveLink((function(t){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseoutLink((function(e){d3.select(this).style("stroke-opacity",t._linkOpacity),i.hide()})).eventOnDrag((function(){i.move([d3.event.offsetX,d3.event.offsetY])})),e.update(),t._interrupt)?(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("height",t._height).attr("width",t.widthOfNoMargin),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("height",t._height).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",t.widthOfNoMargin),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t._data;t.legend.data(e.legendData).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.legendData.forEach((function(t){t.name===i.name&&(t.active=!n)})),e.nodes.forEach((function(t){t.name===i.name&&(t.active=!n)})),t.onDataChange()}))}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new ke(t,e);return i.dataSolveFunc(Se),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.label,o=t.display,r=t.font;this._fontCopy=r,0!==Object.getOwnPropertyNames(a).length&&(this._textLabel=a.textLabel?a.textLabel:this._textLabel,this._positionChoice=a.textLabel&&a.textLabel.positionChoice?a.textLabel.positionChoice:this._positionChoice),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(o).length&&(this._nodeColor=o.nodeColor?q(o.nodeColor):null,this._linkColor=o.linkColor?q(o.linkColor):null,this._nodeBorderWidth=0==o.nodeBorderWidth||o.nodeBorderWidth?d(o.nodeBorderWidth):this._nodeBorderWidth,this._nodeBorderColor=o.nodeBorderColor?q(o.nodeBorderColor):null,this._nodeWidth=0==o.nodeWidth||o.nodeWidth?d(o.nodeWidth):this._nodeWidth,this._nodeGap=0==o.nodeGap||o.nodeGap?d(o.nodeGap):this._nodeGap,this._linkOpacity=0==o.linkOpacity||o.linkOpacity?d(o.linkOpacity):this._linkOpacity)}},{key:"activeData",get:function(){var t=this._data.nodes,e=this._data.links.filter((function(e){return t.some((function(t){return!1!==t.active&&t.key===e.source}))&&t.some((function(t){return!1!==t.active&&t.key===e.target}))})).map((function(t){return Object.assign({},t)}));return{nodes:t.filter((function(t){return!1!==t.active&&(e.some((function(e){return t.key===e.source}))||e.some((function(e){return t.key===e.target})))})).map((function(t){return Object.assign({},t)})),links:e}}}]),e}(nt),Ce=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._nodeColor=null,i._linkColor=null,i._nodeBorderWidth="1",i._nodeBorderColor="black",i._nodeWidth=24,i._nodeGap=8,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._positionOptions=["内侧","外侧","居中"],i._positionChoice="内侧",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["内侧","外侧","居中"],positionChoice:"内侧"},i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"buildOption",value:function(t,e){var i=new ke(t,e);return i.dataSolveFunc(be),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.display,o=t.label,r=t.font;this._fontCopy=r,0!==Object.getOwnPropertyNames(o).length&&(this._textLabel=o.textLabel?o.textLabel:this._textLabel,this._positionChoice=o.textLabel&&o.textLabel.positionChoice?o.textLabel.positionChoice:this._positionChoice),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(a).length&&(this._nodeColor=a.nodeColor?q(a.nodeColor):null,this._linkColor=a.linkColor?q(a.linkColor):null,this._nodeBorderWidth=0==a.nodeBorderWidth||a.nodeBorderWidth?d(a.nodeBorderWidth):this._nodeBorderWidth,this._nodeBorderColor=a.nodeBorderColor?q(a.nodeBorderColor):null,this._nodeWidth=0==a.nodeWidth||a.nodeWidth?d(a.nodeWidth):this._nodeWidth,this._nodeGap=0==a.nodeGap||a.nodeGap?d(a.nodeGap):this._nodeGap,this._linkOpacity=0==a.linkOpacity||a.linkOpacity?d(a.linkOpacity):this._linkOpacity)}}]),e}(we),Oe=function(t){function e(t){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._width,i=t._height,n=t._data,a=t.sankeyFunc,r=t._fontSize,l=t.group,s=r;"内侧"==t._positionChoice?(l.call(o,0,0),s=0):"居中"==t._positionChoice?(l.call(o,0,r/2),s=r/2):l.call(o,0,r);var u=t.sankeyFunc.nodeId((function(t){return t.key})).size([e,i]),h=u(n).nodes.map((function(t){return t.depth}));function d(t){if(t.length){if(1===t.length)return 1;var e={},i=0;return t.forEach((function(t){e[t]?e[t]+=1:e[t]=1,e[t]>i&&(i=e[t])})),i}}var _=(d(h)-1)*parseFloat(t._nodeGap),f=u.nodePadding()*(d(h)-1);a.nodeId((function(t){return t.key})).size([i-2*s,e-_+f]);var p,g=parseFloat(t._nodeGap),v=a(n),m=v.nodes.filter((function(t){return t.sourceLinks.length||t.targetLinks.length}));t._sortByIndex&&(p=d3.max(m,(function(t){return t.depth}))+1,d3.range(p).forEach((function(t){var e=m.filter((function(e){return e.depth===t})).sort((function(t,e){return t.index-e.index})),i=d3.min(e,(function(t){return t.y0}));e.forEach((function(t){var e=t.y1-t.y0;t.y0=i,t.y1=i+e,i+=e+g}))})),a.update(v)),t.group.selectAll("*").remove(),m.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+e.index).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),v.links.forEach((function(t,e){t.y0==t.y1&&(t.y0=t.y0-1e-5)}));var b=parseFloat(t._nodeWidth),S=Array.from(new Set(m.map((function(t){return t.depth})))).length,k=(i-2*parseFloat(s)-b*S)/(S-1),w=parseFloat(t._nodeBorderWidth),C=d3.linkVertical().source((function(t){var e,i=parseInt(t.source.depth);return e=.6*parseFloat(r)+b+i*(k+b),[t.y0,e]})).target((function(t){var e,i=parseInt(t.target.depth)-1;return e=.6*parseFloat(r)+b+i*(k+b)+k,[t.y1,e]})),O=(l.select(".links-group").empty()?l.append("g").attr("class","links-group").style("fill","none"):l.select(".links-group")).selectAll(".link").data(v.links);O.exit().remove();var F=O.enter().append("path").attr("class","link").merge(O).attr("d",(function(t){return C(t)})).style("stroke",(function(e){return t._linkColor||(/\[/.test(e.source.color)?"url("+c("#"+t.id+"-index-"+e.source.index)+")":e.source.color)})).style("stroke-width",(function(t){return Math.max(1,t.width)})).style("stroke-opacity",t._linkOpacity).on("mouseover",t._onMouseoverLink).on("mousemove",t._onMousemoveLink).on("mouseout",t._onMouseoutLink),L=(l.select(".nodes-group").empty()?l.append("g").attr("class","nodes-group"):l.select(".nodes-group")).selectAll(".node-group").data(m);L.exit().remove();var P=L.enter().append("g").attr("class","node-group");P.append("rect"),P.append("text");var A=P.merge(L).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);A.select("rect").attr("x",(function(t){return t.y0})).attr("y",(function(t){var e=parseInt(t.depth);return.6*parseFloat(r)+e*(b+k)})).attr("width",(function(t){return Math.max(0,t.y1-t.y0)})).attr("height",parseFloat(t._nodeWidth)<0?function(t){return Math.max(0,t.x1-t.x0)}:t._nodeWidth).style("fill",null==t._nodeColor?function(t){return t.color}:t._nodeColor).style("fill",(function(e,i){return t._nodeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+e.index)+")":e.color)})).style("stroke",(function(e,i){return t._nodeBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+e.index)+")":e.color)})).style("stroke-width",t._nodeBorderWidth);var W=A.select("text").attr("y",(function(e){var n=parseInt(e.depth);return"内侧"==t._positionChoice?0==n?b+w/2+parseFloat(1.3*r):n*(b+k)-w/2:"居中"==t._positionChoice?n*(b+k)+b/2+.67*parseFloat(r):n==S-1?i-.66*parseFloat(r)+w/2:n*(b+k)-w/2})).attr("x",(function(t){return(t.y0+t.y1)/2})).attr("dy","0.33em").style("text-anchor","middle").style("font-size",r+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("display",t._labelShow?"block":"none").text((function(e){return X(e.name,e.y1-e.y0+g,r,t._fontFamily)}));t._interrupt?W.style("opacity",1):W.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1);var z=d3.drag().on("start",(function(){d3.select(this).raise()})).on("drag",(function(i){var n=d3.event.dx,o=i.y1-i.y0;i.y0=Math.max(0,Math.min(i.y0+n,e-o)),i.y1=i.y0+o,d3.select(this).select("rect").attr("x",i.y0),d3.select(this).select("text").attr("x",(function(t){return(t.y0+t.y1)/2})),a.update(v),v.links.forEach((function(t,e){t.y0==t.y1&&(t.y0=t.y0-1e-5)})),F.attr("d",(function(t){return C(t)})),t._eventOnDrag()}));return A.style("cursor","move").call(z),t}},{key:"nodeColor",value:function(t){return arguments.length?(this._nodeColor=t,this):this._nodeColor}},{key:"nodeGap",value:function(t){return arguments.length?(this._nodeGap=t,this):this._nodeGap}},{key:"linkColor",value:function(t){return arguments.length?(this._linkColor=t,this):this._linkColor}},{key:"nodeBorderWidth",value:function(t){return arguments.length?(this._nodeBorderWidth=t,this):this._nodeBorderWidth}},{key:"nodeBorderColor",value:function(t){return arguments.length?(this._nodeBorderColor=t,this):this._nodeBorderColor}},{key:"nodeWidth",value:function(t){return arguments.length?(this._nodeWidth=t,this):this._nodeWidth}},{key:"linkOpacity",value:function(t){return arguments.length?(this._linkOpacity=t,this):this._linkOpacity}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}}]),e}(me),Fe=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","vertical-sankey-chart"),i.sankey=new Oe(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._nodeColor=null,i._linkColor=null,i._nodeBorderWidth="1",i._nodeBorderColor="black",i._nodeWidth=24,i._nodeGap=8,i._linkOpacity=.3,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._positionOptions=["内侧","外侧","居中"],i._positionChoice="外侧",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["内侧","外侧","居中"],positionChoice:"外侧"},i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="纵向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.sankey,i=t.tooltip,n=(t.AnimationArea,t._fontCopy?t._fontFamily:t._textLabel.fontFamily),a=!!t._fontCopy||t._textLabel.show,o=a?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,r=t._fontCopy?t._fontColor:q(t._textLabel.color),l=t._data.valueLabel,s=t.defs;s.selectAll("filter").remove();var u=s.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_sankey").attr("filterUnits","objectBoundingBox");if(u.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),u.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),u.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),u.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),u.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".linear-gradient").remove(),t._nodeColor&&/\[/.test(t._nodeColor)){var h=x(t._nodeColor),d=[],_=!0,f=!1,p=void 0;try{for(var g,v=h[Symbol.iterator]();!(_=(g=v.next()).done);_=!0){var m=g.value,b=[],S=m.split(":");b.push(q(S[0])),b.push(S[1]),d.push(b)}}catch(t){f=!0,p=t}finally{try{!_&&v.return&&v.return()}finally{if(f)throw p}}var k=d.concat(),w=k.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(w[1]).x1+"%").attr("y1",y(w[1]).y1+"%").attr("x2",y(w[1]).x2+"%").attr("y2",y(w[1]).y2+"%").selectAll("stop").data(k).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._nodeBorderColor&&/\[/.test(t._nodeBorderColor)){var C=x(t._nodeBorderColor),O=[],F=!0,L=!1,P=void 0;try{for(var A,W=C[Symbol.iterator]();!(F=(A=W.next()).done);F=!0){var z=A.value,M=[],D=z.split(":");M.push(q(D[0])),M.push(D[1]),O.push(M)}}catch(t){L=!0,P=t}finally{try{!F&&W.return&&W.return()}finally{if(L)throw P}}var R=O.concat(),N=R.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(N[1]).x1+"%").attr("y1",y(N[1]).y1+"%").attr("x2",y(N[1]).x2+"%").attr("y2",y(N[1]).y2+"%").selectAll("stop").data(R).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._linkColor&&/\[/.test(t._linkColor)){var T=x(t._linkColor),B=[],G=!0,X=!1,j=void 0;try{for(var I,Y=T[Symbol.iterator]();!(G=(I=Y.next()).done);G=!0){var H=I.value,V=[],$=H.split(":");V.push(q($[0])),V.push($[1]),B.push(V)}}catch(t){X=!0,j=t}finally{try{!G&&Y.return&&Y.return()}finally{if(X)throw j}}var U=B.concat(),Z=U.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-2").attr("x1",y(Z[1]).x1+"%").attr("y1",y(Z[1]).y1+"%").attr("x2",y(Z[1]).x2+"%").attr("y2",y(Z[1]).y2+"%").selectAll("stop").data(U).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}(e.data(t.activeData).width(t.widthOfNoMargin).height(.96*t.heightOfMainGroup).nodeColor(/\[/.test(t._nodeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._nodeColor).linkColor(/\[/.test(t._linkColor)?"url("+c("#"+t.id+"-main-border-index-2")+")":t._linkColor).linkOpacity(t._linkOpacity).nodeBorderWidth(t._nodeBorderWidth).nodeBorderColor(/\[/.test(t._nodeBorderColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._nodeBorderColor).nodeWidth(t._nodeWidth).nodeGap(t._nodeGap).fontSize(o).fontFamily(n).fontColor(r).labelShow(a).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).positionChoice(t._positionChoice).onMouseover((function(n){var a=Math.max(d3.sum(n.sourceLinks,(function(t){return t.value})),d3.sum(n.targetLinks,(function(t){return t.value}))),o=[{color:n.color,text:n.name},{text:l+"："+E(a,t._numberStyle,t._decimalPlaces)}];e.elem.selectAll(".link").filter((function(t){return t.source===n||t.target===n})).style("stroke-opacity",1),i.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(n){i.hide(),e.elem.selectAll(".link").filter((function(t){return t.source===n||t.target===n})).style("stroke-opacity",t._linkOpacity)})).onMouseoverLink((function(e){var n=[{text:e.source.name+" → "+e.target.name+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];d3.select(this).style("stroke-opacity",1),i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemoveLink((function(t){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseoutLink((function(e){d3.select(this).style("stroke-opacity",t._linkOpacity),i.hide()})).eventOnDrag((function(){i.move([d3.event.offsetX,d3.event.offsetY])})),e.update(),t._interrupt)?(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",-t._fontSize).attr("width",t._width).attr("height",t._height),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",0).attr("y",-t._fontSize).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("height",t._height),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t._data;t.legend.data(e.legendData).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.legendData.forEach((function(t){t.name===i.name&&(t.active=!n)})),e.nodes.forEach((function(t){t.name===i.name&&(t.active=!n)})),t.onDataChange()}))}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new ke(t,e);return i.dataSolveFunc(Se),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.display,o=t.label,r=t.font;this._fontCopy=r,0!==Object.getOwnPropertyNames(o).length&&(this._textLabel=o.textLabel?o.textLabel:this._textLabel,this._positionChoice=o.textLabel&&o.textLabel.positionChoice?o.textLabel.positionChoice:this._positionChoice),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(a).length&&(this._nodeColor=a.nodeColor?q(a.nodeColor):null,this._linkColor=a.linkColor?q(a.linkColor):null,this._nodeBorderWidth=0==a.nodeBorderWidth||a.nodeBorderWidth?d(a.nodeBorderWidth):this._nodeBorderWidth,this._nodeBorderColor=a.nodeBorderColor?q(a.nodeBorderColor):null,this._nodeWidth=0==a.nodeWidth||a.nodeWidth?d(a.nodeWidth):this._nodeWidth,this._nodeGap=0==a.nodeGap||a.nodeGap?d(a.nodeGap):this._nodeGap,this._linkOpacity=0==a.linkOpacity||a.linkOpacity?d(a.linkOpacity):this._linkOpacity)}},{key:"activeData",get:function(){var t=this._data.nodes,e=this._data.links.filter((function(e){return t.some((function(t){return!1!==t.active&&t.key===e.source}))&&t.some((function(t){return!1!==t.active&&t.key===e.target}))})).map((function(t){return Object.assign({},t)}));return{nodes:t.filter((function(t){return!1!==t.active&&(e.some((function(e){return t.key===e.source}))||e.some((function(e){return t.key===e.target})))})).map((function(t){return Object.assign({},t)})),links:e}}}]),e}(nt),Le=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.keyArr,i=this.generateColorList(e.length);return t.legendData=e.map((function(t,e){return{name:t,color:i[e]}})),t}}]),e}(it);function Pe(t,e){var i=0,n=1,a=2;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"targetCol"===t.function?n=t.index:"vCol"===t.function&&(a=t.index)})),P(t,[i,n,a])||!A(t,a))return{keyArr:[],matrix:[],valueLabel:""};var o=[],r={},l=0;t.slice(1).forEach((function(t){var e=t[i],a=t[n];void 0===r[e]&&(r[e]=l,o.push(e),l++),void 0===r[a]&&(r[a]=l,o.push(a),l++)}));var s=d3.range(l).map((function(t){return d3.range(l).map((function(t){return 0}))}));return t.slice(1).forEach((function(t){var e=t[i],o=t[n],l=t[a],u=r[e],c=r[o];s[u][c]=Math.abs(l)||0})),{keyArr:o,matrix:s,valueLabel:t[0][a]}}var Ae=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","chord"),i.chordFunc=d3.chord(),i._innerRadius=100,i._outerRadius=120,i._padAngle=.02,i._onMouseoverChord=function(){},i._onMousemoveChord=function(){},i._onMouseoutChord=function(){},i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data.matrix,i=t._data.nodes,n=t.group;if(n.selectAll("*").remove(),!(i.length<=1)){i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t._innerRadius,r=t._outerRadius,l=t._padAngle,s=t.chordFunc.padAngle(l),u=d3.arc().innerRadius(a).outerRadius(r),h=d3.ribbon().radius(a);n.datum(s(e)).call(o,r,r);var d=n.selectAll(".arc-group").data((function(t){return t.groups}));d.exit().remove();var _=d.enter().append("g").attr("class","arc-group");_.append("path").attr("class","arc-path");var f=_.merge(d).each(t._onTransitionEnd).select("path").attr("d",u).style("fill",(function(e){return/\[/.test(i[e.index].color)?"url("+c("#"+t.id+"-index-"+e.index)+")":i[e.index].color})).style("stroke",(function(e){return/\[/.test(i[e.index].color)?"url("+c("#"+t.id+"-index-"+e.index)+")":i[e.index].color})).style("opacity","0").on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?f.style("opacity","1"):f.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity","1");var p=n.selectAll(".ribbon-path").data((function(t){return t}));p.exit().remove();var g=p.enter().append("path").attr("class","ribbon-path").merge(p).attr("d",h).style("fill",(function(e,n){return i[e.source.index].color&&/\[/.test(i[e.source.index].color)?"url("+c("#"+t.id+"-index-"+e.source.index)+")":i[e.source.index].color})).style("fill-opacity",.8).style("opacity","0").on("mouseover",t._onMouseoverChord).on("mousemove",t._onMousemoveChord).on("mouseout",t._onMouseoutChord);return t._interrupt?g.style("opacity","1"):g.transition().duration(t._transition?.8*t._duration/(s(e).length>0?s(e).length:1):0).delay((function(i,n){return t._transition?t._startDelay+n*(.8*t._duration/(s(e).length>0?s(e).length:1))+.1*t._duration:0})).style("opacity","1"),t}n.selectAll("*").remove()}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"onMouseoverChord",value:function(t){return arguments.length?(this._onMouseoverChord="function"==typeof t?t:function(){},this):this._onMouseoverChord}},{key:"onMousemoveChord",value:function(t){return arguments.length?(this._onMousemoveChord="function"==typeof t?t:function(){},this):this._onMousemoveChord}},{key:"onMouseoutChord",value:function(t){return arguments.length?(this._onMouseoutChord="function"==typeof t?t:function(){},this):this._onMouseoutChord}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),We=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","chord-chart"),e.chord=new Ae(e.mainGroup),e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveStyle="顺时针展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this,i=t.activeData,n=i.nodes,a=t.chord,o=t.tooltip,r=t.widthOfNoMargin,l=t.heightOfMainGroup,s=(t._fontSize,t._data.valueLabel),u=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,c=parseFloat(t._fontCopy?t._fontSize:t._textLabel.fontSize),h=t._fontCopy?t._fontColor:q(t._textLabel.color),d=!!t._fontCopy||t._textLabel.show,_=Math.min(r,l)/2-(d?c:0),f=.9*_;function p(t,e){"number"==typeof e?a.group.selectAll(".ribbon-path").filter((function(t){return t.source.index!==e&&t.target.index!==e})).transition().style("opacity",t):a.group.selectAll(".ribbon-path").filter((function(t){return this!==e})).transition().style("opacity",t)}a.data(i).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).innerRadius(f).outerRadius(_).translate(r/2-_,l/2-_).onMouseover((function(e){var i=e.index,a=[{color:n[i].color,text:n[i].name},{text:s+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];o.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),p(0,i)})).onMousemove((function(){o.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t){o.hide(),p(1,t.index)})).onMouseoverChord((function(e){var i=[];i=e.source.value===e.target.value?[{text:n[e.source.index].name+" ↔ "+n[e.target.index].name+"："+E(e.source.value,t._numberStyle,t._decimalPlaces)}]:[{text:n[e.source.index].name+" → "+n[e.target.index].name+"："+E(e.source.value,t._numberStyle,t._decimalPlaces)},{text:n[e.target.index].name+" → "+n[e.source.index].name+"："+E(e.target.value,t._numberStyle,t._decimalPlaces)}],o.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show(),p(.1,this)})).onMousemoveChord((function(){o.move([d3.event.offsetX,d3.event.offsetY])})).onMouseoutChord((function(t){o.hide(),p(1,this)})).onTransitionEnd((function(i){var a=d3.select(this),o="arc-path-"+i.index+"-"+t.id,r=e(_+c-2,i.startAngle,i.endAngle);D(a,t.defs.select("#"+o).empty()?t.defs.append("path").attr("d",r).attr("id",o):t.defs.select("#"+o).attr("d",r),n[i.index].name,c,u).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",h),t._interrupt?t.group.selectAll(".chart-label-text").style("display",d?"block":"none").style("opacity",1):t.group.selectAll(".chart-label-text").style("display",d?"block":"none").style("opacity",0).transition().duration(t._transition?1e3*t._duration*.1:0).delay((function(e,i){return t._transition?1e3*t._startDelay+1e3*t._duration*.9:0})).style("opacity",1)})),a.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.legend,i=t._data.legendData;e.data(i).onClick((function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach((function(t){t.name===e.name&&(t.active=!n)})),t.onDataChange()}))}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new Le(t,e);return i.dataSolveFunc(Pe),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.label,o=t.font;this._fontCopy=o,0!==Object.getOwnPropertyNames(a).length&&(this._textLabel=a.textLabel?a.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}},{key:"activeData",get:function(){var t=this._data,e=t.matrix,i=t.legendData,n=[];i.forEach((function(t,e){!1===t.active&&n.push(e)}));var a=i.filter((function(t){return!1!==t.active})),o=[];return e.forEach((function(t,e){if(n.indexOf(e)<0){var i=[];t.forEach((function(t,e){n.indexOf(e)<0&&i.push(t)})),o.push(i)}})),{nodes:a,matrix:o}}}]),i}(nt),ze=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","icon-pie"),i.defs=i.elem.append("defs"),i._width=400,i._height=400,i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._countOfOneRow=20,i._rowCount=5,i._padding=2,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._width,n=t._height,a=t._padding,o=t._icon,r=t._countOfOneRow,l=t._rowCount;t.group.selectAll("*").remove();var s=d3.sum(e,(function(t){return parseFloat(t.value)})),u=e.length,h=0,d=e.map((function(t){var e=t.value/s*(r*l),i=h+e,n=h;h=i;var a=Math.floor(e),o=!1,u=!1;return n%1!=0&&(o=!0,a++),i%1!=0&&(u=!0,a++),{percent:e,count:a,startPercent:Math.round(n),endPercent:Math.round(i),hasHead:o,hasTail:u}})),_=i/r,f=n/l,p=_-2*a,g=f-2*a,v=Math.min(p/o.width,g/o.height)*t._iconScale*1;if("single"==t._type){var m=[],b=[];t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+v+")"),t.group.append("path").attr("class","icon").attr("d",o.path).attr("transform","scale("+v+")");t.group.select(".icon-test").node().getBoundingClientRect(),t.group.select(".icon").node().getBoundingClientRect();var S=t.group.select(".icon-test").node().getBBox(),k=t.group.select(".icon").node().getBBox();if(p=o.width*v,g=o.height*v,m.push((k.x-S.x)*v),b.push((k.y-S.y)*v),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove(),function(){var n=t.group,a=t.defs,l=t.id;n.selectAll("*").remove(),a.selectAll("*").remove();var s=l+"-icon";a.append("path").attr("id",s).attr("d",o.path);for(var h=function(s){var u=d[s];if(!u.percent)return"continue";var h=Math.floor(u.startPercent),S=u.startPercent%r*_,k=Math.floor(h/r)*f,w=Math.ceil(u.endPercent),C=u.endPercent%r==0?(u.endPercent-1)%r*_+_:u.endPercent%r*_,O=(Math.ceil(w/r)-1)*f;a.append("clipPath").attr("id","clip-path-"+l+"-"+s).append("path").attr("id","icon-overlay-"+l+"-"+s).attr("d",(function(){var t=Math.floor(u.startPercent/r)<Math.floor(u.endPercent/r),e="M"+S+","+(k+f)+"V"+k+"H"+(t?i:C)+"V"+(t?O:O+f);return t&&(e+="H"+C+"v"+f+"H0V"+(k+f)),e+="Z"})).style("fill","transparent").style("opacity",0);var F="#clip-path-"+l+"-"+s,L=n.append("g").attr("clip-path","url("+c(F));if(e[s].color&&/\[/.test(e[s].color)){var P=x(e[s].color),A=[],W=!0,z=!1,M=void 0;try{for(var D,R=P[Symbol.iterator]();!(W=(D=R.next()).done);W=!0){var N=D.value,T=[],B=N.split(":");T.push(q(B[0])),T.push(B[1]),A.push(T)}}catch(t){z=!0,M=t}finally{try{!W&&R.return&&R.return()}finally{if(z)throw M}}var G=A.concat(),X=G.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+s).attr("x1",y(X[1]).x1+"%").attr("y1",y(X[1]).y1+"%").attr("x2",y(X[1]).x2+"%").attr("y2",y(X[1]).y2+"%").selectAll("stop").data(G).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}for(var j=function(i){L.append("g").attr("transform",(function(){return"translate("+i%r*_+","+Math.floor(i/r)*f+")"})).append("path").attr("class","icon-path-"+s).attr("d",o.path).attr("transform","translate("+((_-p)/2-m[0])+", "+((f-g)/2-b[0])+")scale("+v+")").style("stroke",t._borderColor||(/\[/.test(e[s].color)?"url("+c("#"+t.id+"-index-"+s)+")":e[s].color)).style("stroke-width",(t._borderWidth||0)/v).style("fill",(function(i){return e[s].color&&/\[/.test(e[s].color)?"url("+c("#"+t.id+"-index-"+s)+")":e[s].color&&/#/.test(e[s].color)?e[s].color:"rgb("+U(e[s].color,0)+","+U(e[s].color,1)+","+U(e[s].color,2)+")"})).style("fill-opacity",(function(i){if(e[s].color&&/#/.test(e[s].color))return t._fillOpacity;var n=U(e[s].color,3)||1;return t._fillOpacity*n}))},I=h;I<w;I++)j(I);L.append("use").datum({index:s,data:e[s]}).attr("xlink:href","#icon-overlay-"+l+"-"+s).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout)},S=0;S<u;S++)h(S)}(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle));else if(0==t._moveOptions.indexOf(t._moveStyle))if(t._interrupt){t.group.selectAll("path").style("opacity",1)}else{var w=t.group.selectAll("path"),C=w.nodes().length,O=0;w.style("opacity",0).transition().duration(t._transition?t._duration/C:0).delay((function(){return O<C?t._transition?t._duration/C*O+++t._startDelay:0:t._startDelay})).style("opacity",1)}}else{for(var F=t._svgArr,L=[],P=[],A=[],W=[],z=[],M=0;M<F.length;M++){var D=Math.min(p/F[M].width,g/F[M].height)*t._iconScale*1;t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+D+")"),t.group.append("path").attr("class","icon").attr("d",F[M].path).attr("transform","scale("+D+")");t.group.select(".icon-test").node().getBoundingClientRect(),t.group.select(".icon").node().getBoundingClientRect();var R=t.group.select(".icon-test").node().getBBox(),N=t.group.select(".icon").node().getBBox();L.push(D),P.push(F[M].width*D),A.push(F[M].height*D),W.push((N.x-R.x)*D),z.push((N.y-R.y)*D),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove()}if(function(){var n=t.group,a=t.defs,l=t.id;n.selectAll("*").remove(),a.selectAll("*").remove();var s=l+"-icon";a.append("path").attr("id",s).attr("d",o.path);for(var h=function(o){var s=d[o];if(!s.percent)return"continue";var u=Math.floor(s.startPercent),h=s.startPercent%r*_,p=Math.floor(u/r)*f,g=Math.ceil(s.endPercent),v=s.endPercent%r==0?(s.endPercent-1)%r*_+_:s.endPercent%r*_,m=(Math.ceil(g/r)-1)*f;a.append("clipPath").attr("id","clip-path-"+l+"-"+o).append("path").attr("id","icon-overlay-"+l+"-"+o).attr("d",(function(){var t=Math.floor(s.startPercent/r)<Math.floor(s.endPercent/r),e="M"+h+","+(p+f)+"V"+p+"H"+(t?i:v)+"V"+(t?m:m+f);return t&&(e+="H"+v+"v"+f+"H0V"+(p+f)),e+="Z"})).style("fill","transparent").style("opacity",0);var b="#clip-path-"+l+"-"+o,S=n.append("g").attr("clip-path","url("+c(b));if(e[o].color&&/\[/.test(e[o].color)){var k=x(e[o].color),w=[],C=!0,O=!1,M=void 0;try{for(var D,R=k[Symbol.iterator]();!(C=(D=R.next()).done);C=!0){var N=D.value,T=[],B=N.split(":");T.push(q(B[0])),T.push(B[1]),w.push(T)}}catch(t){O=!0,M=t}finally{try{!C&&R.return&&R.return()}finally{if(O)throw M}}var G=w.concat(),X=G.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+o).attr("x1",y(X[1]).x1+"%").attr("y1",y(X[1]).y1+"%").attr("x2",y(X[1]).x2+"%").attr("y2",y(X[1]).y2+"%").selectAll("stop").data(G).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}for(var j=function(i){S.append("g").attr("transform",(function(){return"translate("+i%r*_+","+Math.floor(i/r)*f+")"})).append("path").attr("class","icon-path-"+o).attr("d",F[o].path).attr("transform","translate("+((_-P[o])/2-W[o])+", "+((f-A[o])/2-z[o])+")scale("+L[o]+")").style("stroke",t._borderColor||(/\[/.test(e[o].color)?"url("+c("#"+t.id+"-index-"+o)+")":e[o].color)).style("stroke-width",(t._borderWidth||0)/L[o]).style("fill",(function(i){return e[o].color&&/\[/.test(e[o].color)?"url("+c("#"+t.id+"-index-"+o)+")":e[o].color&&/#/.test(e[o].color)?e[o].color:"rgb("+U(e[o].color,0)+","+U(e[o].color,1)+","+U(e[o].color,2)+")"})).style("fill-opacity",(function(i){if(e[o].color&&/#/.test(e[o].color))return t._fillOpacity;var n=U(e[o].color,3)||1;return t._fillOpacity*n}))},I=u;I<g;I++)j(I);S.append("use").datum({index:o,data:e[o]}).attr("xlink:href","#icon-overlay-"+l+"-"+o).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout)},p=0;p<u;p++)h(p)}(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle));else if(0==t._moveOptions.indexOf(t._moveStyle))if(t._interrupt){t.group.selectAll("path").style("opacity",1)}else{var T=t.group.selectAll("path"),B=T.nodes().length,G=0;T.style("opacity",0).transition().duration(t._transition?t._duration/B:0).delay((function(){return G<B?t._transition?t._duration/B*G+++t._startDelay:0:t._startDelay})).style("opacity",1)}}return t}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"svgArr",value:function(t){return arguments.length?(this._svgArr=t,this):this._svgArr}},{key:"iconScale",value:function(t){return arguments.length?(this._iconScale=t,this):this._iconScale}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"rowCount",value:function(t){return arguments.length?(this._rowCount=t,this):this._rowCount}}]),e}(at),Me=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","icon-pie-chart"),i.iconPie=new ze(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._rowCount=5,i._iconScale=1,i._countOfOneRow=20,i._borderWidth=0,i._borderColor=null,i._fillOpacity=1,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["依次出现","横向展开"],i._moveStyle="依次出现",i._endPause=0,i._interrupt=!1,i._type="single",i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.iconPie,i=t.tooltip,n=(t.AnimationArea,e.elem),a=[];if(t._pictures)if("single"==t._type){var o=t.group.append("foreignObject").attr("class","path-container");if(t._svgList[0]){o.html(t._svgList[0]).attr("class","svgIcon");var r=t.group.select(".svgIcon svg path").attr("d"),l=(t.group.append("path").attr("d",r).attr("class","icon"),t.group.select(".icon").node().getBBox());t._icon.path=r,t._icon.width=l.width,t._icon.height=l.height}t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}else for(var s=0;s<t._svgList.length;s++){var u=t.group.append("foreignObject").attr("class","path-container"),h={};if(t._svgList[s]){u.html(t._svgList[s]).attr("class","svgIcon");var d=t.group.select(".svgIcon svg path").attr("d"),_=(t.group.append("path").attr("d",d).attr("class","icon"),t.group.select(".icon").node().getBBox());h.path=d,h.width=_.width,h.height=_.height}else h.path="",h.width=1e-4,h.height=1e-4;a.push(h),t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}else{var f=t.group.append("foreignObject").attr("class","path-container");if(t._icon.path){f.html(t._icon.path).attr("class","svgIcon");var p=t._icon.path,g=(t.group.append("path").attr("d",p).attr("class","icon"),t.group.select(".icon").node().getBBox());t._icon.path=p,t._icon.width=g.width,t._icon.height=g.height}t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}if(t._borderColor&&/\[/.test(t._borderColor)){var v=x(t._borderColor),m=[],b=!0,S=!1,k=void 0;try{for(var w,C=v[Symbol.iterator]();!(b=(w=C.next()).done);b=!0){var O=w.value,F=[],L=O.split(":");F.push(q(L[0])),F.push(L[1]),m.push(F)}}catch(t){S=!0,k=t}finally{try{!b&&C.return&&C.return()}finally{if(S)throw k}}var P=m.concat(),A=P.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(A[1]).x1+"%").attr("y1",y(A[1]).y1+"%").attr("x2",y(A[1]).x2+"%").attr("y2",y(A[1]).y2+"%").selectAll("stop").data(P).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(e.data(t.activeData).width(t.widthOfNoMargin).height(t.heightOfMainGroup).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).icon(t._icon).type(t._type).svgArr(a).rowCount(t._rowCount).iconScale(t._iconScale).countOfOneRow(t._countOfOneRow).borderWidth(t._borderWidth).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).onMouseover((function(e,a){n.selectAll(".icon-path-"+e.index).style("opacity",.4);var o=[{color:e.data.color,text:e.data.name=="$-"+e.index?"":e.data.name},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];i.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t){n.selectAll(".icon-path-"+t.index).style("opacity",1),i.hide()})),e.update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle));else if(1==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("height",t.heightOfMainGroup).attr("width",t.widthOfNoMargin),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("height",t.heightOfMainGroup).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",t.widthOfNoMargin),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.pictures;0!==Object.getOwnPropertyNames(e).length&&(this._rowCount=0==e.countOfRows||e.countOfRows?e.countOfRows:this._rowCount,this._iconScale=0==e.iconScale||e.iconScale?e.iconScale:this._iconScale,this._countOfOneRow=0==e.IconsPerRow||e.IconsPerRow?e.IconsPerRow:this._countOfOneRow,this._borderWidth=0==e.iconBorderWidth||e.iconBorderWidth?e.iconBorderWidth:this._borderWidth,this._borderColor=e.iconBorderColor?q(e.iconBorderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(o).length&&(this._pictures=o||null,this._type=o?o.type:"single",this._svgList=o?o.svglist:null),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}}]),e}(nt),De=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","two-level-pie"),i._radius=0,i._each=function(){},i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t.group.selectAll("*").remove();var e=t._data,i=t._radius,n=d3.partition().size([2*Math.PI,i])(d3.hierarchy(e).sum((function(t){return t.value}))).descendants(),a=d3.arc().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(e){return 0===e.depth?0:1===e.depth?i*t._smallInnerRadiusRatio:i*(1-t._smallInnerRadiusRatio)*t._gapEndRatio+i*t._smallInnerRadiusRatio})).outerRadius((function(e){return 0===e.depth?i*t._smallInnerRadiusRatio:1===e.depth?i*(1-t._smallInnerRadiusRatio)*t._gapStartRatio+i*t._smallInnerRadiusRatio:i})).padAngle(t._gapPercentage).cornerRadius(t._cornerRadius);if(t._interrupt){t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("circle").attr("r",i>0?2*i:0)}else{t.elem.selectAll("defs").remove();var r=t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("circle");r.attr("r",0).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attr("r",i>0?i:0).on("end",(function(){return r.attr("r",2*i)}))}var l=t.group.call(o,i,i).attr("clip-path","url("+c("#overlay-"+t.id)+")");n.filter((function(t){return 0!==t.depth})).forEach((function(e,i){if(e.data.color&&/\[/.test(e.data.color)){var n=x(e.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _,f=[];_=(f=a.concat()).pop(),t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(_[1]).x1+"%").attr("y1",y(_[1]).y1+"%").attr("x2",y(_[1]).x2+"%").attr("y2",y(_[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var s=l.selectAll("g").data(n.filter((function(t){return 0!==t.depth})),(function(t){return t.data.key}));s.exit().remove();var u=s.enter().append("g");return u.append("path"),u.merge(s).select("path").attr("class","arc-path").attr("d",a).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&(/#/.test(e.data.color)||/\[/.test(e.data.color)))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._borderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._borderWidth||0).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).each(t._each),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"each",value:function(t){return arguments.length?(this._each="function"==typeof t?t:function(){},this):this._each}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"gapPercentage",value:function(t){return arguments.length?(this._gapPercentage=t,this):this._gapPercentage}},{key:"smallInnerRadiusRatio",value:function(t){return arguments.length?(this._smallInnerRadiusRatio=t,this):this._smallInnerRadiusRatio}},{key:"gapStartRatio",value:function(t){return arguments.length?(this._gapStartRatio=t,this):this._gapStartRatio}},{key:"gapEndRatio",value:function(t){return arguments.length?(this._gapEndRatio=t,this):this._gapEndRatio}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}}]),e}(ot),Re=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.nodes,i=this.generateColorList(e.length);return e.forEach((function(t,e){var n=i[e];t.color=n})),t}}]),e}(it);function Ne(t,e){var i=0,n=1,a=2;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"typeCol"===t.function?n=t.index:"vCol"===t.function&&(a=t.index)})),P(t,[i,n,a])||!A(t,a))return{nodes:[],valueLabel:""};var o={};t.slice(1).forEach((function(t,e){var r=t[i],l=t[n],s=t[a];o[r]?o[r].children.push({name:null==l?"":l,key:l+"-t-"+e,index:e,value:""==s||isNaN(parseFloat(s))||null==s||null==s?0:parseFloat(s)}):o[r]={name:r,key:r+"-s-"+e,index:e,children:[{name:null==l?"":l,key:l+"-t-"+e,index:e,value:""==s||isNaN(parseFloat(s))||null==s||null==s?0:parseFloat(s)}]}}));var r=[];for(var l in o)r.push(o[l]);return r.forEach((function(t){return t.sum=d3.sum(t.children,(function(t){return t.value}))})),{nodes:r,valueLabel:t[0][a]}}var Te=function(t){function e(t){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return w(e,t),S(e,[{key:"updateCore",value:function(){}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.nodes,i=e.map((function(t,e){return{name:t.name,color:t.color,key:t.name+"-"+e}}));t.legend.data(i).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),i.forEach((function(t){t.key===n.key&&(t.active=!a)})),e.forEach((function(t){t.name===n.name&&(t.active=!a)})),t.onDataChange()}))}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new Re(t,e);return i.dataSolveFunc(Ne),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter((function(t){return!1!==t.active}))}}}]),e}(nt),Be=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","two-level-donut-chart"),e.core=new De(e.mainGroup),e.lineText=new lt(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._labelShow=!0,e._positionOptions=["外部","内部"],e._positionChoice="内部",e._contentOption=["名称","百分比","数值"],e._contentChoice=["名称"],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e._smallInnerRadiusRatio="0.3",e._circleGapRange=["0.5","0.52"],e._borderColor=null,e._borderWidth="1",e._cornerRadius="5",e._gapPercentage="0.02",e._fillOpacity="1",e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this,i=t.core,n=t.tooltip,a=t.lineText,o=t.activeData,r=d3.sum(o.children,(function(t){return parseFloat(t.sum)}));function l(t){return new Function("return "+t)()}for(var s=[],u=[],h=0;h<o.children.length;h++)for(var d=0;d<o.children[h].children.length;d++){o.children[h].children[d].percent=-1==String(o.children[h].children[d].value/r*100).indexOf(".")?parseFloat(o.children[h].children[d].value/r*100):parseFloat((o.children[h].children[d].value/r*100).toFixed(2));var _=d3.scaleLinear().clamp(!1).domain([0,1]);if(o.children[h].color&&/\[/.test(o.children[h].color)){var f=l(o.children[h].color),p=[],x=!0,g=!1,v=void 0;try{for(var m,b=f[Symbol.iterator]();!(x=(m=b.next()).done);x=!0){var S=m.value,k=S.split(":");if("angle"!=k[0]){var w=d3.hsl(q(k[0])),C=o.children[h].children.length;if(1===C)w.l+=.08;else{_.range([w.l+Math.min(.4,.08*C)/2,w.l-Math.min(.4,.08*C)/2]);var O=o.children[h].children.indexOf(o.children[h].children[d])/(C-1);w.l=_(O)}var F="";w&&(F=w+":"+k[1]),p.push(F)}else p.push(S)}}catch(t){g=!0,v=t}finally{try{!x&&b.return&&b.return()}finally{if(g)throw v}}var L=JSON.stringify(p);o.children[h].children[d].color=L}else{var P=d3.hsl(o.children[h].color),A=o.children[h].children.length;if(1===A)P.l+=.08;else{_.range([P.l+Math.min(.4,.08*A)/2,P.l-Math.min(.4,.08*A)/2]);var W=o.children[h].children.indexOf(o.children[h].children[d])/(A-1);P.l=_(W)}o.children[h].children[d].color=P.toString()}s.push(o.children[h].children[d]),u.push(o.children[h].children[d].name)}var z=t._data.valueLabel,M=.88*t.widthOfNoMargin,R=.88*t.heightOfMainGroup;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)M=.88*t.widthOfNoMargin,R=.88*t.heightOfMainGroup;else if(0==t._labelShow||1==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice))M=.88*t.widthOfNoMargin,R=.88*t.heightOfMainGroup;else{var N=[];if(0==t._positionOptions.indexOf(t._positionChoice))if(1==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0]))for(var T=0;T<o.children.length;T++)for(var B=0;B<o.children[T].children.length;B++)N.push(o.children[T].children[B].name);else if(1==t._contentOption.indexOf(t._contentChoice[0]))for(var X=0;X<o.children.length;X++)for(var j=0;j<o.children[X].children.length;j++)N.push(E(o.children[X].children[j].percent,t._numberStyle,t._decimalPlaces)+"%");else if(2==t._contentOption.indexOf(t._contentChoice[0]))for(var I=0;I<o.children.length;I++)for(var Y=0;Y<o.children[I].children.length;Y++)N.push(E(o.children[I].children[Y].value,t._numberStyle,t._decimalPlaces)+t._suffix)}else if(2==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var H=0;H<o.children.length;H++)for(var V=0;V<o.children[H].children.length;V++)N.push(o.children[H].children[V].name),N.push(E(o.children[H].children[V].percent,t._numberStyle,t._decimalPlaces)+"%");else if(0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var $=0;$<o.children.length;$++)for(var U=0;U<o.children[$].children.length;U++)N.push(o.children[$].children[U].name),N.push(E(o.children[$].children[U].value,t._numberStyle,t._decimalPlaces)+t._suffix);else if(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))for(var Z=0;Z<o.children.length;Z++)for(var Q=0;Q<o.children[Z].children.length;Q++)N.push(E(o.children[Z].children[Q].value,t._numberStyle,t._decimalPlaces)+t._suffix),N.push(E(o.children[Z].children[Q].percent,t._numberStyle,t._decimalPlaces)+"%")}else for(var K=0;K<o.children.length;K++)for(var J=0;J<o.children[K].children.length;J++)N.push(o.children[K].children[J].name),N.push(E(o.children[K].children[J].value,t._numberStyle,t._decimalPlaces)+t._suffix),N.push(E(o.children[K].children[J].percent,t._numberStyle,t._decimalPlaces)+"%");var tt=G(N,t._textLabel.fontSize,t._textLabel.fontFamily);tt>.4*t.widthOfNoMargin&&(tt=.4*t.widthOfNoMargin),M=.83*t.widthOfNoMargin-2*tt,R=.74*t.heightOfMainGroup}var et=Math.min(M,R)/2,it=t.defs;it.selectAll("filter").remove();var nt=it.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_twoLevelPie").attr("filterUnits","objectBoundingBox");nt.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),nt.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),nt.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),nt.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),nt.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var at=void 0,ot=void 0;2==t._circleGapRange.length?null!=t._circleGapRange[0]&&""!=t._circleGapRange[0]||null!=t._circleGapRange[1]&&""!=t._circleGapRange[1]?null==t._circleGapRange[0]||""==t._circleGapRange[0]?(at=0,ot=d3.max(t._circleGapRange.filter(String||Number))):null==t._circleGapRange[1]||""==t._circleGapRange[1]?(at=d3.min(t._circleGapRange.filter(String||Number)),ot=1):(at=d3.min(t._circleGapRange),ot=d3.max(t._circleGapRange)):(at=0,ot=1):(at=0,ot=0);t._smallInnerRadiusRatio,t._smallInnerRadiusRatio;if(t._borderColor&&/\[/.test(t._borderColor)){var rt=l(t._borderColor),lt=[],st=!0,ut=!1,ct=void 0;try{for(var ht,dt=rt[Symbol.iterator]();!(st=(ht=dt.next()).done);st=!0){var _t=ht.value,ft=[],pt=_t.split(":");ft.push(q(pt[0])),ft.push(pt[1]),lt.push(ft)}}catch(t){ut=!0,ct=t}finally{try{!st&&dt.return&&dt.return()}finally{if(ut)throw ct}}var yt=lt.concat(),xt=yt.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(xt[1]).x1+"%").attr("y1",y(xt[1]).y1+"%").attr("x2",y(xt[1]).x2+"%").attr("y2",y(xt[1]).y2+"%").selectAll("stop").data(yt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(t.activeData).smallInnerRadiusRatio(t._smallInnerRadiusRatio).gapStartRatio(at).gapEndRatio(ot).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).borderWidth(t._borderWidth).cornerRadius(t._cornerRadius).gapPercentage(t._gapPercentage).fillOpacity(t._fillOpacity).radius(et).translate(t.widthOfNoMargin/2-et,t.heightOfMainGroup/2-et).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).onMouseover((function(e){var i=-1==String(e.value).indexOf(".")?e.data.value||e.value:1==e.height?parseFloat(e.value.toFixed(2)):e.data.value,a=[{color:e.data.color||e.parent.data.color,text:e.data.name},{text:z+"："+E(i,t._numberStyle,t._decimalPlaces)}];n.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this).transition().duration(20).style("opacity",.7)})).onMousemove((function(){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){n.hide(),d3.select(this).transition().duration(20).style("opacity",1)})).each((function(i,n){var a=d3.select(this.parentNode),o="arc-path-"+n+"-two-level-pie-"+i.depth+"-"+t.id,r=e(1===i.depth?et*(1-t._smallInnerRadiusRatio)*at*.5+et*t._smallInnerRadiusRatio:et-et*(1-t._smallInnerRadiusRatio)*(1-ot)*.5,i.x0,i.x1),l=t.defs.select("#"+o).empty()?t.defs.append("path").attr("d",r).attr("id",o):t.defs.select("#"+o).attr("d",r);0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?t.group.selectAll(".chart-label-text").style("display","none"):0!=t._positionOptions.indexOf(t._positionChoice)&&1!=t._positionOptions.indexOf(t._positionChoice)||!i.children?1!=t._positionOptions.indexOf(t._positionChoice)||i.children||(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,i.data.name,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):1==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentOption.indexOf(t._contentChoice[0])&&D(a,l,E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,i.data.name+"  "+i.data.percent+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,i.data.name+"  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==t._contentChoice.length&&D(a,l,i.data.name+"  "+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve")):D(a,l,i.data.name,t._textLabel.fontSize,t._textLabel.fontFamily,"52%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily),t._interrupt?t.group.selectAll(".chart-label-text").style("opacity",1):t.group.selectAll(".chart-label-text").style("opacity",0).transition().duration(t._transition?1e3*t._duration*.1:0).delay((function(e,i){return t._transition?1e3*t._duration*.9:0})).style("opacity",1)})),null!=t._labelShow&&(0!=t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(a.data(s).outerRadius(et).cornerRadius(t._cornerRadius).startAngle(t._startAngle).endAngle(t._endAngle).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).values(s).level("two").transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.lineText.translate(t.widthOfNoMargin/2,t.heightOfMainGroup/2).update(),t.group.select(".outside-text-polygon").attr("display","block")):0!=t._labelShow&&1!=t._positionOptions.indexOf(t._positionChoice)&&-1!=t._positionOptions.indexOf(t._positionChoice)||t.group.select(".outside-text-polygon").attr("display","none")),i.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._smallInnerRadiusRatio=0==e.smallInnerRadiusRatio||e.smallInnerRadiusRatio?d(e.smallInnerRadiusRatio):this._smallInnerRadiusRatio,this._borderColor=e.borderColor?q(e.borderColor):"",this._borderWidth=0==e.borderWidth||e.borderWidth?d(e.borderWidth):this._borderWidth,this._cornerRadius=0==e.cornerRadius||e.cornerRadius?d(e.cornerRadius):this._cornerRadius,this._gapPercentage=0==parseFloat(e.gapPercentage)||e.gapPercentage?d(e.gapPercentage/10):this._gapPercentage,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?d(e.fillOpacity):this._fillOpacity,this._circleGapRange=e.circleGapRange?e.circleGapRange:this._circleGapRange),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),i}(Te),Ge=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.nodes,i=this.generateColorList(e.length);return e.forEach((function(t,e){return t.color=i[e]})),t}}]),e}(it);function Xe(t,e){var i=0,n=1;return e.forEach((function(t){"objCol"===t.function?i=t.index:"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n)?{nodes:[],valueLabel:""}:{nodes:t.slice(1).map((function(t,e){return{name:t[i],key:t[i]+"-"+e,value:t[n]}})),valueLabel:t[0][n]}}var je=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","treemap"),i._width=400,i._height=400,i._paddingInner=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=t._fontSize,a=t._fontFamily;if(e.children.length<1)return i.selectAll("*").remove(),t;var o=d3.treemap().size([t._width,t._height]).paddingInner(t._paddingInner).round(!0),r=d3.hierarchy(e).sum((function(t){return t.value}));o(r),i.selectAll("*").remove(),i.selectAll(".node").remove(),r.leaves().forEach((function(e,i){if(e.data.color&&/\[/.test(e.data.color)){var n=x(e.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var l=i.selectAll(".node").data(r.leaves(),(function(t){return t.data.key}));l.exit().remove();var s=l.enter().append("g").attr("class","node");s.append("path").attr("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).attr("stroke-width",t._strokeWidth||0).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).attr("d",(function(e,i){return f({x:0,y:0,width:0,height:0,cornerRadius:t._barCornerRadius})}));var u=s.merge(l).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?u.transition().duration(0).delay(0).on("end",t._onTransitionEnd).select("path").attr("d",(function(e,i){return f({x:e.x0,y:e.y0,width:e.x1-e.x0,height:e.y1-e.y0,cornerRadius:t._barCornerRadius})})):u.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).on("end",t._onTransitionEnd).select("path").attr("d",(function(e,i){return f({x:e.x0,y:e.y0,width:e.x1-e.x0,height:e.y1-e.y0,cornerRadius:t._barCornerRadius})}));t.group.selectAll(".one-level-treemap-group").remove();var h=i.append("g").selectAll("g").data(r.leaves(),(function(t){return t.data.key}));return h.exit().remove(),h.enter().append("g").attr("class","one-level-treemap-group").merge(h).each((function(e,i){var o=e.y1-e.y0,r=e.x1-e.x0,l=d3.select(this).append("g").attr("class","one-level-treemap-texts").attr("transform",(function(){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?"translate("+(e.x0+6)+","+(e.y0+6)+")":1==t._positionOptions.indexOf(t._positionChoice)?"translate("+((e.x1-e.x0)/2+e.x0)+","+((e.y1-e.y0)/2+e.y0)+")":void 0})).attr("font-size",n+"px").attr("font-family",a).attr("text-anchor",(function(){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?"start":1==t._positionOptions.indexOf(t._positionChoice)?"middle":void 0})).style("fill",t._fontColor);o>parseFloat(n)+10&&(l.append("text").attr("class","one-level-treemap-name").attr("dy","0.75em").text(X(null==e.data.name?"":e.data.name,r-10,n,a)),o>2*parseFloat(n)+10&&l.append("text").attr("class","one-level-treemap-percent").attr("dy","2em").text(X(isNaN(parseFloat(e.data.value))?"":E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%",r-10,n,a)),o>3*parseFloat(n)+10&&l.append("text").attr("class","one-level-treemap-value").attr("dy","3.25em").text(X(isNaN(parseFloat(e.data.value))?"":E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,r-10,n,a)))})),t._interrupt?t.group.selectAll(".one-level-treemap-group").style("opacity",1):t.group.selectAll(".one-level-treemap-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?t.group.selectAll(".one-level-treemap-group").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)?1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".one-level-treemap-name").style("display","block"),t.group.selectAll(".one-level-treemap-percent").style("display","none"),t.group.selectAll(".one-level-treemap-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".one-level-treemap-name").style("display","none"),t.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.75em"),t.group.selectAll(".one-level-treemap-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".one-level-treemap-name").style("display","none"),t.group.selectAll(".one-level-treemap-percent").style("display","none"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","0.75em")):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".one-level-treemap-name").style("display","block"),t.group.selectAll(".one-level-treemap-percent").style("display","block"),t.group.selectAll(".one-level-treemap-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".one-level-treemap-name").style("display","block"),t.group.selectAll(".one-level-treemap-percent").style("display","none"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","2em")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".one-level-treemap-name").style("display","none"),t.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.75em"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","2em")):3==t._contentChoice.length&&(t.group.selectAll(".one-level-treemap-name").style("display","block"),t.group.selectAll(".one-level-treemap-percent").style("display","block"),t.group.selectAll(".one-level-treemap-value").style("display","block")):1==t._positionOptions.indexOf(t._positionChoice)&&(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","0.5em"),t.group.selectAll(".one-level-treemap-percent").style("display","none"),t.group.selectAll(".one-level-treemap-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".one-level-treemap-name").style("display","none"),t.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.5em"),t.group.selectAll(".one-level-treemap-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".one-level-treemap-name").style("display","none"),t.group.selectAll(".one-level-treemap-percent").style("display","none"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","0.5em")):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","-0.125em"),t.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","1.125em"),t.group.selectAll(".one-level-treemap-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","-0.125em"),t.group.selectAll(".one-level-treemap-percent").style("display","none"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","1.125em")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".one-level-treemap-name").style("display","none"),t.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","-0.125em"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","1.125em")):3==t._contentChoice.length&&(t.group.selectAll(".one-level-treemap-name").style("display","block").attr("dy","-0.75em"),t.group.selectAll(".one-level-treemap-percent").style("display","block").attr("dy","0.5em"),t.group.selectAll(".one-level-treemap-value").style("display","block").attr("dy","1.75em"))),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ie=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","one-level-treemap-chart"),i.treemap=new je(i.mainGroup),i._sortValue=null,i._marginLeft=24,i._marginRight=24,i._labelShow=!0,i._positionOptions=["内部左上","内部居中"],i._positionChoice="内部左上",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称","数值"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._barCornerRadius=0,i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._gap=1,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="对角拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.treemap,i=t.tooltip,n=t.widthOfNoMargin,a=.96*t.heightOfMainGroup,o=t._data.valueLabel,r=(t._fontSize,t._fontFamily,t.activeData),l=0,s=0;s<(0==r.length?0:r.children.length);s++)l+=isNaN(parseFloat(r.children[s].value))?0:parseFloat(r.children[s].value);for(var u=0;u<r.children.length;u++){var h=isNaN(parseFloat(r.children[u].value))?0:parseFloat(r.children[u].value);r.children[u].percent=-1==String(h/l*100).indexOf(".")?parseFloat(h/l*100):parseFloat((h/l*100).toFixed(2))}var d=t.defs;d.selectAll("filter").remove();var _=d.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_one_treemap").attr("filterUnits","objectBoundingBox");if(_.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),_.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),_.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),_.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),_.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t._borderColor&&/\[/.test(t._borderColor)){var f=x(t._borderColor),p=[],g=!0,v=!1,m=void 0;try{for(var b,S=f[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),p.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=p.concat(),F=O.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).width(n).height(a).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e){var n=[{color:e.data.color,text:e.data.name},{text:o+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this).select("path").style("opacity",.7)})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){i.hide(),d3.select(this).select("path").style("opacity",t._fillOpacity)})).onTransitionEnd((function(t){})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.nodes;t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"sortData",value:function(){-1===this._sortValue&&this._data.nodes.sort((function(t,e){return e.value-t.value})),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barCornerRadius=0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._gap=0==e.gapDistance||e.gapDistance?e.gapDistance:this._gap),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new Ge(t,e);return i.dataSolveFunc(Xe),i}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter((function(t){return!1!==t.active}))}}}]),e}(nt),Ye=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","two-level-treemap"),i._clipId="clip-overlay-"+i.id,i.overlayRect=i.elem.append("defs").append("clipPath").attr("id",i._clipId).append("rect"),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleLinear(),i._width=400,i._height=400,i._paddingInner=0,i._paddingOuter=0,i._stroke="#fff",i._parentFillOpacity=.7,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t.group.attr("clip-path","url("+c("#"+t._clipId)+")");var e=t._data,i=t.group;if(t._interrupt?i.style("opacity",1):i.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1),e.children.length<1)return i.selectAll("*").remove(),t;i.selectAll("*").remove();var n=!1,a=!1,o=t._width,r=t._height,l=t.xScale.domain([0,1]).range([0,o+t._paddingInner]),s=t.yScale.domain([0,1]).range([0,r+t._paddingInner]),u=d3.hierarchy(e).sum((function(t){return t.value}));function h(){var e=(i.select(".children-group").empty()?i.append("g").attr("class","children-group"):i.select(".children-group")).selectAll(".child-node").data(u.leaves(),(function(t){return t.data.key}));e.exit().remove();var o=e.enter().append("g").attr("class","child-node");(o.append("path").attr("stroke",(function(e){return t._strokeColor||(/\[/.test(e.parent.data.color)?"url("+c("#"+t.id+"-index-"+e.parent.data.index)+")":e.parent.data.color)})).attr("stroke-width",t._strokeWidth||0).style("fill",(function(e){var i=e.parent.data.color;return i&&/\[/.test(i)?"url("+c("#"+t.id+"-index-"+e.parent.data.index)+")":i&&/#/.test(i)?i:"rgb("+U(i,0)+","+U(i,1)+","+U(i,2)+")"})).style("fill-opacity",(function(e){var i=e.parent.data.color;if(i&&/#/.test(i))return t._fillOpacity;var n=U(i,3)||1;return t._fillOpacity*n})).attr("d",(function(e,i){return f({x:0,y:0,width:0,height:0,cornerRadius:t._barCornerRadius})})),t._interrupt)?o.merge(e).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).on("click",(function(){a=!0,_(u)})).transition().duration(0).delay(0).on("start",n?t._onTransitionStart:null).on("end.a",n?t._onTransitionEnd:null).on("end.b",(function(){a=!1})).select("path").attr("d",(function(e,i){return f({x:l(e.x0),y:s(e.y0),width:l(e.x1)-l(e.x0)-t._paddingInner>0?l(e.x1)-l(e.x0)-t._paddingInner:0,height:s(e.y1)-s(e.y0)-t._paddingInner>0?s(e.y1)-s(e.y0)-t._paddingInner:0,cornerRadius:t._barCornerRadius})})).style("opacity",1):o.merge(e).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).on("click",(function(){a=!0,_(u)})).transition().duration(t._transition||a?.9*t._duration:0).delay(t._transition||a?t._startDelay:0).on("start",n?t._onTransitionStart:null).on("end.a",n?t._onTransitionEnd:null).on("end.b",(function(){a=!1})).select("path").attr("d",(function(e,i){return f({x:l(e.x0),y:s(e.y0),width:l(e.x1)-l(e.x0)-t._paddingInner>0?l(e.x1)-l(e.x0)-t._paddingInner:0,height:s(e.y1)-s(e.y0)-t._paddingInner>0?s(e.y1)-s(e.y0)-t._paddingInner:0,cornerRadius:t._barCornerRadius})})).style("opacity",1)}function d(){var e=i.select(".parent-group").empty()?i.append("g").attr("class","parent-group"):i.select(".parent-group"),o=u.descendants().filter((function(t){return 1===t.depth})),r=e.selectAll(".parent-node").data(o,(function(t){return t.data.key}));r.exit().remove();var h=r.enter().append("g").attr("class","parent-node");(h.append("path").style("fill",(function(e){return/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+e.data.index)+")":e.data.color})).style("fill-opacity",t._parentFillOpacity*t._fillOpacity).attr("stroke",(function(e){return t._strokeColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+e.data.index)+")":e.data.color)})).attr("stroke-width",t._strokeWidth||0).attr("d",(function(e,i){return f({x:0,y:0,width:0,height:0,cornerRadius:t._barCornerRadius})})),t._interrupt)?h.merge(r).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).on("click",(function(t){a=!0,_(t)})).transition().duration(0).delay(0).on("start.a",n?null:t._onTransitionStart).on("start.b",(function(){e.style("display",n?"none":"block")})).on("end",n?null:t._onTransitionEnd).select("path").attr("d",(function(e,i){return f({x:l(e.x0),y:s(e.y0),width:l(e.x1)-l(e.x0)-t._paddingInner>0?l(e.x1)-l(e.x0)-t._paddingInner:0,height:s(e.y1)-s(e.y0)-t._paddingInner>0?s(e.y1)-s(e.y0)-t._paddingInner:0,cornerRadius:t._barCornerRadius})})).style("opacity",1):h.merge(r).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).on("click",(function(t){a=!0,_(t)})).transition().duration(t._transition||a?t._duration:0).delay(t._transition||a?t._startDelay:0).on("start.a",n?null:t._onTransitionStart).on("start.b",(function(){e.style("display",n?"none":"block")})).on("end",n?null:t._onTransitionEnd).select("path").attr("d",(function(e,i){return f({x:l(e.x0),y:s(e.y0),width:l(e.x1)-l(e.x0)-t._paddingInner>0?l(e.x1)-l(e.x0)-t._paddingInner:0,height:s(e.y1)-s(e.y0)-t._paddingInner>0?s(e.y1)-s(e.y0)-t._paddingInner:0,cornerRadius:t._barCornerRadius})})).style("opacity",1)}function _(t){var e=t.depth;l.domain([t.x0,t.x1]),s.domain([t.y0,t.y1]),1===e?(n=!0,h(),d()):(n=!1,h(),d())}return d3.treemap().size([1,1]).round(!1)(u),t.overlayRect.attr("x",.5*-t._strokeWidth).attr("y",.5*-t._strokeWidth).attr("width",o+1*t._strokeWidth).attr("height",r+1*t._strokeWidth),u.descendants().filter((function(t){return 1===t.depth})).forEach((function(e,i){if(e.data.color&&/\[/.test(e.data.color)){var n=x(e.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+e.data.index).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),_(u),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}}]),e}(at),He=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","two-level-treemap-chart"),i.treemap=new Ye(i.mainGroup),i._sortValue=null,i._labelShow=!0,i._positionOptions=["内部左上","内部居中"],i._positionChoice="内部左上",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称","数值"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._barCornerRadius=0,i._borderWidth=0,i._borderColor="#FFFFFF",i._fillOpacity=1,i._gap=2,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="对角拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.treemap,i=t.tooltip,n=t.widthOfNoMargin,a=.96*t.heightOfMainGroup,o=t._data.valueLabel,r=(t._fontSize,t._fontFamily),l=t.activeData,s=0,u=0;u<l.children.length;u++)s+=l.children[u].sum;for(var h=0;h<l.children.length;h++){l.children[h].percent=-1==String(l.children[h].sum/s*100).indexOf(".")?parseFloat(l.children[h].sum/s*100):parseFloat((l.children[h].sum/s*100).toFixed(2));for(var d=0;d<l.children[h].children.length;d++){var _=parseFloat(l.children[h].children[d].value)/l.children[h].sum*100;l.children[h].children[d].percent=-1==String(_).indexOf(".")?parseFloat(_):parseFloat(_.toFixed(2))}}if(t._borderColor&&/\[/.test(t._borderColor)){var f=x(t._borderColor),p=[],g=!0,v=!1,m=void 0;try{for(var b,S=f[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),p.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=p.concat(),F=O.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).width(n).height(a).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).onMouseover((function(e){var n=-1==String(e.value).indexOf(".")?e.value:e.value.toFixed(2),a=[{color:e.data.color||e.parent.data.color,text:e.data.name},{text:o+"："+E(n,t._numberStyle,t._decimalPlaces)}];i.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this).select("path").style("opacity",.5)})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){i.hide(),d3.select(this).select("path").style("opacity",1)})).onTransitionStart((function(){e.elem.selectAll(".two-level-treemap-texts").remove()})).onTransitionEnd((function(i){var n=e.xScale,a=e.yScale,o=a(i.y1)-a(i.y0),l=n(i.x1)-n(i.x0),s=d3.select(this).append("g").attr("class","two-level-treemap-texts").attr("transform",(function(){return null==t._positionOptions||null==t._positionChoice?"translate("+-t._gap/2+","+-t._gap/2+")":0==t._positionOptions.indexOf(t._positionChoice)?"translate("+(n(i.x0)+6)+","+(a(i.y0)+6)+")":1==t._positionOptions.indexOf(t._positionChoice)?"translate("+((n(i.x1)-n(i.x0))/2+n(i.x0)-t._gap/2)+","+((a(i.y1)-a(i.y0))/2+a(i.y0)-t._gap/2)+")":void 0})).style("font-size",t._textLabel.fontSize+"px").style("font-family",t._textLabel.fontFamily).style("fill",q(t._textLabel.color)).attr("text-anchor",(function(){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?"start":1==t._positionOptions.indexOf(t._positionChoice)?"middle":void 0})),u="";if(o>parseFloat(t._textLabel.fontSize)+10){u=X(i.data.name,l-10,t._textLabel.fontSize,r),s.append("text").attr("class","two-level-treemap-name").attr("dy","0.75em").text(u),s.append("text").attr("class","two-level-treemap-percent").attr("dy","2em").text(X(E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",l-10,t._textLabel.fontSize,r));var c=1==i.height?-1==String(i.value).indexOf(".")?i.value:i.value.toFixed(2):i.value;s.append("text").attr("class","two-level-treemap-value").attr("dy","3.25em").text(X(E(c+t._suffix,t._numberStyle,t._decimalPlaces),l-10,t._textLabel.fontSize,r))}0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?t.group.selectAll(".two-level-treemap-texts").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)?1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".two-level-treemap-name").style("display","block"),t.group.selectAll(".two-level-treemap-percent").style("display","none"),t.group.selectAll(".two-level-treemap-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".two-level-treemap-name").style("display","none"),t.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.75em"),t.group.selectAll(".two-level-treemap-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".two-level-treemap-name").style("display","none"),t.group.selectAll(".two-level-treemap-percent").style("display","none"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","0.75em")):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".two-level-treemap-name").style("display","block"),t.group.selectAll(".two-level-treemap-percent").style("display","block"),t.group.selectAll(".two-level-treemap-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".two-level-treemap-name").style("display","block"),t.group.selectAll(".two-level-treemap-percent").style("display","none"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","2em")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".two-level-treemap-name").style("display","none"),t.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.75em"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","2em")):3==t._contentChoice.length&&(t.group.selectAll(".two-level-treemap-name").style("display","block"),t.group.selectAll(".two-level-treemap-percent").style("display","block"),t.group.selectAll(".two-level-treemap-value").style("display","block")):1==t._positionOptions.indexOf(t._positionChoice)&&(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","0.5em"),t.group.selectAll(".two-level-treemap-percent").style("display","none"),t.group.selectAll(".two-level-treemap-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".two-level-treemap-name").style("display","none"),t.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.5em"),t.group.selectAll(".two-level-treemap-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".two-level-treemap-name").style("display","none"),t.group.selectAll(".two-level-treemap-percent").style("display","none"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","0.5em")):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","-0.125em"),t.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","1.125em"),t.group.selectAll(".two-level-treemap-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","-0.125em"),t.group.selectAll(".two-level-treemap-percent").style("display","none"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","1.125em")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".two-level-treemap-name").style("display","none"),t.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","-0.125em"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","1.125em")):3==t._contentChoice.length&&(t.group.selectAll(".two-level-treemap-name").style("display","block").attr("dy","-0.75em"),t.group.selectAll(".two-level-treemap-percent").style("display","block").attr("dy","0.5em"),t.group.selectAll(".two-level-treemap-value").style("display","block").attr("dy","1.75em"))),t._interrupt?t.group.selectAll(".two-level-treemap-texts").style("opacity",1):t.group.selectAll(".two-level-treemap-texts").style("opacity",0).transition().duration(t._transition?1e3*t._duration*.1:0).style("opacity",1)})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return e.sum-t.sum||t.index-e.index}))})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return t.sum-e.sum||t.index-e.index}))})),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barCornerRadius=0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._gap=0==e.gapDistance||e.gapDistance?e.gapDistance:this._gap),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),e}(Te);function Ee(t,e){var i=0,n=0;if(e.forEach((function(t){"sourceCol"===t.function?i=t.index:"targetCol"===t.function&&(n=t.index)})),P(t,[i,n]))return{nodesObj:{},nodesArr:[],root:{}};for(var a=[],o={},r=0,l=t.length,s=1;s<l;s++){var u=t[s],c=u[i],h=u[n];if(c&&h&&c!==h){if(!o[c]){var d={name:c,index:r};o[c]=d,a.push(d),r++}if(!o[h]){var _={name:h,index:r};o[h]=_,a.push(_),r++}var f=o[c],p=o[h];p.parent||(p.parent=f,f.children?f.children.push(p):f.children=[p])}}var y=null,x=a.filter((function(t){return!t.parent}));return Ve(y=1===x.length?x[0]:x.length>1?{name:"",children:x}:{name:"",children:[]}),{nodesObj:o,nodesArr:a,root:y}}function Ve(t){var e=t.depth?t.depth:t.depth=0;t.children&&t.children.forEach((function(t){t.depth=e+1,Ve(t)}))}function $e(t,e){var i=Ee(t[0],e[0]),n=Xe(t[1],e[1]);return i.nodesArr.forEach((function(t){n.nodes.forEach((function(e){t.name===e.name&&(t.value=e.value)}))})),{root:i.root,valueLabel:n.valueLabel}}var qe=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=t.root;if(e&&e.children){var i=e.children.slice(0);e.name&&i.unshift(e),$(i,this.generateColorList(i.length))}return{root:t.root,valueLabel:t.valueLabel}}}]),e}(it),Ue=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","sunburst"),i.arcFunc=d3.arc(),i._radius=200,i._stroke="#fff",i._duration=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t.group.selectAll("*").remove(),t._interrupt?t.group.style("opacity",1):t.group.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1);var e=t._data,i=t._radius,n=d3.hierarchy(e).sum((function(t){return t.value})),a=2*Math.PI,o=d3.partition().size([a,i]);o(n),function(t){var e=.075,i=e;function n(t,a){if(t.depth>1){var o=t.parent,r=o.children.length-1,l=Math.pow(-1,t.depth);if(o.data.color&&/\[/.test(o.data.color)){var s=x(o.data.color),u=[],c=!0,h=!1,d=void 0;try{for(var _,f=s[Symbol.iterator]();!(c=(_=f.next()).done);c=!0){var p=_.value,y=p.split(":");if("angle"!=y[0]){var g=d3.hsl(q(y[0])),v=g.l;i=l<0&&v<e*r?v/(r+2):l>0&&1-v<e*r?(1-v)/(r+2):e,g.l+=i*a*l;var m="";g.toString()&&(m=g.toString()+":"+y[1]),u.push(m)}else u.push(p)}}catch(t){h=!0,d=t}finally{try{!c&&f.return&&f.return()}finally{if(h)throw d}}t.data.color=JSON.stringify(u)}else{var b=d3.hsl(o.data.color),S=b.l;i=l<0&&S<e*r?S/(r+2):l>0&&1-S<e*r?(1-S)/(r+2):e,b.l+=i*a*l,t.data.color=b.toString()}}var k=t.children;k&&k.forEach((function(t,e){n(t,e)}))}n(t)}(n);var r=t.arcFunc.innerRadius((function(t){return Math.max(0,t.y0)})).outerRadius((function(t){return Math.max(0,t.y1)})).startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})),l=t.group,s=!1,u={oldState:_(n),newState:_(n),currentRootNode:n,currentClickedNode:n};function h(e){var i=e.data.name?e.descendants():e.descendants().slice(1),n=l.selectAll(".arc-group").data(i,(function(t){return t.data.name}));(n.select("text").remove(),t._interrupt)?n.exit().transition().duration(0).delay(0).on("start",t._onTransitionStart).remove().select("path").attrTween("d",(function(t){return p.call(this,f(t))})):n.exit().transition().duration(t._transition||s?.9*t._duration:0).delay(t._transition||s?t._startDelay:0).on("start",t._onTransitionStart).remove().select("path").attrTween("d",(function(t){return p.call(this,f(t))}));var a=n.enter().append("g").attr("class","arc-group");a.append("path").style("fill",(function(e,i){return/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+e.data.name)+")":e.data.color})).style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+e.data.name)+")":e.data.color)})).each((function(t){this._currentArc=function(t){if(!s)return{x0:t.x0,x1:t.x1,y0:0,y1:0};return{x0:0,x1:0,y0:0,y1:0}}(t)}));var o=a.merge(n).on("click",d).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);(o.select("path").style("fill",(function(e,i){return/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+e.data.name)+")":e.data.color})).style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+e.data.name)+")":e.data.color)})),t._interrupt)?o.transition().duration(0).delay(0).on("start",t._onTransitionStart).on("end.a",t._onTransitionEnd).on("end.b",(function(){s=!1})).select("path").attrTween("d",(function(t){return p.call(this,_(t))})):o.transition().duration(t._transition||s?.9*t._duration:0).delay(t._transition||s?t._startDelay:0).on("start",t._onTransitionStart).on("end.a",t._onTransitionEnd).on("end.b",(function(){s=!1})).select("path").attrTween("d",(function(t){return p.call(this,_(t))}))}function d(e){if(t._interrupt=!1,!s&&e.data.name!==n.data.name){s=!0,u.currentClickedNode=e;var i=e===u.currentRootNode?e.data.parent:e.data;u.oldState=_(e),u.currentRootNode=d3.hierarchy(i).sum((function(t){return t.value})),o(u.currentRootNode);var a=u.currentRootNode.descendants().filter((function(t){return t.data.name===e.data.name}))[0];u.newState=_(a),h(u.currentRootNode)}}function _(t){return{x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1}}function f(t){return s?{x0:0,x1:0,y0:0,y1:0}:{x0:t.x0,x1:t.x1,y0:0,y1:0}}function p(t){var e=d3.interpolate(this._currentArc,t);return this._currentArc=e(0),function(t){return r(e(t))}}return(n.data.name?n.descendants():n.descendants().slice(1)).forEach((function(e,i){if(e.data.color&&/\[/.test(e.data.color)){var n=x(e.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _,f=[];_=(f=a.concat()).pop(),t.group.append("linearGradient").attr("id",t.id+"-index-"+e.data.name).attr("x1",y(_[1]).x1+"%").attr("y1",y(_[1]).y1+"%").attr("x2",y(_[1]).x2+"%").attr("y2",y(_[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),h(n),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at);var Ze=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","sunburst-chart"),i.sunburst=new Ue(i.mainGroup),i._sortValue=-1,i._labelShow=!0,i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.sunburst,i=t.tooltip,n=t.activeData,a=t.widthOfNoMargin,o=t.heightOfMainGroup,r=Math.min(a,o)/2;t._fontSize,t._fontFamily;e.data(n.root).radius(r).translate(a/2,o/2).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).onMouseover((function(e){var a=[{color:e.data.color,text:e.data.name},{text:n.valueLabel+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];i.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){i.hide()})).onTransitionStart((function(){d3.select(this).select("text").style("opacity",0).remove()})).onTransitionEnd((function(i){var n=e.arcFunc,a="";(a=0===i.depth?X(i.data.name,2*(i.y1-i.y0),t._textLabel.fontSize,t._textLabel.fontFamily):i.y0*(i.x1-i.x0)<1.25*t._textLabel.fontSize?"":X(i.data.name,i.y1-i.y0,t._textLabel.fontSize,t._textLabel.fontFamily))&&(d3.select(this).append("text").attr("class",t.labelTextClass).style("pointer-events","none").style("font-size",t._textLabel.fontSize+"px").style("font-family",t._textLabel.fontFamily).style("fill",q(t._textLabel.color)).attr("transform",(function(t){var e=function(t){var e=((t.x0+t.x1)/2-Math.PI/2)/Math.PI*180;return e>90?e-180:e}(t),i=n.centroid(t);return 0===t.depth&&(e=0,i=[0,0]),"translate("+i+")rotate("+e+")"})).append("tspan").attr("class","sunburst-texts").attr("x",0).attr("y",0).attr("dy","0.35em").style("text-anchor","middle").style("fill",q(t._textLabel.color)).text(a),0==t._labelShow?d3.select(this).selectAll(".sunburst-texts").style("display","none"):d3.select(this).selectAll(".sunburst-texts").style("display","block"))})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.root,i=e.children?e.children.map((function(t){return t})):[];e.name&&i.unshift(e),t.legend.data(i).onClick((function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach((function(t){t.name===e.name&&(t.active=!n)})),t.onDataChange()}))}},{key:"sortData",value:function(){var t=this._data,e=t.root;Ke(e),-1===this._sortValue&&Qe(e),this._sortedDataCopy=t}},{key:"setSelfOption",value:function(t){t.display;var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.font;this._fontCopy=o,0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=o?e?e.display:this._labelShow:e.textLabel?e.textLabel.show:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"buildOption",value:function(t,e){var i=new qe(t,e);return i.dataSolveFunc($e),i}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.root,i={name:e.name,color:e.color,value:e.value,sum:e.sum,children:e.children&&e.children.filter((function(t){return!1!==t.active}))};return!1===e.active&&(i.children=[]),{root:i,valueLabel:t.valueLabel}}}]),e}(nt);function Qe(t){t.children&&t.children.sort((function(t,e){return e.sum-t.sum||t.index-e.index})).forEach((function(t){Qe(t)}))}function Ke(t){var e=Math.abs(t.value)||0;return t.children&&t.children.forEach((function(t){e+=Ke(t)})),t.sum=e,e}var Je=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","tree"),i._width=400,i._height=400,i._visibleDepth=5,i._linkWidthMode=null,i._textPadding=5,i._fillOpacity=.45,i._hasValue=!0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove(),t._interrupt?t.group.style("opacity",1):t.group.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1);var i=t._width,n=t._height,a=n/2,r=(t._fillOpacity,t._maxRadius),l=t._endPointRadius,s=t._fontSize,u=t._fontFamily,c=t._textPadding,h=i/5,d=Math.min(R(e.name,s,u),h),_=t._labelShow?d+c+r:r,f=d3.hierarchy(e).sum((function(t){return t.value||0})),p=G(f.leaves().length?f.leaves().map((function(t){return t.data.name})):[""],s,u),y=t._labelShow?p+5:r,x=f.descendants(),g=(f.leaves().length,d3.max(x,(function(t){return t.depth}))),v=d3.max(x,(function(t){return t.value})),m=d3.min(x,(function(t){return t.value})),b=(i-_-y)/(g||1),S=p,k=b-r-c>0?b-r-c:0,w=d3.tree().size([n,i-_-y]).separation((function(t,e){return t.parent===e.parent?1:1.5})),C=d3.linkHorizontal().x((function(t){return t.y})).y((function(t){return t.x})),O=d3.zoom().scaleExtent([.1,3]);w(f);var F=d3.max(x,(function(t){return t.x})),L=d3.min(x,(function(t){return t.x})),P=n/2;(-L>a&&F<a||-L<a&&F>a)&&(P-=(F+L)/2);var A=d3.scaleLinear().domain([m,v]).range([1,r]),W=t._hasValue,z=function(t){var e=A(t.value);return W?e:l},M=function(t){return W||t._children,t.data.color},D=function(t){var e=W&&0===t.depth?r:z(t);return 0==t.depth?-(e+c):0==t.height?e+c:(null!=t.children||null==t._children?-1:1)*(e+c)},N=!1,T=function(){return t._transition||N?t._duration:0},B=t.group;B.attr("transform","translate(0, 0)"),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)?B.call(o,_,P):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?B.interrupt().attr("transform","translate("+_+", "+P+")"):B.attr("transform","translate("+_+", "+P+")")),B.select(".bg-rect").empty()?B.append("rect").attr("class","bg-rect").attr("width",i).attr("height",n).style("opacity",0).call(o,-_,-P):B.select(".bg-rect");var j=B.select(".zoom-group").empty()?B.append("g").attr("class","zoom-group"):B.select(".zoom-group"),I=j.select(".links-group").empty()?j.append("g").attr("class","links-group"):j.select(".links-group"),Y=j.select(".nodes-group").empty()?j.append("g").attr("class","nodes-group"):j.select(".nodes-group");function H(e){w(f),function(e){if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){I.selectAll("path").remove();var i=I.selectAll("path").data(f.links(),(function(t){return t.target.data.name}));i.enter().append("path").attr("d",(function(t,i){e.x0,e.y0;return C({source:t.source,target:t.source})})).merge(i).style("fill","none").style("stroke-width",(function(e){return W?null==t._linkWidth?2*z(e.target):parseFloat(t._linkWidth):t._linkWidth_static})).style("stroke",(function(e){return t._linkColor||e.target.data.color})).style("stroke-linecap","round").style("stroke-opacity",t._fillOpacity).style("opacity","0").attr("d",(function(t){return C(t)})).style("opacity","1"),i.exit().attr("d",(function(t){var i={x:e.x,y:e.y};return C({source:i,target:i})})).remove()}else if(0==t._moveOptions.indexOf(t._moveStyle)){I.selectAll("path").remove();var n=I.selectAll("path").data(f.links(),(function(t){return t.target.data.name})),a=n.enter().append("path").attr("d",(function(t,i){e.x0,e.y0;return C({source:t.source,target:t.source})}));t._interrupt?(a.merge(n).style("fill","none").style("stroke-width",(function(e){return W?null==t._linkWidth?2*z(e.target):parseFloat(t._linkWidth):t._linkWidth_static})).style("stroke",(function(e){return t._linkColor||e.target.data.color})).style("stroke-linecap","round").style("stroke-opacity",t._fillOpacity).style("opacity","0").transition().duration(0).delay(0).attr("d",(function(t){return C(t)})).style("opacity","1"),n.exit().transition().duration(0).attr("d",(function(t){var i={x:e.x,y:e.y};return C({source:i,target:i})})).remove()):(a.merge(n).style("fill","none").style("stroke-width",(function(e){return W?null==t._linkWidth?2*z(e.target):parseFloat(t._linkWidth):t._linkWidth_static})).style("stroke",(function(e){return t._linkColor||e.target.data.color})).style("stroke-linecap","round").style("stroke-opacity",t._fillOpacity).style("opacity","0").transition().duration((t._transition||N?t._duration:0)/f.height).delay((function(e,i){return t._transition?e.source.depth*((t._transition||N?t._duration:0)/f.height)+t._startDelay:0})).attr("d",(function(t){return C(t)})).style("opacity","1"),n.exit().transition().duration(T).attr("d",(function(t){var i={x:e.x,y:e.y};return C({source:i,target:i})})).remove())}else if(1==t._moveOptions.indexOf(t._moveStyle)){var o=I.selectAll("path").data(f.links(),(function(t){return t.target.data.name})),r=o.enter().append("path").attr("d",(function(t){var i={x:e.x0,y:e.y0};return C({source:i,target:i})}));t._interrupt?(r.merge(o).style("fill","none").style("stroke-width",(function(e){return W?null==t._linkWidth?2*z(e.target):parseFloat(t._linkWidth):t._linkWidth_static})).style("stroke",(function(e){return t._linkColor||e.target.data.color})).style("stroke-linecap","round").style("stroke-opacity",t._fillOpacity).transition().duration(0).delay(0).attr("d",(function(t){return C(t)})),o.exit().transition().duration(0).delay(0).attr("d",(function(t){var i={x:e.x,y:e.y};return C({source:i,target:i})})).remove()):(r.merge(o).style("fill","none").style("stroke-width",(function(e){return W?null==t._linkWidth?2*z(e.target):parseFloat(t._linkWidth):t._linkWidth_static})).style("stroke",(function(e){return t._linkColor||e.target.data.color})).style("stroke-linecap","round").style("stroke-opacity",t._fillOpacity).transition().duration(T).delay(t._transition?t._startDelay:0).attr("d",(function(t){return C(t)})),o.exit().transition().duration(T).delay(t._transition?t._startDelay:0).attr("d",(function(t){var i={x:e.x,y:e.y};return C({source:i,target:i})})).remove())}}(e),function(e){if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){Y.selectAll(".node-group").remove();var i=Y.selectAll(".node-group").data(f.descendants(),(function(t){return t.data.name})),n=i.enter().append("g").attr("class","node-group").style("cursor","pointer").attr("transform",(function(t,i){return 0==i?"translate("+e.y0+","+e.x0+")":"translate("+t.parent.y+","+t.parent.x+")"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);n.append("circle").attr("r",z).style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("fill-opacity",t._fillOpacity).style("stroke-width",t._endPointBorderWidth).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor).style("opacity","1"),i.select("circle").style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor),n.append("text").attr("class","tree-texts").attr("x",D).attr("y",0).attr("dy",(function(t,e){return 0==t.depth?0:"0.35em"})).style("text-anchor",(function(t){return t.children||t._children?"end":"start"})).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text((function(e){return 0==e.depth?e.data.name:e.depth==g?X(e.data.name,S,t._fontSize,u):e.children?X(e.data.name,h+e.depth*k,t._fontSize,u):X(e.data.name,S+(g-e.depth)*k,t._fontSize,u)})).each((function(e,i){if(0==e.depth)for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),d=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),d.text(r.join("")),d.node().getComputedTextLength()>h&&(0==s||++l,r.pop(),d.text(r.join("")),r=[n],d=a.append("tspan").attr("x",u).attr("y",l*parseFloat(1.2*t._fontSize)+c).text(n)),s++})).attr("transform",(function(t){if(0==t.depth)return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+s)+")"})).style("fill-opacity","1"),n.merge(i).on("click",E).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).on("end",(function(){N=!1})).select("text").attr("x",D).style("text-anchor",(function(t){return 0==t.depth?"end":0==t.height?"start":null!=t.children||null==t._children?"end":"start"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("fill-opacity",t._labelShow?1:0);var a=i.exit().attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).remove();a.select("circle").attr("r",0),a.select("text").style("fill-opacity",0)}else if(0==t._moveOptions.indexOf(t._moveStyle)){Y.selectAll(".node-group").remove();var o=Y.selectAll(".node-group").data(f.descendants(),(function(t){return t.data.name})),r=o.enter().append("g").attr("class","node-group").style("cursor","pointer").attr("transform",(function(t,i){return 0==i?"translate("+e.y0+","+e.x0+")":"translate("+t.parent.y+","+t.parent.x+")"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);if(t._interrupt){r.append("circle").attr("r",z).style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("fill-opacity",t._fillOpacity).style("stroke-width",t._endPointBorderWidth).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor).style("opacity","0").transition().duration(0).delay(0).style("opacity","1"),o.select("circle").style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor),r.append("text").attr("class","tree-texts").attr("x",D).attr("y",0).attr("dy",(function(t,e){return 0==t.depth?0:"0.35em"})).style("text-anchor",(function(t){return t.children||t._children?"end":"start"})).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text((function(e){return 0==e.depth?e.data.name:e.depth==g?X(e.data.name,S,t._fontSize,u):e.children?X(e.data.name,h+e.depth*k,t._fontSize,u):X(e.data.name,S+(g-e.depth)*k,t._fontSize,u)})).each((function(e,i){if(0==e.depth)for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),d=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),d.text(r.join("")),d.node().getComputedTextLength()>h&&(0==s||++l,r.pop(),d.text(r.join("")),r=[n],d=a.append("tspan").attr("x",u).attr("y",l*parseFloat(1.2*t._fontSize)+c).text(n)),s++})).attr("transform",(function(t){if(0==t.depth)return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+s)+")"})).style("fill-opacity","0").transition().duration(0).delay(0).style("fill-opacity","1"),r.merge(o).on("click",E).transition().duration(0).delay(0).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).on("end",(function(){N=!1})).select("text").attr("x",D).style("text-anchor",(function(t){return 0==t.depth?"end":0==t.height?"start":null!=t.children||null==t._children?"end":"start"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("fill-opacity",t._labelShow?1:0);var l=o.exit().transition().duration(0).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).remove();l.select("circle").attr("r",0),l.select("text").style("fill-opacity",0)}else{r.append("circle").attr("r",z).style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("fill-opacity",t._fillOpacity).style("stroke-width",t._endPointBorderWidth).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor).style("opacity","0").transition().duration((t._transition||N?t._duration:0)/f.height).delay((function(e,i){return t._transition?(e.depth-1)*((t._transition||N?t._duration:0)/f.height)+t._startDelay:0})).style("opacity","1"),o.select("circle").style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor),r.append("text").attr("class","tree-texts").attr("x",D).attr("y",0).attr("dy",(function(t,e){return 0==t.depth?0:"0.35em"})).style("text-anchor",(function(t){return t.children||t._children?"end":"start"})).style("font-size",t._fontSize+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text((function(e){return 0==e.depth?e.data.name:e.depth==g?X(e.data.name,S,t._fontSize,u):e.children?X(e.data.name,h+e.depth*k,t._fontSize,u):X(e.data.name,S+(g-e.depth)*k,t._fontSize,u)})).each((function(e,i){if(0==e.depth)for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),d=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),d.text(r.join("")),d.node().getComputedTextLength()>h&&(0==s||++l,r.pop(),d.text(r.join("")),r=[n],d=a.append("tspan").attr("x",u).attr("y",l*parseFloat(1.2*t._fontSize)+c).text(n)),s++})).attr("transform",(function(t){if(0==t.depth)return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+s)+")"})).style("fill-opacity","0").transition().duration((t._transition||N?t._duration:0)/f.height).delay((function(e,i){return t._transition?(e.depth-1)*((t._transition||N?t._duration:0)/f.height)+t._startDelay:0})).style("fill-opacity","1"),r.merge(o).on("click",E).transition().duration((t._transition||N?t._duration:0)/f.height).delay((function(e,i){return t._transition?(e.depth-1)*((t._transition||N?t._duration:0)/f.height)+t._startDelay:0})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).on("end",(function(){N=!1})).select("text").attr("x",D).style("text-anchor",(function(t){return 0==t.depth?"end":0==t.height?"start":null!=t.children||null==t._children?"end":"start"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("fill-opacity",t._labelShow?1:0);var c=o.exit().transition().duration(T).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).remove();c.select("circle").attr("r",0),c.select("text").style("fill-opacity",0)}}else if(1==t._moveOptions.indexOf(t._moveStyle)){var d=Y.selectAll(".node-group").data(f.descendants(),(function(t){return t.data.name})),_=d.enter().append("g").attr("class","node-group").style("cursor","pointer").attr("transform",(function(t){return"translate("+e.y0+","+e.x0+")"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);if(_.append("circle").attr("r",z).style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("fill-opacity",t._fillOpacity).style("stroke-width",t._endPointBorderWidth).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor),d.select("circle").style("fill",null==t._endPointFillColor?M:t._endPointFillColor).style("stroke",null==t._endPointBorderColor?function(t){return t.data.color}:t._endPointBorderColor),_.append("text").attr("class","tree-texts").attr("x",D).attr("y",0).attr("dy",(function(t,e){return 0==t.depth?0:"0.35em"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).text((function(e){return 0==e.depth?e.data.name:e.depth==g?X(e.data.name,S,t._fontSize,u):e.children?X(e.data.name,h+e.depth*k,t._fontSize,u):X(e.data.name,S+(g-e.depth)*k,t._fontSize,u)})).each((function(e,i){if(0==e.depth)for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),d=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),d.text(r.join("")),d.node().getComputedTextLength()>h&&(0==s||++l,r.pop(),d.text(r.join("")),r=[n],d=a.append("tspan").attr("x",u).attr("y",l*parseFloat(1.2*t._fontSize)+c).text(n)),s++})).attr("transform",(function(t){if(0==t.depth)return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+s)+")"})),t._interrupt){_.merge(d).on("click",E).transition().duration(0).delay(0).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).on("end",(function(){N=!1})).select("text").attr("x",D).style("text-anchor",(function(t){return 0==t.depth?"end":0==t.height?"start":null!=t.children||null==t._children?"end":"start"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("fill-opacity",t._labelShow?1:0);var p=d.exit().transition().duration(0).delay(0).attr("transform",(function(){return"translate("+e.y+","+e.x+")"})).remove();p.select("circle").attr("r",0),p.select("text").style("fill-opacity",0)}else{_.merge(d).on("click",E).transition().duration(T).delay(t._transition?t._startDelay:0).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform",(function(t){return"translate("+t.y+","+t.x+")"})).on("end",(function(){N=!1})).select("text").attr("x",D).style("text-anchor",(function(t){return 0==t.depth?"end":0==t.height?"start":null!=t.children||null==t._children?"end":"start"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("fill-opacity",t._labelShow?1:0);var y=d.exit().transition().duration(T).delay(t._transition?t._startDelay:0).attr("transform",(function(){return"translate("+e.y+","+e.x+")"})).remove();y.select("circle").attr("r",0),y.select("text").style("fill-opacity",0)}}}(e),x.forEach((function(t){t.x0=t.x,t.y0=t.y}))}function E(e){t._interrupt=!1,N=!0,e=function(t){return t.children?(t._children=t.children,t.children=null):t._children&&(t.children=t._children,t._children=null),t}(e),H(e)}f.x0=f.x,f.y0=f.y,O.on("zoom",(function(){var t=d3.event.transform;j.attr("transform",t)})),H(f)}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"linkStrokeOpacity",value:function(t){return arguments.length?(this._linkStrokeOpacity=t,this):this._linkStrokeOpacity}},{key:"nodeStrokeOpacity",value:function(t){return arguments.length?(this._nodeStrokeOpacity=t,this):this._nodeStrokeOpacity}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"visibleDepth",value:function(t){return arguments.length?(this._visibleDepth=t,this):this._visibleDepth}},{key:"textPadding",value:function(t){return arguments.length?(this._textPadding=t,this):this._textPadding}},{key:"hasValue",value:function(t){return arguments.length?(this._hasValue=t,this):this._hasValue}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"linkWidth",value:function(t){return arguments.length?(this._linkWidth=t,this):this._linkWidth}},{key:"linkWidth_static",value:function(t){return arguments.length?(this._linkWidth_static=t,this):this._linkWidth_static}},{key:"linkColor",value:function(t){return arguments.length?(this._linkColor=t,this):this._linkColor}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"numberFontSize",value:function(t){return arguments.length?(this._numberFontSize=t,this):this._numberFontSize}},{key:"numberFontColor",value:function(t){return arguments.length?(this._numberFontColor=t,this):this._numberFontColor}},{key:"numberFontFamily",value:function(t){return arguments.length?(this._numberFontFamily=t,this):this._numberFontFamily}},{key:"numberLabelShow",value:function(t){return arguments.length?(this._numberLabelShow=t,this):this._numberLabelShow}}]),e}(at),ti=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"generateColorList",value:function(t){var e=this._props.colors.type,i=V(this._props.colors.list,this._blockData,this._projectTheme);if(!t)return i;var n=i;switch(e){case"linear":var a=i.slice(0,2),o=d3.scaleLinear().domain([0,t-1]).range(a);n=d3.range(t).map((function(t,e){return o(e)}));break;case"single":n=d3.range(t).map((function(){return i[0]}));break;default:if(n=i.slice(1),i.length<t+1){var r=i.length;do{n.push(i[r%i.length]),r++}while(r<t+1)}}return n}},{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.root;if(e&&e.children){var i=e.children;e.color=this.generateColorList(0)[0],$(i,this.generateColorList(i.length))}return{root:t.root||{children:[]},valueLabel:t.valueLabel}}}]),e}(it),ei=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","tree-chart"),i.tree=new Je(i.mainGroup),i._hasValue=!1,i._fillOpacity=.45,i._endPointRadius=10,i._linkWidth_static="8",i._linkWidth=null,i._linkColor=null,i._endPointBorderWidth="1",i._endPointBorderColor=null,i._endPointFillColor=null,i._maxRadius=10,i._labelShow=!0,i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["按层级展开","对角拉伸"],i._moveStyle="对角拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.tree,i=t.tooltip,n=t.activeData;if(!n.root||!n.root.children)return t;var a=t.widthOfNoMargin,o=t.heightOfMainGroup,r=t.defs;r.selectAll("filter").remove();var l=r.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_tree").attr("filterUnits","objectBoundingBox");l.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),l.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),l.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),l.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),l.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var s=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,u=t._fontCopy?t._fontSize:t._textLabel.fontSize,h=t._fontCopy?t._fontColor:q(t._textLabel.color);if(t.mainGroup.selectAll(".linear-gradient").remove(),t._endPointBorderColor&&/\[/.test(t._endPointBorderColor)){var d=x(t._endPointBorderColor),_=[],f=!0,p=!1,g=void 0;try{for(var v,m=d[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var b=v.value,S=[],k=b.split(":");S.push(q(k[0])),S.push(k[1]),_.push(S)}}catch(t){p=!0,g=t}finally{try{!f&&m.return&&m.return()}finally{if(p)throw g}}var w=_.concat(),C=w.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(C[1]).x1+"%").attr("y1",y(C[1]).y1+"%").attr("x2",y(C[1]).x2+"%").attr("y2",y(C[1]).y2+"%").selectAll("stop").data(w).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._endPointFillColor&&/\[/.test(t._endPointFillColor)){var O=x(t._endPointFillColor),F=[],L=!0,P=!1,A=void 0;try{for(var W,z=O[Symbol.iterator]();!(L=(W=z.next()).done);L=!0){var M=W.value,D=[],R=M.split(":");D.push(q(R[0])),D.push(R[1]),F.push(D)}}catch(t){P=!0,A=t}finally{try{!L&&z.return&&z.return()}finally{if(P)throw A}}var N=F.concat(),T=N.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(T[1]).x1+"%").attr("y1",y(T[1]).y1+"%").attr("x2",y(T[1]).x2+"%").attr("y2",y(T[1]).y2+"%").selectAll("stop").data(N).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._linkColor&&/\[/.test(t._linkColor)){var B=x(t._linkColor),G=[],X=!0,j=!1,I=void 0;try{for(var Y,H=B[Symbol.iterator]();!(X=(Y=H.next()).done);X=!0){var V=Y.value,$=[],U=V.split(":");$.push(q(U[0])),$.push(U[1]),G.push($)}}catch(t){j=!0,I=t}finally{try{!X&&H.return&&H.return()}finally{if(j)throw I}}var Z=G.concat(),Q=Z.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-2").attr("x1",y(Q[1]).x1+"%").attr("y1",y(Q[1]).y1+"%").attr("x2",y(Q[1]).x2+"%").attr("y2",y(Q[1]).y2+"%").selectAll("stop").data(Z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(n.root).width(a).height(o).maxRadius(t._maxRadius).endPointRadius(t._endPointRadius).hasValue(t._hasValue).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).linkWidth(t._linkWidth).linkWidth_static(t._linkWidth_static).linkColor(/\[/.test(t._linkColor)?"url("+c("#"+t.id+"-main-border-index-2")+")":t._linkColor).endPointBorderWidth(t._endPointBorderWidth).endPointBorderColor(/\[/.test(t._endPointBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._endPointBorderColor).endPointFillColor(/\[/.test(t._endPointFillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._endPointFillColor).fontSize(u).fontColor(h).fontFamily(s).labelShow(t._labelShow).numberFontSize(t._numberLabel.fontSize).numberFontColor(t._numberLabel.fontColor).numberFontFamily(t._numberLabel.fontFamily).numberLabelShow(t._numberLabel.show).onMouseover((function(a){var o=-1==String(a.value).indexOf(".")?a.value:a.value.toFixed(2);d3.select(this).select("circle").style("fill-opacity",1),e.elem.select(".links-group").selectAll("path").filter((function(t){return t.target===a})).style("stroke-opacity",.8);var r=[{color:a.data.color,text:a.data.name}];t._hasValue&&r.push({text:n.valueLabel+"："+E(o,t._numberStyle,t._decimalPlaces)}),i.data(r).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(n){i.hide(),d3.select(this).select("circle").style("fill-opacity",t._fillOpacity),e.elem.select(".links-group").selectAll("path").filter((function(t){return t.target===n})).style("stroke-opacity",t._fillOpacity)})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.root.children||[];t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.name===i.name&&(t.active=!n)})),t.onDataChange()}))}},{key:"sortData",value:function(){var t=this._data.root;t&&t.children&&t.children.length&&function(t){function e(t){t.depth>1&&(t.color=t.parent.color),t.children&&t.children.forEach((function(t){e(t)}))}e(t)}(t),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.font;this._fontCopy=r,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=r?i?i.display:this._labelShow:i.textLabel?i.textLabel.show:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._endPointRadius=0==e.endPointRadius||e.endPointRadius?d(e.endPointRadius):this._endPointRadius,this._linkWidth_static=0==e.linkWidth_static||e.linkWidth_static?d(e.linkWidth_static):this._linkWidth_static,this._linkColor=e.linkColor?q(e.linkColor):null,this._endPointBorderWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?d(e.endPointBorderWidth):this._endPointBorderWidth,this._endPointBorderColor=e.endPointBorderColor?q(e.endPointBorderColor):null,this._endPointFillColor=e.endPointFillColor?q(e.endPointFillColor):null,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"buildOption",value:function(t,e){var i=new ti(t,e);return i.dataSolveFunc(Ee),i}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.root;return{root:{name:e.name,color:e.color,value:e.value||0,children:e.children&&e.children.filter((function(t){return!1!==t.active}))},valueLabel:t.valueLabel}}}]),e}(nt);var ii=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"generateColorList",value:function(t){var e=this._props.colors.type,i=V(this._props.colors.list,this._blockData,this._projectTheme);if(!t)return i;var n=i;switch(e){case"linear":var a=i.slice(0,2),o=d3.scaleLinear().domain([0,t-1]).range(a);n=d3.range(t).map((function(t,e){return o(e)}));break;case"single":n=d3.range(t).map((function(){return i[0]}));break;default:if(n=i.slice(1),i.length<t+1){var r=i.length;do{n.push(i[r%i.length]),r++}while(r<t+1)}}return n}},{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=t.root;if(e&&e.children){var i=e.children;e.color=this.generateColorList(0)[0],$(i,this.generateColorList(i.length))}return{root:t.root||{children:[]},valueLabel:t.valueLabel}}}]),e}(it),ni=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._hasValue=!0,i._maxRadius=10,i._fillOpacity=.45,i._endPointRadius="10",i._linkColor=null,i._endPointBorderWidth="1",i._endPointBorderColor=null,i._endPointFillColor=null,i._linkWidth=null,i._labelShow=!0,i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["按层级展开","对角拉伸"],i._moveStyle="对角拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.font;this._fontCopy=r,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=r?i?i.display:this._labelShow:i.textLabel?i.textLabel.show:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._maxRadius=0==e.maxRadius||e.maxRadius?d(e.maxRadius):this._maxRadius,this._linkColor=e.linkColor?e.linkColor:null,this._endPointBorderWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?d(e.endPointBorderWidth):this._endPointBorderWidth,this._endPointBorderColor=e.endPointBorderColor?q(e.endPointBorderColor):null,this._endPointFillColor=e.endPointFillColor?q(e.endPointFillColor):null,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._linkWidth=null==e.linkWidth||0==e.linkWidth||e.linkWidth?e.linkWidth:this._linkWidth)}},{key:"buildOption",value:function(t,e){var i=new ii(t,e);return i.dataSolveFunc($e),i}}]),e}(ei),ai=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.keys,i=this.generateColorList(e.length),n={};return e.forEach((function(t,e){return n[t]=i[e]})),t.colorMap=n,t}}]),e}(it);function oi(t,e){var i=0;if(e.forEach((function(t){"objCol"===t.function&&(i=+t.index)})),P(t,[i],2))return{keys:[],dataForStack:[]};var n=z(t,e),a=n[0];return{keys:a.filter((function(t,e){return e!==i})),dataForStack:n.slice(1).map((function(t){var e={};return t.forEach((function(t,n){n===i?e.name=t:e[a[n]]=""==t||isNaN(parseFloat(t))||null==t||null==t?0:parseFloat(t)})),e}))}}var ri=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","area-plot"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)){var i=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t.group;n.selectAll("path").remove();var a=n.selectAll("path").data(e,(function(t){return t.key}));a.exit().remove();a.enter().append("path").merge(a).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).attr("d",(function(t){return i(t.data)}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){for(var o=[],r=0;r<e.length;r++){o[r]={},o[r].name=e[r].name,o[r].color=e[r].color,o[r].data=[];for(var l=0;l<e[r].data.length;l++)o[r].data[l]={},o[r].data[l].total=e[r].data[0].total,o[r].data[l].value=e[r].data[0].value,o[r].data[l].name=e[r].data[l].name}var s=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),u=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));s.curve(t._curve),u.curve(t._curve);var h=t.group;h.selectAll("path").remove();var d=h.selectAll("path").data(e,(function(t){return t.key}));d.exit().remove();var _=d.enter().append("path").merge(d).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?_.attr("d",(function(t){return s(t.data)})):_.attr("d",(function(t,e){return u(o[e].data)})).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?.9*t._duration:0).attr("d",(function(t){return s(t.data)}))}else if(2==t._moveOptions.indexOf(t._moveStyle)){var f=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),p=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total-e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));f.curve(t._curve),p.curve(t._curve);var g=t.group;g.selectAll("path").remove();var v=g.selectAll("path").data(e,(function(t){return t.key}));v.exit().remove();var m=v.enter().append("path").merge(v).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?m.attr("d",(function(t){return f(t.data)})):m.attr("d",(function(t){return p(t.data)})).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?.9*t._duration:0).attr("d",(function(t){return f(t.data)}))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var b=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),S=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(0)})).y1((function(e){return t._yScale(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));b.curve(t._curve),S.curve(t._curve);var k=t.group;k.selectAll("path").remove();var w=k.selectAll("path").data(e,(function(t){return t.key}));w.exit().remove();var C=w.enter().append("path").merge(w).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?C.attr("d",(function(t){return b(t.data)})):C.attr("d",(function(t){return S(t.data)})).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?.9*t._duration:0).attr("d",(function(t){return b(t.data)}))}else if(4==t._moveOptions.indexOf(t._moveStyle)){var O=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),F=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.value)})).y1((function(e){return t._yScale(e.total-e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));O.curve(t._curve),F.curve(t._curve);var L=t.group;L.selectAll("path").remove();var P=L.selectAll("path").data(e,(function(t){return t.key}));P.exit().remove();var A=P.enter().append("path").merge(P).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?A.attr("d",(function(t){return O(t.data)})):A.attr("d",(function(t){return F(t.data)})).transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:1)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("d",(function(t){return O(t.data)}))}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),li=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stream-graph"),i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,n=[],a=[],o=0;o<e.keys.length;o++){for(var r=[],l=0;l<e.dataForStack.length;l++)r.push(e.dataForStack[l][e.keys[o]]);n.push(d3.max(r))}for(var s=0;s<e.keys.length;s++)for(var u=0;u<e.stackData[s].length;u++)e.stackData[s][u].data[e.keys[s]]==n[s]&&a.push([e.stackData[s][u][0],e.stackData[s][u][1],e.stackData[s][u].data.name]);var h=t.group,d=e.stackData,_=t._areaFunc||d3.area().x((function(e){return t._xScale(e.data.name)})).y0((function(e){return t._yScale(e[0])})).y1((function(e){return t._yScale(e[1])})),f=t._lineFunc||d3.line().x((function(e){return t._xScale(e.data.name)})).y((function(e){return t._yScale(e[0])})).defined((function(t){return!isNaN(parseFloat(t[0]))}));f.curve(d3.curveBasis),h.selectAll("*").remove(),e.keys.forEach((function(i,n){var a=e.colorMap[i];if(a&&/\[/.test(a)){var o=x(a),r=[],l=!0,s=!1,u=void 0;try{for(var c,h=o[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),r.push(_)}}catch(t){s=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(s)throw u}}var p=r.concat(),g=p.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var g=h.append("g").attr("class","stream-graph-group"),v=g.selectAll("path").data(d,(function(t){return t.key}));v.exit().remove(),v.enter().append("path").merge(v).style("fill",(function(i){return e.colorMap[i.key]&&/\[/.test(e.colorMap[i.key])?"url("+c("#"+t.id+"-index-"+i.key)+")":e.colorMap[i.key]&&/#/.test(e.colorMap[i.key])?e.colorMap[i.key]:"rgb("+U(e.colorMap[i.key],0)+","+U(e.colorMap[i.key],1)+","+U(e.colorMap[i.key],2)+")"})).style("fill-opacity",(function(i){if(e.colorMap[i.key]&&/#/.test(e.colorMap[i.key]))return t._fillOpacity;var n=U(e.colorMap[i.key],3)||1;return t._fillOpacity*n})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).transition().duration(t._transition?t._duration:0).attr("d",_);var m=g.append("g").selectAll("path").data(d,(function(t){return t.key}));m.exit().remove(),m.enter().append("path").merge(m).style("fill","none").style("stroke",(function(i){return(/\[/.test(e.colorMap[i.key])?"url("+c("#"+t.id+"-index-"+i.key)+")":e.colorMap[i.key])||""})).style("stroke-width",t._strokeWidth||0).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return f(t)}));var b=g.selectAll("text").data(e.keys);b.exit().remove();var S=b.enter().append("text").attr("class","stream-graph-texts").merge(v).text((function(t,i){return e.keys[i]})).attr("x",(function(e,i){return t._xScale(a[i][2])})).attr("y",(function(e,i){return(t._yScale(a[i][1])-t._yScale(a[i][0]))/2+t._yScale(a[i][0])})).attr("text-anchor","middle").attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily);t._interrupt?S.style("opacity",1):S.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1),0==t._labelShow?h.selectAll(".stream-graph-texts").style("display","none"):h.selectAll(".stream-graph-texts").style("display","block");for(var k=h.selectAll(".stream-graph-texts"),w=[],C=[],O=0;O<k._groups[0].length;O++){C.push(O);for(var F=O+1;F<k._groups[0].length;F++){p(i(d3.select(k._groups[0][O])),i(d3.select(k._groups[0][F])))&&(w.push(O),d3.select(k._groups[0][O]).style("visibility","hidden"))}}for(var L=new Set(w),P=Array.from(L),A=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(P,C),W=0;W<P.length;W++){for(var z=[],M=0;M<A.length;M++){var D=i(d3.select(k._groups[0][P[W]])),R=i(d3.select(k._groups[0][A[M]]));if(z.push(p(D,R)),p(D,R)){if(P[W]==A[M])continue;d3.select(k._groups[0][P[W]]).style("visibility","hidden")}}0==z.filter((function(t){return 1==t})).length&&A.push(P[W])}for(var N=0;N<A.length;N++)d3.select(k._groups[0][A[N]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(ri),si=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.streamgraph=new li(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.clipArea=new Ut(i.defs),i.AnimationArea=new Zt(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._lineWidth=2,i._fillOpacity=.7,i._labelShow=!1,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.streamgraph,n=t.grid,a=t.tooltip,o=t.overlay,r=t.guideLine,l=t.clipArea,s=(t.AnimationArea,t.xScale),u=t.yScale,h=(t.widthOfNoMargin,t.heightOfMainGroup,t._fontSize),d=(d3.max(e.keys,(function(e){return R(e,h,t._fontFamily)})),t.xAxis._axisStart,t.xAxis._axisEnd),_=0;d>t.widthOfNoMargin&&(_=d-t.widthOfNoMargin);var f=t.widthOfCore-_,p=t.heightOfCore,y=e.stackData,x=e.colorMap,g=d3.max(y,(function(t){return d3.max(t,(function(t){return Math.max(t[0],t[1])}))})),v=d3.min(y,(function(t){return d3.min(t,(function(t){return Math.min(t[0],t[1])}))})),m=t.defs;m.selectAll("filter").remove();var b=m.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_streamgraph").attr("filterUnits","objectBoundingBox");b.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),b.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),b.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),b.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),b.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),u.domain([1.1*v,1.1*g]).range([0,p]);var S=d3.area().x((function(t){return s(t.data.name)})).y0((function(t){return u(t[0])})).y1((function(t){return u(t[1])})).curve(d3.curveBasis);(i.data(e).areaFunc(S).xScale(s).yScale(u).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).strokeWidth(t._lineWidth).fillOpacity(t._fillOpacity).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(t){var e=t.key,i=[{text:e,color:x[e]}];a.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this).style("stroke","#000"),d3.select(this.parentNode).selectAll("path").filter((function(e){return e!=t})).style("fill-opacity",.3)})).onMousemove((function(t){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){d3.select(this).style("stroke","none"),d3.select(this.parentNode).selectAll("path").style("fill-opacity",1),a.hide()})),n.width(f).height(p).planeX(s.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),r.y1(0).y2(p).stroke("#c6c6c6").strokeDasharray("0 0"),o.data(s.domain()).bandWidth(s.step()).bandHeight(p).bandX(s.range()[0]).onMouseover((function(i,n){var o=i,l=[{text:o}],u=e.dataForStack[n];for(var c in u)"name"!==c&&!1!==e.states[c]&&l.push({color:e.colorMap[c],text:c+"："+E(u[c],t._numberStyle,t._decimalPlaces)});a.data(l).update().move([d3.event.offsetX,d3.event.offsetY]),r.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+s(o)+",0)"),a.show(),r.show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){a.hide(),r.hide()})),l.width(f).height(p).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+l.id)+")"),n.update(),o.update(),l.update(),i.update(),t._interrupt)?(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("height",t._height).attr("width",t._width),t.coreGroup.select(".stream-graph").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("x",s.range()[0]).attr("width",0).attr("height",t._height).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",f-s.range()[0]>0?f-s.range()[0]:0),t.coreGroup.select(".stream-graph").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy,i=e.colorMap,n=[];for(var a in i)n.push({name:a,color:i[a]});t.legend.data(n).onClick((function(i){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),n.forEach((function(t){t.name===i.name&&(t.active=!a)})),e.states[i.name]=!a,t.onDataChange()}))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(!1).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(!1).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);i.tickCount(d),i.compute();var _=0,f=c;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=h-e.height,g=_;e.translate(0,x).update(),i.translate(g,0).update()}},{key:"computeDomain",value:function(){this.xDomain(this.activeData.dataForStack.map((function(t){return t.name})));var t=this.activeData.stackData,e=d3.max(t,(function(t){return d3.max(t,(function(t){return Math.max(t[0],t[1])}))})),i=d3.min(t,(function(t){return d3.min(t,(function(t){return Math.min(t[0],t[1])}))}));this.yDomain([i,e])}},{key:"sortData",value:function(){var t=this._data,e={};t.keys.forEach((function(t){return e[t]=!0})),t.states||(t.states=e),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.textLabel?i.textLabel.show:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel);d3.curveLinear,d3.curveStepAfter,d3.curveCardinal;0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}},{key:"buildOption",value:function(t,e){var i=new ai(t,e);return i.dataSolveFunc(oi),i}},{key:"activeData",get:function(){var t=this.sortedDataCopy,e=t.keys.filter((function(e){return!1!==t.states[e]})),i=d3.stack().keys(e).order(d3.stackOrderNone).offset(d3.stackOffsetWiggle)(t.dataForStack);return{states:t.states,keys:e,stackData:i,colorMap:t.colorMap,dataForStack:t.dataForStack}}}]),e}(Tt),ui=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","radar"),e._radius=200,e._donutCount=5,e._fillOpacity=.6,e._borderWidth=2,e._fontSize=12,e._fontFamily="sans-serif",e._fontColor="#000",e._endPointRadius=3.5,e._tickTextColor="#333",e._tickTextSize=10,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t.group;if(a.selectAll("*").remove(),n.length){n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));for(var o=t._radius,r=(t._donutCount,t._fontSize,n[0].data.map((function(t){return t.name})).length),l=[],s=0;s<r;s++){for(var u=[],h=0;h<n.length;h++)u.push(n[h].data[s].value);l.push(d3.max(u))}var d=d3.max(n,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))})),_=[0,1.1*d];if(t._isPolar)if(null==t._count)_=v(0,d,Math.ceil(o/t._themeFontSize/3));else if(_=[],0!=t._count){var f=d-0,g=t._count,m=Math.ceil(Math.abs(f/t._count)),b=Math.ceil(o/t._themeFontSize*2),S=d3.tickStep(0,d,b);t._count<S&&(m=Math.ceil(Math.abs(f/S)),g=S),d+=m;for(var k=0;k<m+1;k++)_.push(0+k*g)}else _.push(0);var w=d3.scaleLinear().domain([d3.min(_),d3.max(_)]).range([0,o]),C=d3.scaleLinear().domain([0,r]).range([0,2*Math.PI]),O=d3.areaRadial().angle((function(t,e){return 0})).outerRadius((function(t){return 0})).curve(t._curve),F=d3.areaRadial().angle((function(t,e){return C(e)})).outerRadius((function(t){return t.value>=0?w(t.value):0})).curve(t._curve),L=d3.arc().innerRadius(0).outerRadius(o).startAngle(0).endAngle(2*Math.PI);t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("path").attr("d",L()),a.selectAll(".radar-area-point").remove(),a.selectAll(".radar-area").remove(),a.selectAll(".radar-points").remove();var P=a.append("g").attr("clip-path","").selectAll("g").attr("class","radar-area-point").data(n);P.exit().remove(),P.enter().append("g").merge(P).each((function(e,i){var a=d3.select(this).append("path").attr("class","radar-area").attr("d",(function(t){return O(t.data)})).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth);null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?a.attr("d",(function(t){return F(t.data)})):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?a.attr("d",(function(t){return F(t.data)})):a.transition().duration(t._transition?.8*t._duration:0).delay(t._duration?t._startDelay+.1*t._duration:0).attr("d",(function(t){return F(t.data)})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?a.attr("d",(function(t){return F(t.data)})):a.transition().duration(t._transition?.8*t._duration/n.length*2:0).delay(t._duration?t._startDelay+.8*t._duration/n.length/2*i+.1*t._duration:0).attr("d",(function(t){return F(t.data)})));var o=d3.select(this).selectAll("circle").data((function(t){return t.data.map((function(e){return e.color=t.color,e}))}));o.exit().remove();var r=o.enter().append("circle").attr("class","radar-points").merge(o).attr("r",0).style("stroke",(function(e){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).attr("cx",0).attr("cy",0).style("fill",(function(e){return t._fillColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)}));r.filter((function(t){return t.value<0})).attr("display","none"),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?r.attr("r",t._endPointRadius).attr("cx",(function(t,e){return w(t.value)*Math.cos(C(e)-Math.PI/2)})).attr("cy",(function(t,e){return w(t.value)*Math.sin(C(e)-Math.PI/2)})):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?r.attr("r",t._endPointRadius).attr("cx",(function(t,e){return w(t.value)*Math.cos(C(e)-Math.PI/2)})).attr("cy",(function(t,e){return w(t.value)*Math.sin(C(e)-Math.PI/2)})):r.transition().duration(t._transition?.8*t._duration:0).delay(t._duration?t._startDelay+.1*t._duration:0).attr("r",t._endPointRadius).attr("cx",(function(t,e){return w(t.value)*Math.cos(C(e)-Math.PI/2)})).attr("cy",(function(t,e){return w(t.value)*Math.sin(C(e)-Math.PI/2)})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?r.attr("r",t._endPointRadius).attr("cx",(function(t,e){return w(t.value)*Math.cos(C(e)-Math.PI/2)})).attr("cy",(function(t,e){return w(t.value)*Math.sin(C(e)-Math.PI/2)})):r.transition().duration(t._transition?.8*t._duration/n.length*2:0).delay(t._duration?t._startDelay+.8*t._duration/n.length/2*i+.1*t._duration:0).attr("r",t._endPointRadius).attr("cx",(function(t,e){return w(t.value)*Math.cos(C(e)-Math.PI/2)})).attr("cy",(function(t,e){return w(t.value)*Math.sin(C(e)-Math.PI/2)})))})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),a.selectAll(".radar-area-texts").remove();var A=t._defs;A.selectAll("filter").remove();var W=A.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_radar").attr("filterUnits","objectBoundingBox");W.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),W.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),W.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),W.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),W.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var z=a.append("g").attr("clip-path","").selectAll("g").attr("class","radar-area-groups").data(n);z.exit().remove(),z.enter().append("g").merge(z).each((function(e,i){var n=d3.select(this).selectAll("text").data((function(t){return t.data.map((function(t){return t}))}));n.exit().remove();var a=n.enter().append("text").attr("class","radar-area-texts").merge(n).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t,e){return t.value==l[e]?(w(t.value)+.05*o)*Math.cos(C(e)-Math.PI/2):(w(t.value)-.05*o)*Math.cos(C(e)-Math.PI/2)})).attr("y",(function(t,e){return t.value==l[e]?(w(t.value)+.05*o)*Math.sin(C(e)-Math.PI/2):(w(t.value)-.05*o)*Math.sin(C(e)-Math.PI/2)})).attr("text-anchor",(function(t,e){return 0==C(e)||C(e)==Math.PI?"middle":C(e)>Math.PI&&t.value!=l[e]?"start":C(e)>Math.PI&&t.value==l[e]||C(e)>0&&C(e)<Math.PI&&t.value!=l[e]?"end":void 0})).attr("dy",(function(t,e){if(t.value==l[e])if(t.value==d3.max(l)){if(C(e)<Math.PI/2||C(e)>1.5*Math.PI)return"1.3em";if(C(e)>Math.PI/2&&C(e)<1.5*Math.PI)return"-1.3em";if(C(e)==Math.PI/2||C(e)==1.5*Math.PI)return"1.1em"}else{if(0==C(e))return"0.3em";if(C(e)==Math.PI)return"-0.3em";if(C(e)<Math.PI/2||C(e)>1.5*Math.PI)return"1.3em";if(C(e)>Math.PI/2&&C(e)<1.5*Math.PI)return"-1.3em";if(C(e)==Math.PI/2||C(e)==1.5*Math.PI)return"1.1em"}else if(t.value!=l[e])return 0==C(e)||C(e)>Math.PI&&C(e)<1.5*Math.PI?0:"0.4em"})).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("display",t._labelShow?"block":"none");a.filter((function(t){return t.value<0})).attr("transform","scale(0)"),t._interrupt?a.style("opacity","1"):a.style("opacity","0").transition().delay(t._transition?t._startDelay+.9*t._duration:0).duration(t._transition?.1*t._duration:0).style("opacity","1")}));var M=2*Math.PI,R=n.length>0?n[0].data.map((function(t){return-1!=String(t.name).indexOf("&-")?"":t.name})):[],N=(M-0)/r,T=[],B=o+5;if(n.length>0)for(var G=0;G<r;G++){var I=B*Math.sin(0+G*N),Y=-B*Math.cos(0+G*N);T.push({x:I,y:Y})}else T=[{x:B*Math.sin(0),y:-B*Math.cos(0)},{x:B*Math.sin(M),y:-B*Math.cos(M)}];var H=(M-0)/(r>0?r:1);a.selectAll(".tick-text").remove();var V=a.append("g").selectAll("text").data(T);V.exit().remove();var $=V.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0){if("水平"==t._xLabelDirection){var a=Math.cos(0+H*i-Math.PI/2)*(o+10),r=t._mainWidth/2-Math.abs(a);return X(R[i],r,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var l=Math.sin(0+H*i-Math.PI/2)*(o+10),s=t._mainHeight/2-Math.abs(l);return j(R[i],s,t._themeFontSize,t._themeFontFamily)}}})).attr("x",(function(t,e){var i=0+H*e;return Math.cos(i-Math.PI/2)*(o+10)})).attr("y",(function(t,e){var i=0+H*e;return Math.sin(i-Math.PI/2)*(o+10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)$.attr("transform",(function(e,i){var n=0+H*i;return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,0)":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+.5*t._themeFontSize+")":"translate(0,"+.8*t._themeFontSize+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var Z=t.group.append("g").selectAll("text").data(T);Z.exit().remove(),Z.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(0+H*e)/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none").text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(R[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",o+5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(0+H*e)/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(0+H*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(o+5)+",0)":null}))}else{a.selectAll(".tick-text").remove();var Q=t.group.selectAll("g.text-group").data(T);Q.exit().remove();Q.enter().append("g").attr("class","text-group").merge(Q).each((function(i,a){d3.select(this);var r=o+10,l=0+H*a,s=d3.select(this.parentNode),u="arc-path-"+a+"-"+t.id,c=e(r+.6*t._themeFontSize,l-H/2+.015,l+H/2-.015),h=t._defs.select("#"+u).empty()?t._defs.append("path").attr("d",c).attr("id",u):t._defs.select("#"+u).attr("d",c);n.length>0&&D(s,h,R[a],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none")}))}1==t._interrupt?$.style("opacity",1).style("display",t._showX?"block":"none"):$.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none");for(var K=0;K<r+1;K++){var J=K*H+0;0==J||J==Math.PI?d3.select(a.selectAll(".tick-text").nodes()[K]).attr("text-anchor","middle"):J>Math.PI||J<0&&J>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[K]).attr("text-anchor","end"):d3.select(a.selectAll(".tick-text").nodes()[K]).attr("text-anchor","start")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var tt=t.group.selectAll(".tick-text"),et=[],it=[],nt=0;nt<tt._groups[0].length;nt++){it.push(nt);for(var at=nt+1;at<tt._groups[0].length;at++){p(i(d3.select(tt._groups[0][nt])),i(d3.select(tt._groups[0][at])))&&(et.push(nt),d3.select(tt._groups[0][nt]).style("opacity","0"))}}for(var ot=new Set(et),rt=Array.from(ot),lt=Lt(rt,it),st=0;st<rt.length;st++){for(var ut=[],ct=0;ct<lt.length;ct++){var ht=i(d3.select(tt._groups[0][rt[st]])),dt=i(d3.select(tt._groups[0][lt[ct]]));if(ut.push(p(ht,dt)),p(ht,dt)){if(rt[st]==lt[ct])continue;d3.select(tt._groups[0][rt[st]]).remove()}}0==ut.filter((function(t){return 1==t})).length&&lt.push(rt[st])}for(var _t=0;_t<lt.length;_t++)d3.select(tt._groups[0][lt[_t]]).style("opacity","1")}for(var ft=a.selectAll(".radar-area-texts"),pt=[],yt=[],xt=0;xt<ft._groups[0].length;xt++){yt.push(xt);for(var gt=xt+1;gt<ft._groups[0].length;gt++){p(i(d3.select(ft._groups[0][xt])),i(d3.select(ft._groups[0][gt])))&&(pt.push(xt),d3.select(ft._groups[0][xt]).style("visibility","hidden"))}}for(var vt=new Set(pt),mt=Array.from(vt),bt=Lt(mt,yt),St=0;St<mt.length;St++){for(var kt=[],wt=0;wt<bt.length;wt++){var Ct=i(d3.select(ft._groups[0][mt[St]])),Ot=i(d3.select(ft._groups[0][bt[wt]]));if(kt.push(p(Ct,Ot)),p(Ct,Ot)){if(mt[St]==bt[wt])continue;d3.select(ft._groups[0][mt[St]]).style("visibility","hidden")}}0==kt.filter((function(t){return 1==t})).length&&bt.push(mt[St])}for(var Ft=0;Ft<bt.length;Ft++)d3.select(ft._groups[0][bt[Ft]]).style("visibility","visible");return t}function Lt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}a.selectAll("*").remove()}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"tickTextColor",value:function(t){return arguments.length?(this._tickTextColor=t,this):this._tickTextColor}},{key:"tickTextSize",value:function(t){return arguments.length?(this._tickTextSize=t,this):this._tickTextSize}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),ci=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","radar-chart"),i.grid=new gt(i.mainGroup),i.radar=new ui(i.mainGroup),i.radialAxis=new mt(i.mainGroup),i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._donutCount=5,i._fillOpacity=.6,i._curve=d3.curveCardinalClosed,i._lineWidth=2,i._strokeWidth=0,i._strokeColor="#FFFFFF",i._fillColor="",i._endPointRadius=3.5,i._labelShow=!1,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同时径向展开","依次径向展开"],i._moveStyle="同时径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var e=t.activeData,i=t.radar,n=t.radialAxis,a=t.grid,o=t.tooltip,r=(t._fontSize,t.widthOfNoMargin),l=t.heightOfMainGroup,s=0,u=void 0,h=void 0,d=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"";"水平"==t._xLabelDirection&&1==t._xTickShow?(u=d3.max(d.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),h=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(u=d3.max(d.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),h=d3.max(d.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(u=t._fontSize,h=t._fontSize):(u=0,h=0),u=u<.4*r*.88?u:.4*r*.88,h=h<.4*l*.88?h:.4*l*.88,s="外部"==t._axisPositonChoice?Math.min(.88*r/2-u,.88*l/2-h):.88*Math.min(r,l)/2;if(t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var _=x(t._strokeColor),f=[],p=!0,g=!1,v=void 0;try{for(var m,b=_[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var S=m.value,k=[],w=S.split(":");k.push(q(w[0])),k.push(w[1]),f.push(k)}}catch(t){g=!0,v=t}finally{try{!p&&b.return&&b.return()}finally{if(g)throw v}}var C=f.concat(),O=C.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(O[1]).x1+"%").attr("y1",y(O[1]).y1+"%").attr("x2",y(O[1]).x2+"%").attr("y2",y(O[1]).y2+"%").selectAll("stop").data(C).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var F=x(t._fillColor),L=[],P=!0,A=!1,W=void 0;try{for(var z,M=F[Symbol.iterator]();!(P=(z=M.next()).done);P=!0){var D=z.value,N=[],T=D.split(":");N.push(q(T[0])),N.push(T[1]),L.push(N)}}catch(t){A=!0,W=t}finally{try{!P&&M.return&&M.return()}finally{if(A)throw W}}var B=L.concat(),G=B.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(G[1]).x1+"%").attr("y1",y(G[1]).y1+"%").attr("x2",y(G[1]).x2+"%").attr("y2",y(G[1]).y2+"%").selectAll("stop").data(B).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(e).radius(s).curve(t._curve).endPointRadius(t._endPointRadius).strokeWidth(t._strokeWidth).strokeColor(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).lineWidth(t._lineWidth).fillOpacity(t._fillOpacity).fillColor(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).labelShow(t._labelShow).donutCount(t._donutCount).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).tickTextColor(t._fontColor).translate(r/2,l/2).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).showX(t._xTickShow).xLabelDirection(t._xLabelDirection).mainWidth(r).mainHeight(l).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){d3.select(this.parentNode).selectAll(".radar-area").transition().style("fill-opacity",.5),d3.select(this).select(".radar-area").transition().style("fill-opacity",.75);var n=[{color:e.color,text:e.name=="$-"+(i+1)?"":e.name}];e.data.forEach((function(e,i){n.push({text:(e.name=="&-"+(i+1)?"":e.name)+"："+E(e.value,t._numberStyle,t._decimalPlaces)})})),o.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){o.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){d3.select(this.parentNode).transition().selectAll(".radar-area").style("fill-opacity",t._fillOpacity),o.hide()}));var X=d3.max(e,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))}))||1;n.data(e).radius(s).innerRadius(0).startAngle(t._startAngle).endAngle(t._endAngle).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(r).mainHeight(l).suffix(t._yLabelSuffix).maxValue(X).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.update(),n.translate(r/2,l/2).update();var j=n._polarCount;j.push(-s),j=Array.from(new Set(j)),a.donutCount(t._isPolar?j:5).sectorCount(e[0]?e[0].data.length:1).radius(s).innerRadius(0).translate(r/2,l/2).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),a.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"水平").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"");var r={straight:d3.curveLinearClosed,step:d3.curveStepAfter,curve:d3.curveCardinalClosed};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveCardinalClosed,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}}]),e}(vt),hi=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=function(t){var e=[],i={};t.forEach((function(t){t.children.forEach((function(t){var e=t.name+"a";i[e]?i[e]++:i[e]=0}))}));var n=0;for(var a in i)e.push({name:a,count:i[a],index:n}),n++;return e.sort((function(t,e){return e.count-t.count||t.index-e.index})),e.slice(0,2).map((function(t){return t.name.slice(0,t.name.length-1)}))}(t.nodes),i=this.generateColorList(e.length),n={};return e.forEach((function(t,e){return n[t]=i[e]})),t.colorMap=n,t.keys=e,t}}]),e}(it);var di=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","pyramid"),i._xScale=null,i._yScale=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group;e.selectAll("*").remove();for(var n=t._data,a=[],o=[],r=0;r<n.nodes.length;r++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(o.push(0),a.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(a.push(R(E(n.nodes[r].children[0].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)),o.push(R(E(n.nodes[r].children.length>1?n.nodes[r].children[1].value:"",t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))):(o.push(0),a.push(0));var l,s=n.nodes,u=n.colorMap,h=n.keys,d=t._xScale,f=t._yScale,g=Math.abs(d.range()[1]-d.range()[0]),v=f.bandwidth(),m=h[0],b=u[m],S=h[1],k=u[S],w=[],C=[];if(s.forEach((function(t){var e=t.children.filter((function(t){return t.name==m}))[0],i=t.children.filter((function(t){return t.name==S}))[0];w.push({name:t.name,key:t.key,color:b,value:e&&Math.abs(e.value)||0}),C.push({name:t.name,key:t.key,color:k,value:i&&Math.abs(i.value)||0})})),t._strokeColor&&/\[/.test(t._strokeColor)){var O=x(t._strokeColor),F=[],L=!0,P=!1,A=void 0;try{for(var W,z=O[Symbol.iterator]();!(L=(W=z.next()).done);L=!0){var M=W.value,D=[],N=M.split(":");D.push(q(N[0])),D.push(N[1]),F.push(D)}}catch(t){P=!0,A=t}finally{try{!L&&z.return&&z.return()}finally{if(P)throw A}}var T=F.concat(),B=T.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(B[1]>180?360-(B[1]-180):180-B[1]).x1+"%").attr("y1",y(B[1]>180?360-(B[1]-180):180-B[1]).y1+"%").attr("x2",y(B[1]>180?360-(B[1]-180):180-B[1]).x2+"%").attr("y2",y(B[1]>180?360-(B[1]-180):180-B[1]).y2+"%").selectAll("stop").data(T).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(B[1]).x1+"%").attr("y1",y(B[1]).y1+"%").attr("x2",y(B[1]).x2+"%").attr("y2",y(B[1]).y2+"%").selectAll("stop").data(T).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}!function(){if(b&&/\[/.test(b)){var i=x(b),n=[],a=!0,o=!1,r=void 0;try{for(var l,s=i[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value,h=[],p=u.split(":");h.push(q(p[0])),h.push(p[1]),n.push(h)}}catch(t){o=!0,r=t}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}var g=n.concat(),m=g.pop();t.group.append("linearGradient").attr("id",t.id+"-left-index-0").attr("x1",y(m[1]).x1+"%").attr("y1",y(m[1]).y1+"%").attr("x2",y(m[1]).x2+"%").attr("y2",y(m[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var S=e.select(".left-group").empty()?e.append("g").attr("class","left-group"):e.select(".left-group");S.selectAll("text").remove();var k=S.selectAll("rect").data(w,(function(t){return t.key}));if(k.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))k.enter().append("path").merge(k).style("fill",(function(e){return b&&/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b&&/#/.test(b)?b:"rgb("+U(b,0)+","+U(b,1)+","+U(b,2)+")"})).style("fill-opacity",(function(e){if(b&&/#/.test(b))return t._fillOpacity;var i=U(b,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));else if(0==t._moveOptions.indexOf(t._moveStyle)){var C=k.enter().append("path").merge(k).style("fill",(function(e){return b&&/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b&&/#/.test(b)?b:"rgb("+U(b,0)+","+U(b,1)+","+U(b,2)+")"})).style("fill-opacity",(function(e){if(b&&/#/.test(b))return t._fillOpacity;var i=U(b,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:0,height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?C.style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):C.transition().delay((function(e,i){return t._transition?.9*t._duration/(w.length>0?w.length:1)*(w.length-1-i)+t._startDelay:0})).duration(t._transition?.9*t._duration/(w.length>0?w.length:1):0).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){var O=k.enter().append("path").merge(k).style("fill",(function(e){return b&&/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b&&/#/.test(b)?b:"rgb("+U(b,0)+","+U(b,1)+","+U(b,2)+")"})).style("fill-opacity",(function(e){if(b&&/#/.test(b))return t._fillOpacity;var i=U(b,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:0,height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?O.style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):O.transition().delay((function(e,i){return t._transition?.9*t._duration/(w.length>0?w.length:1)*i+t._startDelay:0})).duration(t._transition?.9*t._duration/(w.length>0?w.length:1):0).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}else if(2==t._moveOptions.indexOf(t._moveStyle)){var F=k.enter().append("path").merge(k).style("fill",(function(e){return b&&/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b&&/#/.test(b)?b:"rgb("+U(b,0)+","+U(b,1)+","+U(b,2)+")"})).style("fill-opacity",(function(e){if(b&&/#/.test(b))return t._fillOpacity;var i=U(b,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:0,height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?F.style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):F.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-left-0")+")":t._strokeColor||(/\[/.test(b)?"url("+c("#"+t.id+"-left-index-0")+")":b)})).attr("d",(function(e,i){return _({x:d(-e.value),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(-e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}var L=S.selectAll("text").data(w,(function(t){return t.key}));L.exit().remove();var P=L.enter().append("text").attr("class","pyramid-left-texts").merge(L).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t){return d(-t.value)})).attr("y",(function(e){return f(e.name)+v*(1-t._barWidthPercent)/2})).attr("dy",v*t._barWidthPercent/2+t._fontSize/3).attr("dx",(function(e,i){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?(d3.selectAll(".pyramid-left-texts").attr("text-anchor","end"),.3*-t._fontSize):1==t._positionOptions.indexOf(t._positionChoice)?(d3.selectAll(".pyramid-left-texts").attr("text-anchor","end"),Math.abs(d(-e.value)-d(0))-.3*t._fontSize):void 0})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).style("display",t._labelShow?"block":"none");t._interrupt?P.style("opacity",1):P.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}(),function(){if(k&&/\[/.test(k)){var i=x(k),n=[],a=!0,o=!1,r=void 0;try{for(var l,s=i[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value,h=[],p=u.split(":");h.push(q(p[0])),h.push(p[1]),n.push(h)}}catch(t){o=!0,r=t}finally{try{!a&&s.return&&s.return()}finally{if(o)throw r}}var g=n.concat(),m=g.pop();t.group.append("linearGradient").attr("id",t.id+"-right-index-0").attr("x1",y(m[1]).x1+"%").attr("y1",y(m[1]).y1+"%").attr("x2",y(m[1]).x2+"%").attr("y2",y(m[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var b=e.select(".right-group").empty()?e.append("g").attr("class","right-group"):e.select(".right-group");b.selectAll("text").remove();var S=b.selectAll("rect").data(C,(function(t){return t.key}));if(S.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))S.enter().append("path").merge(S).style("fill",(function(e){return k&&/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k&&/#/.test(k)?k:"rgb("+U(k,0)+","+U(k,1)+","+U(k,2)+")"})).style("fill-opacity",(function(e){if(k&&/#/.test(k))return t._fillOpacity;var i=U(k,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));else if(0==t._moveOptions.indexOf(t._moveStyle)){var w=S.enter().append("path").merge(S).style("fill",(function(e){return k&&/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k&&/#/.test(k)?k:"rgb("+U(k,0)+","+U(k,1)+","+U(k,2)+")"})).style("fill-opacity",(function(e){if(k&&/#/.test(k))return t._fillOpacity;var i=U(k,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:0,height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?w.style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):w.transition().delay((function(e,i){return t._transition?.9*t._duration/(C.length>0?C.length:1)*(C.length-1-i)+t._startDelay:0})).duration(t._transition?.9*t._duration/(C.length>0?C.length:1):0).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){var O=S.enter().append("path").merge(S).style("fill",(function(e){return k&&/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k&&/#/.test(k)?k:"rgb("+U(k,0)+","+U(k,1)+","+U(k,2)+")"})).style("fill-opacity",(function(e){if(k&&/#/.test(k))return t._fillOpacity;var i=U(k,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:0,height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?O.style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):O.transition().delay((function(e,i){return t._transition?.9*t._duration/(C.length>0?C.length:1)*i+t._startDelay:0})).duration(t._transition?.9*t._duration/(C.length>0?C.length:1):0).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}else if(2==t._moveOptions.indexOf(t._moveStyle)){var F=S.enter().append("path").merge(S).style("fill",(function(e){return k&&/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k&&/#/.test(k)?k:"rgb("+U(k,0)+","+U(k,1)+","+U(k,2)+")"})).style("fill-opacity",(function(e){if(k&&/#/.test(k))return t._fillOpacity;var i=U(k,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:0,height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?F.style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):F.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(k)?"url("+c("#"+t.id+"-right-index-0")+")":k)})).attr("d",(function(e,i){return _({x:d(0),y:f(e.name)+v*(1-t._barWidthPercent)/2,width:Math.abs(d(e.value)-d(0)),height:v*t._barWidthPercent,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}var L=b.selectAll("text").data(C,(function(t){return t.key}));L.exit().remove();var P=L.enter().append("text").attr("class","pyramid-right-texts").merge(L).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",d(0)).attr("y",(function(e){return f(e.name)+v*(1-t._barWidthPercent)/2})).attr("dy",v*t._barWidthPercent/2+t._fontSize/3).attr("dx",(function(e,i){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?Math.abs(d(e.value)-d(0))+.3*t._fontSize:1==t._positionOptions.indexOf(t._positionChoice)?.3*t._fontSize:void 0})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).style("display",t._labelShow?"block":"none");t._interrupt?P.style("opacity",1):P.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}(),(l=(e.select(".overlay-group").empty()?e.append("g").attr("class","overlay-group"):e.select(".overlay-group")).selectAll("rect").data(s,(function(t){return t.key}))).exit().remove(),l.enter().append("rect").merge(l).attr("x",d.range()[0]).attr("y",(function(t){return f(t.name)})).attr("width",g).attr("height",v).style("fill","#fff").style("stroke","none").style("fill-opacity",0).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);for(var G=e.selectAll(".pyramid text"),X=[],j=[],I=0;I<G._groups[0].length;I++){j.push(I);for(var Y=I+1;Y<G._groups[0].length;Y++){p(i(d3.select(G._groups[0][I])),i(d3.select(G._groups[0][Y])))&&(X.push(I),d3.select(G._groups[0][I]).style("visibility","hidden"))}}for(var H=new Set(X),V=Array.from(H),$=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(V,j),Z=0;Z<V.length;Z++){for(var Q=[],K=0;K<$.length;K++){var J=i(d3.select(G._groups[0][V[Z]])),tt=i(d3.select(G._groups[0][$[K]]));if(Q.push(p(J,tt)),p(J,tt)){if(V[Z]==$[K])continue;d3.select(G._groups[0][V[Z]]).style("visibility","hidden")}}0==Q.filter((function(t){return 1==t})).length&&$.push(V[Z])}for(var et=0;et<$.length;et++)d3.select(G._groups[0][$[et]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=parseFloat(t),this):this._barCornerRadius}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),_i=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","pyramid-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.core=new di(i.coreGroup),i._marginLeft=15,i._marginRight=20,i._xType="number",i._yType="category",i._yTitle="y",i._xTitle="x",i._barWidthPercent=.5,i._barCornerRadius=0,i._borderWidth=0,i._borderColor="none",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["外部","内部"],i._positionChoice="内部",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["从上至下","从下至上","左右拉伸"],i._moveStyle="从上至下",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.core,i=t.tooltip,n=t.grid,a=t.activeData,r=a.colorMap,l=t.gridEnd-t.gridStart,s=t.heightOfCore,u=[],c=[],h=0;h<t.activeData.nodes.length;h++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(c.push(0),u.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(u.push(R(E(t.activeData.nodes[h].children[0].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)),c.push(R(E(t.activeData.nodes[h].children.length>1?t.activeData.nodes[h].children[1].value:"",t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily))):(c.push(0),u.push(0));var d=t.defs;d.selectAll("filter").remove();var _=d.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_pyramid").attr("filterUnits","objectBoundingBox");if(_.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),_.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),_.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),_.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),_.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t._borderColor&&/\[/.test(t._borderColor)){var f=x(t._borderColor),p=[],g=!0,v=!1,m=void 0;try{for(var b,S=f[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),p.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=p.concat(),F=O.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(a).xScale(t.xScale).yScale(t.yScale).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(t._borderColor).fillOpacity(t._fillOpacity).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e){d3.select(this).style("fill-opacity",.8);var n=[{text:e.name}];e.children.forEach((function(e){e.name in r&&n.push({color:r[e.name],text:e.name+"："+E(e.value,t._numberStyle,t._decimalPlaces)})})),i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){d3.select(this).style("fill-opacity",0),i.hide()})),n.width(l+t.xScale.range()[0]).height(s).planeX(t.xScale.range()[0]).xTickLocations(t.xAxis.tickLocations.slice()).yTickLocations(t.yAxis.tickLocations.slice().map((function(e){return e+t.yScale.bandwidth()/2}))).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.coreGroup.call(o,t.yAxis.width+.5,0),n.translate(t.yAxis.width+.5,0).update(),e.update()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).chartType("pyramid").orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/u;e.tickCount(d),e.compute();for(var _=[],f=[],p=[],y=0;y<t.activeData.nodes.length;y++)p.push(t.activeData.nodes[y].children.length>1?t.activeData.nodes[y].children[1].value:""),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(f.push(0),_.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(_.push(R(E(t.activeData.nodes[y].children[0].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)),f.push(R(E(t.activeData.nodes[y].children.length>1?t.activeData.nodes[y].children[1].value:"",t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily))):(f.push(0),_.push(0));i.compute();var x=0==f.length?0:d3.max(f),g=c-i.width-(0==_.length?0:d3.max(_));i.compute(),n.range([x,g]),e.compute();var v=e._axisStart,m=e._axisEnd,b=0==f.length?0:d3.max(f);v<0&&(x=b+(Math.abs(v)>i.width?Math.abs(v)-i.width:0)),m>g&&(g=g-(m-g)+(0==_.length?0:d3.max(_))),t.gridStart=x,t.gridEnd=g,n.nice().range([x,g]),a.range([h-e.height,0]);var S=i.width,k=h-e.height,w=i.width+x;((0==f.length?0:d3.max(f))>0||p.length>0)&&(w=i.width),e.translate(S,k).update(),i.translate(w,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this._sortedDataCopy,e=[],i=!0,n=!1,a=void 0;try{for(var o,r=t.keys[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;e.push({name:l,color:t.colorMap[l]})}}catch(t){n=!0,a=t}finally{try{!i&&r.return&&r.return()}finally{if(n)throw a}}this.legend.data(e)}},{key:"computeDomain",value:function(){var t=this._data.nodes,e=t.length>0?d3.max(t,(function(t){return d3.max(t.children,(function(t){return Math.abs(t.value)}))})).toFixed(0):1;this._xDomain=[-e,e],this._yDomain=t.length?t.map((function(t){return t.name})):[0,1],this.xAxis.tickFormat((function(t){return Math.abs(t)}))}},{key:"sortData",value:function(){this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new hi(t,e);return i.dataSolveFunc(Ne),i}},{key:"activeData",get:function(){return this._sortedDataCopy}}]),e}(Tt);function fi(t,e){t.on("mouseover",e._onMouseover).on("mousemove",e._onMousemove).on("mouseout",e._onMouseout)}var pi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bar-plot"),i._xScale=null,i._yScale=null,i._fill=null,i._stroke="",i._strokeWidth=0,i._showZeroLine=!0,i._zeroLineStroke="#000",i._fontColor="#000",i._fontSize=13,i._cornerRadius=0,i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,n=t._xScale,a=t._yScale.clamp(!0),o=n.bandwidth()/2,r=n.bandwidth()*t._barWidthPercent,l=a.domain(),s=l.every((function(t){return t>=0}))?"up":l.every((function(t){return t<=0}))?"down":"both",u=a.range()[0],h=t._transition?t._duration:0,d=[],_=0;_<e.length;_++)d.push(e[_].value);var g=G(d,t._fontSize,t._fontFamily),v=t.group;if(v.selectAll("*").remove(),t._stroke&&/\[/.test(t._stroke)){var m=x(t._stroke),b=[],S=!0,k=!1,w=void 0;try{for(var C,O=m[Symbol.iterator]();!(S=(C=O.next()).done);S=!0){var F=C.value,L=[],P=F.split(":");L.push(q(P[0])),L.push(P[1]),b.push(L)}}catch(t){k=!0,w=t}finally{try{!S&&O.return&&O.return()}finally{if(k)throw w}}var A=b.concat(),W=A.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(360-W[1]).x1+"%").attr("y1",y(360-W[1]).y1+"%").attr("x2",y(360-W[1]).x2+"%").attr("y2",y(360-W[1]).y2+"%").selectAll("stop").data(A).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(W[1]).x1+"%").attr("y1",y(W[1]).y1+"%").attr("x2",y(W[1]).x2+"%").attr("y2",y(W[1]).y2+"%").selectAll("stop").data(A).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var z=Math.round(a(0));(v.select(".zero-line").empty()?v.append("line").attr("class","zero-line"):v.select(".zero-line")).attr("x1",n.range()[0]).attr("y1",z).attr("x2",n.range()[1]).attr("y2",z).style("stroke",t._showZeroLine?t._zeroLineStroke:"none").style("stroke-width",t._zeroLineWidth||1);var M=v.selectAll(".rect").data(e);M.exit().transition().duration(h).remove();var D=M.enter().append("path").attr("class","rect").merge(M).style("fill",(function(e,i){var n=t._fill||e.color;return/url/.test(n)||n&&/#/.test(n)?n:"rgb("+U(n,0)+","+U(n,1)+","+U(n,2)+")"})).style("fill-opacity",(function(e){var i=t._fill||e.color;if(/url/.test(i))return t._fillOpacity;if(i&&/#/.test(i))return t._fillOpacity;var n=U(i,3)||1;return t._fillOpacity*n})).style("stroke-width",t._strokeWidth).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).call(fi,t),R=v.selectAll("text").data(e);R.exit().transition().duration(h).remove();var N=R.enter().append("text").attr("class","simple-bar-texts").merge(R).text((function(t){return t.value})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("display",t._labelShow?"block":"none");if("up"===s)D.attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})),N.attr("x",(function(e){return n(e.name)+o*(1-t._barWidthPercent)})).attr("y",(function(t){return a(t.value)})).attr("dx",r/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?-6:1==t._positionOptions.indexOf(t._positionChoice)?Math.abs(u-a(e.value))-6:void 0})).attr("text-anchor","middle"),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?N.style("display","none"):r<g&&1==t._positionOptions.indexOf(t._positionChoice)?N.attr("transform",(function(e){return"rotate(-90 "+(n(e.name)+o)+" "+(a(e.value)+Math.abs(u-a(e.value))-.5*t._fontSize-4)+" )"})).attr("text-anchor","start"):N.attr("transform","rotate(0)");else if("down"===s)D.attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})),N.attr("x",(function(e){return n(e.name)+o*(1-t._barWidthPercent)})).attr("y",0).attr("dx",r/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?-6:1==t._positionOptions.indexOf(t._positionChoice)?a(e.value)-6:void 0})).attr("text-anchor","middle"),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?N.style("display","none"):r<g&&1==t._positionOptions.indexOf(t._positionChoice)?N.attr("transform",(function(e){return"rotate(-90 "+(n(e.name)+o)+" "+(a(e.value)+Math.abs(u-a(e.value))-.5*t._fontSize-4)+" )"})).attr("text-anchor","start"):N.attr("transform","rotate(0)");else{var T=Math.round(a(0));D.attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):T,width:r,height:Math.abs(T-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})),N.attr("x",(function(e){return n(e.name)+o*(1-t._barWidthPercent)})).attr("y",(function(t){return t.value>=0?a(t.value):T})).attr("dx",r/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?-6:1==t._positionOptions.indexOf(t._positionChoice)?Math.abs(T-a(e.value))-6:void 0})).attr("text-anchor","middle"),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?N.style("display","none"):r<g&&1==t._positionOptions.indexOf(t._positionChoice)?N.attr("transform",(function(e){return"rotate(-90 "+(n(e.name)+o)+" "+(a(e.value)+Math.abs(u-a(e.value))-.5*t._fontSize-4)+" )"})).attr("text-anchor","start"):N.attr("transform","rotate(0)")}if(null==t._positionOptions||null==t._positionChoice)N.style("display","none");else if(0==t._positionOptions.indexOf(t._positionChoice)){for(var B=v.selectAll(".simple-bar-texts"),X=[],j=[],I=0;I<B._groups[0].length;I++){j.push(I);for(var Y=I+1;Y<B._groups[0].length;Y++){p(i(d3.select(B._groups[0][I])),i(d3.select(B._groups[0][Y])))&&(X.push(I),d3.select(B._groups[0][I]).style("opacity","0"))}}for(var H=new Set(X),E=Array.from(H),V=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(E,j),$=0;$<E.length;$++){for(var Z=[],Q=0;Q<V.length;Q++){var K=i(d3.select(B._groups[0][E[$]])),J=i(d3.select(B._groups[0][V[Q]]));if(Z.push(p(K,J)),p(K,J)){if(E[$]==V[Q])continue;d3.select(B._groups[0][E[$]]).style("opacity","0")}}0==Z.filter((function(t){return 1==t})).length&&V.push(E[$])}for(var tt=0;tt<V.length;tt++)d3.select(B._groups[0][V[tt]]).style("opacity","1")}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"zeroLineWidth",value:function(t){return arguments.length?(this._zeroLineWidth=t,this):this._zeroLineWidth}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this.fillOpacity}}]),e}(at),yi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("rect").attr("class","overlay-rect"),i._width=0,i._height=0,i._bandX=0,i._onMouseover=function(){},i._onMousemove=function(){},i._onMouseout=function(){},i}return w(e,t),S(e,[{key:"update",value:function(){return this.elem.attr("x",this._bandX).attr("y",0).attr("width",this._width<0?0:this._width).attr("height",this._height).style("fill","#000").style("opacity",0).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),this}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"bandX",value:function(t){return arguments.length?(this._bandX=t,this):this._bandX}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),e}(L),xi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","multiple-bar"),i.overlay=new yi(i.group),i._width=400,i._height=400,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._zeroLineStroke="#000",i._gapPadding=5,i._allowedMaxTextWidth=100,i._xScale=d3.scaleBand(),i._yScale=d3.scaleLinear(),i._mainLeft=0,i._mainWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var i=t._width,n=t._height,a=t._fontSize,o=t._fontFamily,r=t._gapPadding,l=n/e.length,s=d3.max(e,(function(t){return d3.max(t.data,(function(t){return Math.abs(t.value)}))})),u=d3.max(e,(function(t){return R(t.name,a,o)})),h=u>t._allowedMaxTextWidth,d=e.length>0?Math.min(u,t._allowedMaxTextWidth):0+t._gapPadding,_=i-d-0,f=t._xScale.domain(e.length>0?e[0].data.map((function(t){return t.name})):[]).range([0,_]),p=t._yScale.domain([-s,s]).range([l,0]);return function(){var i=t.group.selectAll(".bar-plot-group").data(e,(function(t){return t.key}));i.exit().remove();var n=i.enter().append("g").attr("class","bar-plot-group").merge(i).style("font-size",a+"px").style("font-family",o).each((function(e,i){var n=d3.select(this),s=n.property("bar-plot")||new pi(n);n.property("bar-plot",s),(n.select(".left-text").empty()?n.append("text").attr("class","left-text"):n.select(".left-text")).attr("x",-r).attr("y",l/2).attr("dy","0.35em").style("text-anchor","end").style("fill",t._fontColor).text((function(t){return h?X(t.name,d,a,o):t.name})).attr("font-size",t._fontSize).attr("font-family",t._fontFamily),s.data(e.data).xScale(f).yScale(p).fill(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color).showZeroLine(t._showZeroLine).zeroLineStroke(t._zeroLineStroke).transition(t._transition).zeroLineWidth(t._zeroLineWidth).duration(t._duration).cornerRadius(t._barCornerRadius).stroke(t._strokeColor).barWidthPercent(t._barWidthPercent).strokeWidth(t._strokeWidth).fillOpacity(t._fillOpacity),s.update()})).attr("transform",(function(t,e){return"translate("+d+", "+l*e+")"}));null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?n.style("opacity",1):n.style("opacity",0).transition().duration(t._transition?t._duration/(e.length>0?e.length:1):0).delay((function(i,n){return t._transition?n*(t._duration/(e.length>0?e.length:1))+t._startDelay:0})).style("opacity",1))}(),t.overlay.elem.raise(),t.overlay.width(_).height(n).translate(d,0).onMouseover(t._onMouseover).onMousemove(t._onMousemove).onMouseout(t._onMouseout).update(),t._mainLeft=d,t._mainWidth=_,t}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"zeroLineWidth",value:function(t){return arguments.length?(this._zeroLineWidth=t,this):this._zeroLineWidth}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"xScale",get:function(){return this._xScale}},{key:"yScale",get:function(){return this._yScale}},{key:"mainLeft",get:function(){return this._mainLeft}},{key:"mainWidth",get:function(){return this._mainWidth}}]),e}(at),gi="axis-group",vi="x-title",mi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-x"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=void 0;(s=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding);var u=n.select(".axis-group").empty()?n.append("g").attr("class",gi):n.select(".axis-group");u.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).call(s).on("start",(function(i,n){u.selectAll(".tick text").style("fill",t._fontColor).attr("dx",0).attr("dy","0.71em").attr("transform","rotate(0)").style("text-anchor","middle").text((function(t,e){return l[e]})).filter((function(){return r})).attr("dx","-0.5em").style("text-anchor","end").attr("transform","rotate("+t._tickTextRotate+")").filter((function(){return"top"!==e})).attr("dy","0.5em"),u.selectAll(".tick line").style("stroke",t._lineStroke),u.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")}));var c=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var h=n.select(".x-title").empty()?n.append("g").attr("class",vi):n.select(".x-title"),d=h.select("text").empty()?h.append("text"):h.select("text");h.call(o,c/2,t.height),d.attr("dy","0.5em").attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy","-0.5em").text(t._title)}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0;function o(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a}var r=t._scaleFunc,l=t._type,s=t._fontSize,u=(t._minTickDistance,t._allowedMaxTextHeight),c=Math.abs(r.range()[0]-r.range()[1]),h=void 0,d=void 0;if(e="category"===l?r.domain():r.ticks(t._tickCount),"number"===l&&0!=r.domain()[0]&&e.push(r.domain()[0]),function(){var r=!1;h=c/e.length,(d=d3.max(e,(function(e){return R(e,s,t._fontFamily)})))<h&&(n=0,i=e,a=1.125*s,o(),r=!0);return r}())return t;n="top"===t._orient?45:-45;var _=Math.abs(Math.sin(Math.PI/4));d*_<u?(a=d*_,i=e):(a=u,i=e.map((function(e){return X(e,a/_,s,t._fontFamily)})));var f=c/e.length;if("category"===l&&2*s>f){var p=Math.ceil(2*s/f);e=e.filter((function(t,e){return e%p==0}))}return o(),t}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"height",get:function(){var t=0;return this.isShow&&(t=(this._tickShow?this._tickSize+this._tickPadding+1.2*this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.25*this._fontSize:0)),t}}]),e}(Bt),bi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","multiple-bar-chart"),i.core=new xi(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.xAxis=new mi(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._barWidthPercent=.5,i._barCornerRadius=[0,0,0,0],i._fillOpacity=1,i._borderWidth=0,i._borderColor="none",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["从上至下","横向展开"],i._moveStyle="从上至下",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.core,n=t.tooltip,a=t.overlay,o=t.guideLine,r=t.widthOfCore,l=t.heightOfCore,s=(t.AnimationArea,i.xScale);if(o.y1(0).y2(l).stroke("#c6c6c6").strokeDasharray("0 0"),i.data(e).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(t._borderColor).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).width(r).height(l).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).zeroLineStroke(t._axisLineStrokeX).zeroLineWidth(t._xAxisLineWidth).showZeroLine(t._xAxisShow).allowedMaxTextWidth(r/5).update(),a.data(s.domain()).bandWidth(s.step()).bandHeight(l).isScalePoint(!1).translate(i.mainLeft,0).onMouseover((function(a,r){var l=a,u=s.step(),c=[{text:l}];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===l}));c.push({text:e.name+": "+E(n[0].value,t._numberStyle,t._decimalPlaces),color:e.color})})),n.data(c).update(),o.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+(s(l)+i.mainLeft+u/2)+",0)"),n.move([d3.event.offsetX,d3.event.offsetY]).show(),o.show()})).onMousemove((function(){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){n.hide(),o.hide()})),a.update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle));else if(1==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("x",-t._fontSize).attr("height",t.heightOfMainGroup).attr("width",t._width),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("height",t.heightOfMainGroup).attr("x",-t._fontSize).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",t._width),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}}},{key:"updateAxis",value:function(){var t=this,e=t.xAxis;e.scaleFunc(d3.scaleLinear().range([0,t.widthOfNoMargin])).title(t._xTitle).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),e.translate(0,t.heightOfMainGroup-e.height).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.display;0!==Object.getOwnPropertyNames(a).length&&(this._barWidthPercent=0==a.barWidthPercent||a.barWidthPercent?a.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==a.bar4CornerRadius||a.bar4CornerRadius?a.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==a.borderWidth||a.borderWidth?a.borderWidth:this._borderWidth,this._borderColor=a.borderColor?q(a.borderColor):"",this._fillOpacity=0==a.fillOpacity||a.fillOpacity?a.fillOpacity:1),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}}]),e}(Tt),Si=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bubble-plot"),i._radius=function(){},i._cx=function(){},i._cy=function(){},i._fill=null,i._stroke=null,i._strokeWidth=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));t._transition&&t._duration;var a=n.selectAll("circle").data(e,(function(t){return t.key}));a.exit().remove();var o=a.enter().append("circle").merge(a).attr("cx",t._cx).attr("cy",t._cy).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).attr("r",0).style("stroke",(function(e,i){return t._bubbleBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._bubbleBorderWidth||0).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),r=n.selectAll("text").data(e,(function(t){return t.key}));r.exit().remove();var l=r.enter().append("text").attr("class","bubble-text").merge(r).text((function(e){return E(e.radius,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",t._cx).attr("y",t._cy).attr("tips",(function(t){return t.radius})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").attr("dy","0.4em").style("display",t._labelShow?"block":"none");t._interrupt?(o.attr("r",t._radius),l.style("opacity",1)):(o.transition().duration(t._transition?t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+t._duration/(e.length>0?e.length:0)*n:0})).attr("r",t._radius),l.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+t._duration:0})).style("opacity",1));for(var s=t.group.selectAll(".bubble-text"),u=[],h=[],d=0;d<s._groups[0].length;d++){h.push(d);for(var _=d+1;_<s._groups[0].length;_++){var f=d3.select(s._groups[0][d]).attr("tips")||0,g=d3.select(s._groups[0][_]).attr("tips")||1;p(i(d3.select(s._groups[0][d])),i(d3.select(s._groups[0][_])))&&(parseFloat(f)<parseFloat(g)?(u.push(d),d3.select(s._groups[0][d]).style("visibility","hidden")):(u.push(_),d3.select(s._groups[0][_]).style("visibility","hidden")))}}for(var v=new Set(u),m=Array.from(v),b=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(m,h),S=0;S<m.length;S++){for(var k=[],w=0;w<b.length;w++){var C=i(d3.select(s._groups[0][m[S]])),O=i(d3.select(s._groups[0][b[w]]));if(k.push(p(C,O)),p(C,O)){if(m[S]==b[w])continue;d3.select(s._groups[0][m[S]]).style("visibility","hidden")}}0==k.filter((function(t){return 1==t})).length&&b.push(m[S])}for(var F=0;F<b.length;F++)d3.select(s._groups[0][b[F]]).style("visibility","visible");for(var L=0;L<s._groups[0].length;L++){var P=i(d3.select(s._groups[0][L]));parseFloat(d3.select(s._groups[0][L]).attr("x"))+parseFloat(P.width)/2>t._width&&d3.select(s._groups[0][L]).style("visibility","hidden")}return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"cx",value:function(t){return arguments.length?(this._cx=t,this):this._cx}},{key:"cy",value:function(t){return arguments.length?(this._cy=t,this):this._cy}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"bubbleBorderWidth",value:function(t){return arguments.length?(this._bubbleBorderWidth=t,this):this._bubbleBorderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}}]),e}(at),ki=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.categories,i=this.generateColorList(e.length),n={},a=[];return e.forEach((function(t,e){var o=i[e];n[t]=o,a.push({name:t,color:o})})),t.nodes.forEach((function(t){return t.color=n[t.category]})),0==e.length&&t.nodes.forEach((function(t){return t.color=i[0]})),t.legendData=a,t}}]),e}(it);function wi(t,e){var i=0,n=1,a=2,o=3,r=4;e.forEach((function(t){"typeCol"===t.function?i=t.index:"objCol"===t.function?n=t.index:"X轴"===t.name?a=t.index:"Y轴"===t.name?o=t.index:"半径"===t.name&&(r=t.index)}));var l=[],s=[],u={};t.slice(1).forEach((function(t,e){var c=t[i]||"",h=t[n]||"",d=t[a],_=t[o],f=t[r]||0,p=c+"-"+h+"-"+e;u[c]||""==c||(u[c]=c,l.push(c)),s.push({category:c,name:h,x:d,y:_,radius:f,key:p})}));var c=t[0],h={category:c[i]||"",name:c[n]||"",x:c[a],y:c[o],radius:c[r]||0};return{categories:l,nodes:s,labels:h}}var Ci="axis-group",Oi="y-title",Fi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-horizontal"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i._countOfLabel=null,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=e._orient,n=e._scaleFunc,a=e.group,r=e._fontSize,l=e._tickValueTexts,s=void 0;s=e.axisFunc="right"===i?d3.axisRight(n):d3.axisLeft(n);var u=null;"number"===e._type&&e._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(u=d3.format("d")),s.tickValues(e._tickValues).tickSizeInner(e._tickSize).tickSizeOuter(-.5).tickPadding(e._tickPadding).tickFormat(u);var c=a.select(".axis-group").empty()?a.append("g").attr("class",Ci):a.select(".axis-group");c.transition().duration(e._transition?e._duration:0).call(s).on("start",(function(){c.selectAll(".tick text").remove(),c.selectAll(".tick").filter((function(t,i){return-1!=e._tickValues.indexOf(t)})).append("text").style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).style("display",e._tickShow?"block":"none").attr("dx",(function(t,e){return-8})).attr("dy",.4*r).text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})),c.selectAll(".tick line").style("stroke",e._lineStroke).style("display",e._axisLineShow?"block":"none").style("stroke-width",e._yAxisLineWidth),c.select("path").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none")}));var h=e.group.selectAll(".axis-y-horizontal .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)||"&-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove();var d=Math.abs(n.range()[0]-n.range()[1]);if(e._titleShow&&e._title){var _=a.select(".y-title").empty()?a.append("g").attr("class",Oi):a.select(".y-title"),f=_.select("text").empty()?_.append("text"):_.select("text"),p=(R(e._title,r,e._fontFamily),d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(null==e?"":e,t._fontSize,t._fontFamily)})));_.call(o,-(this._tickShow?(p?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0!=parseFloat(e._yAxisLineWidth)&&e._yAxisLineWidth&&e._axisLineShow?5:0),d/2),f.attr("y",-9).style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(e._title)}else a.select(".y-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);Math.abs(a.range()[0]-a.range()[1]);e="category"===o?a.domain():a.ticks(t._tickCount),"number"===o&&0!=t._yRange.length&&null!=t._yRange[0]&&t._yRange[0].constructor!==Object&&(t._yRange[0]==e[0]&&e.shift(),e.unshift(-1==String(t._yRange[0]).indexOf(".")?t._yRange[0]:t._yRange[0].toFixed(0)));new Array;var s=[];if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[0],c=(Math.abs(parseFloat(u))>1?Math.round(parseFloat(u)):u)||0,h=a.domain()[1]||1;if(0!=t._countOfLabel){var d=h-c,_=t._countOfLabel,f=Math.ceil(Math.abs(d/t._countOfLabel)),p=8*Math.ceil(t._tickCount),y=d3.tickStep(c,h,p);t._countOfLabel<y&&(f=Math.ceil(Math.abs(d/y)),_=y),h+=f;for(var x=0;x<f+1;x++)s.push(c+x*_)}else s.push(c);"number"===o&&0!=t._yRange.length&&(1==t._yRange.length?isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]):(isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]),isNaN(t._yRange[1])||null==t._yRange[1]||(s[s.length-1]>t._yRange[1]&&s.pop(),s.push(t._yRange[1]))),s=Array.from(new Set(s))),0!=t._countOfLabel&&a.domain([d3.min(s),d3.max(s)]);var g=[];s.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;g.push(i)}})),g=g.filter((function(t){return t<=8})),s=s.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(g)&&(t=parseFloat(t).toFixed(d3.max(g)))}return t}))}if(i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o){for(var v=[],m=0;m<e.length;m++)v.push(E(e[m],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=v}var b=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(null==e?"":e,r,t._fontFamily)}))||0;return b<=l?(i=i,n=b):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"width",get:function(){var t=this,e=d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(null==e?"":e,t._fontSize,t._fontFamily)})),i=0;return this.isShow&&(i=this._tickShow?(e?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0),i}}]),e}(Bt),Li=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","grouping-bubble-chart"),i.clipArea=new Ut(i.defs),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup).tickFormat((function(t){return t})),i.yAxis=new Fi(i.mainGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleLinear(),i._xType="number",i._yType="number",i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.core=new Si(i.coreGroup),i._sortValue=-1,i._bubbleSizeType="area",i._bubbleBorderColor="",i._bubbleBorderWidth=1,i._minRadius=0,i._maxRadius=32,i._fillOpacity=.9,i._labelShow=!1,i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="依次出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.core,i=t.tooltip,n=t.grid,a=t.clipArea,r=t.activeData,l=r.nodes,s=r.labels,u=(t.xAxis._axisStart,t.xAxis._axisEnd),h=0;u>t.widthOfNoMargin-t.yAxis.width&&(h=u-(t.widthOfNoMargin-t.yAxis.width));var d=t.widthOfCore-h,_=t.heightOfCore,f=t.xScale,p=t.yScale,x=d3.max(l,(function(t){return Math.abs(t.radius)})),g=d3.scaleSqrt().domain([0,x]).range([t._minRadius,t._maxRadius]);function v(t){return new Function("return "+t)()}"diameter"==t._bubbleSizeType&&(g=d3.scaleLinear().domain([0,x]).range([t._minRadius,t._maxRadius])),t.group.selectAll(".hover-gradient").remove(),l.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=v(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("class","hover-gradient").attr("id",t.id+"-hover-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var m=t._numberLabel.fontFamily,b=t._numberLabel.fontSize,S=q(t._numberLabel.color);if(t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var k=v(t._bubbleBorderColor),w=[],C=!0,O=!1,F=void 0;try{for(var L,P=k[Symbol.iterator]();!(C=(L=P.next()).done);C=!0){var A=L.value,W=[],z=A.split(":");W.push(q(z[0])),W.push(z[1]),w.push(W)}}catch(t){O=!0,F=t}finally{try{!C&&P.return&&P.return()}finally{if(O)throw F}}var M=w.concat(),D=M.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(D[1]).x1+"%").attr("y1",y(D[1]).y1+"%").attr("x2",y(D[1]).x2+"%").attr("y2",y(D[1]).y2+"%").selectAll("stop").data(M).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(l).cx((function(t){return f(isNaN(t.x)?0:t.x)})).cy((function(t){return p(isNaN(t.y)?0:t.y)})).radius((function(t){return g(isNaN(Math.abs(t.radius))?0:Math.abs(t.radius))})).stroke("#fff").transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).bubbleBorderColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).bubbleBorderWidth(t._bubbleBorderWidth).fillOpacity(t._fillOpacity).fontSize(b).fontFamily(m).fontColor(S).labelShow(t._labelShow).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).width(t.widthOfNoMargin-t.yAxis.width).onMouseover((function(e){0==t._bubbleBorderWidth&&d3.select(this).style("stroke-width","1"),d3.select(this).style("stroke","#000");var n=[{color:e.color,text:s.category+"："+e.category},{text:s.name+"："+e.name},{text:s.x+"："+E(e.x,t._numberStyle,t._decimalPlaces)},{text:s.y+"："+E(e.y,t._numberStyle,t._decimalPlaces)},{text:s.radius+"："+E(e.radius,t._numberStyle,t._decimalPlaces)}];""==e.category&&(n=[{text:s.name+"："+e.name},{text:s.x+"："+E(e.x,t._numberStyle,t._decimalPlaces)},{text:s.y+"："+E(e.y,t._numberStyle,t._decimalPlaces)},{text:s.radius+"："+E(e.radius,t._numberStyle,t._decimalPlaces)}]),""==e.name&&(n=[{color:e.color,text:s.category+"："+e.category},{text:s.x+"："+E(e.x,t._numberStyle,t._decimalPlaces)},{text:s.y+"："+E(e.y,t._numberStyle,t._decimalPlaces)},{text:s.radius+"："+E(e.radius,t._numberStyle,t._decimalPlaces)}]),""==e.category&&""==e.name&&(n=[{text:s.x+"："+E(e.x,t._numberStyle,t._decimalPlaces)},{text:s.y+"："+E(e.y,t._numberStyle,t._decimalPlaces)},{text:s.radius+"："+E(e.radius,t._numberStyle,t._decimalPlaces)}]),i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e,n){0==t._bubbleBorderWidth&&d3.select(this).style("stroke-width","0"),d3.select(this).style("stroke",(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor)||(/\[/.test(e.color)?"url("+c("#"+t.id+"-hover-index-"+n)+")":e.color)),i.hide()})),n.width(d).height(_).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length||0!=t._clipShowX.length?(a.width(d).height(_).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+a.id)+")"),a.update()):(a.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),a.update()),(null==t._clipShow[0]&&null==t._clipShow[1]||""==t._clipShow[0]&&""==t._clipShow[1]||null==t._clipShow[0]&&null==t._clipShow[1])&&(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&(a.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),a.update(),t.coreGroup.attr("clip-path","")),e.update(),n.translate(t.yAxis.width+.5,0).update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy,i=e.legendData;t.legend.data(i).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),i.forEach((function(t){t.name===n.name&&(t.active=!a)})),e.nodes.forEach((function(t){t.category===n.name&&(t.active=!a)})),t.onDataChange()}))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.3*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"computeDomain",value:function(){var t=this.activeData.nodes,e=this._xRange||[],i=this._yRange||[],n=d3.extent(t,(function(t){return parseFloat(t.x)})),a=d3.extent(t,(function(t){return parseFloat(t.y)})),o=[Math.min(0,n[0]||0),Math.max(1,n[1]||0)],r=[Math.min(0,a[0]||0),Math.max(1,a[1]||0)];this._xDomain=[isNaN(parseFloat(e[0]))?o[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?isNaN(parseFloat(e[0]))?o[1]:o[1]<e[0]?1.5*e[0]:o[1]:parseFloat(e[1])],this._yDomain=[isNaN(parseFloat(i[0]))?r[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?r[1]:r[1]<i[0]?1.5*i[0]:r[1]:parseFloat(i[1])]}},{key:"sortData",value:function(){var t=this._data;-1===this._sortValue?t.nodes.sort((function(t,e){return e.radius-t.radius||t.index-e.index})):1===this._sortValue&&t.nodes.sort((function(t,e){return t.radius-e.radius||t.index-e.index})),this._sortedDataCopy=t}},{key:"buildOption",value:function(t,e){var i=new ki(t,e);return i.dataSolveFunc(wi),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range).yRange(a.range).clipShow(a.range).clipShowX(n.range).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.display,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(o.display||0==o.display?(this._labelShow=o.display||0==o.display?o.display:this._labelShow,this._numberLabel=o.textLabel?o.textLabel:this._numberLabel,this._suffix=""):(this._labelShow=o.numberLabel?o.numberLabel.show:this._labelShow,this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel,this._suffix=o.numberLabel&&o.numberLabel.suffix?o.numberLabel.suffix:"")),0!==Object.getOwnPropertyNames(i).length&&(this._bubbleSizeType=i.bubbleSizeType?i.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=i.bubbleBorderColor?q(i.bubbleBorderColor):"",this._bubbleBorderWidth=0==i.bubbleBorderWidth||i.bubbleBorderWidth?i.bubbleBorderWidth:this._bubbleBorderWidth,this._minRadius=0==i.minRadius||i.minRadius?i.minRadius:this._minRadius,this._maxRadius=0==i.maxRadius||i.maxRadius?i.maxRadius:this._maxRadius,this._fillOpacity=0==i.fillOpacity||i.fillOpacity?i.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{nodes:t.nodes.filter((function(t){return!1!==t.active})),labels:t.labels}}}]),e}(Tt),Pi=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.minValue,i=t.maxValue,n=t.data,a=this.generateColorList(),o=[],r=[];if(1==a.length)if(a[0]&&/\[/.test(a[0])){var l=x(a[0]),s=[],u=[],c=!0,h=!1,d=void 0;try{for(var _,f=l[Symbol.iterator]();!(c=(_=f.next()).done);c=!0){var p=_.value.split(":");s.push(q(p[0])),u.push(p[1])}}catch(t){h=!0,d=t}finally{try{!c&&f.return&&f.return()}finally{if(h)throw d}}var y=s.concat();y.pop();var g=u.concat();g.pop(),o=y,r=g}else o.push(a[0]),o.push(a[0]);else o=a;var v=o.length,m=(i-e)/(v-1),b=d3.range(v).map((function(t){return e+m*t})),S=d3.scaleLinear().domain(b).range(o);return 1==a.length&&a[0]&&/\[/.test(a[0])&&(b=r.map((function(t,n){return e+(i-e)*t})),S=d3.scaleLinear().domain(b).range(o)),n.forEach((function(t){t.nodes.forEach((function(t){return t.color=S(t.value)}))})),t.colorScale=S,t.offset=r,t}}]),e}(it);function Ai(t,e){var i=0,n=1;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n))return{data:[],minValue:0,maxValue:0,dateLabel:"",valueLabel:""};for(var a={},o=/^\d{1,4}(\-|\/)\d{1,2}(\-|\/)\d{1,2}$/,r=1,l=t.length;r<l;r++){var s=t[r],c=s[i],h=parseFloat(s[n]);if(o.test(c)&&!isNaN(h)&&"Invalid Date"!==new Date(c)){c=u(c);var d=new Date(c),_=d.getFullYear();a[_]||(a[_]=[]),a[_].push({date:d,dateString:c,value:h})}}var f=[];for(var p in a)f.push({year:parseInt(p),nodes:a[p]});var y=d3.max(f,(function(t){return d3.max(t.nodes,(function(t){return t.value}))}));return{data:f,minValue:d3.min(f,(function(t){return d3.min(t.nodes,(function(t){return t.value}))})),maxValue:y,dateLabel:t[0][i],valueLabel:t[0][n]}}var Wi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","calendar-heatmap"),i._cellSize=20,i._cellFill="#fff",i._cellStroke="#ccc",i._monthStroke="#000",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=parseInt(e.year),n=e.nodes,a=t._cellSize,o=t.group;function r(t){var e=new Date(t.getFullYear(),t.getMonth()+1,0),i=t.getDay(),n=d3.timeWeek.count(d3.timeYear(t),t),o=e.getDay(),r=d3.timeWeek.count(d3.timeYear(e),e);return"M"+(n+1)*a+","+i*a+"H"+n*a+"V"+7*a+"H"+r*a+"V"+(o+1)*a+"H"+(r+1)*a+"V0H"+(n+1)*a+"Z"}o.selectAll("*").remove(),function(){var e=(o.select(".bottom-group").empty()?o.append("g").attr("class","bottom-group"):o.select(".bottom-group")).selectAll(".bottom-rect").data((function(){return d3.timeDays(new Date(i,0,1),new Date(i+1,0,1))}));e.exit().remove();var n=e.enter().append("rect").attr("class","bottom-rect").merge(e).attr("x",(function(t){return d3.timeWeek.count(d3.timeYear(t),t)*a})).attr("y",(function(t){return t.getDay()*a})).attr("width",a).attr("height",a).style("fill",t._cellFill).style("stroke",t._cellStroke).style("stroke-dasharray",(function(){return t._gridShowX&&t._gridShowY?0:t._gridShowX?a+" "+a:t._gridShowY?"0 "+a+" 0":void 0})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).style("opacity",0);t._interrupt?n.style("opacity",1):n.transition().duration(t._transition?.4*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1)}(),function(){var e=(o.select(".active-group").empty()?o.append("g").attr("class","active-group"):o.select(".active-group")).selectAll(".color-rect").data(n,(function(t){return t.date}));e.exit().remove();var i=e.enter().append("rect").attr("class","color-rect").merge(e).attr("x",(function(t){return d3.timeWeek.count(d3.timeYear(t.date),t.date)*a})).attr("y",(function(t){return t.date.getDay()*a})).attr("width",a).attr("height",a).style("fill",(function(t){return t.color})).style("stroke",t._cellStroke).style("stroke-dasharray",(function(){return t._gridShowX&&t._gridShowY?0:t._gridShowX?a+" "+a:t._gridShowY?"0 "+a+" 0":void 0})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).style("opacity",0);i.transition().duration(t._transition?.5*t._duration:0).delay(t._transition?t._startDelay+.4*t._duration:0).style("opacity",1),t._interrupt?i.style("opacity",1):i.transition().duration(t._transition?.5*t._duration:0).delay(t._transition?t._startDelay+.4*t._duration:0).style("opacity",1)}(),function(){var e=(o.select(".month-group").empty()?o.append("g").attr("class","month-group"):o.select(".month-group")).selectAll(".month-path").data((function(){return d3.timeMonths(new Date(i,0,1),new Date(i+1,0,1))}));e.exit().remove();var n=e.enter().append("path").attr("class","month-path").merge(e).style("fill","none").style("stroke",t._monthStroke).attr("d",r).style("opacity",0);t._interrupt?n.style("opacity",1):n.transition().duration(t._transition?.4*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1)}()}},{key:"cellSize",value:function(t){return arguments.length?(this._cellSize=t,this):this._cellSize}},{key:"cellFill",value:function(t){return arguments.length?(this._cellFill=t,this):this._cellFill}},{key:"cellStroke",value:function(t){return arguments.length?(this._cellStroke=t,this):this._cellStroke}},{key:"monthStroke",value:function(t){return arguments.length?(this._monthStroke=t,this):this._monthStroke}},{key:"gridShowX",value:function(t){return arguments.length?(this._gridShowX=t,this):this._gridShowX}},{key:"gridShowY",value:function(t){return arguments.length?(this._gridShowY=t,this):this._gridShowY}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),zi=function(){function t(e){b(this,t),this.id=r(""),this.elem=e.append("linearGradient").attr("id",this.id),this._colorList=[],this._offsetList=[]}return S(t,[{key:"update",value:function(){var t=this,e=t.elem,i=t._colorList,n=t._offsetList||[],a=i.length;if(n.length!==a){var o=1/(a-1);n=d3.range(a).map((function(t){return o*t}))}var r=e.selectAll("stop").data(i);return r.exit().remove(),r.enter().append("stop").merge(r).attr("offset",(function(t,e){return n[e]})).attr("stop-color",(function(t){return t})),t}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"offsetList",value:function(t){return arguments.length?(this._offsetList=t,this):this._offsetList}}]),t}(),Mi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","gradient-legend"),i.group=i.elem.append("g"),i.defs=i.elem.append("defs"),i.gradient=new zi(i.defs),i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._rectWidth=100,i._rectHeight=30,i._colorList=[],i._startText=0,i._endText=1,i._paddingHor=3,i._paddingVer=5,i._limitedWidth=400,i._horizontalAlign="center",i._title="title",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.gradient,i=t._rectWidth,n=t._rectHeight,a=t.group.style("font-size",t._fontSize+"px").style("font-family",t._fontFamily),r=a.select("rect").empty()?a.append("rect"):a.select("rect"),l=a.select(".start-text").empty()?a.append("text").attr("class","start-text"):a.select(".start-text"),s=a.select(".end-text").empty()?a.append("text").attr("class","end-text"):a.select(".end-text"),u=a.select(".legend-title").empty()?a.append("text").attr("class","legend-title"):a.select(".legend-title");e.colorList(t._colorList).offsetList(t._offsetList).update(),r.attr("x",0).attr("y",0).attr("width",i).attr("height",n).style("fill","url(#"+t.gradient.id+")"),u.attr("x",i/2).attr("y",n+t._paddingVer).attr("dy","1em").style("text-anchor","middle").style("fill",t._fontColor).text(t._title),l.attr("x",-t._paddingHor).attr("y",n/2).attr("dy","0.35em").style("text-anchor","end").style("fill",t._fontColor).text(t._startText),s.attr("x",i+t._paddingHor).attr("y",n/2).attr("dy","0.35em").style("text-anchor","start").style("fill",t._fontColor).text(t._endText);var c=t._horizontalAlign;return"left"===c?a.call(o,R(this._startText,t._fontSize,t._fontFamily),0):"right"===c?a.call(o,t._limitedWidth-i-R(this._endText,t._fontSize,t._fontFamily),0):a.call(o,t._limitedWidth/2-i/2,0),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"rectWidth",value:function(t){return arguments.length?(this._rectWidth=t,this):this._rectWidth}},{key:"rectHeight",value:function(t){return arguments.length?(this._rectHeight=t,this):this._rectHeight}},{key:"paddingHor",value:function(t){return arguments.length?(this._paddingHor=t,this):this._paddingHor}},{key:"paddingVer",value:function(t){return arguments.length?(this._paddingVer=t,this):this._paddingVer}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"offsetList",value:function(t){return arguments.length?(this._offsetList=t,this):this._offsetList}},{key:"startText",value:function(t){return arguments.length?(this._startText=t,this):this._startText}},{key:"endText",value:function(t){return arguments.length?(this._endText=t,this):this._endText}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}}]),e}(L),Di=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","calendar-heatmap-chart"),i.legend=new Mi(i.group),i.xAxis=new mi(i.mainGroup),i._sortValue=1,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="淡入",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=e.data,n=e.valueLabel,a=t.tooltip,o=t.widthOfCore,r=t.heightOfCore/i.length,l=Math.min(r/7,o/56),s=t._gridShowX||t._gridShowY?t._gridStroke:"none",u=t._xTickShow?t._axisLineStroke:"none",c=53*l,h=7*l,d=d3.timeFormat("%Y-%m-%d"),_=t.coreGroup.selectAll(".year-group").data(i,(function(t){return t.year}));_.exit().remove(),_.enter().append("g").attr("class","year-group").merge(_).attr("transform",(function(t,e){return"translate("+(o-c)/2+", "+(r*e+(r-h)/2)+")"})).each((function(e){var i=d3.select(this),o=i.property("calendar")||new Wi(i);i.property("calendar",o),o.data(e).cellSize(l).cellStroke(s).monthStroke(u).gridShowX(t._gridShowX).gridShowY(t._gridShowY).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).onMouseover((function(e){var i=[];i=e instanceof Date?[{text:d(e)}]:[{text:e.dateString,color:e.color},{text:n+"："+E(e.value,t._numberStyle,t._decimalPlaces)}],d3.select(this).raise().style("stroke","#000"),a.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){d3.select(this).style("stroke",s),a.hide()})),o.update(),i.selectAll(".calendar-year").remove();var r=i.select("text").empty()?i.append("text"):i.select("text");r.attr("class","calendar-year").attr("transform","translate(-6, "+h/2+")rotate(-90)").style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor","middle").text(e.year).style("opacity",0),t._interrupt?r.style("opacity",1):r.transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay+.9*t._duration*1e3:0).style("opacity",1)}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"updateLegend",value:function(){var t=this,e=t.legend,i=t.widthOfNoMargin;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(i).horizontalAlign(t._legendX).rectWidth(i/5).rectHeight(i/5/10).fontSize(t._legendFontSize).fontFamily(t._legendFontFamily).fontColor(t._legendFontColor),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.colorList(e.colorScale.range()).offsetList(e.offset).startText(E(e.minValue,t._numberStyle,t._decimalPlaces)).endText(E(e.maxValue,t._numberStyle,t._decimalPlaces)).title(e.valueLabel)}},{key:"updateAxis",value:function(){var t=this,e=t.xAxis;e.scaleFunc(d3.scaleLinear().range([0,t.widthOfNoMargin])).title(t._xTitle).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),e.translate(0,t.heightOfMainGroup-e.height).update()}},{key:"computeDomain",value:function(){}},{key:"sortData",value:function(){var t=this._data.data;1===this._sortValue?t.sort((function(t,e){return t.year-e.year})):-1===this._sortValue&&t.sort((function(t,e){return e.year-t.year})),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new Pi(t,e);return i.dataSolveFunc(Ai),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{data:t.data,valueLabel:t.valueLabel}}}]),e}(Tt),Ri=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","hollow-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth="",i._fillOpacity=.7,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;if(n.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var a=x(t._borderColor),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],g=d.split(":");_.push(q(g[0])),_.push(g[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var v=o.concat(),m=v.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(m[1]>180?360-(m[1]-180):180-m[1]).x1+"%").attr("y1",y(m[1]>180?360-(m[1]-180):180-m[1]).y1+"%").attr("x2",y(m[1]>180?360-(m[1]-180):180-m[1]).x2+"%").attr("y2",y(m[1]>180?360-(m[1]-180):180-m[1]).y2+"%").selectAll("stop").data(v).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(m[1]).x1+"%").attr("y1",y(m[1]).y1+"%").attr("x2",y(m[1]).x2+"%").attr("y2",y(m[1]).y2+"%").selectAll("stop").data(v).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var b=n.append("g").attr("class","hollow-bar-rects").selectAll("rect").data(e,(function(t){return t.key}));b.exit().remove();var S=b.enter().append("path").merge(b).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));if(t._rectObj?(S.attr("d",(function(e,i){return f({x:t._xScale(0),y:t._rectObj.yFunc(e,i),width:0,height:t._rectObj.heightFunc(e,i),cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),S.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})})),t._interrupt&&S.interrupt().style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})}))):S.style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(t){return f({x:0,y:0,width:0,height:0,cornerRadius:0,roundCorners:[0,1,2,3],type:"horizontal"})})),this._textObj){n.select(".hollow-bar-texts").remove();var k=n.append("g").attr("class","hollow-bar-texts").selectAll("text").data(e,(function(t){return t.key}));k.exit().remove();var w=k.enter().append("text").attr("class","hollow-bar-text").merge(b).text(this._textObj.textFunc).attr("fill",t._textObj.colorFunc).attr("font-size",t._textObj.fontSize).attr("font-family",t._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dy",this._textObj.dyFunc).attr("dx",(function(e,a){return null==t._labelShow||0==t._labelShow||null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?e.value>0?.3*t._textObj.fontSize:-i(d3.select(n.selectAll(".hollow-bar-texts text").nodes()[a])).width-.3*t._textObj.fontSize:1==t._positionOptions.indexOf(t._positionChoice)?e.value>0?-(t._xScale(e.value)-t._xScale(0))+.3*t._textObj.fontSize:-(t._xScale(e.value)-t._xScale(0))-i(d3.select(n.selectAll(".hollow-bar-texts text").nodes()[a])).width-.3*t._textObj.fontSize:2==t._positionOptions.indexOf(t._positionChoice)?e.value>0?.3*-t._textObj.fontSize-i(d3.select(n.selectAll(".hollow-bar-texts text").nodes()[a])).width:.3*t._textObj.fontSize:void 0})).style("display",this._textObj.labelShow?"block":"none");t._interrupt?w.style("opacity",1):w.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1),null!=t._labelShow&&0!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||n.selectAll(".hollow-bar-texts text").style("display","none")}for(var C=n.selectAll(".hollow-bar-text"),O=[],F=[],L=0;L<C._groups[0].length;L++){F.push(L);for(var P=L+1;P<C._groups[0].length;P++){p(i(d3.select(C._groups[0][L])),i(d3.select(C._groups[0][P])))&&(O.push(L),d3.select(C._groups[0][L]).style("visibility","hidden"))}}for(var A=new Set(O),W=Array.from(A),z=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(W,F),M=0;M<W.length;M++){for(var D=[],R=0;R<z.length;R++){var N=i(d3.select(C._groups[0][W[M]])),T=i(d3.select(C._groups[0][z[R]]));if(D.push(p(N,T)),p(N,T)){if(W[M]==z[R])continue;d3.select(C._groups[0][W[M]]).style("visibility","hidden")}}0==D.filter((function(t){return 1==t})).length&&z.push(W[M])}for(var B=0;B<z.length;B++)d3.select(C._groups[0][z[B]]).style("visibility","visible");return S.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),Ni=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("rect").attr("class","selectOverlay-rect"),i._width=0,i._height=0,i._shadowColor="#000",i._tranX=0,i}return w(e,t),S(e,[{key:"update",value:function(){return this.elem.attr("x",this._tranX).attr("y",0).attr("width",this._width<0?0:this._width).attr("height",this._height).style("fill",this._shadowColor).style("opacity",.15),this}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}},{key:"tranX",value:function(t){return arguments.length?(this._tranX=t,this):this._tranX}}]),e}(L),Ti=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","hollow-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.yAxis.minTickDistance(1),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new Ri(i.coreGroup),i.overlay=new te(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._rectHeight=.5,i._barCornerRadius=[0,0,0,0],i._borderWidth=2,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["右边","内部居左","内部居右"],i._positionChoice="内部居右",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向同步拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=[],n=[],a=[];e.children.forEach((function(t){t.children.forEach((function(e){e.color=t.color,i.push(e)}))})),i.sort((function(t,e){return t.index-e.index}));for(var r=0;r<i.length;r++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(n.push(0),a.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?i[r].value>0||0==i[r].value?a.push(R(E(i[r].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):i[r].value<0&&n.push(R(E(i[r].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(n.push(0),a.push(0));var l=t.xScale,s=t.yScale;1.1*Math.min(d3.min(i,(function(t){return+t.value})),0)<0?(t.group.selectAll(".hollow-chart .axis-y-horizontal path").attr("transform","translate("+(-(l.range()[0]-l(0))+t.gridStart)+",0)"),t.group.selectAll(".hollow-chart .axis-y-horizontal line").attr("transform","translate("+(-(l.range()[0]-l(0))+t.gridStart)+",0)")):(t.group.selectAll(".hollow-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),t.group.selectAll(".hollow-chart .axis-y-horizontal line").attr("transform","translate(0,0)"));var u,h,d=t.grid,_=t.rectPlot,f=t.tooltip,p=t.overlay,y=t.selectOverlay,x=(t.clipArea,t.gridEnd-t.gridStart),g=t.heightOfCore,v=s.step();(d.width(x+l.range()[0]).height(g).planeX(l.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),p.data(s.domain()).isScalePoint(!1).isHorizontal(!0).bandX(l.range()[0]).bandWidth(x).bandHeight(s.step()).onMouseover((function(n,a){for(var o=s.domain()[i.length-a-1==-1?1:i.length-a-1==-2?0:i.length-a-1],r=i.filter((function(t){return t.name===o})),l=[],u="",c=0;c<e.children.length;c++)for(var h=0;h<e.children[c].children.length;h++)e.children[c].children[h].name==o&&(u=e.children[c].name);o&&1!=o&&((l=[{text:u}]).push({text:r[0].name+": "+E(r[0].value,t._numberStyle,t._decimalPlaces),color:r[0].color}),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+s(o)+")")),f.data(l).update(),f.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){f.move([d3.event.offsetX,d3.event.offsetY]),y.show()})).onMouseout((function(){f.hide(),y.hide()})),y.width(x).height(s.step()).shadowColor("#ccc").hide(),u=i,h=new Map,i=u.filter((function(t){return!h.has(t.name)&&h.set(t.name,1)})),_.data(i).xScale(l).yScale(s).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).fillOpacity(t._fillOpacity).borderWidth(t._borderWidth).borderColor(t._borderColor).barCornerRadius(t._barCornerRadius).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).rectObj({xFunc:function(e){return e.value>0||0==e.value?t.xScale(0):e.value<0?t.xScale(e.value):void 0},yFunc:function(e,i){return t.yScale.range()[0]-(i*v+(v-v*t._rectHeight)/2+v*t._rectHeight)},widthFunc:function(e){return e.value>0||0==e.value?t.xScale(e.value)-t.xScale(0)>0?t.xScale(e.value)-t.xScale(0):0:e.value<0?t.xScale(0)-t.xScale(e.value)>0?t.xScale(0)-t.xScale(e.value):0:void 0},heightFunc:function(e){return v*t._rectHeight}}).textObj({xFunc:function(e,i){return t.xScale(e.value)},yFunc:function(e,i){return t.yScale.range()[0]-(i*v+(v-.9*v*t._rectHeight)/2+.7*v*t._rectHeight)},dyFunc:.5*v*t._rectHeight/2+t._textLabel.fontSize/3,colorFunc:function(){return q(t._textLabel.color)},textFunc:function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix},fontSize:t._textLabel.fontSize,fontFamily:t._textLabel.fontFamily,labelShow:t._labelShow}),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),d.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),d.translate(t.yAxis.width+.5,t.xAxis.height)),d.update(),y.update(),_.update(),p.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+t.gridStart),0!=t._xRange.length)&&(0==isNaN(parseFloat(t._xRange[0]))||0==isNaN(parseFloat(t._xRange[1]))?(t.mainGroup.selectAll(".clip-defs").remove(),t.mainGroup.append("defs").attr("class","clip-defs").append("clipPath").attr("id","clip-overlay-"+t.id).append("rect").attr("x",t.gridStart).attr("height",g).attr("width",x),t.coreGroup.attr("clip-path","url("+c("#clip-overlay-"+t.id)+")")):t.coreGroup.attr("clip-path",""))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var d=t.activeData,_=[];d.children.forEach((function(t){t.children.forEach((function(e){e.color=t.color,_.push(e)}))})),_.sort((function(t,e){return t.index-e.index}));for(var f=[],p=[],y=[],x=0;x<_.length;x++)_[x].value<0&&y.push(_[x].value),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(f.push(0),p.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?_[x].value>0||0==_[x].value?p.push(R(E(_[x].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):_[x].value<0&&f.push(R(E(_[x].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(f.push(0),p.push(0));i&&i.titleHeight;var g=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(g).compute(),i.compute();var v=0==f.length?0:d3.max(f),m=c-i.width-(0==p.length?0:d3.max(p));i.compute(),n.range([v,m]),e.compute();var b=e._axisStart,S=e._axisEnd,k=0==f.length?0:d3.max(f);b<0&&(v=k+(Math.abs(b)>i.width?Math.abs(b)-i.width:0)),S>m&&(m=m-(S-m)+(0==valueRight.length?0:d3.max(valueRight))),t.gridStart=v,t.gridEnd=m,n.range([v,m]),a.range([h-e.height,0]);var w=i.width,C=h-e.height,O=i.width+v,F=0;((0==f.length?0:d3.max(f))>0||y.length>0)&&(O=i.width);var L=e.height;"上面"==t._axisPositonChoiceX?(C=L,F=L):C=(t._axisPositonChoiceX,h-L),e.translate(w,C).update(),i.translate(O,F).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"computeDomain",value:function(){var t,e,i=this,n=i.activeData,a=[];n.children.forEach((function(t){t.children.forEach((function(e){e.color=t.color,a.push(e)}))})),t=a,e=new Map,(a=t.filter((function(t){return!e.has(t.name)&&e.set(t.name,1)}))).sort((function(t,e){return t.index-e.index}));var o=i._xRange||[],r=a.length?a.map((function(t){return t.name})):[0,1],l=a.length?[1.1*Math.min(d3.min(a,(function(t){return+t.value})),0),Math.max(1.1*d3.max(a,(function(t){return+t.value})),0)]:[0,1];i._xDomain=[isNaN(parseFloat(o[0]))?l[0]:parseFloat(o[0]),isNaN(parseFloat(o[1]))?isNaN(parseFloat(o[0]))?l[1]:l[1]<o[0]?1.5*o[0]:l[1]:parseFloat(o[1])],i._yDomain=r}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._rectHeight=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._rectHeight,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"configLegend",value:function(){var t=this,e=t.activeData,i=e.children.map((function(t,e){return{name:t.name,color:t.color,key:t.name+"-"+e,index:t.index}}));i.sort((function(t,e){return t.index-e.index})),t.legend.data(i).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),i.forEach((function(t){t.key===n.key&&(t.active=!a)})),e.children.forEach((function(t){t.name===n.name&&(t.active=!a)})),t.onDataChange()}))}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new Re(t,e);return i.dataSolveFunc(Ne),i}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter((function(t){return!1!==t.active}))}}}]),e}(Tt),Bi=function(t){function e(t){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data,n=t._xScale,a=t._yScale;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-scatter-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var o=e.selectAll("g").data(i,(function(t){return t.name}));o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").attr("class","stacked-scatter-circle").attr("cx",(function(t){return n(t.name)||0})).attr("cy",(function(t){return a(t.total)||0})).merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t){return n(t.name)||0})).attr("cy",(function(t){return a(t.total)||0}))}));for(var r=e.selectAll(".stacked-scatter-circle").nodes(),l=0;l<r.length;l++)""==r[l].__data__.value||isNaN(r[l].__data__.value)?d3.select(r[l]).style("opacity","0"):d3.select(r[l]).style("opacity","1");return t}}]),e}(Vt),Gi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-area-line-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._lineWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-line-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)){var i=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t.group,a=n.selectAll("path").data(e,(function(t){return t.key}));a.exit().remove(),a.enter().append("path").merge(a).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return i(t.data)}));var o=n.append("g").selectAll("g").data(e,(function(t){return t.name}));o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.total)||0})).attr("r",t._radius)}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){for(var r=[],l=0;l<e.length;l++){r[l]={},r[l].name=e[l].name,r[l].color=e[l].color,r[l].data=[];for(var s=0;s<e[l].data.length;s++)r[l].data[s]={},r[l].data[s].total=e[l].data[0].total,r[l].data[s].value=e[l].data[0].value,r[l].data[s].name=e[l].data[s].name}var u=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));u.curve(t._curve);var h=t.group;h.selectAll("path").remove();var d=h.selectAll("path").data(e,(function(t){return t.key}));d.exit().remove();var _=d.enter().append("path").merge(d).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry),f=h.append("g").selectAll("g").data(e,(function(t){return t.name}));f.exit().remove();f.enter().append("g").merge(f).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();var a=n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?a.attr("cy",(function(e){return t._yScale(e.total)||0})):a.attr("cy",(function(e,n){return t._yScale(r[i].data[n].total)||0})).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?.9*t._duration:0).attr("cy",(function(e){return t._yScale(e.total)||0}))}));t._interrupt?_.attr("d",(function(t){return u(t.data)})):_.attr("d",(function(t,e){return u(r[e].data)})).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?.9*t._duration:0).attr("d",(function(t){return u(t.data)}))}else if(2==t._moveOptions.indexOf(t._moveStyle)){var p=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),g=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total-e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));p.curve(t._curve),g.curve(t._curve);var v=t.group;v.selectAll("path").remove();var m=v.selectAll("path").data(e,(function(t){return t.key}));m.exit().remove();var b=m.enter().append("path").merge(m).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry),S=v.append("g").selectAll("g").data(e,(function(t){return t.name}));S.exit().remove();var k=S.enter().append("g").merge(S).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.total)||0})).attr("r",t._radius)}));t._interrupt?(b.style("opacity",1).attr("d",(function(t){return p(t.data)})),k.style("opacity",1)):(b.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+.8*t._duration:0})).duration(t._transition?.1*t._duration:0).style("opacity",1).attr("d",(function(t){return p(t.data)})),k.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+.8*t._duration:0})).duration(t._transition?.1*t._duration:0).style("opacity",1))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var w=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),C=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));w.curve(t._curve),C.curve(t._curve);var O=t.group;O.selectAll("path").remove();var F=O.selectAll("path").data(e,(function(t){return t.key}));F.exit().remove();var L=F.enter().append("path").merge(F).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry),P=O.append("g").selectAll("g").data(e,(function(t){return t.name}));P.exit().remove();var A=P.enter().append("g").merge(P).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();var a=n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?a.attr("cy",(function(e){return t._yScale(e.total)||0})):a.attr("cy",(function(e){return t._yScale(0)||0})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("cy",(function(e){return t._yScale(e.total)||0}))}));t._interrupt?(L.style("opacity",1).attr("d",(function(t){return w(t.data)})),A.style("opacity",1)):(L.attr("d",(function(t){return C(t.data)})).style("opacity",0).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).attr("d",(function(t){return w(t.data)})),A.style("opacity",0).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1))}else if(4==t._moveOptions.indexOf(t._moveStyle)){var W=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),z=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total-e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));W.curve(t._curve),z.curve(t._curve);var M=t.group;M.selectAll("path").remove();var D=M.selectAll("path").data(e,(function(t){return t.key}));D.exit().remove();var R=D.enter().append("path").merge(D).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry),N=M.append("g").selectAll("g").data(e,(function(t){return t.name}));N.exit().remove();var T=N.enter().append("g").merge(N).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.total)||0})).attr("r",t._radius)}));t._interrupt?(R.style("opacity",1).attr("d",(function(t){return W(t.data)})),T.style("opacity",1)):(R.style("opacity",0).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:0)*(n+1):0})).style("opacity",1).attr("d",(function(t){return W(t.data)})),T.style("opacity",0).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:0)*(n+1):0})).style("opacity",1))}for(var B=t.group.selectAll(".clip-scatter-plot").nodes(),G=0;G<B.length;G++)""==B[G].__data__.value||isNaN(B[G].__data__.value)?d3.select(B[G]).style("visibility","hidden"):d3.select(B[G]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"radiusFill",value:function(t){return arguments.length?(this._radiusFill=t,this):this._radiusFill}},{key:"radiusStroke",value:function(t){return arguments.length?(this._radiusStroke=t,this):this._radiusStroke}},{key:"radiusWidth",value:function(t){return arguments.length?(this._radiusWidth=t,this):this._radiusWidth}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),Xi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stacked-chart"),i.grid=new Jt(i.coreGroup),i.areaPlot=new ri(i.coreGroup),i.linePlot=new Gi(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new Bi(i.coreGroup),i.areaStackText=new qt(i.coreGroup),i.clipArea=new Ut(i.defs),i.AnimationArea=new Zt(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._curve=d3.curveCardinal,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=0,i._fillOpacity=.7,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向展开","起波澜","同步展示面","纵向同步拉伸","分步展示面"],i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.areaPlot,a=t.linePlot,r=t.guideScatter,l=t.tooltip,s=t.areaStackText,u=t.overlay,h=t.guideLine,d=t.clipArea,_=(t.AnimationArea,t.xScale),f=t.yScale,p=(t.xAxis._axisStart,t.xAxis._axisEnd),g=0;p>t.widthOfNoMargin-t.yAxis.width&&(g=p-(t.widthOfNoMargin-t.yAxis.width));for(var v=t.widthOfCore-g,m=t.heightOfCore,b=0;b<e.length;b++)for(var S=0;S<e[b].data.length;S++)e[b].data[S].value=parseFloat(e[b].data[S].value),e[b].data[S].total=0==b?isNaN(parseFloat(e[b].data[S].value))?0:parseFloat(e[b].data[S].value):e[b-1].data[S].total+(isNaN(parseFloat(e[b].data[S].value))?0:parseFloat(e[b].data[S].value));Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0);var k=t.defs;k.selectAll("filter").remove();var w=k.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_stacklinear").attr("filterUnits","objectBoundingBox");if(w.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),w.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),w.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),w.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),w.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),i.width(v).height(m).planeX(_.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).xScale(_).yScale(f).fillOpacity(t._fillOpacity).curve(t._curve).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).moveOptions(t._moveOptions).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var C=x(t._strokeColor),O=[],F=!0,L=!1,P=void 0;try{for(var A,W=C[Symbol.iterator]();!(F=(A=W.next()).done);F=!0){var z=A.value,M=[],D=z.split(":");M.push(q(D[0])),M.push(D[1]),O.push(M)}}catch(t){L=!0,P=t}finally{try{!F&&W.return&&W.return()}finally{if(L)throw P}}var R=O.concat(),N=R.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(N[1]).x1+"%").attr("y1",y(N[1]).y1+"%").attr("x2",y(N[1]).x2+"%").attr("y2",y(N[1]).y2+"%").selectAll("stop").data(R).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var T=x(t._fillColor),B=[],G=!0,X=!1,j=void 0;try{for(var I,Y=T[Symbol.iterator]();!(G=(I=Y.next()).done);G=!0){var H=I.value,V=[],$=H.split(":");V.push(q($[0])),V.push($[1]),B.push(V)}}catch(t){X=!0,j=t}finally{try{!G&&Y.return&&Y.return()}finally{if(X)throw j}}var U=B.concat(),Z=U.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(Z[1]).x1+"%").attr("y1",y(Z[1]).y1+"%").attr("x2",y(Z[1]).x2+"%").attr("y2",y(Z[1]).y2+"%").selectAll("stop").data(U).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(e).xScale(_).yScale(f).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).mainGroup(t.mainGroup).curve(t._curve).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).moveOptions(t._moveOptions).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).lineWidth(t._lineWidth).radius(t._endPointRadius).radiusFill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).radiusStroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).radiusWidth(t._strokeWidth),r.xScale(_).yScale(f).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),h.y1(0).y2(m).stroke("#c6c6c6").strokeDasharray("0 0"),u.data(_.domain()).bandWidth(_.step()).bandHeight(m).bandX(_.range()[0]).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],s=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));s.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),l.data(o).update(),h.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+_(a)+",0)"),r.data(s).update(),l.move([d3.event.offsetX,d3.event.offsetY]).show(),h.show(),r.show()})).onMousemove((function(){l.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){l.hide(),h.hide(),r.hide()})),s.data(e).xScale(_).yScale(f).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(d.width(v).height(m).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+d.id)+")"),d.update()):(d.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),d.update()),r.elem.style("pointer-events","none");var Q=t.group.selectAll(".stacked-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));if(d3.selectAll(Q).remove(),i.update(),u.update(),n.update(),a.update(),s.update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))t.coreGroup.select(".area-plot").attr("clip-path",""),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","");else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)+_.range()[0]).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).attr("width",v+2*parseFloat(t._endPointRadius)-_.range()[0]),t.coreGroup.select(".area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)+_.range()[0]).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",v+2*parseFloat(t._endPointRadius)-_.range()[0]),t.coreGroup.select(".area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}else t.coreGroup.select(".area-plot").attr("clip-path",""),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","")}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);e.compute(),i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.display,r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(o).length&&(this._lineWidth=0==o.lineWidth||o.lineWidth?d(o.lineWidth):this._lineWidth,this._curve=o.lineType?r[o.lineType]:d3.curveCardinal,this._endPointRadius=0==o.endPointRadius||o.endPointRadius?o.endPointRadius:this._endPointRadius,this._strokeWidth=0==o.endPointBorderWidth||o.endPointBorderWidth?o.endPointBorderWidth:this._strokeWidth,this._strokeColor=o.endPointBorderColor?q(o.endPointBorderColor):"",this._fillColor=o.endPointFillColor?q(o.endPointFillColor):"",this._fillOpacity=0==o.fillOpacity||o.fillOpacity?o.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)e[i].data[n].value=parseFloat(e[i].data[n].value),e[i].data[n].total=0==i?isNaN(parseFloat(e[i].data[n].value))?0:parseFloat(e[i].data[n].value):e[i-1].data[n].total+(isNaN(parseFloat(e[i].data[n].value))?0:parseFloat(e[i].data[n].value));var a=t._yRange||[],o=e.length?e[0].data.map((function(t){return t.name})):[0,1],r=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0),1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))]:[0,1];t._xDomain=o,t._yDomain=[isNaN(parseFloat(a[0]))?r[0]:parseFloat(a[0]),isNaN(parseFloat(a[1]))?isNaN(parseFloat(a[0]))?r[1]:r[1]<a[0]?1.5*a[0]:r[1]:parseFloat(a[1])]}}]),e}(Tt),ji=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rect-plot"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth=0,i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=n.selectAll("rect").data(e,(function(t){return t.key}));a.exit().remove();var o=a.enter().append("g").append("path").merge(a).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0}));if(this._rectObj?o.attr("d",(function(e,i){return _({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):o.attr("d",(function(t,e){return _({x:0,y:0,width:0,height:0,cornerRadius:0,roundCorners:[0,1,2,3]})})),this._textObj){n.selectAll(".symmetric-texts").remove();var r=n.append("g").attr("class","symmetric-texts").selectAll("text").data(e,(function(t){return t.key}));r.exit().remove();r.enter().append("g").append("text").merge(r).text(this._textObj.textFunc).attr("fill",t._textObj.colorFunc).attr("font-size",t._textObj.fontSize).attr("font-family",t._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).style("display",this._textObj.labelShow?"block":"none")}o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);for(var l=n.selectAll(".symmetric-texts text"),s=[],u=[],h=0;h<l._groups[0].length;h++){u.push(h);for(var d=h+1;d<l._groups[0].length;d++){p(i(d3.select(l._groups[0][h])),i(d3.select(l._groups[0][d])))&&(s.push(h),d3.select(l._groups[0][h]).style("opacity","0"))}}for(var f=new Set(s),g=Array.from(f),v=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(g,u),m=0;m<g.length;m++){for(var b=[],S=0;S<v.length;S++){var k=i(d3.select(l._groups[0][g[m]])),w=i(d3.select(l._groups[0][v[S]]));if(b.push(p(k,w)),p(k,w)){if(g[m]==v[S])continue;d3.select(l._groups[0][g[m]]).style("opacity","0")}}0==b.filter((function(t){return 1==t})).length&&v.push(g[m])}for(var C=0;C<v.length;C++)d3.select(l._groups[0][v[C]]).style("opacity","1");return t}},{key:"updateChangeWaterfall",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove(),i.select(".change-rects").remove(),e.forEach((function(e,i){var n="";if((n=e.value>0?e.color:e.color_special)&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,c=a[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var h=u.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),o.push(d)}}catch(t){l=!0,s=t}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}var f=o.concat(),p=f.pop();t.group.append("linearGradient").attr("id",t.id+"-changeWaterfall-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=i.append("g").attr("class","change-rects").selectAll("rect").data(e,(function(t){return t.key}));n.exit().remove();var a=n.enter().append("path").merge(n).style("fill",(function(e,i){var n="";return n=e.value>0?e.color:e.color_special,"linear"==t._colorType&&(n=e.linearColor),n&&/\[/.test(n)?"url("+c("#"+t.id+"-changeWaterfall-index-"+i)+")":n&&/#/.test(n)?n:"rgb("+U(n,0)+","+U(n,1)+","+U(n,2)+")"})).style("fill-opacity",(function(e){var i="";if(i=e.value>0?e.color:e.color_special,"linear"==t._colorType&&(i=e.linearColor),i&&/#/.test(i))return t._fillOpacity;var n=U(i,3)||1;return t._fillOpacity*n})).style("stroke-width",(function(e){return t._borderWidth||0}));if(this._rectObj?(a.attr("d",(function(e,i){return _({x:t._rectObj.xFunc(e,i),y:t._yScale(e.total-e.value),width:t._rectObj.widthFunc(e,i),height:0,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})),a.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){var n="";return n=e.value>0?e.color:e.color_special,"linear"==t._colorType&&(n=e.linearColor),t._borderColor||(/\[/.test(n)?"url("+c("#"+t.id+"-formWaterfall-index-"+i)+")":n)})).attr("d",(function(e,i){return _({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})),t.interrupt=function(e){a.interrupt().style("stroke",(function(e,i){var n="";return n=e.value>0?e.color:e.color_special,"linear"==t._colorType&&(n=e.linearColor),t._borderColor||(/\[/.test(n)?"url("+c("#"+t.id+"-formWaterfall-index-"+i)+")":n)})).attr("d",(function(e,i){return _({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}):a.attr("d",(function(t,e){return _({x:0,y:0,width:0,height:0,cornerRadius:0,roundCorners:[0,1,2,3]})})),this._textObj){i.select(".change-texts").remove();var o=i.append("g").attr("class","change-texts").selectAll("text").data(e,(function(t){return t.key}));o.exit().remove();var r=o.enter().append("text").merge(o).text(this._textObj.textFunc).attr("fill",t._textObj.colorFunc).attr("font-size",t._textObj.fontSize).attr("font-family",t._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("text-anchor","middle");r.style("display",this._textObj.labelShow?"block":"none").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),t.interruptText=function(t){r.interrupt().style("opacity",1)},null!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||i.selectAll(".change-texts text").style("display","none")}return a.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"updateFormWaterfall",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove(),i.select(".form-rects").remove(),e.forEach((function(e,i){var n="";if((n=e.value>0?e.color:e.color_special)&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,c=a[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var h=u.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),o.push(d)}}catch(t){l=!0,s=t}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}var f=o.concat(),p=f.pop();t.group.append("linearGradient").attr("id",t.id+"-formWaterfall-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=i.append("g").attr("class","form-rects").selectAll("rect").data(e,(function(t){return t.key}));n.exit().remove();var a=n.enter().append("path").merge(n).style("fill",(function(e,i){var n="";return(n=e.value>0?e.color:e.color_special)&&/\[/.test(n)?"url("+c("#"+t.id+"-formWaterfall-index-"+i)+")":n&&/#/.test(n)?n:"rgb("+U(n,0)+","+U(n,1)+","+U(n,2)+")"})).style("fill-opacity",(function(e){var i="";if((i=e.value>0?e.color:e.color_special)&&/#/.test(i))return t._fillOpacity;var n=U(i,3)||1;return t._fillOpacity*n})).style("stroke-width",(function(e){return t._borderWidth||0}));if(this._rectObj?(a.attr("d",(function(e,i){var n=0;return n=0==i?t._yScale(e.total-e.value):t._yScale(e.total),_({x:t._rectObj.xFunc(e,i),y:n,width:t._rectObj.widthFunc(e,i),height:0,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})),a.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){var n="";return n=e.value>0?e.color:e.color_special,t._borderColor||(/\[/.test(n)?"url("+c("#"+t.id+"-formWaterfall-index-"+i)+")":n)})).attr("d",(function(e,i){return _({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})),t.interrupt=function(e){a.interrupt().style("stroke",(function(e,i){var n="";return n=e.value>0?e.color:e.color_special,t._borderColor||(/\[/.test(n)?"url("+c("#"+t.id+"-formWaterfall-index-"+i)+")":n)})).attr("d",(function(e,i){return _({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}))}):a.attr("d",(function(t,e){return _({x:0,y:0,width:0,height:0,cornerRadius:0,roundCorners:[0,1,2,3]})})),this._textObj){i.select(".form-texts").remove();var o=i.append("g").attr("class","form-texts").selectAll("text").data(e,(function(t){return t.key}));o.exit().remove();var r=o.enter().append("text").merge(o).text(this._textObj.textFunc).attr("fill",t._textObj.colorFunc).attr("font-size",t._textObj.fontSize).attr("font-family",t._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("text-anchor","middle");r.style("display",this._textObj.labelShow?"block":"none").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),t.interruptText=function(t){r.interrupt().style("opacity",1)},null!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||i.selectAll(".form-texts text").style("display","none")}return a.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"colorType",value:function(t){return arguments.length?(this._colorType=t,this):this._colorType}}]),e}(at),Ii=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return function(t,e){return t.forEach((function(t,i){t.color=e[i],t.color_special=e[i+1]?e[i+1]:e[i],t.data.forEach((function(e){e.color=t.color,e.color_special=t.color_special}))})),t}(t,this.generateColorList(t.length))}}]),e}(it),Yi="legend-group",Hi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","waterfalllegend"),i.group=i.elem.append("g"),i._data=[],i._shapeType="circle",i._shapeWidth=12,i._shapeHeight=12,i._shapeStroke="none",i._rowGap=6,i._colGap=20,i._innerGap=6,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._limitedWidth=400,i._horizontalAlign="center",i._onClick=function(){},i._each=function(){},i._orient="horizontal",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,n=Math.max(t._shapeHeight,t._fontSize),a=t._limitedWidth-t._shapeWidth-t._innerGap,r=0,l=0;t.elem.selectAll(".legend-group").remove();var s=e.append("g").attr("class",Yi);if(t._data.length>0){var u={name:t._data[0].name,data:t._data[0].data,color:t._data[0].color,color_special:t._data[0].color_special,key:t._data[0].key,name1:"收入"},c={name:t._data[0].name,data:t._data[0].data,color:t._data[0].color,color_special:t._data[0].color_special,key:t._data[0].key,name1:"支出"},h=[];h.push(u),h.push(c);("linear"==t._colorType?t._data:h).forEach((function(i,o){var u=X(i.name1,a,t._fontSize,t._fontFamily),c=t._shapeWidth+t._innerGap+R(u,t._fontSize,t._fontFamily);if("vertical"===t._orient)t._legendItem(i,s,0,l,o),l=l+n+t._rowGap;else{var h=r+c+t._colGap;h>t._limitedWidth&&(r=0,h=c+t._colGap,l+=n+t._rowGap,s=e.append("g").attr("class",Yi)),t._legendItem(i,s,r,l,o),r=h}}));var d=i(e).width;"center"===t._horizontalAlign?e.call(o,t._limitedWidth/2-d/2,0):"left"===t._horizontalAlign?e.call(o,0,0):"right"===t._horizontalAlign&&e.call(o,t._limitedWidth-d,0)}return t}},{key:"_shapeElem",value:function(t){var e=void 0;return(e="rect"===this._shapeType?t.append("rect").attr("width",this._shapeWidth).attr("height",this._shapeHeight):t.append("circle").attr("cx",this._shapeWidth/2).attr("cy",this._shapeHeight/2).attr("r",Math.min(this._shapeWidth,this._shapeHeight)/2)).attr("class","legend-shape"),e}},{key:"_legendItem",value:function(t,e,i,n,a){var r=this,l=e.append("g").datum(t).attr("class","legend-item").call(o,i,n).on("click",this._onClick).each(this._each);return this._shapeElem(l).style("fill",(function(e){var i="";if(i=0==a?t.color:t.color_special,"linear"==r._colorType&&(i=t.color),i&&/\[/.test(i)){var n=new Function("return "+i)(),o=[],s=!0,u=!1,h=void 0;try{for(var d,_=n[Symbol.iterator]();!(s=(d=_.next()).done);s=!0){var f=d.value,p=[],x=f.split(":");p.push(q(x[0])),p.push(x[1]),o.push(p)}}catch(t){u=!0,h=t}finally{try{!s&&_.return&&_.return()}finally{if(u)throw h}}var g=o.concat(),v=g.pop();return l.append("linearGradient").attr("id",r.id+"-legend-index-"+a).attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+r.id+"-legend-index-"+a)+")"}return i})),l.append("text").attr("x",this._shapeWidth+this._innerGap).attr("y",this._shapeHeight/2).attr("dy","0.35em").style("text-anchor","start").style("font-size",this._fontSize+"px").style("font-family",this._fontFamily).style("fill",this._fontColor).text(X(t.name1,this._limitedWidth-this._shapeWidth-this._innerGap,this._fontSize,this._fontFamily)),l}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"limitedWidth",value:function(t){return arguments.length?(this._limitedWidth=t,this):this._limitedWidth}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}},{key:"shapeWidth",value:function(t){return arguments.length?(this._shapeWidth=t,this):this._shapeWidth}},{key:"shapeHeight",value:function(t){return arguments.length?(this._shapeHeight=t,this):this._shapeHeight}},{key:"rowGap",value:function(t){return arguments.length?(this._rowGap=t,this):this._rowGap}},{key:"colGap",value:function(t){return arguments.length?(this._colGap=t,this):this._colGap}},{key:"innerGap",value:function(t){return arguments.length?(this._innerGap=t,this):this._innerGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"orient",value:function(t){return arguments.length?(this._orient=t,this):this._orient}},{key:"horizontalAlign",value:function(t){return arguments.length?(this._horizontalAlign=t,this):this._horizontalAlign}},{key:"onClick",value:function(t){return arguments.length?(this._onClick=t,this):this._onClick}},{key:"each",value:function(t){return arguments.length?(this._each=t,this):this._each}},{key:"colorType",value:function(t){return arguments.length?(this._colorType=t,this):this._colorType}}]),e}(L);function Ei(t,e){var i=0,n=1;if(e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n))return[];var a={},o=[],r=t.length,l=t[0][n];""!=l&&null!=l&&null!=l||(l="$-0"),a[l]={name:l,dataScreen:!0,showLegend:"$-0"!=l,data:[]};for(var s=0,u=1;u<r;u++){var c=t[u],h=c[i];if(""!=h&&null!=h&&null!=h||(h="&-"+u),h){var d=l;1==u?s=isNaN(parseFloat(t[1][n]))?0:parseFloat(t[1][n]):s+=isNaN(parseFloat(c[n]))?0:parseFloat(c[n]),a[d].data.push({name:h,showAxisText:h!="&-"+u,value:""==c[n]||isNaN(parseFloat(c[n]))||null==c[n]||null==c[n]?0:parseFloat(c[n]),total:s})}}for(var _ in a)o.push(a[_]);return o.forEach((function(t,e){t.key=t.name+"-"+e})),o}var Vi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","change-waterfall-histogram-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(1),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=-1,i._curve=d3.curveCardinal,i.legend=new Hi(i.group),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new ji(i.coreGroup),i.overlay=new te(i.coreGroup),i._histogramWidth=1,i._yScaleHeight=1.05,i._barWidthPercent=.5,i._barCornerRadius=0,i._borderWidth=0,i._borderColor="none",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["上面","内部居下","内部居中"],i._positionChoice="内部居中",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="阶梯",i._endPause=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=[];if("linear"==t._colors.type){var i=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],n=d3.scaleLinear().domain([t.activeData[0].data.length-1,0]).range(i);t.activeData[0].data.map((function(t,e){return t.linearColor=n(e),t})),e=t.activeData}else e=t.activeData;var a=t.defs;a.selectAll("filter").remove();var o=a.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_changeWaterfall").attr("filterUnits","objectBoundingBox");o.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),o.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),o.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),o.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),o.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var r=e.toString()?e[0].data:[],l=t.grid,s=t.tooltip,u=t.rectPlot,h=t.overlay,d=t.selectOverlay,_=t._barWidthPercent,f=t.xScale,p=t.yScale,g=(t.xAxis._axisStart,t.xAxis._axisEnd),v=0;g>t.widthOfNoMargin-t.yAxis.width&&(v=g-(t.widthOfNoMargin-t.yAxis.width));var m=t.widthOfCore-v,b=t.heightOfCore,S=Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0),k=(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))})),d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),e.length&&e[0].data[0].value,t.widthOfNoMargin,t.heightOfMainGroup);t.yAxis.width,t.xAxis.height;if(h.data(f.domain()).isScalePoint(!1).bandWidth(f.step()).bandHeight(b).bandX(f.range()[0]).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a})),r="";r="linear"==t._colors.type?n[0].linearColor:n[0].value>0?n[0].color:n[0].color_special,o.push({text:("$-0"==e.name?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:r})})),s.data(o).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+f(a)+",0)"),s.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){s.move([d3.event.offsetX,d3.event.offsetY]),d.show()})).onMouseout((function(){s.hide(),d.hide()})),t._borderColor&&/\[/.test(t._borderColor)){var w=x(t._borderColor),C=[],O=!0,F=!1,L=void 0;try{for(var P,A=w[Symbol.iterator]();!(O=(P=A.next()).done);O=!0){var W=P.value,z=[],M=W.split(":");z.push(q(M[0])),z.push(M[1]),C.push(z)}}catch(t){F=!0,L=t}finally{try{!O&&A.return&&A.return()}finally{if(F)throw L}}var D=C.concat(),R=D.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(R[1]).x1+"%").attr("y1",y(R[1]).y1+"%").attr("x2",y(R[1]).x2+"%").attr("y2",y(R[1]).y2+"%").selectAll("stop").data(D).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}u.data(r).xScale(f).yScale(p).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).colorType(t._colors.type).rectObj({xFunc:function(e,i){return f.range()[0]+f.step()*i+f.step()*(1-t._histogramWidth*_)/2},yFunc:function(t){return t.value<0?p(t.total-t.value):p(t.total)},widthFunc:function(){var e=f.step()*t._histogramWidth*_;return Math.max(0,isNaN(e)?0:e)},heightFunc:function(t){var e=0;return S>0||0==S?e=Math.abs(p.range()[0]-p(Math.abs(t.value))):S<0&&(e=Math.abs(p(0)-p(Math.abs(t.value)))),Math.max(0,isNaN(e)?0:e)}}).textObj({xFunc:function(e,i){return f.range()[0]+f.step()*i+f.step()*(1-t._histogramWidth*_)/2},yFunc:function(t){return t.value<0?p(t.total-t.value):p(t.total)},dxFunc:function(e,i){return f.step()*t._histogramWidth*_/2},dyFunc:function(e,i){return 0==t._positionOptions.indexOf(t._positionChoice)?.5*-t._textLabel.fontSize:1==t._positionOptions.indexOf(t._positionChoice)?S>0?p.range()[0]-p(Math.abs(e.value))-.5*t._textLabel.fontSize:p(0)-p(Math.abs(e.value))-.5*t._textLabel.fontSize:2==t._positionOptions.indexOf(t._positionChoice)?S>0?(p.range()[0]-p(Math.abs(e.value)))/2+.4*t._textLabel.fontSize:(p(0)-p(Math.abs(e.value)))/2+.4*t._textLabel.fontSize:void 0},colorFunc:function(){return q(t._textLabel.color)},textFunc:function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix},fontSize:t._textLabel.fontSize,fontFamily:t._textLabel.fontFamily,labelShow:t._labelShow}).fillOpacity(t._fillOpacity),l.width(m).height(b).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),d.width(f.step()).height(b).shadowColor("#ccc").hide();var N=t.yAxis.width+1;t.coreGroup.attr("transform","translate("+N+",0)");var T=t.group.selectAll(".change-waterfall-histogram-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(T).remove(),u.updateChangeWaterfall(),d.update(),h.update(),l.translate(N,0).update()}},{key:"onInterruptChange",value:function(t){this.rectPlot.interrupt(t),this.rectPlot.interruptText(t)}},{key:"updateLegend",value:function(){var t=this,e=t.legend,i=t.widthOfNoMargin;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(i).fontSize(t._legendFontSize).fontFamily(t._legendFontFamily).fontColor(t._legendFontColor).horizontalAlign(t._legendX).each((function(t){var e=!1===t.active;d3.select(this).classed("clicked",e).style("opacity",e?.5:1)})),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy,i=[];if("linear"==t._colors.type){var n=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],a=d3.scaleLinear().domain([t.activeData[0].data.length-1,0]).range(n);e.length>0&&e[0].data.forEach((function(t,e){var n={};n.name1=t.name,n.color=a(e),i.push(n)}))}t.legend.data("linear"==t._colors.type?i:e).colorType(t._colors.type).onClick((function(t){}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=Ei;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0),Math.max(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))})),0)*t._yScaleHeight]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?a[1]:parseFloat(i[1])]}}]),e}(Tt);function $i(t,e){var i=0,n=1;if(e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n))return[];var a=[],o=t.length,r=t[0],l=[],s=d3.max(t.slice(1),(function(t){return parseFloat(t[n])}))||0;t.slice(1).forEach((function(t){t[n]==s&&l.push(t)}));for(var u=1;u<o;u++)t[u][n]!=s&&l.push(t[u]);for(var c=r[n],h=0,d=0;d<l.length;d++){var _=l[d],f=_[i],p=!0;if(""!=f&&null!=f&&null!=f||""!=_[n]&&null!=_[n]&&null!=_[n]||(p=!1),""!=f&&null!=f&&null!=f||(f="&-"+d),f){r[n];0==d||1==d?h=isNaN(parseFloat(l[0][n]))?0:parseFloat(l[0][n]):h-=isNaN(parseFloat(l[d-1][n]))?0:parseFloat(l[d-1][n]),a.push({valueLabel:c,name:f,dataScreen:p,showLegend:f!="&-"+d,showAxisText:f!="&-"+d,value:""==_[n]||isNaN(parseFloat(_[n]))||null==_[n]||null==_[n]?0:parseFloat(_[n]),total:h})}}return a.forEach((function(t,e){t.key=t.name+"-"+e})),a}var qi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","form-waterfall-histogram-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(1),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=-1,i._curve=d3.curveCardinal,i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new ji(i.coreGroup),i.overlay=new te(i.coreGroup),i._sortValue=0,i._histogramWidth=1,i._yScaleHeight=1.05,i._marginTop=20,i._barWidthPercent=.5,i._barCornerRadius=0,i._borderWidth=0,i._borderColor="none",i._formationType="decrease",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["上面","内部居下","内部居中"],i._positionChoice="内部居中",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="阶梯",i._endPause=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.defs;i.selectAll("filter").remove();var n=i.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_formWaterfall").attr("filterUnits","objectBoundingBox");if(n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),n.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),n.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),n.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),n.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),"increase"==t._formationType&&e.length>0)for(var a=0;a<e.length;a++)e[a].total=0==a||1==a?e[a].value:e[a-1].total+e[a].value;var o=e.toString()?e:[],r=t.grid,l=t.tooltip,s=t.rectPlot,u=t.overlay,h=t.selectOverlay,d=t._barWidthPercent?t._barWidthPercent:.8,_=t.xScale,f=t.yScale,p=(t.xAxis._axisStart,t.xAxis._axisEnd),g=0;p>t.widthOfNoMargin-t.yAxis.width&&(g=p-(t.widthOfNoMargin-t.yAxis.width));var v=t.widthOfCore-g,m=t.heightOfCore,b=d3.min(e,(function(t){return+t.total-t.value})),S=(t.widthOfNoMargin,t.heightOfMainGroup);t.yAxis.width,t.xAxis.height;if(b<0?(t.group.selectAll(".form-water-fall-histogram-chart .axis-x path").attr("transform","translate(0, "+-(f.range()[0]-f(0))+")"),t.group.selectAll(".form-water-fall-histogram-chart .axis-x line").attr("transform","translate(0, "+-(f.range()[0]-f(0))+")")):(t.group.selectAll(".form-water-fall-histogram-chart .axis-x path").attr("transform","translate(0,0)"),t.group.selectAll(".form-water-fall-histogram-chart .axis-x line").attr("transform","translate(0,0)")),u.data(_.domain()).isScalePoint(!1).bandWidth(_.step()).bandHeight(m).bandX(_.range()[0]).onMouseover((function(i,n){var a=i,o=e.filter((function(t){return t.name===a})),r=[{text:""+(o[0].name=="$-"+n?"":o[0].name)},{text:o[0].valueLabel+": "+E(o[0].value,t._numberStyle,t._decimalPlaces),color:o[0].color}];l.data(r).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+_(a)+",0)"),l.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){l.move([d3.event.offsetX,d3.event.offsetY]),h.show()})).onMouseout((function(){l.hide(),h.hide()})),t._borderColor&&/\[/.test(t._borderColor)){var k=x(t._borderColor),w=[],C=!0,O=!1,F=void 0;try{for(var L,P=k[Symbol.iterator]();!(C=(L=P.next()).done);C=!0){var A=L.value,W=[],z=A.split(":");W.push(q(z[0])),W.push(z[1]),w.push(W)}}catch(t){O=!0,F=t}finally{try{!C&&P.return&&P.return()}finally{if(O)throw F}}var M=w.concat(),D=M.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(D[1]).x1+"%").attr("y1",y(D[1]).y1+"%").attr("x2",y(D[1]).x2+"%").attr("y2",y(D[1]).y2+"%").selectAll("stop").data(M).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}s.data(o).xScale(_).yScale(f).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).rectObj({xFunc:function(e,i){return _(e.name)+_.step()*(1-t._histogramWidth*d)/2},yFunc:function(t){return f(t.total)},widthFunc:function(){return _.step()*t._histogramWidth*d},heightFunc:function(t){return Math.abs(f(0)-f(t.value))}}).textObj({xFunc:function(e,i){return _(e.name)+_.step()*(1-t._histogramWidth*d)/2},yFunc:function(t){return f(t.total)},dxFunc:function(e,i){return _.step()*t._histogramWidth*d/2},dyFunc:function(e,i){return 0==t._positionOptions.indexOf(t._positionChoice)?.5*-t._textLabel.fontSize:1==t._positionOptions.indexOf(t._positionChoice)?f(0)-f(Math.abs(e.value))-.5*t._textLabel.fontSize:2==t._positionOptions.indexOf(t._positionChoice)?(f(0)-f(Math.abs(e.value)))/2+.4*t._textLabel.fontSize:void 0},colorFunc:function(){return q(t._textLabel.color)},textFunc:function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix},fontSize:t._textLabel.fontSize,fontFamily:t._textLabel.fontFamily,labelShow:t._labelShow}).fillOpacity(t._fillOpacity),r.width(v).height(m).planeX(_.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),h.width(_.step()).height(m).shadowColor("#ccc").hide();var R=t.yAxis.width+1;t.coreGroup.attr("transform","translate("+R+",0)");var N=t.group.selectAll(".form-waterfall-histogram-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(N).remove(),s.updateFormWaterfall(),h.update(),u.update(),r.translate(R,0).update()}},{key:"onInterruptChange",value:function(t){this.rectPlot.interrupt(t),this.rectPlot.interruptText(t)}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=$i;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showAxisText})),i=e;if("single"==t._colors.type){if(e.length>0){var n={},a=[];n.name=e[0].valueLabel,n.color=e[0].color,a.push(n),i=""==n.name||null==n.name||null==n.name?[]:a}else i=[];t.legend.data(i).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.active=!n})),t.onDataChange()}))}else t.legend.data(i).onClick((function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach((function(t){t.key===e.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._formationType=e.formationType?e.formationType:this._formationType),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length>0?e.map((function(t){return t.name})):[0,1];if("increase"==this._formationType&&(n.push(n[0]),n.shift()),"increase"==t._formationType&&e.length>0)for(var a=0;a<e.length;a++)e[a].total=0==a||1==a?e[a].value:e[a-1].total+e[a].value;var o=e.length>0?[Math.min(d3.min(e,(function(t){return+t.total-t.value})),0),Math.max(d3.max(e,(function(t){return t.total})),1)*t._yScaleHeight]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?o[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?o[1]:parseFloat(i[1])]}}]),e}(Tt),Ui=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","simple-bar-plot"),i._xScale=null,i._yScale=null,i._fill=null,i._stroke="",i._strokeWidth=0,i._showZeroLine=!0,i._zeroLineStroke="#000",i._fontColor="#000",i._fontSize=13,i._cornerRadius=0,i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,n=t._xScale,a=t._yScale.clamp(!0),o=n.bandwidth()/2,r=n.bandwidth()*t._barWidthPercent,l=a.domain(),s=l.every((function(t){return t>=0}))?"up":l.every((function(t){return t<=0}))?"down":"both",u=a.range()[0],h=t._transition?t._duration:0,d=[],_=0;_<e.length;_++)d.push(E(e[_].value,t._numberStyle,t._decimalPlaces)+t._suffix);var g=G(d,t._fontSize,t._fontFamily),v=t.group;v.selectAll("*").remove();var m=t._defs;m.selectAll("filter").remove();var b=m.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_simplebar").attr("filterUnits","objectBoundingBox");if(b.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),b.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),b.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),b.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),b.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._stroke&&/\[/.test(t._stroke)){var S=x(t._stroke),k=[],w=!0,C=!1,O=void 0;try{for(var F,L=S[Symbol.iterator]();!(w=(F=L.next()).done);w=!0){var P=F.value,A=[],W=P.split(":");A.push(q(W[0])),A.push(W[1]),k.push(A)}}catch(t){C=!0,O=t}finally{try{!w&&L.return&&L.return()}finally{if(C)throw O}}var z=k.concat(),M=z.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(360-M[1]).x1+"%").attr("y1",y(360-M[1]).y1+"%").attr("x2",y(360-M[1]).x2+"%").attr("y2",y(360-M[1]).y2+"%").selectAll("stop").data(z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(M[1]).x1+"%").attr("y1",y(M[1]).y1+"%").attr("x2",y(M[1]).x2+"%").attr("y2",y(M[1]).y2+"%").selectAll("stop").data(z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if("up"===s){var D=v.selectAll(".rect").data(e);if(D.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))D.enter().append("path").attr("class","rect").merge(D).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).call(fi,t).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)){var R=D.enter().append("path").attr("class","rect").merge(D).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).attr("d",(function(e){return f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(0),width:r,height:0,cornerRadius:[0,0,0,0]})})).call(fi,t);0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?R.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):R.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?R.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):R.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:0)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})))}else if(2==t._moveOptions.indexOf(t._moveStyle)||3==t._moveOptions.indexOf(t._moveStyle)){var N=D.enter().append("path").attr("class","rect").merge(D).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).attr("d",(function(e){return f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:0,height:Math.abs(u-a(e.value)),cornerRadius:[0,0,0,0]})})).call(fi,t);2==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?N.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):N.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):3==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?N.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):N.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:0)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(e.value),width:r,height:Math.abs(u-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})))}var T=v.selectAll("text").data(e);T.exit().remove();var B=T.enter().append("text").attr("class","simple-bar-texts").merge(T).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).style("display",t._labelShow?"block":"none");B.attr("x",(function(e){return n(e.name)+o*(1-t._barWidthPercent)})).attr("y",(function(t){return a(t.value)})).attr("dx",r/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?-6:1==t._positionOptions.indexOf(t._positionChoice)?Math.abs(u-a(e.value))-6:void 0})).attr("text-anchor","middle"),t._interrupt?B.style("opacity",1):B.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?B.style("display","none"):r<g&&1==t._positionOptions.indexOf(t._positionChoice)?B.attr("transform",(function(e){return"rotate(-90 "+(n(e.name)+o)+" "+(a(e.value)+Math.abs(u-a(e.value))-.5*t._fontSize-4)+" )"})).attr("text-anchor","start"):B.attr("transform","rotate(0)")}else if("down"===s){var X=v.selectAll(".rect").data(e);if(X.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))X.enter().append("path").attr("class","rect").merge(X).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).call(fi,t).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)){var j=X.enter().append("path").attr("class","rect").merge(X).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).attr("d",(function(e){return f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:0,cornerRadius:[0,0,0,0]})})).call(fi,t);0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?j.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})):j.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?j.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})):j.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:0)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})))}else if(2==t._moveOptions.indexOf(t._moveStyle)||3==t._moveOptions.indexOf(t._moveStyle)){var I=X.enter().append("path").attr("class","rect").merge(X).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).attr("d",(function(e){return f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:0,height:a(e.value),cornerRadius:[0,0,0,0]})})).call(fi,t);2==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?I.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})):I.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})):3==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?I.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})):I.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:0)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:0,width:r,height:a(e.value),cornerRadius:e.value>0?t._cornerRadius:i})})))}var Y=v.selectAll("text").data(e);Y.exit().transition().duration(h).remove();var H=Y.enter().append("text").attr("class","simple-bar-texts").merge(Y).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).style("display",t._labelShow?"block":"none");H.attr("x",(function(e){return n(e.name)+o*(1-t._barWidthPercent)})).attr("y",0).attr("dx",r/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?-6:1==t._positionOptions.indexOf(t._positionChoice)?a(e.value)-6:void 0})).attr("text-anchor","middle"),t._interrupt?H.style("opacity",1):H.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?H.style("display","none"):r<g&&1==t._positionOptions.indexOf(t._positionChoice)?H.attr("transform",(function(e){return"rotate(-90 "+(n(e.name)+o||0)+" "+(a(e.value)-.5*t._fontSize-4)+" )"})).attr("text-anchor","start"):H.attr("transform","rotate(0)")}else{var V=Math.round(a(0)),$=v.selectAll(".rect").data(e);if($.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))$.enter().append("path").attr("class","rect").merge($).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).call(fi,t).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)){var Z=$.enter().append("path").attr("class","rect").merge($).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:a(0),width:r,height:0,cornerRadius:[0,0,0,0]})})).call(fi,t);0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?Z.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):Z.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?Z.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):Z.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:0)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})))}else if(2==t._moveOptions.indexOf(t._moveStyle)||3==t._moveOptions.indexOf(t._moveStyle)){var Q=$.enter().append("path").attr("class","rect").merge($).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",t._strokeWidth).attr("d",(function(e){return f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:0,height:Math.abs(V-a(e.value)),cornerRadius:[0,0,0,0]})})).call(fi,t);2==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?Q.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):Q.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):3==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?Q.style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})):Q.transition().delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length>0?e.length:0)):0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).style("stroke",(function(e,i){return/\[/.test(t._stroke)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e){var i=[];return Array.isArray(t._cornerRadius)&&(i.push(t._cornerRadius[2]),i.push(t._cornerRadius[3]),i.push(t._cornerRadius[0]),i.push(t._cornerRadius[1])),f({x:n(e.name)+o*(1-t._barWidthPercent),y:e.value>=0?a(e.value):V,width:r,height:Math.abs(V-a(e.value)),cornerRadius:e.value>0?t._cornerRadius:i})})))}var K=v.selectAll("text").data(e);K.exit().transition().duration(h).remove();var J=K.enter().append("text").attr("class","simple-bar-texts").merge(K).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).style("display",t._labelShow?"block":"none");J.attr("x",(function(e){return n(e.name)+o*(1-t._barWidthPercent)})).attr("y",(function(t){return t.value>=0?a(t.value):V})).attr("dx",r/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?-6:1==t._positionOptions.indexOf(t._positionChoice)?Math.abs(V-a(e.value))-6:void 0})).attr("text-anchor","middle"),t._interrupt?J.style("opacity",1):J.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?J.style("display","none"):r<g&&1==t._positionOptions.indexOf(t._positionChoice)?J.attr("transform",(function(e){return"rotate(-90 "+(n(e.name)+o||0)+" "+((e.value>=0?a(e.value):V)+Math.abs(V-a(e.value))-.5*t._fontSize-4)+" )"})).attr("text-anchor","start"):J.attr("transform","rotate(0)"),(v.select(".zero-line").empty()?v.append("line").attr("class","zero-line"):v.select(".zero-line")).attr("x1",n.range()[0]).attr("y1",V).attr("x2",n.range()[1]).attr("y2",V).style("stroke",t._showZeroLine?t._zeroLineStroke:"none")}if(null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice))v.selectAll(".simple-bar-texts").style("display","none");else if(r<g&&1==t._positionOptions.indexOf(t._positionChoice)){for(var tt=v.selectAll(".simple-bar-texts"),et=[],it=[],nt=0;nt<tt._groups[0].length;nt++){it.push(nt);for(var at=nt+1;at<tt._groups[0].length;at++){var ot=i(d3.select(tt._groups[0][nt])),rt=i(d3.select(tt._groups[0][at])),lt=ot.width;ot.width=ot.height,ot.height=lt;var st=rt.width;rt.width=rt.height,rt.height=st,p(ot,rt)&&(et.push(nt),d3.select(tt._groups[0][nt]).style("visiblity","hidden"))}}for(var ut=new Set(et),ct=Array.from(ut),ht=Dt(ct,it),dt=0;dt<ct.length;dt++){for(var _t=[],ft=0;ft<ht.length;ft++){var pt=i(d3.select(tt._groups[0][ct[dt]])),yt=i(d3.select(tt._groups[0][ht[ft]])),xt=pt.width;pt.width=pt.height,pt.height=xt;var gt=yt.width;if(yt.width=yt.height,yt.height=gt,_t.push(p(pt,yt)),p(pt,yt)){if(ct[dt]==ht[ft])continue;d3.select(tt._groups[0][ct[dt]]).style("visibility","hidden")}}0==_t.filter((function(t){return 1==t})).length&&ht.push(ct[dt])}for(var vt=0;vt<ht.length;vt++)d3.select(tt._groups[0][ht[vt]]).style("visibility","visible")}else{for(var mt=v.selectAll(".simple-bar-texts"),bt=[],St=[],kt=0;kt<mt._groups[0].length;kt++){St.push(kt);for(var wt=kt+1;wt<mt._groups[0].length;wt++){p(i(d3.select(mt._groups[0][kt])),i(d3.select(mt._groups[0][wt])))&&(bt.push(kt),d3.select(mt._groups[0][kt]).style("visibility","hidden"))}}for(var Ct=new Set(bt),Ot=Array.from(Ct),Ft=Dt(Ot,St),Lt=0;Lt<Ot.length;Lt++){for(var Pt=[],At=0;At<Ft.length;At++){var Wt=i(d3.select(mt._groups[0][Ot[Lt]])),zt=i(d3.select(mt._groups[0][Ft[At]]));if(Pt.push(p(Wt,zt)),p(Wt,zt)){if(Ot[Lt]==Ft[At])continue;d3.select(mt._groups[0][Ot[Lt]]).style("visibility","hidden")}}0==Pt.filter((function(t){return 1==t})).length&&Ft.push(Ot[Lt])}for(var Mt=0;Mt<Ft.length;Mt++)d3.select(mt._groups[0][Ft[Mt]]).style("visibility","visible")}function Dt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Zi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","simple-bar-chart"),i.grid=new Jt(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.core=new Ui(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xTickShow=!0,i._yTickShow=!0,i._barWidthPercent=.5,i._cornerRadius=[0,0,0,0],i._stroke="",i._strokeWidth=0,i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["上面","内部居下"],i._positionChoice="内部居下",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveoptions=["纵向同步拉伸","纵向依次拉伸","横向同步展开","横向依次展开"],i._moveStyle="",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.core,a=t.tooltip,r=t.clipArea,l=(t.xAxis._axisStart,t.xAxis._axisEnd),s=0;l>t.widthOfNoMargin-t.yAxis.width&&(s=l-(t.widthOfNoMargin-t.yAxis.width));var u=t.widthOfCore-s,h=t.heightOfCore,d=t.xScale,_=t.yScale,f=Math.min(d3.min(e,(function(t){return+t.value})),0);function p(t){return new Function("return "+t)()}if(f<0?(t.mainGroup.selectAll(".axis-x-line path").attr("transform","translate(0, "+-(_.range()[0]-_(0))+")"),t.mainGroup.selectAll(".axis-x-line line").attr("transform","translate(0, "+-(_.range()[0]-_(0))+")")):(t.mainGroup.selectAll(".axis-x-line path").attr("transform","translate(0,0)"),t.mainGroup.selectAll(".axis-x-line line").attr("transform","translate(0,0)")),0!=t._clipShow.length&&(t.mainGroup.selectAll(".axis-x-line path").attr("transform","translate(0,0)"),t.mainGroup.selectAll(".axis-x-line line").attr("transform","translate(0,0)")),i.width(u).height(h).planeX(d.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.group.selectAll(".hover-gradient").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=p(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("class","hover-gradient").attr("id",t.id+"-hover-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._stroke&&/\[/.test(t._stroke)){var x=p(t._stroke),g=[],v=!0,m=!1,b=void 0;try{for(var S,k=x[Symbol.iterator]();!(v=(S=k.next()).done);v=!0){var w=S.value,C=[],O=w.split(":");C.push(q(O[0])),C.push(O[1]),g.push(C)}}catch(t){m=!0,b=t}finally{try{!v&&k.return&&k.return()}finally{if(m)throw b}}var F=g.concat(),L=F.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-down-index-0").attr("x1",y(360-L[1]).x1+"%").attr("y1",y(360-L[1]).y1+"%").attr("x2",y(360-L[1]).x2+"%").attr("y2",y(360-L[1]).y2+"%").selectAll("stop").data(F).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(L[1]).x1+"%").attr("y1",y(L[1]).y1+"%").attr("x2",y(L[1]).x2+"%").attr("y2",y(L[1]).y2+"%").selectAll("stop").data(F).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).xScale(t.xScale).yScale(t.yScale).zeroLineStroke(t._axisLineStrokeX).cornerRadius(t._cornerRadius).stroke(t._stroke).barWidthPercent(t._barWidthPercent).strokeWidth(t._strokeWidth).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveoptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fillOpacity(t._fillOpacity).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return t._fontColor}}).onMouseover((function(e,i){0==t._strokeWidth&&d3.select(this).style("stroke-width",1),d3.select(this).style("stroke","#000");var n=[{text:""+(e.name=="$-"+i?"":e.name),color:e.color},{text:e.valueLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];a.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e,i){a.hide(),0==t._strokeWidth&&d3.select(this).style("stroke-width",0),d3.select(this).style("stroke",(function(){return null==t._stroke?/\[/.test(e.color)?"url("+c("#"+t.id+"-hover-index-"+i)+")":e.color:e.value<0?/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-down-index-0")+")":t._stroke:/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke}))})),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(r.width(u).height(h).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+r.id)+")"),r.update()):(r.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),r.update());var P=t.group.selectAll(".simple-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="$-"+e}));d3.selectAll(P).remove(),i.translate(t.yAxis.width+.5,0).update(),n.update(),t.coreGroup.selectAll(".zero-line").remove(),f<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",d.range()[0]).attr("y1",_.range()[0]).attr("x2",d.range()[1]).attr("y2",_.range()[0]).attr("stroke",t._axisLineStrokeX)):t.coreGroup.selectAll(".fake-x-line").remove()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend})),i=e;if("single"==t._colors.type){if(e.length>0){var n={},a=[];n.name=e[0].valueLabel,n.color=e[0].color,a.push(n),i=""==n.name||null==n.name||null==n.name?[]:a}else i=[];t.legend.data(i).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.active=!n})),t.onDataChange()}))}else t.legend.data(i).onClick((function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach((function(t){t.key===e.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e.map((function(t){return t.name})):[0,1],a=void 0;if(e.length){var o=1.1*d3.min(e,(function(t){return+t.value})),r=1.1*d3.max(e,(function(t){return+t.value}));a=o<0?r<=0?[o,0]:[o,r]:[0,r]}else a=[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this.barWidthPercent(d(0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent)).cornerRadius(e.bar4CornerRadius?e.bar4CornerRadius:this._cornerRadius).stroke(q(e.borderColor)||"").strokeWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._strokeWidth)),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),e}(Tt),Qi=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","progress-pie"),i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._innerRadius=0,i._outerRadius=0,i._endAngle=2*Math.PI,i._padRadius=null,i._sortMethod=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius),t.pieFunc.value((function(t){return Math.abs(t.value)})).startAngle("clockwise"==t._rotateDirection?t._startAngle:2*Math.PI-t._endAngle).endAngle("clockwise"==t._rotateDirection?t._endAngle:2*Math.PI-t._startAngle).sort(t._sortMethod);var n=t.pieFunc(t._data);t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-up-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t.group.selectAll("path").data(n);a.exit().remove();var o=a.merge(a.enter().append("path")).attr("class","pie-path").style("fill",(function(e,i){return/\[/.test(e.data.color)?"url("+c("#"+t.id+"-up-index-"+i)+")":e.data.color})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),r=t.group.append("text").attr("class","middleNumber").attr("dy","-4").style("text-anchor","middle").text("0%").style("pointer-events","none").style("fill",isNaN(parseFloat(t._nColor))?t._nColor:t._colorList[t._nColor]).attr("font-size",t._nFontSize).attr("font-family",t._nFontFamily).attr("display",e.length>0?"block":"none"),l=String(e.length>0?e[0].value:"0").indexOf(".")+1,s=String(e.length>0?e[0].value:"0").length-l;if(t._interrupt){var u=e.length>0?s>2?parseFloat(100*e[0].value).toFixed(s-2):parseFloat(100*e[0].value).toFixed(0):0;r.text((function(e,i){return E(u,t._numberStyle,t._decimalPlaces)+"%"}))}else r.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).tween("d",(function(){var i=this,n=e.length>0?100*e[0].value:0,a=d3.interpolateNumber(0,n);return function(n){var o=-1==String(a(n)).indexOf(".")?a(n):a(n).toFixed(1);if(d3.select(i).text(E(o,t._numberStyle,t._decimalPlaces)+"%"),1==n){var r=e.length>0?s>2?parseFloat(100*e[0].value).toFixed(s-2):parseFloat(100*e[0].value).toFixed(0):0;d3.select(i).text(E(r,t._numberStyle,t._decimalPlaces)+"%")}}}));var h=t.group.append("text").attr("class","middleText").attr("dy",parseFloat(t._tFontSize)+4).style("text-anchor","middle").text((e.length>0?e[0].name:"")+" ").style("pointer-events","none").style("fill",isNaN(parseFloat(t._tColor))?t._tColor:t._colorList[t._tColor]).attr("font-size",t._tFontSize).attr("font-family",t._tFontFamily);if(1==t._textShow&&0==t._numberShow?h.attr("dy","0.5em"):0==t._textShow&&1==t._numberShow&&t.group.selectAll(".middleNumber").attr("dy","0.5em"),1==t._textShow&&e.length>0?t.group.selectAll(".middleText").style("display","block"):t.group.selectAll(".middleText").style("display","none"),null!=t._textShow&&0!=t._textShow&&null!=t._tFontSize&&null!=t._tColor&&null!=t._tFontFamily&&0!=e.length||t.group.selectAll(".middleText").style("display","none"),1==t._numberShow&&e.length>0?t.group.selectAll(".middleNumber").style("display","block"):t.group.selectAll(".middleNumber").style("display","none"),null!=t._numberShow&&0!=t._numberShow&&null!=t._nFontSize&&null!=t._nColor&&null!=t._nFontFamily&&0!=e.length||t.group.selectAll(".middleNumber").style("display","none"),t._interrupt?o.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):"clockwise"==t._rotateDirection?o.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).delay(t._transition?t._startDelay:0).attrTween("d",(function(e){var i=d3.interpolate(e.startAngle,e.endAngle);return function(n){return e.endAngle=i(n),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):o.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).delay(t._transition?t._startDelay:0).attrTween("d",(function(e){var i=d3.interpolate(e.endAngle,e.startAngle);return function(n){return e.startAngle=i(n),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd),t.group.selectAll(".pie-texts").remove(),t.group.selectAll(".pie-percents").remove(),t.group.selectAll(".pie-numbers").remove(),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none");else if(1==t._positionOptions.indexOf(t._positionChoice)){var d=t.group.append("g").selectAll("g").data(n);d.exit().remove(),d.enter().append("g").attr("class","pie-text-groups").merge(d).each((function(e,i){d3.select(this).append("g").attr("class","pie-texts").append("text").text(e.data.name).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]-1.3*t._fontSize})),d3.select(this).append("g").attr("class","pie-percents").append("text").text(e.data.percent+"%").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return A(t)[0]})).attr("y",(function(t){return A(t)[1]})),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(e.data.value).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]+1.3*t._fontSize}))})),1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(t){return A(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(t){return A(t)[1]})),t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(t){return A(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-texts text").style("display","none")):2==t._contentChoice.length&&(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","none")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return A(t)[0]})).attr("y",(function(e){return A(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-texts text").style("display","none")))}for(var _=t.group.selectAll(".pie-text-groups"),f=[],g=[],v=0;v<_._groups[0].length;v++){g.push(v);for(var m=v+1;m<_._groups[0].length;m++){p(i(d3.select(_._groups[0][v])),i(d3.select(_._groups[0][m])))&&(f.push(v),d3.select(_._groups[0][v]).style("opacity","0"))}}for(var b=new Set(f),S=Array.from(b),k=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(S,g),w=0;w<S.length;w++){for(var C=[],O=0;O<k.length;O++){var F=i(d3.select(_._groups[0][S[w]])),L=i(d3.select(_._groups[0][k[O]]));if(C.push(p(F,L)),p(F,L)){if(S[w]==k[O])continue;d3.select(_._groups[0][S[w]]).style("opacity","0")}}0==C.filter((function(t){return 1==t})).length&&k.push(S[w])}for(var P=0;P<k.length;P++)d3.select(_._groups[0][k[P]]).style("opacity","1");function A(e){var i=.7*t._outerRadius,n=(e.startAngle+e.endAngle)/2-Math.PI/2;return[Math.cos(n)*i,Math.sin(n)*i]}return t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"numberShow",value:function(t){return arguments.length?(this._numberShow=t,this):this._numberShow}},{key:"textShow",value:function(t){return arguments.length?(this._textShow=t,this):this._textShow}},{key:"nFontSize",value:function(t){return arguments.length?(this._nFontSize=parseFloat(t),this):this._nFontSize}},{key:"nFontFamily",value:function(t){return arguments.length?(this._nFontFamily=t,this):this._nFontFamily}},{key:"nColor",value:function(t){return arguments.length?(this._nColor=t,this):this._nColor}},{key:"tFontSize",value:function(t){return arguments.length?(this._tFontSize=parseFloat(t),this):this._tFontSize}},{key:"tFontFamily",value:function(t){return arguments.length?(this._tFontFamily=t,this):this._tFontFamily}},{key:"tColor",value:function(t){return arguments.length?(this._tColor=t,this):this._tColor}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"processStartAngle",value:function(t){return arguments.length?(this._processStartAngle=t,this):this._processStartAngle}},{key:"processGapPercentage",value:function(t){return arguments.length?(this._processGapPercentage=t,this):this._processGapPercentage}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"bgBorderWidth",value:function(t){return arguments.length?(this._bgBorderWidth=t,this):this._bgBorderWidth}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ki=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._bgBorderWidth="0",i._bgBorderColor="#cccccc",i._bgColor="#cccccc",i._bgOpacity="1",i._rotateDirection="clockwise",i._processStartAngle=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove();var i=t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius).startAngle((function(t){return t.startAngle})).endAngle((function(t){return t.endAngle}));t.pieFunc.value((function(t){return t.value})).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod);var n=t.pieFunc(t._data),a=t.group.selectAll("path").data(n,(function(t){return t.data.key}));a.exit().remove();a.merge(a.enter().append("path")).attr("d",(function(t){return i(t)})).attr("stroke",(function(e,i){var n=""==t._bgColor?e.data.color:t._bgColor;if(n&&/\[/.test(n)){var a=x(n),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=a[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,f=[],p=_.split(":");f.push(o(q(p[0]))),f.push(p[1]),r.push(f)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var g=r.concat(),v=g.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(n&&/\[/.test(n))return""==t._bgBorderColor?"url("+c("#"+t.id+"-index-0")+")":t._bgBorderColor;if(n&&/#/.test(n))return""==t._bgBorderColor?""==t._bgColor?o(n):n:t._bgBorderColor;U(n,0),U(n,1),U(n,2),U(n,3);return""==t._bgBorderColor?""==t._bgColor?o(n):n:t._bgBorderColor})).style("stroke-width",t._bgBorderWidth).style("fill",(function(e,i){var n=""==t._bgColor?e.data.color:t._bgColor;if(n&&/\[/.test(n)){var a=x(n),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=a[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,f=[],p=_.split(":");f.push(o(q(p[0]))),f.push(p[1]),r.push(f)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var g=r.concat(),v=g.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(n&&/\[/.test(n))return"url("+c("#"+t.id+"-index-0")+")";if(n&&/#/.test(n))return""==t._bgColor?o(n):n;var m="rgb("+U(n,0)+","+U(n,1)+","+U(n,2)+")";return""==t._bgColor?o(m):n})).style("fill-opacity",(function(e){var i=""==t._bgColor?e.data.color:t._bgColor;if(i&&/#/.test(i))return t._bgOpacity;var n=U(i,3)||1;return t._bgOpacity*n})).style("opacity",e.length>0?"1":"0");function o(t){var e=d3.hsl(t);return e.l=1.4*e.l,e}return t}},{key:"bgBorderColor",value:function(t){return arguments.length?(this._bgBorderColor=t,this):this._bgBorderColor}},{key:"bgBorderWidth",value:function(t){return arguments.length?(this._bgBorderWidth=t,this):this._bgBorderWidth}},{key:"bgColor",value:function(t){return arguments.length?(this._bgColor=t,this):this._bgColor}},{key:"bgOpacity",value:function(t){return arguments.length?(this._bgOpacity=t,this):this._bgOpacity}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"gapPercentage",value:function(t){return arguments.length?(this._gapPercentage=t,this):this._gapPercentage}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"processStartAngle",value:function(t){return arguments.length?(this._processStartAngle=t,this):this._processStartAngle}}]),e}(Qi);function Ji(t,e){var i=0,n=1;if(e.forEach((function(t){"objCol"===t.function?i=t.index:"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n))return[];var a=[],o=t[0][i],r=t[0][n],l=t.slice(1,2),s=parseFloat(l[0][n]);function u(t,e){var i=0,n=0;try{i=t.toString().split(".")[1].length}catch(t){}try{n=e.toString().split(".")[1].length}catch(t){}return function(t,e){var i=0,n=t.toString(),a=e.toString();try{i+=n.split(".")[1].length}catch(t){}try{i+=a.split(".")[1].length}catch(t){}return Number(n.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,i)}(Number(t.toString().replace(".",""))/Number(e.toString().replace(".","")),Math.pow(10,n-i))}return s=s>10||10==s?u(s,Math.pow(10,String(parseInt(s)).length)):s<10&&s>1?u(s,Math.pow(10,String(parseInt(s)).length+1)):s,isNaN(s)||a.push({name:l[0][i],dataScreen:!0,showLegend:!0,value:+s,nameLabel:o,valueLabel:r}),a.forEach((function(t,e){t.key=h(t.name)+"-"+e})),a}var tn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","Progress-Round-pie-chart"),i.pieBg=new Ki(i.mainGroup),i.core=i.pie=new Qi(i.mainGroup),i._padAngle=0,i._startAngle=0,i._endAngle=2*Math.PI,i._innerRadius=0,i._labelRadiusRatio=.5,i._innerRadiusRatio=.65,i._cornerRadius=0,i._bgBorderWidth="0",i._bgBorderColor="black",i._processStartAngle="0",i._processGapPercentage="0",i._bgColor=null,i._rotateDirection="clockwise",i._numberShow=!0,i._nFontSize=35,i._nFontFamily="noto",i._nColor="0",i._textShow=!0,i._tFontSize=25,i._tFontFamily="noto",i._tColor="1",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="轮子",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.pieBg,i=t.pie,n=t.widthOfNoMargin,a=.88*n,o=.88*t.heightOfMainGroup,r=t._startAngle,l=t._endAngle,u=s(a,o,r,l),h=u.radius,d=t._innerRadiusRatio*u.radius,_=u.cx+(n-a)/2,f=u.cy+.06*t.heightOfMainGroup,p=t._processGapPercentage*(h-d-parseFloat(t._bgBorderWidth))*.5;if(t.mainGroup.selectAll(".linear-gradient").remove(),t._bgBorderColor&&/\[/.test(t._bgBorderColor)){var g=x(t._bgBorderColor),v=[],m=!0,b=!1,S=void 0;try{for(var k,w=g[Symbol.iterator]();!(m=(k=w.next()).done);m=!0){var C=k.value,O=[],F=C.split(":");O.push(q(F[0])),O.push(F[1]),v.push(O)}}catch(t){b=!0,S=t}finally{try{!m&&w.return&&w.return()}finally{if(b)throw S}}var L=v.concat(),P=L.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(P[1]).x1+"%").attr("y1",y(P[1]).y1+"%").attr("x2",y(P[1]).x2+"%").attr("y2",y(P[1]).y2+"%").selectAll("stop").data(L).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._bgColor&&/\[/.test(t._bgColor)){var A=x(t._bgColor),W=[],z=!0,M=!1,D=void 0;try{for(var R,N=A[Symbol.iterator]();!(z=(R=N.next()).done);z=!0){var T=R.value,B=[],G=T.split(":");B.push(q(G[0])),B.push(G[1]),W.push(B)}}catch(t){M=!0,D=t}finally{try{!z&&N.return&&N.return()}finally{if(M)throw D}}var X=W.concat(),j=X.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(j[1]).x1+"%").attr("y1",y(j[1]).y1+"%").attr("x2",y(j[1]).x2+"%").attr("y2",y(j[1]).y2+"%").selectAll("stop").data(X).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).innerRadius(d).outerRadius(h).startAngle(t._startAngle).endAngle(t._endAngle).bgBorderColor(/\[/.test(t._bgBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bgBorderColor).bgBorderWidth(t._bgBorderWidth).bgColor(/\[/.test(t._bgColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._bgColor),t.pieBg.translate(_,f).update(),i.data(t.activeData).innerRadius(d+t._bgBorderWidth/2+p).outerRadius(h-t._bgBorderWidth/2-p).cornerRadius(t._cornerRadius).rotateDirection(t._rotateDirection).bgBorderWidth(t._bgBorderWidth).startAngle(t._processStartAngle).endAngle(l*(t.activeData.length>0?t.activeData[0].value:0)+t._processStartAngle).areaBorderColor(t._areaBorderColor).areaBorderWidth(t._areaBorderWidth).numberShow(t._numberShow).nFontSize(t._nFontSize).nFontFamily(t._nFontFamily).nColor(t._nColor).textShow(t._textShow).tFontSize(t._tFontSize).tFontFamily(t._tFontFamily).tColor(t._tColor).colorList(t._colorList).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,n){var a=String(e.data.value).indexOf(".")+1,o=String(e.data.value).length-a;d+t._bgBorderWidth/2<h-t._bgBorderWidth/2&&d3.select(this).transition().duration(30).attrTween("d",(function(){var n=d3.interpolateNumber(h-t._bgBorderWidth/2-p,1.05*(h-t._bgBorderWidth/2-p));return function(t){var a=n(t);return i.arcFunc.outerRadius(a),i.arcFunc(e)}}));var r=t.activeData.length>0?o>2?parseFloat(100*e.data.value).toFixed(o-2):parseFloat(100*e.data.value).toFixed(0):0,l=[{text:e.data.name+": "+E(r,t._numberStyle,t._decimalPlaces)+"%",color:e.data.color}];t.tooltip.data(l).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d+t._bgBorderWidth/2<h-t._bgBorderWidth/2&&d3.select(this).transition().duration(30).attrTween("d",(function(){var n=d3.interpolateNumber(1.05*(h-t._bgBorderWidth/2-p),h-t._bgBorderWidth/2-p);return function(t){var a=n(t);return i.arcFunc.outerRadius(a),i.arcFunc(e)}})),t.tooltip.hide()})),0==t.activeData.length&&(t.group.selectAll(".middleText").style("display","none"),t.group.selectAll(".middleNumber").style("display","none")),t.pie.translate(_,f).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=Ji;switch(i.dataType){case"cross-table":n=M;break;default:n=Ji}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?d(e.innerRadiusRatio):this._innerRadiusRatio,this._cornerRadius=0==e.processCornerRadius||e.processCornerRadius?e.processCornerRadius:this._cornerRadius,this._bgBorderWidth=0==e.bgBorderWidth||e.bgBorderWidth?d(e.bgBorderWidth):this._bgBorderWidth,this._bgBorderColor=e.bgBorderColor?q(e.bgBorderColor):"",this._processStartAngle=0==e.processStartAngle||e.processStartAngle?parseFloat(e.processStartAngle)*(Math.PI/180):this._processStartAngle,this._processGapPercentage=0==parseFloat(e.processGapPercentage)||e.processGapPercentage?d(e.processGapPercentage):this._processGapPercentage,this._bgColor=e.bgColor?q(e.bgColor):"",this._rotateDirection=e.rotateDirection?e.rotateDirection:this._rotateDirection),0!==Object.getOwnPropertyNames(i).length&&(null!=i.numberLabel&&(this._numberShow=i.numberLabel?i.numberLabel.show:this._numberShow,this._nFontSize=i.numberLabel.fontSize?i.numberLabel.fontSize:this._nFontSize,this._nFontFamily=i.numberLabel.fontFamily?i.numberLabel.fontFamily:this._nFontFamily,this._nColor=i.numberLabel.color||0==i.numberLabel.color?q(i.numberLabel.color):this._nColor),null!=i.textLabel&&(this._textShow=i.textLabel?i.textLabel.show:this._textShow,this._tFontSize=i.textLabel.fontSize?i.textLabel.fontSize:this._tFontSize,this._tFontFamily=i.textLabel.fontFamily?i.textLabel.fontFamily:this._tFontFamily,this._tColor=i.textLabel.color||0==i.textLabel.color?q(i.textLabel.color):this._tColor))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),e}(nt),en=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","half-progress-pie"),i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._innerRadius=0,i._outerRadius=0,i._startAngle=.5*-Math.PI,i._endAngle=.5*Math.PI,i._padRadius=null,i._isOverMaxAngle="false",i._sortMethod=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._bgBorderWidth/2/((t._innerRadius+t._outerRadius)/2);t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(0).padAngle(i),t.pieFunc.value((function(t){return Math.abs(t.value)})).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod);var n=t.pieFunc(e);t.group.selectAll("*").remove(),d3.select(t.group.node().parentNode.parentNode).selectAll("text").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-up-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t.group.selectAll(".pie-path").data(n);a.exit().remove();var o=a.merge(a.enter().append("path")).attr("class","pie-path").style("fill",(function(e,i){return/\[/.test(e.data.color)?"url("+c("#"+t.id+"-up-index-"+i)+")":e.data.color})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),r=d3.select(t.group.node().parentNode.parentNode).append("text").attr("class","middleNumber").attr("dy",t._isOverMaxAngle?"-4":"-"+(parseFloat(t._tFontSize)+10)).style("text-anchor","middle").text("0%").style("pointer-events","none").style("fill",isNaN(parseFloat(t._nColor))?t._nColor:t._colorList[t._nColor]).attr("font-size",t._nFontSize).attr("font-family",t._nFontFamily).attr("display",e.length>0?"block":"none"),l=String(e.length>0?e[0].value:"0").indexOf(".")+1,s=String(e.length>0?e[0].value:"0").length-l;if(t._interrupt){var u=e.length>0?s>2?parseFloat(100*e[0].value).toFixed(s-2):parseFloat(100*e[0].value).toFixed(0):0;r.text((function(e,i){return E(u,t._numberStyle,t._decimalPlaces)+"%"}))}else r.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).tween("d",(function(){var i=this,n=e.length>0?100*e[0].value:0,a=d3.interpolateNumber(0,n);return function(n){var o=-1==String(a(n)).indexOf(".")?a(n):a(n).toFixed(1);if(d3.select(i).text(E(o,t._numberStyle,t._decimalPlaces)+"%"),1==n){var r=e.length>0?s>2?parseFloat(100*e[0].value).toFixed(s-2):parseFloat(100*e[0].value).toFixed(0):0;d3.select(i).text(E(r,t._numberStyle,t._decimalPlaces)+"%")}}}));d3.select(t.group.node().parentNode.parentNode).append("text").attr("class","middleText").attr("dy",t._isOverMaxAngle?""+(.9*t._nFontSize+6):"-0.1em").style("text-anchor","middle").text((e.length>0?e[0].name:"")+" ").style("pointer-events","none").style("fill",isNaN(parseFloat(t._tColor))?t._tColor:t._colorList[t._tColor]).attr("font-size",t._tFontSize).attr("font-family",t._tFontFamily);return 1==t._textShow&&0==t._numberShow||0==t._textShow&&1==t._numberShow&&d3.select(t.group.node().parentNode.parentNode).selectAll(".middleNumber").attr("dy","-0.1em"),1==t._textShow&&e.length>0?d3.select(t.group.node().parentNode.parentNode).selectAll(".middleText").style("display","block"):d3.select(t.group.node().parentNode.parentNode).selectAll(".middleText").style("display","none"),null!=t._textShow&&0!=t._textShow&&null!=t._tFontSize&&null!=t._tColor&&null!=t._tFontFamily||d3.select(t.group.node().parentNode.parentNode).selectAll(".middleText").style("display","none"),1==t._numberShow&&e.length>0?d3.select(t.group.node().parentNode.parentNode).selectAll(".middleNumber").style("display","block"):d3.select(t.group.node().parentNode.parentNode).selectAll(".middleNumber").style("display","none"),null!=t._numberShow&&0!=t._numberShow&&null!=t._nFontSize&&null!=t._nColor&&null!=t._nFontFamily||d3.select(t.group.node().parentNode.parentNode).selectAll(".middleNumber").style("display","none"),t._interrupt?o.transition().duration(0).ease(d3.easeLinear).delay(0).attrTween("d",(function(e){var i=d3.interpolate(e.startAngle,(e.endAngle-e.startAngle)*e.value+e.startAngle);return function(n){return e.endAngle=i(n),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):o.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).delay(t._transition?t._startDelay:0).attrTween("d",(function(e){var i=d3.interpolate(e.startAngle,(e.endAngle-e.startAngle)*e.value+e.startAngle),n=d3.interpolate(0,t._processCornerRadius);return function(a){return e.endAngle=i(a),a>.01&&t.arcFunc.cornerRadius(n(a)),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd),t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"isOverMaxAngle",value:function(t){return arguments.length?(this._isOverMaxAngle=t,this):this._isOverMaxAngle}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"numberShow",value:function(t){return arguments.length?(this._numberShow=t,this):this._numberShow}},{key:"textShow",value:function(t){return arguments.length?(this._textShow=t,this):this._textShow}},{key:"nFontSize",value:function(t){return arguments.length?(this._nFontSize=parseFloat(t),this):this._nFontSize}},{key:"nFontFamily",value:function(t){return arguments.length?(this._nFontFamily=t,this):this._nFontFamily}},{key:"nColor",value:function(t){return arguments.length?(this._nColor=t,this):this._nColor}},{key:"tFontSize",value:function(t){return arguments.length?(this._tFontSize=parseFloat(t),this):this._tFontSize}},{key:"tFontFamily",value:function(t){return arguments.length?(this._tFontFamily=t,this):this._tFontFamily}},{key:"tColor",value:function(t){return arguments.length?(this._tColor=t,this):this._tColor}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"processGapPercentage",value:function(t){return arguments.length?(this._processGapPercentage=t,this):this._processGapPercentage}},{key:"processCornerRadius",value:function(t){return arguments.length?(this._processCornerRadius=t,this):this._processCornerRadius}},{key:"bgBorderWidth",value:function(t){return arguments.length?(this._bgBorderWidth=t,this):this._bgBorderWidth}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),nn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","Half-Progress-pie-chart"),i.pieBg=new Ki(i.mainGroup),i.core=i.pie=new en(i.mainGroup),i._innerRadius=0,i._startAngle=.5*-Math.PI,i._endAngle=.5*Math.PI,i._labelRadiusRatio=.5,i._innerRadiusRatio=.7,i._processCornerRadius=0,i._bgBorderWidth="0",i._bgBorderColor="black",i._totalAngle=Math.PI,i._processGapPercentage="0",i._bgColor=null,i._bgOpacity="1",i._rotateDirection="clockwise",i._numberShow=!0,i._nFontSize=35,i._nFontFamily="noto",i._nColor="0",i._textShow=!0,i._tFontSize=25,i._tFontFamily="noto",i._tColor="1",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="轮子",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t,e,i=this,n=i.pieBg,a=i.pie;t=-i._totalAngle/2,e=i._totalAngle/2;var o=i.widthOfNoMargin,r=.88*o,l=.5*Math.PI-(parseFloat(i._totalAngle)-Math.PI)/2,s=void 0,u=void 0,h=void 0,d=void 0;i._totalAngle>Math.PI?(u=(s=g(r,i.heightOfMainGroup,t,e,l)).cx+(o-r)/2,h=s.cy,d=!0):(u=(s=g(r,i.heightOfMainGroup,t,e,Math.PI)).cx+(o-r)/2,h=s.cy,d=!1);var _=s.radius,f=i._innerRadiusRatio*s.radius,p=i._processGapPercentage*(_-f-parseFloat(i._bgBorderWidth))*.5;function g(t,e,i,n,a){var o=Math.min(t,e),r=o/2,l=t/2,s=e/2+r/2;return o==e&&(r=.88*e,s=1.1*(r/=1+Math.cos(a)),r>t/2&&(s=e/2+(r=t/2)/2)),{radius:r,cx:l,cy:s,quadrant:0}}if(i.mainGroup.selectAll(".linear-gradient").remove(),i._bgBorderColor&&/\[/.test(i._bgBorderColor)){var v=x(i._bgBorderColor),m=[],b=!0,S=!1,k=void 0;try{for(var w,C=v[Symbol.iterator]();!(b=(w=C.next()).done);b=!0){var O=w.value,F=[],L=O.split(":");F.push(q(L[0])),F.push(L[1]),m.push(F)}}catch(t){S=!0,k=t}finally{try{!b&&C.return&&C.return()}finally{if(S)throw k}}var P=m.concat(),A=P.pop();i.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",i.id+"-main-border-index-0").attr("x1",y(A[1]).x1+"%").attr("y1",y(A[1]).y1+"%").attr("x2",y(A[1]).x2+"%").attr("y2",y(A[1]).y2+"%").selectAll("stop").data(P).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(i._bgColor&&/\[/.test(i._bgColor)){var W=x(i._bgColor),z=[],M=!0,D=!1,R=void 0;try{for(var N,T=W[Symbol.iterator]();!(M=(N=T.next()).done);M=!0){var B=N.value,G=[],X=B.split(":");G.push(q(X[0])),G.push(X[1]),z.push(G)}}catch(t){D=!0,R=t}finally{try{!M&&T.return&&T.return()}finally{if(D)throw R}}var j=z.concat(),I=j.pop();i.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",i.id+"-main-border-index-1").attr("x1",y(I[1]).x1+"%").attr("y1",y(I[1]).y1+"%").attr("x2",y(I[1]).x2+"%").attr("y2",y(I[1]).y2+"%").selectAll("stop").data(j).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(i.activeData).innerRadius(f).outerRadius(_).startAngle(t).endAngle(e).bgBorderColor(/\[/.test(i._bgBorderColor)?"url("+c("#"+i.id+"-main-border-index-0")+")":i._bgBorderColor).bgBorderWidth(i._bgBorderWidth).bgColor(/\[/.test(i._bgColor)?"url("+c("#"+i.id+"-main-border-index-1")+")":i._bgColor),a.data(i.activeData).innerRadius(f+i._bgBorderWidth/2+p).outerRadius(_-i._bgBorderWidth/2-p).processCornerRadius(i._processCornerRadius).isOverMaxAngle(d).startAngle(t).endAngle(e).numberShow(i._numberShow).nFontSize(i._nFontSize).nFontFamily(i._nFontFamily).nColor(i._nColor).textShow(i._textShow).tFontSize(i._tFontSize).tFontFamily(i._tFontFamily).tColor(i._tColor).colorList(i._colorList).bgBorderWidth(i._bgBorderWidth).transition(i._transition).duration(1e3*i._duration).easeStyle(i._easeStyle).startDelay(1e3*parseFloat(i._startDelay)).moveStyle(i._moveStyle).endPause(i._endPause).interrupt(i._interrupt).numberStyle(i._numberStyle).decimalPlaces(i._decimalPlaces).onMouseover((function(t,e){var n=String(t.data.value).indexOf(".")+1,o=String(t.data.value).length-n;f+i._bgBorderWidth/2<_-i._bgBorderWidth/2&&(d3.select(this).transition().duration(30).attrTween("d",(function(){var e=d3.interpolateNumber(_-i._bgBorderWidth/2-p,1.05*(_-i._bgBorderWidth/2-p));return function(i){var n=e(i);return a.arcFunc.outerRadius(n),a.arcFunc(t)}})),i.mainGroup.select(".half-progress-Toolpie").select(".pie-path").transition().duration(30).attrTween("d",(function(t){var e=d3.interpolateNumber(_-i._bgBorderWidth/2-p,1.05*(_-i._bgBorderWidth/2-p));return function(i){var n=e(i);return toolPie.arcFunc.outerRadius(n),toolPie.arcFunc(t)}})));var r=i.activeData.length>0?o>2?parseFloat(100*t.data.value).toFixed(o-2):parseFloat(100*t.data.value).toFixed(0):0,l=[{text:t.data.name+": "+E(r,i._numberStyle,i._decimalPlaces)+"%",color:t.data.color}];i.tooltip.data(l).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t){f+i._bgBorderWidth/2<_-i._bgBorderWidth/2&&(d3.select(this).transition().duration(30).attrTween("d",(function(){var e=d3.interpolateNumber(1.05*(_-i._bgBorderWidth/2-p),_-i._bgBorderWidth/2-p);return function(i){var n=e(i);return a.arcFunc.outerRadius(n),a.arcFunc(t)}})),i.mainGroup.select(".half-progress-Toolpie").select(".pie-path").transition().duration(30).attrTween("d",(function(t){var e=d3.interpolateNumber(1.05*(_-i._bgBorderWidth/2-p),_-i._bgBorderWidth/2-p);return function(i){var n=e(i);return toolPie.arcFunc.outerRadius(n),toolPie.arcFunc(t)}}))),i.tooltip.hide()})),0==i.activeData.length&&(i.group.selectAll(".middleText").style("display","none"),i.group.selectAll(".middleNumber").style("display","none")),i.pie.translate(u,h).update(),i.pieBg.translate(u,h).update(),i.mainGroup.selectAll("text").attr("transform","translate("+u+","+h+")")}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=Ji;switch(i.dataType){case"cross-table":n=M;break;default:n=Ji}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?d(e.innerRadiusRatio):this._innerRadiusRatio,this._bgBorderWidth=0==e.bgBorderWidth||e.bgBorderWidth?d(e.bgBorderWidth):this._bgBorderWidth,this._bgBorderColor=e.bgBorderColor?q(e.bgBorderColor):"",this._processCornerRadius=0==e.processCornerRadius||e.processCornerRadius?e.processCornerRadius:this._processCornerRadius,this._processGapPercentage=0==parseFloat(e.processGapPercentage)||e.processGapPercentage?d(e.processGapPercentage):this._processGapPercentage,this._bgColor=e.bgColor?q(e.bgColor):"",this._totalAngle=e.totalAngle_demi?d(e.totalAngle_demi)*(Math.PI/180):this._totalAngle),0!==Object.getOwnPropertyNames(i).length&&(null!=i.numberLabel&&(this._numberShow=i.numberLabel?i.numberLabel.show:this._numberShow,this._nFontSize=i.numberLabel.fontSize?i.numberLabel.fontSize:this._nFontSize,this._nFontFamily=i.numberLabel.fontFamily?i.numberLabel.fontFamily:this._nFontFamily,this._nColor=i.numberLabel.color||0==i.numberLabel.color?q(i.numberLabel.color):this._nColor),null!=i.textLabel&&(this._textShow=i.textLabel?i.textLabel.show:_textShow,this._tFontSize=i.textLabel.fontSize?i.textLabel.fontSize:_tFontSize,this._tFontFamily=i.textLabel.fontFamily?i.textLabel.fontFamily:_tFontFamily,this._tColor=i.textLabel.color||0==i.textLabel.color?q(i.textLabel.color):this._tColor))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),e}(nt),an=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","half-pie"),i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._innerRadius=0,i._outerRadius=0,i._startAngle=0,i._endAngle=2*Math.PI,i._cornerRadius=0,i._padAngle=.1,i._padRadius=null,i._areaBorderColor="#fff",i._areaBorderWidth=1,i._innerRadiusRatio=.75,i._sortMethod=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.arcFunc.innerRadius(t._innerRadius).outerRadius(t._outerRadius).cornerRadius(t._cornerRadius).padAngle(t._padAngle).padRadius(t._padRadius),t.pieFunc.value((function(t){return Math.abs(t.value)})).startAngle(t._startAngle).endAngle(t._endAngle).sort(t._sortMethod);var n=t.pieFunc(t._data);t.group.selectAll("*").remove(),t.group.selectAll(".pie-path").remove(),t.group.attr("stroke-linejoin","round"),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}}));var a=t.group.selectAll("path").data(n);a.exit().remove();var o=a.merge(a.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._areaBorderColor||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._areaBorderWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))o.transition().attr("d",(function(e,i){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd);else if(0==t._moveOptions.indexOf(t._moveStyle)){t._interrupt?o.transition().duration(0).delay(0).ease(d3.easeLinear).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):o.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("d",(function(e){var i=d3.interpolateNumber(t._innerRadius,t._outerRadius);return function(n){var a=i(n);return t.arcFunc.outerRadius(a),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(1==t._moveOptions.indexOf(t._moveStyle)){t._interrupt?o.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):o.transition().duration((function(i,n){return t._transition?function(i){for(var n=0,a=0;a<i;a++)n=e[a].percent/100;return n*(t._transition?.9*t._duration:0)}(n+1):0})).ease(d3.easeLinear).delay((function(i,n){return(t._transition?t._startDelay:0)+function(i){for(var n=0,a=0;a<i;a++)n+=e[a].percent/100;return n*(t._transition?.9*t._duration:0)}(n)})).attrTween("d",(function(e){var i=d3.interpolate(e.startAngle,e.endAngle);return function(n){return e.endAngle=i(n),t.arcFunc(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}if(t.group.selectAll(".pie-texts").remove(),t.group.selectAll(".pie-percents").remove(),t.group.selectAll(".pie-numbers").remove(),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none");else if(1==t._positionOptions.indexOf(t._positionChoice)){var r=t.group.append("g").selectAll("g").data(n);r.exit().remove(),r.enter().append("g").attr("class","pie-text-groups").merge(r).each((function(e,i){d3.select(this).append("g").attr("class","pie-texts").append("text").text(e.data.name).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]-1.3*t._fontSize})).style("opacity",(function(){return"$-"==e.data.name.slice(0,2)?0:1})),d3.select(this).append("g").attr("class","pie-percents").append("text").text(E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return C(t)[0]})).attr("y",(function(t){return C(t)[1]})),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]+1.3*t._fontSize}))})),1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(t){return C(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(t){return C(t)[1]})),t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(t){return C(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-texts text").style("display","none")):2==t._contentChoice.length&&(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","none")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return C(t)[0]})).attr("y",(function(e){return C(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-texts text").style("display","none")))}t._interrupt?t.group.selectAll(".pie-text-groups").style("opacity",1):t.group.selectAll(".pie-text-groups").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1);for(var l=t.group.selectAll(".pie-text-groups"),s=[],u=[],h=0;h<l._groups[0].length;h++){u.push(h);for(var d=h+1;d<l._groups[0].length;d++){p(i(d3.select(l._groups[0][h])),i(d3.select(l._groups[0][d])))&&(s.push(h),d3.select(l._groups[0][h]).style("visibility","hidden"))}}for(var _=new Set(s),f=Array.from(_),g=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(f,u),v=0;v<f.length;v++){for(var m=[],b=0;b<g.length;b++){var S=i(d3.select(l._groups[0][f[v]])),k=i(d3.select(l._groups[0][g[b]]));if(m.push(p(S,k)),p(S,k)){if(f[v]==g[b])continue;d3.select(l._groups[0][f[v]]).style("visibility","hidden")}}0==m.filter((function(t){return 1==t})).length&&g.push(f[v])}for(var w=0;w<g.length;w++)d3.select(l._groups[0][g[w]]).style("visibility","visible");function C(e){var i=.7*t._outerRadius,n=(e.startAngle+e.endAngle)/2-Math.PI/2;return[Math.cos(n)*i,Math.sin(n)*i]}return t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),on=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","half-pie-chart"),e.core=e.pie=new an(e.mainGroup),e.lineText=new lt(e.mainGroup),e.pieText=new rt(e.mainGroup),e._innerRadius=0,e._startAngle=-Math.PI/2,e._endAngle=Math.PI/2,e._padAngle=.01,e._labelRadiusRatio=.87,e._innerRadiusRatio=.75,e._cornerRadius=0,e._areaBorderWidth=0,e._areaBorderColor=null,e._fillOpacity=1,e._labelShow=!0,e._positionOptions=["外部","内部"],e._positionChoice="内部",e._contentOption=["名称","百分比","数值"],e._contentChoice=["名称"],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["径向展开","轮子"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this,i=t.pie,n=t.pieText,a=t.defs;a.selectAll("filter").remove();var o=a.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_halfPie").attr("filterUnits","objectBoundingBox");o.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),o.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),o.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),o.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),o.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");for(var r=t.lineText,l=t.widthOfNoMargin,s=[],u=0;u<t.activeData.length;u++)s.push(parseFloat(t.activeData[u].value));for(var h=0,d=0;d<t.activeData.length;d++)h+=parseFloat(t.activeData[d].value);for(var _=0;_<t.activeData.length;_++)t.activeData[_].percent=-1==String(t.activeData[_].value/h*100).indexOf(".")?parseFloat(t.activeData[_].value/h*100):parseFloat((t.activeData[_].value/h*100).toFixed(2));var f=t.activeData,p=.88*l;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)p=.88*l;else if(0==t._labelShow||1==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice))p=.88*l;else{var g=[];if(0==t._positionOptions.indexOf(t._positionChoice))if(1==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0]))for(var v=0;v<f.length;v++)g.push(f[v].name);else if(1==t._contentOption.indexOf(t._contentChoice[0]))for(var m=0;m<f.length;m++)g.push(E(f[m].percent,t._numberStyle,t._decimalPlaces)+"%");else if(2==t._contentOption.indexOf(t._contentChoice[0]))for(var b=0;b<f.length;b++)g.push(E(f[b].value,t._numberStyle,t._decimalPlaces)+t._suffix)}else if(2==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var S=0;S<f.length;S++)g.push(f[S].name),g.push(E(f[S].percent,t._numberStyle,t._decimalPlaces)+"%");else if(0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var k=0;k<f.length;k++)g.push(f[k].name),g.push(E(f[k].value,t._numberStyle,t._decimalPlaces)+t._suffix);else if(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))for(var w=0;w<f.length;w++)g.push(E(f[w].value,t._numberStyle,t._decimalPlaces)+t._suffix),g.push(E(f[w].percent,t._numberStyle,t._decimalPlaces)+"%")}else for(var C=0;C<f.length;C++)g.push(f[C].name),g.push(E(f[C].value,t._numberStyle,t._decimalPlaces)+t._suffix),g.push(E(f[C].percent,t._numberStyle,t._decimalPlaces)+"%");var O=G(g,t._textLabel.fontSize,t._textLabel.fontFamily);O>.4*t.widthOfNoMargin&&(O=.4*t.widthOfNoMargin),p=.83*t.widthOfNoMargin-2*O}var F=t.heightOfMainGroup,L=t._startAngle,P=t._endAngle,A=function(t,e,i,n){var a=Math.min(t,e),o=a/2,r=e/2+o/2;a==e&&(r=1.1*(o=.88*e),o>t/2&&(r=e/2+(o=t/2)/2));return{radius:o,cx:t/2,cy:r,quadrant:0}}(p,F),W=A.radius,z=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*W:0);if(t._areaBorderColor&&/\[/.test(t._areaBorderColor)){var M=x(t._areaBorderColor),R=[],N=!0,T=!1,B=void 0;try{for(var X,j=M[Symbol.iterator]();!(N=(X=j.next()).done);N=!0){var I=X.value,Y=[],H=I.split(":");Y.push(q(H[0])),Y.push(H[1]),R.push(Y)}}catch(t){T=!0,B=t}finally{try{!N&&j.return&&j.return()}finally{if(T)throw B}}var V=R.concat(),$=V.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y($[1]).x1+"%").attr("y1",y($[1]).y1+"%").attr("x2",y($[1]).x2+"%").attr("y2",y($[1]).y2+"%").selectAll("stop").data(V).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(t.activeData).innerRadius(z).outerRadius(W).cornerRadius(t._cornerRadius).startAngle(L-parseFloat(t._padAngle)/2).endAngle(P).areaBorderColor(/\[/.test(t._areaBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._areaBorderColor).areaBorderWidth(t._areaBorderWidth).padAngle(t._padAngle).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,n){d3.select(this).transition().duration(30).attrTween("d",(function(){var t=d3.interpolateNumber(W,1.05*W);return function(n){var a=t(n);return i.arcFunc.outerRadius(a),i.arcFunc(e)}}));var a=[{text:""+(e.data.name=="$-"+n?"":e.data.name),color:e.data.color},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move()})).onMouseout((function(e){d3.select(this).transition().duration(30).attrTween("d",(function(){var t=d3.interpolateNumber(1.05*W,W);return function(n){var a=t(n);return i.arcFunc.outerRadius(a),i.arcFunc(e)}})),t.tooltip.hide()})),n.data(t.activeData).innerRadius(z).outerRadius(W).startAngle(L-parseFloat(t._padAngle)/2).endAngle(P).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).onTransitionEnd((function(i,n){var a=d3.select(this.parentNode),o="arc-path-"+i.data.key.replace(/\s*/g,"").replace(/\./g,"")+"-"+t.id;t.defs.select("#"+o).remove();var r=e(W*t._labelRadiusRatio,i.startAngle+.03+parseFloat(t._padAngle)/2,i.endAngle-.025-parseFloat(t._padAngle)/2),l=t.defs.select("#"+o).empty()?t.defs.append("path").attr("d",r).attr("id",o):t.defs.select("#"+o).attr("d",r);null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._labelShow?t.group.selectAll(".chart-label-text").style("display","none"):1==t._positionOptions.indexOf(t._positionChoice)&&(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,i.data.name=="$-"+n?"":i.data.name,t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("dx",0):1==t._contentOption.indexOf(t._contentChoice[0])?D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("dx",0):2==t._contentOption.indexOf(t._contentChoice[0])&&D(a,l,E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("dx",0):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,(i.data.name=="$-"+n?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(a,l,(i.data.name=="$-"+n?"":i.data.name+"  ")+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&D(a,l,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==t._contentChoice.length&&D(a,l,(i.data.name=="$-"+n?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily).attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"))}));var U=A.cx+(l-p)/2,Z=A.cy;null!=t._labelShow&&(0!=t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?(r.data(t.activeData).innerRadius(z).outerRadius(W).cornerRadius(t._cornerRadius).startAngle(L-parseFloat(t._padAngle)/2).endAngle(P).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).values(s).areaType("half").transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.group.select(".outside-text-polygon").attr("display","block")):t.group.select(".outside-text-polygon").attr("display","none")),t.lineText.translate(U||0,Z).update(),t.pie.translate(U||0,Z).update(),n.translate(U,Z).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this.innerRadiusRatio(d(0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(d(0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._areaBorderWidth)).areaBorderColor(q(e.borderColor)||"").padAngle(0==parseFloat(e.gapPercentage)||e.gapPercentage?e.gapPercentage/10:this._padAngle),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}}]),i}(nt),rn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.xAxis=null,i.yAxis=null,i.yAxisDoubleY=null,i.xScale=null,i.yScale=null,i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._yOrientRight="right",i._xDomain=null,i._yDomain=null,i._xTitle="",i._yTitle="",i._axisLineStroke=null,i._xTickShow=!0,i._yTickShow=!0,i}return w(e,t),S(e,[{key:"update",value:function(){return this._interrupt=!1,this._titlePadding=this._unitWord&&this._unitShow?this._titlePadding:15,this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this.updateTitle(),this.updateUnit(),this.updateSource(),this.updateAxis(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();t.xAxis;var e=t.yAxis,i=t.yAxisDoubleY,n=t.xScale,a=t.yScale,o=(t._xType,t._yType),r=(t._xOrient,t._yOrient),l=t._yOrientRight,s=t._fontSize,u=t.widthOfNoMargin,c=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(a).allowedMaxTextWidth(.5*u).type(o).orient(r).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(s).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelSuffix(t._yLabelSuffix),i.scaleFunc(a).allowedMaxTextWidth(.5*u).type(o).orient(l).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(s).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelSuffix(t._yLabelSuffix);var h=(null==t._yTitle[0]?0:e.titleHeight)||(null==t._yTitle[1]?0:i.titleHeight),d=c/(3*s);e.tickCount(d),i.tickCount(d),a.nice().range([c-h,0]);e.width;var _=e.width,f=h;e.translate(_,f).update(),i.translate(_,f).update()}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yDomain||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?a[1]:parseFloat(i[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"yOrientRight",value:function(t){return arguments.length?(this._yOrientRight=t,this):this._yOrientRight}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"axisLabelShowLeft",value:function(t){return arguments.length?(this._axisLabelShowLeft=t,this):this._axisLabelShowLeft}},{key:"axisLabelShowRight",value:function(t){return arguments.length?(this._axisLabelShowRight=t,this):this._axisLabelShowRight}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};i.y1;this.axisLineStroke(q(a.axisColor)||q(i.color)).xTitle(n.name).axisLabelShowLeft(0!=a.labelShow&&!a.labelShow||a.labelShow).axisLabelShowRight(0!=a.labelShow&&!a.labelShow||a.labelShow).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xDomain(n.range).yDomain(a.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.yAxis||this.yAxisDoubleY?this.yAxis.titleHeight||this.yAxisDoubleY.titleHeight:0,i=this.heightOfMainGroup-t-e;return i>0?i:0}}]),e}(vt),ln="axis-group",sn="y-slope-title",un=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-slope"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,o=t._tickValueTexts,r=void 0;r=t.axisFunc="right"===e?d3.axisRight(i):d3.axisLeft(i);var l=null;"number"===t._type&&t._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(l=d3.format("d")),r.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter("right"===e?.5:-.5).tickPadding(t._tickPadding).tickFormat(l);var s=n.select(".axis-group").empty()?n.append("g").attr("class",ln):n.select(".axis-group");s.transition().duration(t._transition?t._duration:0).call(r).on("start",(function(){s.selectAll(".tick text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text((function(t,e){return o[e]})),s.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none"),s.select("path").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none")}));var u=Math.abs(i.range()[0]-i.range()[1]);if(t._title="left"==e?t._title[0]:"right"==e?t._title[1]:t._title,t._titleShow&&t._title){var c=n.select(".y-slope-title").empty()?n.append("g").attr("class",sn):n.select(".y-slope-title"),h=c.select("text").empty()?c.append("text"):c.select("text"),d=R(t._title,a,t._fontFamily);h.attr("x",d>=2*t.width?-d/2:0).attr("y",u+this._fontSize+4).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",d>=2*t.width?"start":"middle").text(t._title)}else n.select(".y-slope-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);e="category"===o?a.domain():a.ticks(t._tickCount);var s=d3.max(e,(function(e){return R(e,r,t._fontFamily)}));return s<=l?(i=e,n=s):(i=e.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),e}(Bt),cn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","slope"),i._xScale=null,i._yScale=null,i._sWidth=null,i._stroke=null,i._lineWidth=2,i._strokeDasharry="",i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove(),t._interrupt?t.group.interrupt().style("opacity",1):t.group.interrupt().style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay+.3*t._duration:0).style("opacity",1),i.selectAll(".slope-lines").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=i.selectAll("line").data(e);n.exit().remove();var a=n.enter().append("line").attr("class","slope-lines").merge(n).style("fill","none").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)||"#000"})).style("stroke-width",t._lineWidth||0).style("stroke-dasharray",t._strokeDasharry).style("display","block").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);t._interrupt?a.attr("x1",t._textLength).attr("y1",(function(e){return e.data.length&&1==e.data[0].index?t._yScale(e.data[0].value):0})).attr("x2",t._sWidth).attr("y2",(function(e){return e.data.length>1?t._yScale(e.data[1].value):1==e.data.length&&2==e.data[0].index?t._yScale(e.data[0].value):0})).attr("stroke-dasharray",t._strokeDasharry):a.attr("x1",t._textLength).attr("y1",(function(e){return e.data.length&&1==e.data[0].index?t._yScale(e.data[0].value):0})).attr("x2",t._sWidth).attr("y2",(function(e){return e.data.length>1?t._yScale(e.data[1].value):1==e.data.length&&2==e.data[0].index?t._yScale(e.data[0].value):0})).transition().duration(t._transition?.7*t._duration:0).delay(t._transition?t._startDelay+.3*t._duration:0).ease(d3.easeLinear).attrTween("stroke-dasharray",(function(e,i){var n=0;n=e.data.length&&1==e.data[0].index?t._yScale(e.data[0].value):0;var a=0;a=e.data.length>1?t._yScale(e.data[1].value):1==e.data.length&&2==e.data[0].index?t._yScale(e.data[0].value):0;var o=Math.abs(t._textLength-t._sWidth),r=Math.abs(n-a),l=Math.sqrt(Math.pow(o,2)+Math.pow(r,2));return i=d3.interpolateString("0,"+l,l+","+l),function(t){return i(t)}}));for(var o=i.selectAll(".slope-lines").nodes(),r=0;r<o.length;r++)0==o[r].__data__.data.length?d3.select(o[r]).style("display","none"):1==o[r].__data__.data.length?o[r].__data__.data[0].tooltipValueShow||d3.select(o[r]).style("display","none"):2==o[r].__data__.data.length&&(o[r].__data__.data[0].tooltipValueShow&&o[r].__data__.data[1].tooltipValueShow||d3.select(o[r]).style("display","none"));return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"numberFontSize",value:function(t){return arguments.length?(this._numberFontSize=t,this):this._numberFontSize}},{key:"numberFontColor",value:function(t){return arguments.length?(this._numberFontColor=t,this):this._numberFontColor}},{key:"numberFontFamily",value:function(t){return arguments.length?(this._numberFontFamily=t,this):this._numberFontFamily}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),hn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","slope-scatter-plot"),i._xScale=null,i._yScale=null,i._sWidth=null,i._circleRadius=2,i._circleBorderWidth=1,i._circleBorderColor="#000",i._fill=null,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,n=t._data,a=(t._xScale,t._yScale);e.selectAll("*").remove(),e.selectAll(".slope-circles").remove(),e.selectAll(".slopeTexts text").remove(),e.selectAll(".slopeNumbers text").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-slope-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var o=e.selectAll("g").data(n);o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove(),n.enter().append("circle").attr("class","slope-circles").merge(n).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-slope-index-"+i)+")":e.color)).style("stroke",t._circleBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-slope-index-"+i)+")":e.color)).style("stroke-width",t._circleBorderWidth||0).attr("r",t._circleRadius).attr("cx",(function(e){return 1==e.index?t._textLength:2==e.index?t._sWidth:void 0})).attr("cy",(function(t){return a(t.value)||0}))}));var r=e.append("g").selectAll("g").data(n);r.exit().remove(),r.enter().append("g").attr("class","slope-text-groups").merge(r).each((function(e,i){var o=d3.select(this).append("g").attr("class","slopeNumbers").selectAll("text").data(e.data);o.exit().remove(),o.enter().append("text").merge(o).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("text-anchor",(function(t){return 1==t.index?"end":2==t.index?"start":void 0})).attr("fill",t._numberFontColor).attr("font-size",t._numberFontSize).style("font-family",t._numberFontFamily).style("display","block").attr("x",(function(e){return 1==e.index?t._textLength:2==e.index?t._sWidth:void 0})).attr("y",(function(t){return a(t.value)||0})).attr("dx",(function(e){return 1==e.index?"-8":2==e.index?R(n[i].name,t._fontSize,t._fontFamily)+d3.min([parseFloat(t._fontSize),parseFloat(t._numberFontSize)]):void 0})).attr("dy","0.3em");var r=d3.select(this).append("g").attr("class","slopeTexts").selectAll("text").data(e.data);r.exit().remove(),r.enter().append("text").merge(r).text(n[i].name).style("text-anchor",(function(t){return 1==t.index?"end":2==t.index?"start":void 0})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).style("display","block").attr("x",(function(e){return 1==e.index?t._textLength:2==e.index?t._sWidth:void 0})).attr("y",(function(t){return a(t.value)||0})).attr("dx",(function(e){return 1==e.index?-(R(E(n[i].data[0].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._numberFontSize,t._numberFontFamily)+d3.min([parseFloat(t._fontSize),parseFloat(t._numberFontSize)])):2==e.index?"8":void 0})).attr("dy","0.3em")}));var l=e.selectAll(".slopeTexts text").nodes().filter((function(t,e,i){return e%2==0})),s=e.selectAll(".slopeTexts text").nodes().filter((function(t,e){return e%2!=0})),u=e.selectAll(".slopeNumbers text").nodes().filter((function(t,e,i){return e%2==0})),h=e.selectAll(".slopeNumbers text").nodes().filter((function(t,e){return e%2!=0}));null!=t._axisLabelShowLeft&&null!=t._axisLabelShowRight||(d3.selectAll(u).attr("fill","none"),d3.selectAll(h).attr("fill","none")),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||0==t._labelShow?(d3.selectAll(l).attr("fill","none"),d3.selectAll(s).attr("fill","none"),d3.selectAll(h).attr("dx","8"),d3.selectAll(u).attr("dx","-8")):0==t._positionOptions.indexOf(t._positionChoice)?(d3.selectAll(s).attr("fill","none"),d3.selectAll(h).attr("dx","8"),(0==t._axisLabelShowLeft&&1==t._axisLabelShowRight||0==t._axisLabelShowLeft&&0==t._axisLabelShowRight)&&d3.selectAll(l).attr("dx","-8")):1==t._positionOptions.indexOf(t._positionChoice)?(d3.selectAll(l).attr("fill","none"),d3.selectAll(u).attr("dx","-8")):2==t._positionOptions.indexOf(t._positionChoice)&&(0==t._axisLabelShowLeft&&1==t._axisLabelShowRight||0==t._axisLabelShowLeft&&0==t._axisLabelShowRight)&&d3.selectAll(l).attr("dx","-8"),0==t._axisLabelShowLeft&&d3.selectAll(u).attr("fill","none"),0==t._axisLabelShowRight&&d3.selectAll(h).attr("fill","none");var d=e.selectAll(".slope-circles").nodes(),_=e.selectAll(".slopeTexts text").nodes(),f=e.selectAll(".slopeNumbers text").nodes(),g=_.concat(f);d3.selectAll(g);!function(t){for(var e=t,n=[],a=[],o=0;o<e._groups[0].length;o++){a.push(o);for(var r=o+1;r<e._groups[0].length;r++){p(i(d3.select(e._groups[0][o])),i(d3.select(e._groups[0][r])))&&(n.push(o),d3.select(e._groups[0][o]).style("opacity","0"),d3.select(f[o]).style("opacity","0"))}}for(var l=new Set(n),s=Array.from(l),u=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(s,a),c=0;c<s.length;c++){for(var h=[],d=0;d<u.length;d++){var _=i(d3.select(e._groups[0][s[c]])),y=i(d3.select(e._groups[0][u[d]]));if(h.push(p(_,y)),p(_,y)){if(s[c]==u[d])continue;d3.select(e._groups[0][s[c]]).style("opacity","0"),d3.select(f[s[c]]).style("opacity","0")}}0==h.filter((function(t){return 1==t})).length&&u.push(s[c])}for(var x=0;x<u.length;x++)d3.select(e._groups[0][u[x]]).style("opacity","1"),d3.select(f[u[x]]).style("opacity","1")}(d3.selectAll(_));for(var v=0;v<d.length;v++)d[v].__data__.tooltipValueShow||d3.select(d[v]).style("opacity","0");for(var m=0;m<_.length;m++)_[m].__data__.tooltipValueShow||d3.select(_[m]).style("opacity","0");for(var b=0;b<f.length;b++)f[b].__data__.tooltipValueShow||d3.select(f[b]).style("opacity","0");return t}},{key:"circleRadius",value:function(t){return arguments.length?(this._circleRadius=t,this):this._circleRadius}},{key:"circleBorderWidth",value:function(t){return arguments.length?(this._circleBorderWidth=t,this):this._circleBorderWidth}},{key:"circleBorderColor",value:function(t){return arguments.length?(this._circleBorderColor=t,this):this._circleBorderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"axisLabelShowLeft",value:function(t){return arguments.length?(this._axisLabelShowLeft=t,this):this._axisLabelShowLeft}},{key:"axisLabelShowRight",value:function(t){return arguments.length?(this._axisLabelShowRight=t,this):this._axisLabelShowRight}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"numberLength",value:function(t){return arguments.length?(this._numberLength=t,this):this._numberLength}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"numberFontSize",value:function(t){return arguments.length?(this._numberFontSize=t,this):this._numberFontSize}},{key:"numberFontColor",value:function(t){return arguments.length?(this._numberFontColor=t,this):this._numberFontColor}},{key:"numberFontFamily",value:function(t){return arguments.length?(this._numberFontFamily=t,this):this._numberFontFamily}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),dn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","slopeOverlay-polygon"),i._width=0,i._height=0,i._shadowColor="#000",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=i.selectAll("polygon").data(e);n.exit().remove(),n.enter().append("polygon").attr("class","slope-polygons").merge(n).style("fill",t._shadowColor).style("fill-opacity",.85).style("opacity",0).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout).transition().duration(t._transition?t._duration:0).attr("points",(function(e){return t._textLength+","+((e.data.length>0?t._yScale(e.data[0].value):0)+.012*t._sHeight)+"\n        "+t._sWidth+","+((e.data.length>1?t._yScale(e.data[1].value):0)+.012*t._sHeight)+" \n        "+t._sWidth+","+((e.data.length>1?t._yScale(e.data[1].value):0)-.012*t._sHeight)+" \n        "+t._textLength+","+((e.data.length>0?t._yScale(e.data[0].value):0)-.012*t._sHeight)}));for(var a=i.selectAll(".slope-polygons").nodes(),o=0;o<a.length;o++)0==a[o].__data__.data.length?d3.select(a[o]).style("display","none"):1==a[o].__data__.data.length?a[o].__data__.data[0].tooltipValueShow||d3.select(a[o]).style("display","none"):2==a[o].__data__.data.length&&(a[o].__data__.data[0].tooltipValueShow&&a[o].__data__.data[1].tooltipValueShow||d3.select(a[o]).style("display","none"));return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),e}(at);function _n(t,e){var i=0,n=!1;if(e.forEach((function(t){"objCol"===t.function&&(i=t.index,n=t.isLegend)})),P(t,[i],2))return[];var a=z(t,e),o={},r=[],l=a.length,s=a[0];if(n)for(var u=1;u<l;u++){var c=a[u],d=c[i];if(d){for(var _={name:d,index:u-1,data:[]},f=0;f<3;f++){var p=s[f];f!==i&&_.data.push({name:p,value:""==c[f]||isNaN(parseFloat(c[f]))||null==c[f]||null==c[f]?0:c[f],tooltipValueShow:!isNaN(parseFloat(c[f])),index:f})}r.push(_)}}else{s.forEach((function(t,e){e!==i&&t&&(o[t]={name:t,index:e-1,data:[]})}));for(var y=1;y<l;y++){var x=a[y],g=x[i];if(g)for(var v=0;v<x.length+1;v++){var m=s[v];v!==i&&m&&o[m].data.push({name:g,index:y,value:""==x[v]||null==x[v]||null==x[v]?0:x[v],tooltipValueShow:!isNaN(parseFloat(x[v]))})}}for(var b in o)r.push(o[b])}return r.forEach((function(t,e){t.key=h(t.name)+"-"+e})),r}var fn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","slope-chart"),i.yAxis=new un(i.mainGroup),i.yAxisDoubleY=new un(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.slopeOverlay=new dn(i.coreGroup),i.slope=new cn(i.coreGroup),i.scatterPlot=new hn(i.mainGroup),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._yOrientRight="right",i._curve=d3.curveCardinal,i._showPoints=!0,i._circleRadius=3.5,i._lineWidth=2,i._circleBorderWidth=0,i._circleBorderColor=null,i._fillColor=null,i._labelShow=!0,i._positionOptions=["左侧","右侧","两侧"],i._positionChoice="两侧",i._axisLabelShowLeft=!0,i._axisLabelShowRight=!0,i._textLabel={show:!0,fontSize:14,color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["左侧","右侧","两侧"],positionChoice:"两侧"},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="淡入",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;t._interrupt?(t.group.selectAll(".axis-y-slope").interrupt().style("opacity",1),t.group.selectAll(".slope-scatter-plot").interrupt().style("opacity",1)):(t.group.selectAll(".axis-y-slope").interrupt().style("opacity",0).transition().duration(t._transition?.15*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1),t.group.selectAll(".slope-scatter-plot").interrupt().style("opacity",0).transition().duration(t._transition?.15*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay+.15*t._duration*1e3:0).style("opacity",1));var e=t.activeData,i=t.slopeOverlay,n=t.slope,a=t.scatterPlot,r=(t.tooltip,t.xScale),l=t.yScale,s=(t.widthOfCore,t.heightOfCore);t._width,t._marginLeft,t._marginRight;for(var u=function(t){for(var e,i=0;i<t.length;i++)for(var n=i;n<t.length;n++)t[i].data.length>0&&t[i].data[0].value<t[n].data[0].value&&(e=t[n],t[n]=t[i],t[i]=e);return t}(e),h=0;h<u.length;h++)u[h].index=h;for(var d=[],_=0;_<e.length;_++)d.push(e[_].name);for(var f=[],p=0;p<e.length;p++)e[p].data.length>0&&f.push(E(e[p].data[0].value,t._numberStyle,t._decimalPlaces)+t._yLabelSuffix),e[p].data.length>1&&f.push(E(e[p].data[1].value,t._numberStyle,t._decimalPlaces)+t._yLabelSuffix);var g=e.length>0&&e[0].data.length>0?G(d,t._textLabel.fontSize,t._textLabel.fontFamily):0,v=e.length>0&&e[0].data.length>0?G(f,t._fontSize,t._fontFamily):0;t._axisLabelShowLeft||(v=0);var m=g+v,b=t.widthOfNoMargin-g-v;if(null==t._labelShow||0==t._labelShow||null==t._positionOptions||null==t._positionChoice?(t.yAxis.translate(9+v,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-9-v,0),b=t.widthOfNoMargin-v-18,m=v,0==t._axisLabelShowLeft&&0==t._axisLabelShowRight&&(t.yAxis.translate(9,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-9,0),b=t.widthOfNoMargin-18,m=0)):0==t._positionOptions.indexOf(t._positionChoice)?(t.yAxis.translate(g+9+v,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-9-v,0),b=t.widthOfNoMargin-v-18,m=g+v,0==t._axisLabelShowLeft&&0==t._axisLabelShowRight&&(t.yAxis.translate(g+9,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-9,0),b=t.widthOfNoMargin-18,m=g)):1==t._positionOptions.indexOf(t._positionChoice)?(t.yAxis.translate(9+v,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-g-9-v,0),b=t.widthOfNoMargin-g-v-18,m=v,0==t._axisLabelShowLeft&&0==t._axisLabelShowRight&&(t.yAxis.translate(9,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-9-g,0),b=t.widthOfNoMargin-g-18,m=0)):2==t._positionOptions.indexOf(t._positionChoice)&&(t.yAxis.translate(g+9+v,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-g-9-v,0),b=t.widthOfNoMargin-g-v-18,m=g+v,0==t._axisLabelShowLeft&&0==t._axisLabelShowRight&&(t.yAxis.translate(g+9,0),t.yAxisDoubleY.translate(t.widthOfNoMargin-9-g,0),b=t.widthOfNoMargin-g-18,m=g)),t.mainGroup.selectAll(".linear-gradient").remove(),t._circleBorderColor&&/\[/.test(t._circleBorderColor)){var S=x(t._circleBorderColor),k=[],w=!0,C=!1,O=void 0;try{for(var F,L=S[Symbol.iterator]();!(w=(F=L.next()).done);w=!0){var P=F.value,A=[],W=P.split(":");A.push(q(W[0])),A.push(W[1]),k.push(A)}}catch(t){C=!0,O=t}finally{try{!w&&L.return&&L.return()}finally{if(C)throw O}}var z=k.concat(),M=z.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(M[1]).x1+"%").attr("y1",y(M[1]).y1+"%").attr("x2",y(M[1]).x2+"%").attr("y2",y(M[1]).y2+"%").selectAll("stop").data(z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var D=x(t._fillColor),R=[],N=!0,T=!1,B=void 0;try{for(var X,j=D[Symbol.iterator]();!(N=(X=j.next()).done);N=!0){var I=X.value,Y=[],H=I.split(":");Y.push(q(H[0])),Y.push(H[1]),R.push(Y)}}catch(t){T=!0,B=t}finally{try{!N&&j.return&&j.return()}finally{if(T)throw B}}var V=R.concat(),$=V.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y($[1]).x1+"%").attr("y1",y($[1]).y1+"%").attr("x2",y($[1]).x2+"%").attr("y2",y($[1]).y2+"%").selectAll("stop").data(V).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(u).xScale(r).yScale(l).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).numberFontSize(t._fontSize).numberFontColor(q(t._fontColor)).numberFontFamily(t._fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).axisLabelShowLeft(t._axisLabelShowLeft).axisLabelShowRight(t._axisLabelShowRight).suffix(t._yLabelSuffix).textLength(m).numberLength(v).sWidth(b).circleBorderColor(/\[/.test(t._circleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._circleBorderColor).circleBorderWidth(t._circleBorderWidth).circleRadius(t._circleRadius).fill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),n.data(u).xScale(r).yScale(l).textLength(m).sWidth(b).lineWidth(t._lineWidth).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).onMouseover((function(e,i){var n=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),a=t.coreGroup.selectAll("polygon").nodes(),o=d3.select(this).node().__data__.index;d3.select(a[o]).style("opacity",.45),d3.select(n[2*o+1]).attr("r",1.8*t._circleRadius),d3.select(n[2*o]).attr("r",1.8*t._circleRadius);var r=[{text:e.name,color:e.color},{text:e.data[0].name+": "+(e.data[0].tooltipValueShow?E(e.data[0].value,t._numberStyle,t._decimalPlaces):""),color:"none"},{text:e.data[1].name+": "+(e.data[1].tooltipValueShow?E(e.data[1].value,t._numberStyle,t._decimalPlaces):""),color:"none"}];t.tooltip.data(r).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY]);var e=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),i=t.coreGroup.selectAll("polygon").nodes(),n=d3.select(this).node().__data__.index;d3.select(i[n]).style("opacity",.45),d3.select(e[2*n+1]).attr("r",1.8*t._circleRadius),d3.select(e[2*n]).attr("r",1.8*t._circleRadius)})).onMouseout((function(e){t.tooltip.hide();var i=d3.selectAll(".slope-chart .slope-scatter-plot circle").nodes(),n=t.coreGroup.selectAll("polygon").nodes(),a=d3.select(this).node().__data__.index;d3.select(n[a]).style("opacity",0),d3.select(i[2*a+1]).attr("r",t._circleRadius),d3.select(i[2*a]).attr("r",t._circleRadius)})),i.data(u).xScale(r).yScale(l).textLength(m).sWidth(b).sHeight(s).shadowColor("#ccc").onMouseover((function(e,i){var n=t.coreGroup.selectAll("circle").nodes(),a=d3.select(this).node().__data__.index;d3.select(this).style("opacity",.35),d3.select(n[2*a+1]).attr("r",1.8*t._circleRadius),d3.select(n[2*a]).attr("r",1.8*t._circleRadius);var o=[{text:e.name,color:e.color},{text:e.data[0].name+": "+(e.data[0].tooltipValueShow?E(e.data[0].value,t._numberStyle,t._decimalPlaces):""),color:"none"},{text:e.data[1].name+": "+(e.data[1].tooltipValueShow?E(e.data[1].value,t._numberStyle,t._decimalPlaces):""),color:"none"}];t.tooltip.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY]);var e=t.coreGroup.selectAll("circle").nodes(),i=d3.select(this).node().__data__.index;d3.select(this).style("opacity",.35),d3.select(e[2*i+1]).attr("r",1.8*t._circleRadius),d3.select(e[2*i]).attr("r",1.8*t._circleRadius)})).onMouseout((function(e){t.tooltip.hide();var i=t.coreGroup.selectAll("circle").nodes(),n=d3.select(this).node().__data__.index;d3.select(this).style("opacity",0),d3.select(i[2*n+1]).attr("r",t._circleRadius),d3.select(i[2*n]).attr("r",t._circleRadius)})),t.coreGroup.call(o,t.yAxis.width+1.5,0),i.update(),n.update(),a.translate(t.yAxis.width+1.5,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=_n;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=(t._yDomain,e.length?e.map((function(t){return t.name})):[0,1]),n=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.05*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];t._xDomain=i,t._yDomain=n}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.y.name,a=i.y1?i.y1.name:null,o=null==n||null==n?n:n.constructor===Object?null:n,r=null==a||null==a?a:a.constructor===Object?null:a;this.yTitle([o,r])}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._circleRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._circleRadius,this._circleBorderWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._circleBorderWidth,this._circleBorderColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):""),this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.textLabel?i.textLabel.show:this._labelShow,this._positionChoice=this._fontCopy?i.positionChoice?i.positionChoice:this._positionChoice:i.textLabel.positionChoice?i.textLabel.positionChoice:_this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel)}}]),e}(rn),pn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bar-progress"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth="",i._fillOpacity=1,i._barCornerRadius=5,i._borderColor="#000",i._borderWidth=1,i._cornerRadius=[0,0,0,0],i._bgBorderWidth=0,i._bgBorderColor="#cccccc",i._processCornerRadius=0,i._processGapPercentage="0",i._bgColor="#cccccc",i._bgOpacity="1",i}return w(e,t),S(e,[{key:"bg",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove();var i=t.group.append("g").selectAll("rect").data(e,(function(t){return t.key}));i.exit().remove();var n=i.enter().append("path").attr("class","bg-rect").merge(i).style("stroke-width",t._bgBorderWidth).style("fill",(function(e,i){var n=""==t._bgColor?e.color:t._bgColor;if(n&&/\[/.test(n)){var o=x(n),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,f=[],p=_.split(":");f.push(a(q(p[0]))),f.push(p[1]),r.push(f)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var g=r.concat(),v=g.pop();t.group.append("linearGradient").attr("id",t.id+"-bg-index-"+i).attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}return n&&/\[/.test(n)?"url("+c("#"+t.id+"-bg-index-0")+")":""==t._bgColor?a(n):n})).attr("stroke",(function(e,i){var n=""==t._bgBorderColor?""==t._bgColor?e.color:t._bgColor:t._bgBorderColor;if(n&&/\[/.test(n)){var o=x(n),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,f=[],p=_.split(":");f.push(a(q(p[0]))),f.push(p[1]),r.push(f)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var g=r.concat(),v=g.pop();t.group.append("linearGradient").attr("id",t.id+"-bg-stroke-index-"+i).attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}return n&&/\[/.test(n)?"url("+c("#"+t.id+"-bg-stroke-index-0")+")":""==t._bgBorderColor?""==t._bgColor?a(n):n:t._bgBorderColor})).style("opacity",e.length>0?"1":"0");function a(t){var e=d3.hsl(t);return e.l=1.4*e.l,e}return this._rectObj?n.attr("d",(function(e,i){var n=t._rectObj;return f({x:0,y:n.yFunc,width:n.widthFunc,height:n.heightFunc,cornerRadius:t._cornerRadius,roundCorners:[0,1,2,3],type:"horizontal"})})):n.attr("d",(function(e,i){return f({x:e.value,y:e.value,width:e.value,height:e.value,cornerRadius:t._cornerRadius,roundCorners:[0,1,2,3],type:"horizontal"})})),t}},{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove(),t.group.selectAll(".progress-rect").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-up-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var i=t.group.append("g").selectAll("rect").data(e,(function(t){return t.key}));i.exit().remove();var n=i.enter().append("g"),a=n.append("path").attr("class","progress-rect").merge(i).style("fill",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-up-index-"+i)+")":e.color})).style("fill-opacity",(function(e){return t._fillOpacity})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-up-index-"+i)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0}));t._rectObj?a.attr("d",(function(e,i){e.value;var n=t._rectObj,a=(n.heightFunc-parseFloat(t._bgBorderWidth))*t._processGapPercentage*.5;return f({x:t._bgBorderWidth/2,y:n.yFunc+t._bgBorderWidth/2+a,width:0,height:n.heightFunc-parseFloat(t._bgBorderWidth)-2*a,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})):a.attr("d",(function(t,e){return f({x:t.value,y:t.value,width:t.value,height:t.value,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),a.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(e,i){var n=e.value,a=t._rectObj,o=(a.heightFunc-parseFloat(t._bgBorderWidth))*t._processGapPercentage*.5;return f({x:t._bgBorderWidth/2,y:a.yFunc+t._bgBorderWidth/2+o,width:a.widthFunc*n-parseFloat(t._bgBorderWidth),height:a.heightFunc-parseFloat(t._bgBorderWidth)-2*o,cornerRadius:[t._cornerRadius[0],t._processCornerRadius,t._cornerRadius[2],t._processCornerRadius],roundCorners:[0,1,2,3],type:"horizontal"})})),t.group.selectAll(".bar-text").remove();var o=n.append("text").attr("class","bar-text").merge(i).text("0%").attr("fill",t._textObj.colorFunc).attr("font-size",t._textObj.fontSize).attr("font-family",t._textObj.fontFamily).attr("x",t._textObj.xFunc).attr("y",t._textObj.yFunc).attr("dx",t._textObj.dxFunc).attr("dy",t._textObj.dyFunc).style("display",t._labelShow?"block":"none");return o.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).tween("d",(function(i){var n=this,a=String(i.value).indexOf(".")+1,o=String(i.value).length-a,r=-1==String(100*i.value).indexOf(".")?100*i.value:(100*i.value).toFixed(1);r=E(r,t._numberStyle,t._decimalPlaces);var l=d3.interpolateNumber(0,r);return function(a){var r=-1==String(l(a)).indexOf(".")?l(a):l(a).toFixed(1);if(r=E(r,t._numberStyle,t._decimalPlaces),d3.select(n).text(r+"%"),1==a){var s=e.length>0?o>2?parseFloat(100*i.value).toFixed(o-2):parseFloat(100*i.value).toFixed(0):0;s=E(s,t._numberStyle,t._decimalPlaces),d3.select(n).text(s+"%")}}})),t.interrupt=function(i){o.interrupt().text((function(i,n){var a=String(i.value).indexOf(".")+1,o=String(i.value).length-a,r=e.length>0?o>2?parseFloat(100*i.value).toFixed(o-2):parseFloat(100*i.value).toFixed(0):0;return(r=E(r,t._numberStyle,t._decimalPlaces))+"%"}))},a.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"bgBorderWidth",value:function(t){return arguments.length?(this._bgBorderWidth=t,this):this._bgBorderWidth}},{key:"bgBorderColor",value:function(t){return arguments.length?(this._bgBorderColor=t,this):this._bgBorderColor}},{key:"processCornerRadius",value:function(t){return arguments.length?(this._processCornerRadius=t,this):this._processCornerRadius}},{key:"processGapPercentage",value:function(t){return arguments.length?(this._processGapPercentage=t,this):this._processGapPercentage}},{key:"bgColor",value:function(t){return arguments.length?(this._bgColor=t,this):this._bgColor}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),yn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bar-progress-chart"),i.rectBg=new pn(i.mainGroup),i.rect=new pn(i.mainGroup),i._labelShow=!1,i._positionOptions=["内部居右","内部居中"],i._positionChoice="内部居右",i._numberLabel={show:!0,fontSize:"35",color:"#ffffff",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["内部居右","内部居中"],positionChoice:"内部居右"},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="向右",i._endPause=0,i._cornerRadius=[0,0,0,0],i._bgBorderWidth=0,i._bgBorderColor=null,i._processCornerRadius=[0,0,0,0],i._processGapPercentage="0",i._bgColor=null,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.rect,i=t.rectBg,n=t.activeData,a=t.defs;a.selectAll("filter").remove();var o=a.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_barprogress").attr("filterUnits","objectBoundingBox");o.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),o.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),o.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),o.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),o.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var r=.9*t.widthOfNoMargin,l=.9*t.heightOfMainGroup;var s=function(t,e){var i=.15*t;return e<t/5&&(i=.6*e),i}(r,l);i.data(n).rectObj({xFunc:0,yFunc:l/2.1,widthFunc:r,heightFunc:s}).bgBorderColor(t._bgBorderColor).bgBorderWidth(t._bgBorderWidth).bgColor(t._bgColor).cornerRadius(t._cornerRadius),e.data(n).transition(t._transition).duration(1e3*t._duration).processCornerRadius(t._processCornerRadius).processGapPercentage(t._processGapPercentage).cornerRadius(t._cornerRadius).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).bgBorderWidth(t._bgBorderWidth).moveStyle(t._moveStyle).endPause(t._endPause).labelShow(t._labelShow).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).rectObj({xFunc:0,yFunc:l/2.1,widthFunc:r,heightFunc:s}).textObj({xFunc:function(t){return t.value},yFunc:l/2.1,dyFunc:s/2+.4*t._textLabel.fontSize,dxFunc:function(e,i){var a=String(e.value).indexOf(".")+1,o=String(e.value).length-a,l=n.length>0?o>2?parseFloat(100*e.value).toFixed(o-2):parseFloat(100*e.value).toFixed(0):0;return l=E(l,t._numberStyle,t._decimalPlaces)+"%",0==t._positionOptions.indexOf(t._positionChoice)?r*e.value-R(l,t._textLabel.fontSize,t._fontFamily)-5:1==t._positionOptions.indexOf(t._positionChoice)?r*e.value/2-.5*R(l,t._textLabel.fontSize,t._fontFamily):void 0},colorFunc:function(){return t._labelShow?q(t._textLabel.color):"none"},textFunc:function(t){return t.value},fontSize:t._textLabel.fontSize,fontFamily:t._textLabel.fontFamily}).fillOpacity(1).onMouseover((function(e,i){var a=String(e.value).indexOf(".")+1,o=String(e.value).length-a,r=n.length>0?o>2?parseFloat(100*e.value).toFixed(o-2):parseFloat(100*e.value).toFixed(0):0;r=E(r,t._numberStyle,t._decimalPlaces)+"%";var l=[{text:e.name+": "+r,color:e.color}];t.tooltip.data(l).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide()})),t.rect.translate(.1*t.widthOfNoMargin/2,0).update(),t.rectBg.translate(.1*t.widthOfNoMargin/2,0).bg()}},{key:"onInterruptChange",value:function(t){this.rect.interrupt(t)}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=Ji;switch(i.dataType){case"cross-table":n=M;break;default:n=Ji}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.display;0!==Object.getOwnPropertyNames(i).length&&(this._cornerRadius=0==i.bar4CornerRadius||i.bar4CornerRadius?i.bar4CornerRadius:this._cornerRadius,this._bgBorderWidth=0==i.bgBorderWidth||i.bgBorderWidth?d(i.bgBorderWidth):this._bgBorderWidth,this._bgBorderColor=i.bgBorderColor?q(i.bgBorderColor):"",this._processCornerRadius=0==i.processCornerRadius||i.processCornerRadius?i.processCornerRadius:this._processCornerRadius,this._processGapPercentage=0==parseFloat(i.processGapPercentage)||i.processGapPercentage?d(i.processGapPercentage):this._processGapPercentage,this._bgColor=i.bgColor?q(i.bgColor):"");t.font;this._fontCopy=null!=e.display&&null!=e.display,0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=this._fontCopy?e?e.display:this._labelShow:e.numberLabel?e.numberLabel.show:this._labelShow,this._positionChoice=this._fontCopy?e.positionChoice?e.positionChoice:this._positionChoice:e.numberLabel.positionChoice?e.numberLabel.positionChoice:this._positionChoice,this._textLabel=e.numberLabel?e.numberLabel:this._numberLabel);var n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}}]),e}(nt),xn=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polygon-radar"),e._lineFunc=null,e._startAngle=0,e._endAngle=2*Math.PI,e._radius=100,e._stroke=null,e._borderWidth=2,e._strokeDasharry="",e._transition=!0,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t._startAngle,o=t._endAngle,r=t._radius,l=d3.max(n,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))})),s=[0,1.1*l];if(t._isPolar)if(null==t._count)s=v(0,l,Math.ceil(r/t._themeFontSize/3));else if(s=[],0!=t._count){var u=l-0,h=t._count,d=Math.ceil(Math.abs(u/t._count)),_=Math.ceil(r/t._themeFontSize*2),f=d3.tickStep(0,l,_);t._count<f&&(d=Math.ceil(Math.abs(u/f)),h=f),l+=d;for(var g=0;g<d+1;g++)s.push(0+g*h)}else s.push(0);for(var m=d3.scaleLinear().domain([d3.min(s),d3.max(s)]).range([0,r]),b=t._deadData[0].data.length,S=2*Math.PI/b,k=[],w=0;w<n.length;w++){k[w]=[];for(var C=0;C<n[w].data.length;C++){var O=n[w].data[C].value;k[w][C]=m(O)}}for(var F=[],L=0;L<k.length;L++)for(var P=k[L],A="",W=[],z=0;z<b;z++){var M=P[z],R=M*Math.sin(z*S),N=-M*Math.cos(z*S);A+=R+","+N+" ",n[L].data[z].value>=0?W.push({x:R,y:N,value:n[L].data[z].value}):W.push({x:0,y:0,value:n[L].data[z].value}),F[L]={polygon:A,points:W}}t.group.selectAll("*").remove();for(var T="",B=0;B<b;B++){var G=r;T+=G*Math.sin(B*S)+","+-G*Math.cos(B*S)+" "}t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("polygon").attr("points",T),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var I=t._lineFunc||d3.line().x((function(t){return t.x})).y((function(t){return t.y}));I.curve(t._curve);var Y=t._lineFunc||d3.line().x((function(t){return 0})).y((function(t){return 0}));Y.curve(t._curve);var H=t.group,V=H.append("g").attr("clip-path","").selectAll("path").data(n,(function(t){return t.key}));V.exit().remove();var $=V.enter().append("path").merge(V).attr("d",(function(t,e){return Y(F[e].points)})).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth||0).style("stroke-dasharray",t._strokeDasharry).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?$.attr("d",(function(t,e){return I(F[e].points)})):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?$.attr("d",(function(t,e){return I(F[e].points)})):$.transition().delay((function(e,i){return t._transition?.1*t._duration+t._startDelay:0})).duration(t._transition?.8*t._duration:0).attr("d",(function(t,e){return I(F[e].points)})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?$.attr("d",(function(t,e){return I(F[e].points)})):$.transition().delay((function(e,i){return t._transition?i*(.8*t._duration/(n.length>0?n.length:0))+.1*t._duration+t._startDelay:0})).duration(t._transition?.8*t._duration/(n.length>0?n.length:0):0).attr("d",(function(t,e){return I(F[e].points)}))),H.selectAll(".circle-g").remove();var Z=H.append("g").attr("clip-path","").selectAll("g").data(n);Z.exit().remove(),Z.enter().append("g").attr("class","circle-g").merge(Z).each((function(e,i){var a=d3.select(this).selectAll("circle").data(F[i].points);a.exit().remove();var o=a.enter().append("circle").attr("class","circle-"+i).attr("cx",0).attr("cy",0).merge(a).style("fill",t._fillColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke",t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth||0);null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?o.attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?o.attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):o.attr("r",0).transition().delay(t._transition?.1*t._duration+t._startDelay:0).duration(t._transition?.8*t._duration:0).attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?o.attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):o.attr("r",0).transition().delay(t._transition?i*(.8*t._duration/(n.length>0?n.length:0))+.1*t._duration+t._startDelay:0).duration(t._transition?.8*t._duration/(n.length>0?n.length:0):0).attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0}))),o.filter((function(t){return t.value<0})).attr("display","none")})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);for(var Q=[],K=0;K<b;K++){for(var J=[],tt=0;tt<F.length;tt++)J.push(F[tt].points[K].value);Q.push(d3.max(J))}H.selectAll(".polygon-radar-texts").remove();var et=H.append("g").attr("clip-path","").selectAll("g").data(n);et.exit().remove(),et.enter().append("g").merge(et).each((function(e,i){var n=d3.select(this).append("g").selectAll("text").data(F[i].points);n.exit().remove();var a=n.enter().append("text").attr("class","polygon-radar-texts").merge(n).text((function(e,i){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(t,e){return t.value==Q[e]?t.x+.06*r*(e*S==1.5*Math.PI?-1:Math.sin(e*S))||0:t.x-.06*r*Math.sin(e*S)||0})).attr("y",(function(e,i){return e.value==Q[i]?e.y+.06*r*(i*S==0?1.5:Math.cos(i*S))+(i*S==0?t._fontSize/2.5:0)||0:e.y-.06*r*(i*S==Math.PI?-1.5:Math.cos(i*S))+(i*S==Math.PI?t._fontSize/2.5:0)||0})).attr("text-anchor",(function(t,e){return e*S==0||e*S==Math.PI?"middle":e*S>Math.PI&&t.value!=Q[e]?"start":e*S>Math.PI&&t.value==Q[e]||e*S>0&&e*S<Math.PI&&t.value!=Q[e]?"end":void 0})).attr("dy",(function(t,e){if(t.value==Q[e])if(t.value==d3.max(Q)){if(e*S<Math.PI/2||e*S>1.5*Math.PI)return"0.7em";if(e*S>Math.PI/2&&e*S<1.5*Math.PI)return"-0.7em";if(e*S==Math.PI/2||e*S==1.5*Math.PI)return"1.1em"}else{if(e*S==0)return"0.1em";if(e*S==Math.PI)return"0";if(e*S<Math.PI/2||e*S>1.5*Math.PI)return"0.5em";if(e*S>Math.PI/2&&e*S<1.5*Math.PI)return"-0.5em";if(e*S==Math.PI/2||e*S==1.5*Math.PI)return"0.9em"}else if(t.value!=Q[e])return e*S==0||e*S>Math.PI&&e*S<1.5*Math.PI?0:"0.4em"})).style("display",t._labelShow?"block":"none");t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),a.filter((function(t){return t.value<0})).attr("transform","scale(0)")}));for(var it=[],nt=1.06*r,at=0;at<b;at++){var ot=nt*Math.sin(at*S),rt=-nt*Math.cos(at*S);it.push({x:ot,y:rt})}var lt=n.length>0?n[0].data.map((function(t){return-1!=String(t.name).indexOf("&-")?"":t.name})):[],st=lt.length,ut=(o-a)/(st>0?st:1);H.selectAll(".angle-text").remove();var ct=H.append("g").selectAll("text").data(it);ct.exit().remove();var ht=ct.enter().append("text").attr("class","angle-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0){if("水平"==t._xLabelDirection){var o=Math.cos(a+ut*i-Math.PI/2)*(r+10),l=t._mainWidth/2-Math.abs(o);return X(lt[i],l,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var s=Math.sin(a+ut*i-Math.PI/2)*(r+10),u=t._mainHeight/2-Math.abs(s);return j(lt[i],u,t._themeFontSize,t._themeFontFamily)}}})).attr("x",(function(t,e){var i=a+ut*e;return Math.cos(i-Math.PI/2)*(r+10)})).attr("y",(function(t,e){var i=a+ut*e;return Math.sin(i-Math.PI/2)*(r+10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)ht.attr("transform",(function(e,i){var n=a+ut*i;return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,0)":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+.5*t._themeFontSize+")":"translate(0,"+.8*t._themeFontSize+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".angle-text").remove();var dt=t.group.append("g").selectAll("text").data(it);dt.exit().remove(),dt.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(a+ut*e)/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none").text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(lt[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",r+5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(a+ut*e)/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(a+ut*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(r+5)+",0)":null}))}else{H.selectAll(".tick-text").remove();var _t=t.group.selectAll("g.text-group").data(it);_t.exit().remove();_t.enter().append("g").attr("class","text-group").merge(_t).each((function(i,o){d3.select(this);var l=r+10,s=a+ut*o,u=d3.select(this.parentNode),c="arc-path-"+o+"-"+t.id,h=e(l+.6*t._themeFontSize,s-ut/2+.015,s+ut/2-.015),d=t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);n.length>0&&D(u,d,lt[o],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none")}))}1==t._interrupt?ht.style("opacity",1).style("display",t._showX?"block":"none"):ht.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none");for(var ft=0;ft<b;ft++)ft*S==0||ft*S==Math.PI?d3.select(H.selectAll(".angle-text").nodes()[ft]).attr("text-anchor","middle"):ft*S>Math.PI?d3.select(H.selectAll(".angle-text").nodes()[ft]).attr("text-anchor","end"):ft*S>0&&ft*S<Math.PI&&d3.select(H.selectAll(".angle-text").nodes()[ft]).attr("text-anchor","start");if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var pt=t.group.selectAll(".angle-text"),yt=[],xt=[],gt=0;gt<pt._groups[0].length;gt++){xt.push(gt);for(var vt=gt+1;vt<pt._groups[0].length;vt++){p(i(d3.select(pt._groups[0][gt])),i(d3.select(pt._groups[0][vt])))&&(yt.push(gt),d3.select(pt._groups[0][gt]).style("opacity","0"))}}for(var mt=new Set(yt),bt=Array.from(mt),St=Yt(bt,xt),kt=0;kt<bt.length;kt++){for(var wt=[],Ct=0;Ct<St.length;Ct++){var Ot=i(d3.select(pt._groups[0][bt[kt]])),Ft=i(d3.select(pt._groups[0][St[Ct]]));if(wt.push(p(Ot,Ft)),p(Ot,Ft)){if(bt[kt]==St[Ct])continue;d3.select(pt._groups[0][bt[kt]]).remove()}}0==wt.filter((function(t){return 1==t})).length&&St.push(bt[kt])}for(var Lt=0;Lt<St.length;Lt++)d3.select(pt._groups[0][St[Lt]]).style("opacity","1")}for(var Pt=H.selectAll(".polygon-radar-texts"),At=[],Wt=[],zt=0;zt<Pt._groups[0].length;zt++){Wt.push(zt);for(var Mt=zt+1;Mt<Pt._groups[0].length;Mt++){p(i(d3.select(Pt._groups[0][zt])),i(d3.select(Pt._groups[0][Mt])))&&(At.push(zt),d3.select(Pt._groups[0][zt]).style("visibility","hidden"))}}for(var Dt=new Set(At),Rt=Array.from(Dt),Nt=Yt(Rt,Wt),Tt=0;Tt<Rt.length;Tt++){for(var Bt=[],Gt=0;Gt<Nt.length;Gt++){var Xt=i(d3.select(Pt._groups[0][Rt[Tt]])),jt=i(d3.select(Pt._groups[0][Nt[Gt]]));if(Bt.push(p(Xt,jt)),p(Xt,jt)){if(Rt[Tt]==Nt[Gt])continue;d3.select(Pt._groups[0][Rt[Tt]]).style("visibility","hidden")}}0==Bt.filter((function(t){return 1==t})).length&&Nt.push(Rt[Tt])}for(var It=0;It<Nt.length;It++)d3.select(Pt._groups[0][Nt[It]]).style("visibility","visible");function Yt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"deadData",value:function(t){return arguments.length?(this._deadData=t,this):this._deadData}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),gn="grid-polygon-path",vn="grid-line",mn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","polygon-grid"),i.group=i.elem.append("g"),i._radius=100,i._startAngle=0,i._endAngle=2*Math.PI,i._donutCount=5,i._sectorCount=8,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=(t._data,t._startAngle,t._endAngle,t._radius),i=t._donutCount,n=t._sectorCount,a=2*Math.PI/n,o={webs:[],webPoints:[]};if(isNaN(Number(i)))for(var r=i.length-1;r>=0;r--){for(var l="",s=[],u=Math.abs(i[r]),c=0;c<n;c++){var h=u*Math.sin(c*a),d=-u*Math.cos(c*a);l+=h+","+d+" ",s.push({x:h,y:d})}o.webs.push(l),o.webPoints.push(s)}else for(var _=i;_>0;_--){for(var f="",p=[],y=e/i*_,x=0;x<n;x++){var g=y*Math.sin(x*a),v=-y*Math.cos(x*a);f+=g+","+v+" ",p.push({x:g,y:v})}o.webs.push(f),o.webPoints.push(p)}var m=t.group.style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray);m.selectAll("*").remove(),function(){if(!t._showX)return void m.selectAll(".grid-polygon-path").remove();var e=m.selectAll(".grid-polygon-path").data(o.webs);e.exit().remove(),e.enter().append("polygon").attr("class",gn).merge(e).attr("points",(function(t){return t})).attr("fill","white").attr("fill-opacity",1).filter((function(t,e){return e%2!=0})).attr("fill","#e4e3e6").attr("fill-opacity",.4)}(),function(){if(!t._showY)return void m.selectAll(".grid-line").remove();var e=m.selectAll(".grid-line").data(o.webPoints[0]);e.exit().remove(),e.enter().append("line").attr("class",vn).merge(e).attr("x1",0).attr("y1",0).attr("x2",(function(t){return t.x})).attr("y2",(function(t){return t.y}))}()}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}}]),e}(pt);function bn(t,e){var i=0,n=[];if(e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&0==t.configurable&&n.push(t.index)})),P(t,[i],2))return[];for(var a=z(t,e),o=[],r=a.length,l=a[0],s=[],u=1;u<r;u++)s.push(a[u].length);s.sort((function(t,e){return e-t}));for(var c=1;c<r;c++){var d=a[c],_=d[i];if(""!=_&&null!=_&&null!=_||(_="$-"+c),_){for(var f={name:_,showLegend:_!="$-"+c,data:[]},p=0;p<s[0];p++){var y=l[p];""!=y&&null!=y&&null!=y||(y="&-"+p),p!==i&&f.data.push({name:y,subName:_,showAxisText:y!="&-"+p,value:""==d[p]||isNaN(parseFloat(d[p]))||null==d[p]||null==d[p]?0:parseFloat(d[p]),tooltipValueShow:!isNaN(parseFloat(d[p]))})}o.push(f)}}return o.forEach((function(t,e){t.key=h(t.name)+"-"+e})),o}var Sn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.gridPolygon=new mn(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.radar=new xn(i.coreGroup),i.radialAxis=new mt(i.mainGroup),i._startAngle=0,i._endAngle=2*Math.PI,i._showPoints=!0,i._fillOpacity=0,i._curve=d3.curveLinearClosed,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#FFFFFF",i._fillColor=null,i._endPointRadius=3.5,i._labelShow=!1,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同时径向展开","依次径向展开"],i._moveStyle="同时径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var e=t.activeData,i=t.gridPolygon,n=t.radialAxis,a=t.radar,r=(t.tooltip,t.widthOfCore,t.heightOfCore,t.widthOfNoMargin),l=t.heightOfMainGroup,s=(t._fontSize,t._startAngle,t._endAngle,0),u=void 0,h=void 0,d=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"";"水平"==t._xLabelDirection&&1==t._xTickShow?(u=d3.max(d.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),h=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(u=d3.max(d.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),h=d3.max(d.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(u=t._fontSize,h=t._fontSize):(u=0,h=0),u=u<.4*r*.88?u:.4*r*.88,h=h<.4*l*.88?h:.4*l*.88,s="外部"==t._axisPositonChoice?Math.min(.88*r/2-u,.88*l/2-h):.88*Math.min(r,l)/2;var _=t.defs;_.selectAll("filter").remove();var f=_.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_polygonRadar").attr("filterUnits","objectBoundingBox");if(f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),f.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),f.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),f.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),f.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var p=x(t._strokeColor),g=[],v=!0,m=!1,b=void 0;try{for(var S,k=p[Symbol.iterator]();!(v=(S=k.next()).done);v=!0){var w=S.value,C=[],O=w.split(":");C.push(q(O[0])),C.push(O[1]),g.push(C)}}catch(t){m=!0,b=t}finally{try{!v&&k.return&&k.return()}finally{if(m)throw b}}var F=g.concat(),L=F.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(L[1]).x1+"%").attr("y1",y(L[1]).y1+"%").attr("x2",y(L[1]).x2+"%").attr("y2",y(L[1]).y2+"%").selectAll("stop").data(F).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var P=x(t._fillColor),A=[],W=!0,z=!1,M=void 0;try{for(var D,N=P[Symbol.iterator]();!(W=(D=N.next()).done);W=!0){var T=D.value,B=[],G=T.split(":");B.push(q(G[0])),B.push(G[1]),A.push(B)}}catch(t){z=!0,M=t}finally{try{!W&&N.return&&N.return()}finally{if(z)throw M}}var X=A.concat(),j=X.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(j[1]).x1+"%").attr("y1",y(j[1]).y1+"%").attr("x2",y(j[1]).x2+"%").attr("y2",y(j[1]).y2+"%").selectAll("stop").data(X).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(e).deadData(t.sortedDataCopy).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).labelShow(t._labelShow).radius(s).curve(t._curve).endPointRadius(t._endPointRadius).strokeWidth(t._strokeWidth).strokeColor(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).lineWidth(t._lineWidth).fillOpacity(t._fillOpacity).fillColor(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).showX(t._xTickShow).xLabelDirection(t._xLabelDirection).mainWidth(r).mainHeight(l).defs(t.defs).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(i,n){var a=[{text:e[n].name=="$-"+(n+1)?"":e[n].name,color:e[n].color}];e[n].data.forEach((function(e,i){a.push({text:(e.name=="&-"+(i+1)?"":e.name)+": "+E(e.value,t._numberStyle,t._decimalPlaces),color:"none"})})),d3.select(this).style("stroke-opacity",.8).style("stroke-width",1.5*t._lineWidth);var o=t.group.selectAll(".circle-g").nodes(),r=t.group.selectAll(".polygon-radar polygon").nodes();d3.selectAll(o[n].childNodes).style("r",1.5*t._endPointRadius),d3.select(r[n]).style("stroke-width",1.5*t._lineWidth),t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(e,i){d3.select(this).style("stroke-opacity",.8).style("stroke-width",1.5*t._lineWidth);var n=t.group.selectAll(".circle-g").nodes(),a=t.group.selectAll(".polygon-radar polygon").nodes();d3.select(a[i]).style("stroke-width",1.5*t._lineWidth),d3.selectAll(n[i].childNodes).style("r",1.5*t._endPointRadius),t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e,i){d3.select(this).style("stroke-opacity",1).style("stroke-width",t._lineWidth);var n=t.group.selectAll(".circle-g").nodes(),a=t.group.selectAll(".polygon-radar polygon").nodes();d3.select(a[i]).style("stroke-width",t._lineWidth),d3.selectAll(n[i].childNodes).style("r",t._endPointRadius),t.tooltip.hide()}));var I=d3.max(e,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))}))||1;n.data(e).radius(s).innerRadius(0).startAngle(t._startAngle).endAngle(t._endAngle).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(r).mainHeight(l).suffix(t._yLabelSuffix).maxValue(I).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var Y=(t._width-t._marginLeft-t._marginRight)/2;t.coreGroup.call(o,Y,l/2+(e.length>0&&3==e[0].data.length?s/4:0)),n.translate(Y,l/2+(e.length>0&&3==e[0].data.length?s/4:0)).update();var H=n._polarCount;H.push(-s),H=Array.from(new Set(H)),i.donutCount(t._isPolar?H:5).sectorCount(e[0]?e[0].data.length:1).radius(s).fillOpacity(null==t._fillOpacity?0:t._fillOpacity).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),i.translate(Y,l/2+(e.length>0&&3==e[0].data.length?s/4:0)).update(),a.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=bn;return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"水平").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"");var r={straight:d3.curveLinearClosed,curve:d3.curveCardinalClosed};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinearClosed,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"widthOfNoMargin",get:function(){var t=this._width-this._marginLeft-this._marginRight;return t>0?t:0}}]),e}(vt),kn="axis-group",wn="y-ranking-title",Cn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-ranking"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i._countOfLabel=null,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickValueTexts,l=void 0;l=t.axisFunc="right"===e?d3.axisRight(i):d3.axisLeft(i);var s=null;"number"===t._type&&t._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(s=d3.format("d")),l.tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(-.5).tickPadding(t._tickPadding).tickFormat(s);var u=n.select(".axis-group").empty()?n.append("g").attr("class",kn):n.select(".axis-group");u.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).call(l).on("start",(function(){u.selectAll(".tick text").remove(),u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("display",t._tickShow?"block":"none").attr("dx",(function(t,e){return-8})).attr("dy",.4*a).text((function(t,e){return r[e]})),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none")}));var c=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var h=n.select("."+wn).empty()?n.append("g").attr("class",wn):n.select("."+wn),d=h.select("text").empty()?h.append("text"):h.select("text");R(t._title,a,t._fontFamily);h.call(o,-(this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0!=parseFloat(t._yAxisLineWidth)&&t._yAxisLineWidth&&t._axisLineShow?7:0),c/2),d.attr("y",-7).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title)}else n.select("."+wn).remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);e="category"===o?a.domain():a.ticks(t._tickCount);var s=new Array;if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[1],c=u||0,h=a.domain()[0],d=h||1;if(t._countOfLabel>1){var _=(d-c)/(t._countOfLabel-1);d+=_;for(var f=c;f<d;f+=_)f<Math.ceil(h)+1&&s.push(parseFloat(f.toFixed(0)))}else s.push(u)}if(s.length>t._countOfLabel&&1!=s.length&&s.pop(),i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o){for(var p=[],y=0;y<e.length;y++)p.push(E(e[y],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=p}var x=d3.max(i,(function(e){return R(e,r,t._fontFamily)}));x<=l?(i=i,n=x):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l);var g=Math.abs(a.range()[0]-a.range()[1])/e.length;if("category"===o&&1.1*t._fontSize>g){var v=Math.ceil(1.1*t._fontSize/g);e=e.filter((function(t,e){return e%v==1}))}return t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth+(this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?7:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?7:0),t}}]),e}(Bt),On=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","ranking-line-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._lineWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t.group;n.selectAll("*").remove(),n.selectAll(".groups").remove(),n.selectAll(".animation-ranking-groups").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=n.append("g").attr("class","groups").selectAll("g").data(e);function o(t,e){var i=e.getPointAtLength(t);return[i.x,i.y]}function r(t,e){var i=o(Math.max(t-.01,0),e),n=o(t+.01,e);return 180*Math.atan2(n[1]-i[1],n[0]-i[0])/Math.PI}a.exit().remove(),a.enter().append("g").attr("class","animation-ranking-groups").merge(a).each((function(n,a){var l=d3.select(this).append("path").attr("class","ranking-lines").style("fill","none").style("stroke",/\[/.test(n.color)?"url("+c("#"+t.id+"-index-"+a)+")":n.color).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).style("display","none").attr("d",i(n.data)),s=d3.select(this).append("path").attr("class",".arrow").attr("d","M-0,0 L-8,8 L8,0 L-8,-8 Z").style("stroke",/\[/.test(n.color)?"url("+c("#"+t.id+"-index-"+a)+")":n.color).style("fill",/\[/.test(n.color)?"url("+c("#"+t.id+"-index-"+a)+")":n.color).style("display","none"),u=d3.select(this).select(".ranking-lines").node(),h=u.getTotalLength();null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?(s.style("display","none"),l.style("display","block").style("stroke-dasharray",t._strokeDasharry)):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?(s.style("display","none"),l.style("display","block").style("stroke-dasharray",t._strokeDasharry)):(s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attrTween("transform",(function(){return function(t){var e=t*h;return"translate("+o(e,u)+") rotate( "+r(e,u)+")"}})).style("display","block").transition().style("display","none"),l.transition().style("display","block").duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attrTween("stroke-dasharray",(function(){return d3.interpolateString("0,"+h,h+","+h)}))):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?(s.style("display","none"),l.style("display","block").style("stroke-dasharray",t._strokeDasharry)):(s.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*a:0).attrTween("transform",(function(){return function(t){var e=t*h;return"translate("+o(e,u)+") rotate( "+r(e,u)+")"}})).style("display","block").transition().style("display","none"),l.transition().style("display","block").duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*a:0).attrTween("stroke-dasharray",(function(){return d3.interpolateString("0,"+h,h+","+h)}))))})),n.selectAll(".circle-group").remove();var l=n.append("g").attr("class","circle-group").selectAll("g").data(e,(function(t){return t.name}));l.exit().remove(),l.enter().append("g").merge(l).each((function(i,n){var a=d3.select(this).selectAll("circle").data(i.data);a.exit().remove();var o=a.enter().append("circle").attr("class","clip-scatter-plot").merge(a).style("fill",t._fill||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color)).style("stroke",t._stroke||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.value)||0}));null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?o.attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?o.attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):o.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("r",(function(){var e=d3.interpolate(0,t._radius);return function(t){return e(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?o.attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):o.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0).ease(d3.easeLinear).attrTween("r",(function(){var e=d3.interpolate(0,t._radius);return function(t){return e(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd))}));for(var s=n.selectAll(".clip-scatter-plot").nodes(),u=0;u<s.length;u++)""==s[u].__data__.value||isNaN(s[u].__data__.value)?d3.select(s[u]).style("opacity","0"):d3.select(s[u]).style("opacity","1");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),Fn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.linePlot=new On(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Cn(i.mainGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.stackText=new ae(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._curve=d3.curveCardinal,i._showPoints=!0,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=2,i._strokeColor="",i._fillColor="#fff",i._endPointRadius=3.5,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="下面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同时绘制","依次绘制"],i._moveStyle="同时绘制",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.linePlot,a=t.clipArea,r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.stackText,h=t.xScale,d=t.yScale,_=(t.xAxis._axisStart,t.xAxis._axisEnd),f=0;_>t.widthOfNoMargin-t.yAxis.width&&(f=_-(t.widthOfNoMargin-t.yAxis.width));var p=t.widthOfCore-f,g=t.heightOfCore,v=(t.xAxis,t.yAxis,t.defs);v.selectAll("filter").remove();var m=v.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_line").attr("filterUnits","objectBoundingBox");if(m.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),m.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),m.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),m.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),m.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var b=x(t._strokeColor),S=[],k=!0,w=!1,C=void 0;try{for(var O,F=b[Symbol.iterator]();!(k=(O=F.next()).done);k=!0){var L=O.value,P=[],A=L.split(":");P.push(q(A[0])),P.push(A[1]),S.push(P)}}catch(t){w=!0,C=t}finally{try{!k&&F.return&&F.return()}finally{if(w)throw C}}var W=S.concat(),z=W.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(z[1]).x1+"%").attr("y1",y(z[1]).y1+"%").attr("x2",y(z[1]).x2+"%").attr("y2",y(z[1]).y2+"%").selectAll("stop").data(W).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var M=x(t._fillColor),D=[],R=!0,N=!1,T=void 0;try{for(var B,G=M[Symbol.iterator]();!(R=(B=G.next()).done);R=!0){var X=B.value,j=[],I=X.split(":");j.push(q(I[0])),j.push(I[1]),D.push(j)}}catch(t){N=!0,T=t}finally{try{!R&&G.return&&G.return()}finally{if(N)throw T}}var Y=D.concat(),H=Y.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(H[1]).x1+"%").attr("y1",y(H[1]).y1+"%").attr("x2",y(H[1]).x2+"%").attr("y2",y(H[1]).y2+"%").selectAll("stop").data(Y).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.width(p).height(g).planeX(h.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).xScale(h).yScale(d).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).mainGroup(t.mainGroup).curve(t._curve).radius(t._endPointRadius).stroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).fill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).lineWidth(t._lineWidth).strokeWidth(t._strokeWidth),s.y1(0).y2(g).stroke("#c6c6c6").strokeDasharray("0 0"),l.data(h.domain()).isScalePoint(!1).bandX(h.range()[0]).bandWidth(h.step()).bandHeight(g).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],l=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));l.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),r.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show(),s.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+(h(a)+h.bandwidth()/2)+",0)")})).onMousemove((function(){r.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){r.hide(),s.hide()})),u.data(e).xScale(h).yScale(d).type("mix").fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0);var V=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(V).remove(),l.update(),i.update(),n.update(),u.update(),a.width(p).height(g).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),a.update(),0!=t._yRange.length&&(0==isNaN(parseFloat(t._yRange[0]))||0==isNaN(parseFloat(t._yRange[1]))?t.coreGroup.attr("clip-path","url("+c("#"+a.id)+")"):t.coreGroup.attr("clip-path",""))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),e.compute();var d=t._yDomain[0]-t._yDomain[1]>0?t._yDomain[0]-t._yDomain[1]:0;i.tickCount(d+1),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))})),d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))}))]:[1,0];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[0]:a[0]<i[0]?1.5*i[0]:a[0]:parseFloat(i[1]),isNaN(parseFloat(i[0]))?a[1]:parseFloat(i[0])]}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):""),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}}]),e}(Tt),Ln="axis-group",Pn="y-percent-title",An=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-percent"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i._countOfLabel=null,i._labelSuffix="%",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickValueTexts,l=void 0;l=t.axisFunc="right"===e?d3.axisRight(i):d3.axisLeft(i);var s=null;"number"===t._type&&t._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(s=d3.format("d")),l.tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(s);var u=n.select(".axis-group").empty()?n.append("g").attr("class",Ln):n.select(".axis-group");u.transition().duration(t._transition?t._duration:0).call(l).on("start",(function(){u.selectAll(".tick text").remove(),u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dx",-8).attr("dy",.4*a).text((function(t,e){return r[e]})),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.selectAll(".tick text").style("display",t._tickShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none")}));var c=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var h=n.select("."+Pn).empty()?n.append("g").attr("class",Pn):n.select("."+Pn),d=h.select("text").empty()?h.append("text"):h.select("text");R(t._title,a,t._fontFamily);h.call(o,-(this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0!=parseFloat(t._yAxisLineWidth)&&t._yAxisLineWidth&&t._axisLineShow?7:0),c/2),d.attr("y",-7).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title)}else n.select("."+Pn).remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);Math.abs(a.range()[0]-a.range()[1]);e="category"===o?a.domain():a.ticks(t._tickCount);new Array;var s=[];if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[0],c=(Math.abs(parseFloat(u))>1?Math.round(parseFloat(u)):u)||0,h=a.domain()[1]||1;if(0!=t._countOfLabel){var d=h-c,_=t._countOfLabel/100,f=Math.ceil(Math.abs(d/(t._countOfLabel/100))),p=8*Math.ceil(t._tickCount),y=d3.tickStep(c,h,p);t._countOfLabel/100<y&&(f=Math.ceil(Math.abs(d/y)),_=y),h+=f;for(var x=0;x<f+1;x++)s.push(c+x*_)}else s.push(c);"number"===o&&(s.unshift(0),s[s.length-1]>1&&s.pop(),s.push(1),s=Array.from(new Set(s)));var g=[];s.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;g.push(i)}})),g=g.filter((function(t){return t<=8})),s=s.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(g)&&(t=parseFloat(t).toFixed(d3.max(g)))}return t}))}if(i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o){for(var v=[],m=0;m<e.length;m++)v.push(E((100*e[m]).toFixed(0),t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=v}var b=d3.max(i,(function(e){return R(e,r,t._fontFamily)}))||0;return b<=l?(i=i,n=b):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth+(this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?7:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?7:0),t}}]),e}(Bt),Wn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","percentage-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth=0,i._fillOpacity=.7,i._barCornerRadius=5,i._borderColor="#000",i._borderWidth=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll("*").remove(),n.selectAll(".percentageStackBar").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t._rectObj.barWidthPercent,o=n.append("g").selectAll("g").data(e);o.exit().remove(),o.enter().append("g").merge(o).each((function(i,n){var o=d3.select(this).selectAll("rect").data(i.data);if(o.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))o.enter().append("rect").attr("class","percentageStackBar").merge(o).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("y",(function(e){return t._yScale(e.total)})).attr("width",t._xScale.step()*a).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||2==t._moveOptions.indexOf(t._moveStyle)){var r=o.enter().append("rect").attr("class","percentageStackBar").merge(o).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("y",(function(e){return t._yScale(e.total-e.percent)})).attr("width",t._xScale.step()*a).attr("height",0);0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?r.attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):r.transition().delay((function(i,a){return t._transition?n*(.9*t._duration/(e.length>0?e.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):1==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?r.attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):r.transition().delay((function(e,n){return t._transition?n*(.9*t._duration/(i.data.length>0?i.data.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):2==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?r.attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var l=o.enter().append("rect").attr("class","percentageStackBar").merge(o).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("y",(function(e){return t._yScale(0)})).attr("width",t._xScale.step()*a).attr("height",0);t._interrupt?l.attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):l.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0}))}else if(4==t._moveOptions.indexOf(t._moveStyle)||5==t._moveOptions.indexOf(t._moveStyle)){var s=o.enter().append("rect").attr("class","percentageStackBar").merge(o).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("y",(function(e){return t._yScale(e.total)})).attr("width",0).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0}));4==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("width",t._xScale.step()*a):s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("width",t._xScale.step()*a):5==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?s.attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("width",t._xScale.step()*a):s.transition().delay((function(e,n){return t._transition?n*(.9*t._duration/(i.data.length>0?i.data.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("width",t._xScale.step()*a))}else if(6==t._moveOptions.indexOf(t._moveStyle)){var u=o.enter().append("rect").attr("class","percentageStackBar").merge(o).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-a)/2})).attr("y",0).attr("width",t._xScale.step()*a).attr("height",0);t._interrupt?u.attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0})):u.transition().delay((function(i,a){return t._transition?n*(.9*t._duration/(e.length>0?e.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("y",(function(e){return t._yScale(e.total)})).attr("height",(function(e){return t._yScale(1-e.percent)>0?t._yScale(1-e.percent):0}))}o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)})),n.selectAll(".percentageStackBarTexts").remove();var r=n.append("g").selectAll("g").data(e);r.exit().remove(),r.enter().append("g").merge(r).each((function(e,i){var o=d3.select(this).append("g").attr("class","percentageStackBarTexts").selectAll("text").data(e.data);o.exit().remove();var r=o.enter().append("text").merge(o).text((function(e){return null==t._contentOption||null==t._contentChoice?0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix:0==t._contentOption.indexOf(t._contentChoice[0])?0==e.value?"":-1==String(100*e.percent).indexOf(".")?E(100*parseFloat(e.percent),t._numberStyle,t._decimalPlaces)+"%":E((100*parseFloat(e.percent)).toFixed(2),t._numberStyle,t._decimalPlaces)+"%":1==t._contentOption.indexOf(t._contentChoice[0])?0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix:void 0})).attr("fill",t._textObj.colorFunc).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return t._xScale.range()[0]+(t._xScale.step()*i+t._xScale.step()*(1-a)/2)})).attr("y",(function(e){return t._yScale(e.total)})).attr("text-anchor","middle").attr("dx",t._xScale.step()*a/2).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice?0:0==t._positionOptions.indexOf(t._positionChoice)?t._yScale(1-e.percent)/2+.4*t._fontSize:1==t._positionOptions.indexOf(t._positionChoice)?t._yScale(1-e.percent)-.3*t._fontSize:void 0})).style("display",t._labelShow?"block":"none");t._interrupt?r.style("opacity",1):r.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),null!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&null!=t._contentOption&&null!=t._contentChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||n.selectAll(".percentageStackBarTexts text").style("display","none")}));for(var l=n.selectAll(".percentageStackBarTexts text"),s=[],u=[],h=0;h<l._groups[0].length;h++){u.push(h);for(var d=h+1;d<l._groups[0].length;d++){p(i(d3.select(l._groups[0][h])),i(d3.select(l._groups[0][d])))&&(s.push(h),d3.select(l._groups[0][h]).style("visibility","hidden"))}}for(var _=new Set(s),f=Array.from(_),g=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(f,u),v=0;v<f.length;v++){for(var m=[],b=0;b<g.length;b++){var S=i(d3.select(l._groups[0][f[v]])),k=i(d3.select(l._groups[0][g[b]]));if(m.push(p(S,k)),p(S,k)){if(f[v]==g[b])continue;d3.select(l._groups[0][f[v]]).style("visibility","hidden")}}0==m.filter((function(t){return 1==t})).length&&g.push(f[v])}for(var w=0;w<g.length;w++)d3.select(l._groups[0][g[w]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),zn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","percentage-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new An(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new Wn(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._curve=d3.curveCardinal,i._histogramWidth=1,i._yScaleHeight=1.05,i._barWidthPercent=.5,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["内部居中","内部居下"],i._positionChoice="内部居中",i._contentOption=["百分比","数值"],i._contentChoice=["百分比"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向分类拉伸","纵向分组拉伸","纵向同步拉伸","纵向整体拉伸","横向整体展开","横向同步展开","俄罗斯方块"],i._moveStyle="纵向整体拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=[],n=0;n<(0==e.length?0:e[0].data.length);n++){for(var a=0,o=0;o<e.length;o++)a+=parseFloat(e[o].data[n].value);i.push(a)}for(var r=0;r<e.length;r++)for(var l=0;l<e[r].data.length;l++)0==i[l]?e[r].data[l].percent=0:e[r].data[l].percent=e[r].data[l].value/i[l];for(var s=0;s<e.length;s++)for(var u=0;u<e[s].data.length;u++)e[s].data[u].total=0==s?parseFloat(e[s].data[u].percent):e[s-1].data[u].total+parseFloat(e[s].data[u].percent);var h=e,d=t.grid,_=t.tooltip,f=t.rectPlot,p=t.overlay,g=t.selectOverlay,v=t.xScale,m=t.yScale,b=(t.xAxis._axisStart,t.xAxis._axisEnd),S=0;b>t.widthOfNoMargin-t.yAxis.width&&(S=b-(t.widthOfNoMargin-t.yAxis.width));var k=t.widthOfCore-S,w=t.heightOfCore,C=t.defs;C.selectAll("filter").remove();var O=C.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_percentageBar").attr("filterUnits","objectBoundingBox");if(O.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),O.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),O.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),O.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),O.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),p.data(v.domain()).isScalePoint(!1).bandWidth(v.step()).bandHeight(w).bandX(v.range()[0]).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],r=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));r.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),_.data(o).update().move([d3.event.offsetX,d3.event.offsetY]),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+v(a)+",0)"),_.show()})).onMousemove((function(){_.move([d3.event.offsetX,d3.event.offsetY]),g.show()})).onMouseout((function(){_.hide(),g.hide()})),t._borderColor&&/\[/.test(t._borderColor)){var F=x(t._borderColor),L=[],P=!0,A=!1,W=void 0;try{for(var z,M=F[Symbol.iterator]();!(P=(z=M.next()).done);P=!0){var D=z.value,R=[],N=D.split(":");R.push(q(N[0])),R.push(N[1]),L.push(R)}}catch(t){A=!0,W=t}finally{try{!P&&M.return&&M.return()}finally{if(A)throw W}}var T=L.concat(),B=T.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(B[1]).x1+"%").attr("y1",y(B[1]).y1+"%").attr("x2",y(B[1]).x2+"%").attr("y2",y(B[1]).y2+"%").selectAll("stop").data(T).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}f.data(h).xScale(v).yScale(m).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).rectObj({barWidthPercent:t._barWidthPercent}).textObj({colorFunc:function(){return q(t._textLabel.color)}}).fillOpacity(t._fillOpacity),d.width(k).height(w).planeX(v.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),g.width(v.step()).height(w).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)");var G=t.group.selectAll(".percentage-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(G).remove(),f.update(),g.update(),p.update(),d.translate(t.yAxis.width,0).update()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix("%").numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.display,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._barWidthPercent=0==i.barWidthPercent||i.barWidthPercent?i.barWidthPercent:this._barWidthPercent,this._barCornerRadius=i.bar4CornerRadius?i.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==i.borderWidth||i.borderWidth?i.borderWidth:this._borderWidth,this._borderColor=i.borderColor?q(i.borderColor):"",this._fillOpacity=0==i.fillOpacity||i.fillOpacity?i.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._contentChoice=e.contentChoice?e.contentChoice:this._contentChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=(t._yDomain,e.length?e[0].data.map((function(t){return t.name})):[0,1]);t._xDomain=i,t._yDomain=[0,1]}}]),e}(Tt),Mn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","percentage-area-plot"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)){var i=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.percent)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t.group.selectAll("path").data(e,(function(t){return t.key}));n.exit().remove(),n.enter().append("path").merge(n).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).attr("d",(function(t){return i(t.data)}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){var a=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.percent)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),o=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.percent)})).y1((function(e){return t._yScale(e.total-e.percent)})).defined((function(t){return!isNaN(parseFloat(t.value))}));a.curve(t._curve),o.curve(t._curve);var r=t.group;r.selectAll("path").remove();var l=r.selectAll("path").data(e,(function(t){return t.key}));l.exit().remove();var s=l.enter().append("path").merge(l).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?s.attr("d",(function(t){return a(t.data)})):s.attr("d",(function(t){return o(t.data)})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t){return a(t.data)}))}else if(2==t._moveOptions.indexOf(t._moveStyle)){var u=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.percent)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),h=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(0)})).y1((function(e){return t._yScale(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));u.curve(t._curve),h.curve(t._curve);var d=t.group;d.selectAll("path").remove();var _=d.selectAll("path").data(e,(function(t){return t.key}));_.exit().remove();var f=_.enter().append("path").merge(_).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?f.attr("d",(function(t){return u(t.data)})):f.attr("d",(function(t){return h(t.data)})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t){return u(t.data)}))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var p=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.percent)})).y1((function(e){return t._yScale(e.total)})).defined((function(t){return!isNaN(parseFloat(t.value))})),g=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.total-e.percent)})).y1((function(e){return t._yScale(e.total-e.percent)})).defined((function(t){return!isNaN(parseFloat(t.value))}));p.curve(t._curve),g.curve(t._curve);var v=t.group;v.selectAll("path").remove();var m=v.selectAll("path").data(e,(function(t){return t.key}));m.exit().remove();var b=m.enter().append("path").merge(m).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}));t._interrupt?b.attr("d",(function(t){return p(t.data)})):b.attr("d",(function(t){return g(t.data)})).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:0)*n:0})).attr("d",(function(t){return p(t.data)}))}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),Dn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","percentage-line-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._strokeWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-line-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)){var i=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e,i){return t._yScale(e.total)+i/Math.pow(10,8)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t.group,a=n.selectAll("path").data(e,(function(t){return t.key}));a.exit().remove(),a.enter().append("path").merge(a).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._strokeWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return i(t.data)}));var o=n.append("g").selectAll("g").data(e,(function(t){return t.name}));o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.total)||0})).attr("r",t._radius)}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){var r=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e,i){return t._yScale(e.total)+i/Math.pow(10,8)})).defined((function(t){return!isNaN(parseFloat(t.value))})),l=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.total-e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));r.curve(t._curve),l.curve(t._curve);var s=t.group;s.selectAll("path").remove();var u=s.selectAll("path").data(e,(function(t){return t.key}));u.exit().remove();var h=u.enter().append("path").merge(u).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._strokeWidth).style("stroke-dasharray",t._strokeDasharry),d=s.append("g").selectAll("g").data(e,(function(t){return t.name}));d.exit().remove();var _=d.enter().append("g").merge(d).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.total)||0})).attr("r",t._radius)}));t._interrupt?(h.style("opacity",1).attr("d",(function(t){return r(t.data)})),_.style("opacity",1)):(h.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+.8*t._duration:0})).duration(t._transition?.1*t._duration:0).style("opacity",1).attr("d",(function(t){return r(t.data)})),_.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+.8*t._duration:0})).duration(t._transition?.1*t._duration:0).style("opacity",1))}else if(2==t._moveOptions.indexOf(t._moveStyle)){var f=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e,i){return t._yScale(e.total)+i/Math.pow(10,8)})).defined((function(t){return!isNaN(parseFloat(t.value))})),p=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e,i){return t._yScale(0)+i/Math.pow(10,8)})).defined((function(t){return!isNaN(parseFloat(t.value))}));f.curve(t._curve),p.curve(t._curve);var g=t.group;g.selectAll("path").remove();var v=g.selectAll("path").data(e,(function(t){return t.key}));v.exit().remove();var m=v.enter().append("path").merge(v).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._strokeWidth).style("stroke-dasharray",t._strokeDasharry),b=g.append("g").selectAll("g").data(e,(function(t){return t.name}));b.exit().remove();var S=b.enter().append("g").merge(b).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();var a=n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?a.attr("cy",(function(e){return t._yScale(e.total)||0})):a.attr("cy",(function(e){return t._yScale(0)||0})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("cy",(function(e){return t._yScale(e.total)||0}))}));t._interrupt?(m.style("opacity",1).attr("d",(function(t){return f(t.data)})),S.style("opacity",1)):(m.attr("d",(function(t){return p(t.data)})).style("opacity",0).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).attr("d",(function(t){return f(t.data)})),S.style("opacity",0).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var k=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e,i){return t._yScale(e.total)+i/Math.pow(10,8)})).defined((function(t){return!isNaN(parseFloat(t.value))})),w=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e,i){return t._yScale(e.total-e.value)+i/Math.pow(10,8)})).defined((function(t){return!isNaN(parseFloat(t.value))}));k.curve(t._curve),w.curve(t._curve);var C=t.group;C.selectAll("path").remove();var O=C.selectAll("path").data(e,(function(t){return t.key}));O.exit().remove();var F=O.enter().append("path").merge(O).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._strokeWidth).style("stroke-dasharray",t._strokeDasharry),L=C.append("g").selectAll("g").data(e,(function(t){return t.name}));L.exit().remove();var P=L.enter().append("g").merge(L).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();n.enter().append("circle").attr("class","clip-scatter-plot").merge(n).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth).attr("cx",(function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2||0})).attr("cy",(function(e){return t._yScale(e.total)||0})).attr("r",t._radius)}));t._interrupt?(F.style("opacity",1).attr("d",(function(t){return k(t.data)})),P.style("opacity",1)):(F.style("opacity",0).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:0)*(n+1):0})).style("opacity",1).attr("d",(function(t){return k(t.data)})),P.style("opacity",0).transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:0)*(n+1):0})).style("opacity",1))}for(var A=t.group.selectAll(".clip-scatter-plot").nodes(),W=0;W<A.length;W++)""==A[W].__data__.value||isNaN(A[W].__data__.value)?d3.select(A[W]).style("visibility","hidden"):d3.select(A[W]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"radiusFill",value:function(t){return arguments.length?(this._radiusFill=t,this):this._radiusFill}},{key:"radiusStroke",value:function(t){return arguments.length?(this._radiusStroke=t,this):this._radiusStroke}},{key:"radiusWidth",value:function(t){return arguments.length?(this._radiusWidth=t,this):this._radiusWidth}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),Rn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","percentage-area-text"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._strokeWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll(".stackAreaTexts").remove();var a=n.selectAll("g").data(e);a.exit().remove(),a.enter().append("g").merge(a).each((function(e){var i=d3.select(this).append("g").attr("class","stackAreaTexts").selectAll("text").data(e.data);i.exit().remove();var n=i.enter().append("text").merge(i).text((function(e){return null==t._contentOption||null==t._contentChoice?isNaN(parseFloat(e.value))||0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix:0==t._contentOption.indexOf(t._contentChoice[0])?isNaN(parseFloat(e.value))||0==e.value?"":-1==String(100*e.percent).indexOf(".")?E(100*parseFloat(e.percent),t._numberStyle,t._decimalPlaces)+"%":E((100*parseFloat(e.percent)).toFixed(2),t._numberStyle,t._decimalPlaces)+"%":1==t._contentOption.indexOf(t._contentChoice[0])?isNaN(parseFloat(e.value))||0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix:void 0})).attr("fill",t._textObj.colorFunc).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return t._xScale.range()[0]+(t._xScale.step()*i+.35*t._xScale.step())})).attr("y",(function(e){return t._yScale(e.total)})).attr("text-anchor","middle").attr("dx",.15*-t._xScale.step()).attr("dy",(function(e){return null==t._positionOptions||null==t._positionChoice||0==t._positionOptions.indexOf(t._positionChoice)?0:1==t._positionOptions.indexOf(t._positionChoice)?t._fontSize:void 0})).style("display",t._labelShow?"block":"none");t._interrupt?n.style("opacity",1):n.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)})),null!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&null!=t._contentOption&&null!=t._contentChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||n.selectAll(".stackAreaTexts text").style("display","none");for(var o=n.selectAll(".stackAreaTexts text"),r=[],l=[],s=0;s<o._groups[0].length;s++){l.push(s);for(var u=s+1;u<o._groups[0].length;u++){p(i(d3.select(o._groups[0][s])),i(d3.select(o._groups[0][u])))&&(r.push(s),d3.select(o._groups[0][s]).style("visibility","hidden"))}}for(var c=new Set(r),h=Array.from(c),d=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(h,l),_=0;_<h.length;_++){for(var f=[],y=0;y<d.length;y++){var x=i(d3.select(o._groups[0][h[_]])),g=i(d3.select(o._groups[0][d[y]]));if(f.push(p(x,g)),p(x,g)){if(h[_]==d[y])continue;d3.select(o._groups[0][h[_]]).style("visibility","hidden")}}0==f.filter((function(t){return 1==t})).length&&d.push(h[_])}for(var v=0;v<d.length;v++)d3.select(o._groups[0][d[v]]).style("visibility","visible");for(var m=n.selectAll(".stackAreaTexts text").nodes(),b=0;b<m.length;b++)isNaN(m[b].__data__.value)&&d3.select(m[b]).style("visibility","hidden");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Nn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","percentage-area-chart"),i.grid=new Jt(i.coreGroup),i.areaPlot=new Mn(i.coreGroup),i.linePlot=new Dn(i.coreGroup),i.percentareatext=new Rn(i.mainGroup),i.overlay=new te(i.mainGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new Bi(i.coreGroup),i.clipArea=new Ut(i.defs),i.AnimationArea=new Zt(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new An(i.mainGroup),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._curve=null,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=0,i._fillOpacity=.7,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="下面",i._contentOption=["百分比","数值"],i._contentChoice=["百分比"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向展开","同步展示面","纵向同步拉伸","分步展示面"],i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=[],n=0;n<(0==e.length?0:e[0].data.length);n++){for(var a=0,r=0;r<e.length;r++)a+=isNaN(parseFloat(e[r].data[n].value))?0:parseFloat(e[r].data[n].value);i.push(a)}for(var l=0;l<e.length;l++)for(var s=0;s<e[l].data.length;s++)0==i[s]||isNaN(parseFloat(e[l].data[s].value))?e[l].data[s].percent=0:e[l].data[s].percent=e[l].data[s].value/i[s];for(var u=0;u<e.length;u++)for(var h=0;h<e[u].data.length;h++)e[u].data[h].total=0==u?parseFloat(e[u].data[h].percent):e[u-1].data[h].total+parseFloat(e[u].data[h].percent);var d=t.defs;d.selectAll("filter").remove();var _=d.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_percentageArea").attr("filterUnits","objectBoundingBox");_.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),_.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),_.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),_.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),_.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var f=t.grid,p=t.areaPlot,g=t.linePlot,v=t.percentareatext,m=t.guideScatter,b=t.tooltip,S=t.overlay,k=t.guideLine,w=(t.clipArea,t.AnimationArea,t.xScale),C=t.yScale,O=(t.xAxis._axisStart,t.xAxis._axisEnd),F=0;O>t.widthOfNoMargin-t.yAxis.width&&(F=O-(t.widthOfNoMargin-t.yAxis.width));var L=t.widthOfCore-F,P=t.heightOfCore;t.widthOfNoMargin,t.heightOfMainGroup;if(f.width(L).height(P).planeX(w.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),p.data(e).xScale(w).yScale(C).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).curve(t._curve).fillOpacity(t._fillOpacity),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var A=x(t._strokeColor),W=[],z=!0,M=!1,D=void 0;try{for(var R,N=A[Symbol.iterator]();!(z=(R=N.next()).done);z=!0){var T=R.value,B=[],G=T.split(":");B.push(q(G[0])),B.push(G[1]),W.push(B)}}catch(t){M=!0,D=t}finally{try{!z&&N.return&&N.return()}finally{if(M)throw D}}var X=W.concat(),j=X.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(j[1]).x1+"%").attr("y1",y(j[1]).y1+"%").attr("x2",y(j[1]).x2+"%").attr("y2",y(j[1]).y2+"%").selectAll("stop").data(X).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var I=x(t._fillColor),Y=[],H=!0,V=!1,$=void 0;try{for(var U,Z=I[Symbol.iterator]();!(H=(U=Z.next()).done);H=!0){var Q=U.value,K=[],J=Q.split(":");K.push(q(J[0])),K.push(J[1]),Y.push(K)}}catch(t){V=!0,$=t}finally{try{!H&&Z.return&&Z.return()}finally{if(V)throw $}}var tt=Y.concat(),et=tt.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(et[1]).x1+"%").attr("y1",y(et[1]).y1+"%").attr("x2",y(et[1]).x2+"%").attr("y2",y(et[1]).y2+"%").selectAll("stop").data(tt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}g.data(e).xScale(w).yScale(C).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).curve(t._curve).strokeWidth(t._lineWidth).radius(t._endPointRadius).radiusFill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).radiusStroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).radiusWidth(t._strokeWidth),v.data(e).xScale(w).yScale(C).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).textObj({colorFunc:function(){return q(t._textLabel.color)}}).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),m.xScale(w).yScale(C).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),k.y1(0).y2(P).stroke("#c6c6c6").strokeDasharray("0 0"),S.data(w.domain()).isScalePoint(!0).bandWidth(w.step()).bandHeight(P).bandX(w.range()[0]).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],r=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));r.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),b.data(o).update(),k.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+w(a)+",0)"),m.data(r).update(),b.move([d3.event.offsetX,d3.event.offsetY]).show(),k.show(),m.show()})).onMousemove((function(){b.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){b.hide(),k.hide(),m.hide()})),t.coreGroup.call(o,t.yAxis.width+.5,0),m.elem.style("pointer-events","none");var it=t.group.selectAll(".percentage-area-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));if(d3.selectAll(it).remove(),f.update(),p.update(),g.update(),v.translate(t.yAxis.width+.5,0).update(),S.translate(t.yAxis.width+.5,0).update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))t.coreGroup.select(".percentage-area-plot").attr("clip-path",""),t.coreGroup.select(".percentage-line-plot").attr("clip-path","");else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).attr("width",L+2*parseFloat(t._endPointRadius)),t.coreGroup.select(".percentage-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".percentage-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",L+2*parseFloat(t._endPointRadius)),t.coreGroup.select(".percentage-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".percentage-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}else t.coreGroup.select(".percentage-area-plot").attr("clip-path",""),t.coreGroup.select(".percentage-line-plot").attr("clip-path","")}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain).range([0,c-i.width]),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.3*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix("%").numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=(t._yDomain,e.length?e[0].data.map((function(t){return t.name})):[0,1]);t._xDomain=i,t._yDomain=[0,1]}}]),e}(Tt),Tn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","arcDiagram-chart"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=1,i._transition=!1,i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._startAngle=-Math.PI/2,i._endAngle=Math.PI/2,i._sWidth=null,i._areaBorderColor="#fff",i._areaBorderWidth=1,i._sortMethod=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data;if(e.selectAll("*").remove(),i[0].forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._fillColor&&/\[/.test(t._fillColor)){var n=x(t._fillColor),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();t.group.append("linearGradient").attr("id",t.id+"-fill-index-0").attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._stroke&&/\[/.test(t._stroke)){var g=x(t._stroke),v=[],m=!0,b=!1,S=void 0;try{for(var k,w=g[Symbol.iterator]();!(m=(k=w.next()).done);m=!0){var C=k.value,O=[],F=C.split(":");O.push(q(F[0])),O.push(F[1]),v.push(O)}}catch(t){b=!0,S=t}finally{try{!m&&w.return&&w.return()}finally{if(b)throw S}}var L=v.concat(),P=L.pop();t.group.append("linearGradient").attr("id",t.id+"-stroke-index-0").attr("x1",y(P[1]).x1+"%").attr("y1",y(P[1]).y1+"%").attr("x2",y(P[1]).x2+"%").attr("y2",y(P[1]).y2+"%").selectAll("stop").data(L).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}for(var A=[],W=0;W<i[0].length;W++)A.push(parseFloat(i[0][W].value));var z=d3.max(A),M=d3.min(A),D=d3.scaleLinear().domain([M,z]).range([t._minRadius,t._maxRadius]).clamp(!0),N=t._sWidth,T=(t._sHeight,N/(i[0].length-1)),B=(t._xScale,t._yScale,t.arcFunc.startAngle(t._startAngle).endAngle(t._endAngle));B.setRadius=function(e){var i=.5*Math.abs(e.x2-e.x1);this.innerRadius(i-t._lineWidth/2).outerRadius(i+t._lineWidth/2)},e.selectAll("path").remove();var G=e.selectAll("path").data(i[1]);G.exit().remove();var X=G.merge(G.enter().append("path")).attr("transform",(function(t,e){return t.x1=i[0][t.target].displayOrder*T,t.x2=i[0][t.source].displayOrder*T,"translate("+(t.x1+t.x2)/2+",0)"})).style("stroke",(function(e){return/\[/.test(i[0][e.source].color)?"url("+c("#"+t.id+"-index-"+e.source)+")":i[0][e.source].color})).style("stroke-width",0).style("fill",(function(e){return/\[/.test(i[0][e.source].color)?"url("+c("#"+t.id+"-index-"+e.source)+")":i[0][e.source].color})).style("fill-opacity",t._lineOpacity).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);X.transition().duration(t._transition?.7*t._duration/i[1].length:0).delay((function(e,n){return t._transition?t._startDelay+.2*t._duration+.7*t._duration/i[1].length*n:0})).attrTween("d",(function(e){var i=d3.interpolate(t._startAngle,t._endAngle);return function(t){return e.endAngle=i(t),B.setRadius(e),B(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd),e.select(".arc-groups").remove();var j=e.append("g").attr("class","arc-groups").selectAll("circle").data(i[0]);j.exit().remove();var I=j.enter().append("circle").attr("cx",(function(t){return t.displayOrder*T||0})).attr("cy",0).merge(j).style("fill",(function(e,i){return(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-fill-index-0")+")":t._fillColor)||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("fill-opacity",t._lineOpacity).style("stroke",(function(e,i){return(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-stroke-index-0")+")":t._stroke)||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).attr("r",(function(t){return D(t.value)})).attr("cx",(function(t){return t.displayOrder*T||0})).attr("cy",0);I.style("opacity",0).transition().duration(t._transition?.2*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1),e.select(".arc-texts").remove();var Y=e.append("g").attr("class","arc-texts").attr("transform",(function(e){return"translate(0, "+t._maxRadius+")"})).selectAll("g").data(i[0]);Y.exit().remove();var H=Y.enter().append("g").attr("class","arc-text").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).style("display",t._labelShow?"block":"none").attr("text-anchor",1==i[0].length?"middle":"start").attr("x",(function(e){return E(e.name)?e.displayOrder*T-.5*t._fontSize||0:e.displayOrder*T||0})).attr("y",(function(e){return E(e.name)?t._fontSize:0})).attr("dx",(function(e){return E(e.name)?0:-(R(e.name,t._fontSize,t._fontFamily)+t._fontSize)})).attr("transform",(function(e){return E(e.name)?"":"rotate(-90 "+(e.displayOrder*T||0)+" "+.3*-t._fontSize+" )"})).each((function(e){if(E(e.name))for(var i=d3.select(this),n=e.name.split("").reverse(),a=void 0,o=[],r=0,l=(i.node().getBoundingClientRect().height,+i.attr("x")),s=+i.attr("y"),u=i.text(null).append("text").attr("x",l).attr("y",s);a=n.pop();)o.push(a),u.text(o.join("")),u.node().getComputedTextLength()>t._fontSize&&(++r,o.pop(),u.text(o.join("")),o=[a],u=i.append("text").attr("x",l).attr("y",r*t._fontSize*1.3+s).text(a));else d3.select(this).append("text").text((function(t){return t.name})).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("text-anchor","start").attr("x",(function(e){return E(e.name)?e.displayOrder*T-.5*t._fontSize||0:e.displayOrder*T||0})).attr("y",(function(e){return E(e.name)?t._fontSize+9:0})).attr("dx",(function(e){return E(e.name)?0:-(R(e.name,t._fontSize,t._fontFamily)+t._fontSize)}))}));function E(t){return!!/^[\u4E00-\u9FA5]+$/.test(t)}return H.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),t.interrupt=function(t){X.interrupt().attr("d",(function(t){return B.setRadius(t),B()})),I.interrupt().style("opacity",1),H.interrupt().style("opacity",1)},t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"lineOpacity",value:function(t){return arguments.length?(this._lineOpacity=t,this):this._lineOpacity}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"minRadius",value:function(t){return arguments.length?(this._minRadius=t,this):this._minRadius}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}}]),e}(at),Bn=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return function(t,e){return t[0].forEach((function(t,i){t.color=e[i]})),t}(t,this.generateColorList(t.length>0?t[0].length:0))}}]),e}(it);function Gn(t,e){var i=0,n=1,a=2;e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"targetCol"===t.function?n=t.index:"vCol"===t.function&&(a=t.index)}));for(var o=[],r=t.length,l=[],s=1;s<r;s++){var u=t[s];""!=u[i]&&null!=u[i]&&null!=u[i]&&(l.push(u[i]),""!=u[n]&&null!=u[n]&&null!=u[n]&&l.push(u[n]))}Array.prototype.distinct=function(){var t,e,i=this,n=i.length;for(t=0;t<n;t++)for(e=t+1;e<n;e++)i[t]==i[e]&&(i.splice(e,1),n--,e--);return i};for(var c=l.distinct(),h=[],d=0;d<c.length;d++)h.push({name:c[d]});for(var _=[],f=1;f<r;f++){var p=t[f];_.push({source:c.indexOf(p[i]),target:c.indexOf(p[n]),s:p[i],t:p[n],value:""==p[a]||null==p[a]||null==p[a]?0:p[a]})}for(var y=0;y<h.length;y++)h[y].value=0,h[y].displayOrder=y;return o.push(h),o.push(_),o[0].forEach((function(t,e){t.key=t.name+"-"+e})),o}var Xn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","arcDiagram-chart"),i.arcDiagram=new Tn(i.mainGroup),i._innerRadius=0,i._startAngle=-Math.PI/2,i._endAngle=Math.PI/2,i._lineOpacity=.7,i._lineWidth=1,i._bubbleBorderColor=null,i._bubbleFillColor=null,i._bubbleBorderWidth=1,i._minRadius=4.5,i._maxRadius=8.5,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="淡入",i._endPause=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=[];i.push(l(e[0]));for(var n=[],a=0;a<i[0].length;a++)null!=i[0][a].name&&n.push(i[0][a].name);for(var o=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,r=t._fontCopy?t._fontSize:t._textLabel.fontSize,s=t._fontCopy?t._fontColor:q(t._textLabel.color),u=!!t._fontCopy||t._textLabel.show,c=u?G(n,r,o):0,h=0;h<e[1].length;h++)-1==n.indexOf(e[1][h].s)||-1==n.indexOf(e[1][h].t)?e[1][h].active=!1:e[1][h].active=!0;i.push(l(e[1]));for(var d=0;d<i[0].length;d++)i[0][d].value=0,i[0][d].displayOrder=d;for(var _=0;_<i[1].length;_++)for(var f=0;f<i[0].length;f++)i[1][_].s==i[0][f].name&&(i[1][_].source=i[0][f].displayOrder),i[1][_].t==i[0][f].name&&(i[1][_].target=i[0][f].displayOrder);for(var p=0;p<i[1].length;p++){var y=i[1][p];i[0][y.source].value+=parseFloat(y.value),i[0][y.target].value+=parseFloat(y.value)}var x=t.arcDiagram,g=t.widthOfNoMargin,v=(t.heightOfNoMargin,g),m=t.heightOfMainGroup,b=t._startAngle,S=t._endAngle,k=function(e,i,n,a){var o=Math.min(e,i),r=o/2,l=0,s=i/2+r/2-c/2-t._maxRadius/2;o==i&&(r=.85*i-c/2-t._maxRadius/2,l=(e-2*r)/2,s=1.1*r-c/2-t._maxRadius/2,r>e/2&&(l=0,s=i/2+(r=e/2)/2-c/2-t._maxRadius/2));return{radius:r,cx:l,cy:s,quadrant:0}}(v,m),w=k.radius;t._innerRadius||t._innerRadiusRatio&&t._innerRadiusRatio;for(var C=1e8,O=0,F=0;F<i[0].length;F++)C=Math.min(C,i[0][F].value),O=Math.max(O,i[0][F].value);function L(t,e,i,n,a){return n+(Math.min(Math.max(t,e),i)-e)/(i-e)*(a-n)}x.data(i).startAngle(b).endAngle(S).sWidth(2*w).lineWidth(t._lineWidth).lineOpacity(t._lineOpacity).minRadius(t._minRadius).maxRadius(t._maxRadius).stroke(t._bubbleBorderColor).strokeWidth(t._bubbleBorderWidth).fillColor(t._bubbleFillColor).fontSize(r).fontColor(s).fontFamily(o).labelShow(u).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).onTransitionEnd((function(t,e){})).onMouseover((function(e,n){var a=d3.select(this)._groups[0][0].__data__.source,o=d3.select(this)._groups[0][0].__data__.target,r=d3.selectAll(".arc-groups circle").nodes();d3.select(r[a]).attr("r",(function(e){return 1.3*(L(e.value,C,O,t._minRadius,t._maxRadius)||4.5)})),d3.select(r[o]).attr("r",(function(e){return 1.3*(L(e.value,C,O,t._minRadius,t._maxRadius)||4.5)}));var l=[{text:i[0][e.source].name+"→"+i[0][e.target].name+"："+E(e.value,t._numberStyle,t._decimalPlaces),color:i[0][e.source].color}];t.tooltip.data(l).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){var e=d3.select(this)._groups[0][0].__data__.source,i=d3.select(this)._groups[0][0].__data__.target,n=d3.selectAll(".arc-groups circle").nodes();d3.select(n[e]).attr("r",(function(e){return 1.3*(L(e.value,C,O,t._minRadius,t._maxRadius)||4.5)})),d3.select(n[i]).attr("r",(function(e){return 1.3*(L(e.value,C,O,t._minRadius,t._maxRadius)||4.5)})),t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){var i=d3.select(this)._groups[0][0].__data__.source,n=d3.select(this)._groups[0][0].__data__.target,a=d3.selectAll(".arc-groups circle").nodes();d3.select(a[i]).attr("r",(function(e){return L(e.value,C,O,t._minRadius,t._maxRadius)||4.5})),d3.select(a[n]).attr("r",(function(e){return L(e.value,C,O,t._minRadius,t._maxRadius)||4.5})),t.tooltip.hide()}));var P=k.cx,A=k.cy;t.arcDiagram.translate(P||0,A||0).update()}},{key:"onInterruptChange",value:function(t){this.arcDiagram.interrupt(t)}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.data(e[0]).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e[0].forEach((function(t){t.key===i.key&&(t.active=!n),e[1].forEach((function(e){t.active==!n&&(e.s!=t.name&&e.t!=t.name||(e.active=!n))}))})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Bn(t,e),n=Gn;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.font;this._fontCopy=r,0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._lineOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._lineOpacity,this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._bubbleFillColor=e.bubbleFillColor?q(e.bubbleFillColor):"",this._bubbleBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._bubbleBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._bubbleBorderWidth,this._minRadius=0==e.minRadius||e.minRadius?parseFloat(e.minRadius):this._minRadius,this._maxRadius=0==e.maxRadius||e.maxRadius?parseFloat(e.maxRadius):this._maxRadius),0!==Object.getOwnPropertyNames(i).length&&(this._textLabel=i.textLabel?i.textLabel:this._textLabel)}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}}]),e}(nt),jn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","basic-horizontal-bar"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;if(n.selectAll("*").remove(),n.select(".horizontal-bar-rects").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var a=x(t._borderColor),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],g=d.split(":");_.push(q(g[0])),_.push(g[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var v=o.concat(),m=v.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(m[1]>180?360-(m[1]-180):180-m[1]).x1+"%").attr("y1",y(m[1]>180?360-(m[1]-180):180-m[1]).y1+"%").attr("x2",y(m[1]>180?360-(m[1]-180):180-m[1]).x2+"%").attr("y2",y(m[1]>180?360-(m[1]-180):180-m[1]).y2+"%").selectAll("stop").data(v).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(m[1]).x1+"%").attr("y1",y(m[1]).y1+"%").attr("x2",y(m[1]).x2+"%").attr("y2",y(m[1]).y2+"%").selectAll("stop").data(v).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var b=n.append("g").attr("class","horizontal-bar-rects").selectAll("rect").data(e,(function(t){return t.key}));b.exit().remove();var S=b.enter().append("path").merge(b).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));if(this._rectObj?null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?(S.style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})})),t.interrupt=function(t){}):0==t._moveOptions.indexOf(t._moveStyle)?(S.attr("d",(function(e,i){return f({x:t._xScale(0),y:t._rectObj.yFunc(e,i),width:0,height:t._rectObj.heightFunc(e,i),cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),S.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})})),t.interrupt=function(e){S.interrupt().style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})}))}):1==t._moveOptions.indexOf(t._moveStyle)?(S.attr("d",(function(e,i){return f({x:t._xScale(0),y:t._rectObj.yFunc(e,i),width:0,height:t._rectObj.heightFunc(e,i),cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),S.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0})).style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})})),t.interrupt=function(e){S.interrupt().style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})}))}):2==t._moveOptions.indexOf(t._moveStyle)?(S.attr("d",(function(e,i){return f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:0,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),S.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})})),t.interrupt=function(e){S.interrupt().style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})}))}):3==t._moveOptions.indexOf(t._moveStyle)&&(S.interrupt().attr("d",(function(e,i){return f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:0,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),S.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0})).style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})})),t.interrupt=function(e){S.interrupt().style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){var n=[];return Array.isArray(t._barCornerRadius)&&(n.push(t._barCornerRadius[1]),n.push(t._barCornerRadius[0]),n.push(t._barCornerRadius[3]),n.push(t._barCornerRadius[2])),f({x:t._rectObj.xFunc(e,i),y:t._rectObj.yFunc(e,i),width:t._rectObj.widthFunc(e,i),height:t._rectObj.heightFunc(e,i),cornerRadius:e.value>0?t._barCornerRadius:n,roundCorners:[0,1,2,3],type:"horizontal"})}))}):S.style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(t){return f({x:0,y:0,width:0,height:0,cornerRadius:0,roundCorners:[0,1,2,3],type:"horizontal"})})),this._textObj){n.select(".horizontal-bar-texts").remove();var k=n.append("g").attr("class","horizontal-bar-texts").selectAll("text").data(e,(function(t){return t.key}));k.exit().remove();var w=k.enter().append("text").attr("class","horizontal-bar-text").merge(b).text(this._textObj.textFunc).attr("fill",t._textObj.colorFunc).attr("font-size",t._textObj.fontSize).attr("font-family",t._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dy",this._textObj.dyFunc).attr("dx",(function(e,i){var n=E(e.value,t._numberStyle,t._decimalPlaces);if(null==t._labelShow||0==t._labelShow||null==t._positionOptions||null==t._positionChoice)return 0;if(0==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return.3*t._textObj.fontSize;if(e.value<0)return-R(n+t._suffix,t._textObj.fontSize,t._textObj.fontFamily)-.3*t._textObj.fontSize}else if(1==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return-(t._xScale(e.value)-t._xScale(0))+.3*t._textObj.fontSize;if(e.value<0)return t._xScale(0)-t._xScale(e.value)-.3*t._textObj.fontSize-R(n+t._suffix,t._textObj.fontSize,t._textObj.fontFamily)}else if(2==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return-(t._xScale(e.value)-t._xScale(0))/2-R(n+t._suffix,t._textObj.fontSize,t._textObj.fontFamily)/2;if(e.value<0)return(t._xScale(0)-t._xScale(e.value))/2-R(n+t._suffix,t._textObj.fontSize,t._textObj.fontFamily)/2}else if(3==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return.3*-t._textObj.fontSize-R(n+t._suffix,t._textObj.fontSize,t._textObj.fontFamily);if(e.value<0)return.3*t._textObj.fontSize}}));w.style("display",this._textObj.labelShow?"block":"none").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),t.interruptText=function(t){w.interrupt().style("opacity",1)},null!=t._labelShow&&0!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice||n.selectAll(".horizontal-bar-texts text").style("display","none")}for(var C=n.selectAll(".horizontal-bar-text"),O=[],F=[],L=0;L<C._groups[0].length;L++){F.push(L);for(var P=L+1;P<C._groups[0].length;P++){p(i(d3.select(C._groups[0][L])),i(d3.select(C._groups[0][P])))&&(O.push(L),d3.select(C._groups[0][L]).style("visibility","hidden"))}}for(var A=new Set(O),W=Array.from(A),z=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(W,F),M=0;M<W.length;M++){for(var D=[],N=0;N<z.length;N++){var T=i(d3.select(C._groups[0][W[M]])),B=i(d3.select(C._groups[0][z[N]]));if(D.push(p(T,B)),p(T,B)){if(W[M]==z[N])continue;d3.select(C._groups[0][W[M]]).style("visibility","hidden")}}0==D.filter((function(t){return 1==t})).length&&z.push(W[M])}for(var G=0;G<z.length;G++)d3.select(C._groups[0][z[G]]).style("visibility","visible");return S.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),In=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","basic-horizontal-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new jn(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.yAxis.minTickDistance(1),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._barWidthPercent=.5,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["外部居右","内部居左","内部居中","内部居右"],i._positionChoice="内部居右",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向同步拉伸","纵向依次展开","百叶窗","机场翻牌"],i._moveStyle="横向同步拉伸",i._endPause=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.defs;i.selectAll("filter").remove(),i.selectAll("linearGradient").remove();var n=i.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_basicHorizontal").attr("filterUnits","objectBoundingBox");n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),n.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),n.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),n.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),n.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");for(var a=t.grid,r=t.rectPlot,l=t.tooltip,s=t.overlay,u=t.selectOverlay,h=t._barWidthPercent?t._barWidthPercent:.8,d=t.xScale,_=t.yScale,f=_.step(),p=[],y=[],x=0;x<t.activeData.length;x++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(p.push(0),y.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[x].value)>0||0==parseFloat(t.activeData[x].value)?y.push(R(E(t.activeData[x].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[x].value)<0&&p.push(R(E(t.activeData[x].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(p.push(0),y.push(0));t.xAxis._axisStart;var g=t.xAxis._axisEnd;g>t.gridEnd&&t.gridEnd;var v=t.gridEnd-t.gridStart,m=t.heightOfCore;1.1*Math.min(d3.min(e,(function(t){return+t.value})),0)<0?(t.group.selectAll(".basic-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+(-(d.range()[0]-d(0))+t.gridStart)+",0)"),t.group.selectAll(".basic-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+(-(d.range()[0]-d(0))+t.gridStart)+",0)")):(t.group.selectAll(".basic-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),t.group.selectAll(".basic-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,0)")),a.width(v+d.range()[0]).height(m).planeX(d.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.data(_.domain()).isScalePoint(!1).isHorizontal(!0).bandX(d.range()[0]).bandWidth(v).bandHeight(_.step()).onMouseover((function(i,n){var a=_.domain()[e.length-n-1==-1?1:e.length-n-1==-2?0:e.length-n-1],o=e.filter((function(t){return t.name===a})),r=[];a&&1!=a&&((r=[{text:o[0].valueLabel}]).push({text:(o[0].showLegend?a:"")+": "+E(o[0].value,t._numberStyle,t._decimalPlaces),color:o[0].color}),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+_(a)+")")),l.data(r).update(),l.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){l.move([d3.event.offsetX,d3.event.offsetY]),u.show()})).onMouseout((function(){l.hide(),u.hide()})),u.width(v).height(_.step()).shadowColor("#ccc").hide(),r.data(e).xScale(d).yScale(_).fontSize(t._fontSize).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(t._borderColor).fillOpacity(t._fillOpacity).suffix(t._suffix).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).rectObj({xFunc:function(e,i){return e.value>0||0==e.value?t.xScale(0):e.value<0?t.xScale(e.value):void 0},yFunc:function(e,i){return t.yScale.range()[0]-(i*f+(f-f*h)/2+f*h)},widthFunc:function(e){return e.value>0||0==e.value?t.xScale(e.value)-t.xScale(0)>0?t.xScale(e.value)-t.xScale(0):0:e.value<0?t.xScale(0)-t.xScale(e.value)>0?t.xScale(0)-t.xScale(e.value):0:void 0},heightFunc:function(t){return f*h}}).textObj({xFunc:function(e,i){return t.xScale(e.value)},yFunc:function(e,i){return t.yScale.range()[0]-(i*f+(f-.9*f*h)/2+.7*f*h)},dyFunc:.5*f*h/2+t._textLabel.fontSize/3,colorFunc:function(){return q(t._textLabel.color)},textFunc:function(e){var i=E(e.value,t._numberStyle,t._decimalPlaces);return 0==i?"":i+t._suffix},fontSize:t._textLabel.fontSize,fontFamily:t._textLabel.fontFamily,labelShow:t._labelShow}),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),a.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),a.translate(t.yAxis.width+.5,t.xAxis.height));var b=t.group.selectAll(".basic-horizontal-bar-chart .axis-y-horizontal .tick text").nodes().filter((function(t,e){return t.__data__=="$-"+e}));(d3.selectAll(b).remove(),a.update(),u.update(),r.update(),s.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+t.gridStart),0!=t._xRange.length)&&(0==isNaN(parseFloat(t._xRange[0]))||0==isNaN(parseFloat(t._xRange[1]))?(t.mainGroup.selectAll(".clip-defs").remove(),t.mainGroup.append("defs").attr("class","clip-defs").append("clipPath").attr("id","clip-overlay-"+t.id).append("rect").attr("x",t.gridStart).attr("height",m).attr("width",v),t.coreGroup.attr("clip-path","url("+c("#clip-overlay-"+t.id)+")")):t.coreGroup.attr("clip-path",""))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t._width-t._marginLeft-t._marginRight,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);for(var d=[],_=[],f=[],p=0;p<t.activeData.length;p++)t.activeData[p].value<0&&f.push(t.activeData[p].value),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(d.push(0),_.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[p].value)>0||0==parseFloat(t.activeData[p].value)?_.push(R(E(t.activeData[p].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[p].value)<0&&d.push(R(E(t.activeData[p].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(d.push(0),_.push(0));i&&i.titleHeight;var y=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(y).compute(),i.compute();var x=0==d.length?0:d3.max(d),g=c-i.width-(0==_.length?0:d3.max(_));i.compute(),n.range([x,g]),e.compute();var v=e._axisStart,m=e._axisEnd,b=0==d.length?0:d3.max(d);v<0&&(x=b+(Math.abs(v)>i.width?Math.abs(v)-i.width:0)),m>g&&(g=g-(m-g)+(0==_.length?0:d3.max(_))),t.gridStart=x,t.gridEnd=g,n.range([x,g]),a.range([h-e.height,0]);var S=i.width,k=h-e.height,w=i.width+x,C=0;((0==d.length?0:d3.max(d))>0||f.length>0)&&(w=i.width);var O=e.height;"上面"==t._axisPositonChoiceX?(k=O,C=O):k=(t._axisPositonChoiceX,h-O),e.translate(S,k).update(),i.translate(w,C).update()}},{key:"onInterruptChange",value:function(t){this.rectPlot.interrupt(t),this.rectPlot.interruptText(t)}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend})),i=e;if("single"==t._colors.type){if(e.length>0){var n={},a=[];n.name=e[0].valueLabel,n.color=e[0].color,a.push(n),i=""==n.name||null==n.name||null==n.name?[]:a}else i=[];t.legend.data(i).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.active=!n})),t.onDataChange()}))}else t.legend.data(i).onClick((function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach((function(t){t.key===e.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._xRange||[],n=e.length?e.map((function(t){return t.name})):[0,1],a=e.length?[1.05*Math.min(d3.min(e,(function(t){return+t.value})),0),Math.max(1.05*d3.max(e,(function(t){return+t.value})),0)]:[0,1];t._yDomain=n,t._xDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range).yRange(a.range).clipShow(a.range).clipShowX(n.range).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}}]),e}(Tt),Yn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth=0,i._fillOpacity=.7,i._barCornerRadius=5,i._borderColor="#000",i._borderWidth=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;if(n.selectAll("*").remove(),n.selectAll(".stackBars").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._strokeColor&&/\[/.test(t._strokeColor)){var a=x(t._strokeColor),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var g=o.concat(),v=g.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(360-v[1]).x1+"%").attr("y1",y(360-v[1]).y1+"%").attr("x2",y(360-v[1]).x2+"%").attr("y2",y(360-v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var m=n.append("g").selectAll("g").data(e);m.exit().remove(),m.enter().append("g").merge(m).each((function(i,n){var a=d3.select(this).selectAll("rect").data(i.data);if(a.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))a.enter().append("rect").attr("class","stackBars").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||2==t._moveOptions.indexOf(t._moveStyle)){var o=a.enter().append("rect").attr("class","stackBars").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total-e.value):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",0);0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?o.attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):o.transition().delay((function(i,a){return t._transition?n*(.9*t._duration/(e.length>0?e.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):1==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?o.attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):o.transition().delay((function(e,n){return t._transition?t._startDelay+n*(.9*t._duration/(i.data.length>0?i.data.length:1)):0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):2==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?o.attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):o.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var r=a.enter().append("rect").attr("class","stackBars").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent).attr("y",(function(e){return t._yScale(0)})).attr("height",0);t._interrupt?r.attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0}))}else if(4==t._moveOptions.indexOf(t._moveStyle)||5==t._moveOptions.indexOf(t._moveStyle)){var l=a.enter().append("rect").attr("class","stackBars").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",0);4==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?l.attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent):l.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent):5==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?l.attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent):l.transition().delay((function(e,n){return t._transition?t._startDelay+n*(.9*t._duration/(i.data.length>0?i.data.length:1)):0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent))}else if(6==t._moveOptions.indexOf(t._moveStyle)){var s=a.enter().append("rect").attr("class","stackBars").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",0).attr("height",0).attr("x",(function(e,i){return t._xScale.range()[0]+t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2})).attr("width",t._xScale.step()*t._barWidthPercent).attr("y",(function(e){return e.value>0||0==e.value?t._yScale.range()[1]:e.value<0?t._yScale.range()[0]:void 0})).attr("height",0);t._interrupt?s.attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0})):s.transition().delay((function(i,a){return t._transition?n*(.9*t._duration/(e.length>0?e.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("y",(function(e){return e.value>0||0==e.value?t._yScale(e.total):e.value<0?t._yScale(e.downtotal-e.value):void 0})).attr("height",(function(e){return e.value>0||0==e.value?t._yScale(0)-t._yScale(e.value)>0?t._yScale(0)-t._yScale(e.value):0:e.value<0?t._yScale(e.value)-t._yScale(0)>0?t._yScale(e.value)-t._yScale(0):0:void 0}))}a.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)})),n.selectAll(".stackBarTexts").remove();var b=t._defs;b.selectAll("filter").remove();var S=b.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_stackbar").attr("filterUnits","objectBoundingBox");S.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),S.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),S.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),S.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),S.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var k=n.append("g").selectAll("g").data(e);k.exit().remove(),k.enter().append("g").merge(k).each((function(e,i){var a=d3.select(this).append("g").attr("class","stackBarTexts").selectAll("text").data(e.data);a.exit().remove();var o=a.enter().append("text").merge(a).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._textObj.colorFunc).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return t._xScale.range()[0]+(t._xScale.step()*i+t._xScale.step()*(1-t._barWidthPercent)/2)})).attr("y",(function(e){if(null==t._positionOptions||null==t._positionChoice)return 0;if(0==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return t._yScale(e.total)+(t._yScale(0)-t._yScale(e.value))/2+.4*t._fontSize;if(e.value<0)return t._yScale(e.downtotal-e.value)+(t._yScale(e.value)-t._yScale(0))/2+.4*t._fontSize}else if(1==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return t._yScale(e.total)+(t._yScale(0)-t._yScale(e.value))-.2*t._fontSize;if(e.value<0)return t._yScale(e.downtotal-e.value)+(t._yScale(e.value)-t._yScale(0))-.2*t._fontSize}})).attr("text-anchor","middle").attr("dx",t._xScale.step()*t._barWidthPercent/2).style("display",(function(e){return t._labelShow&&e.textShow?"block":"none"}));t._interrupt?o.style("opacity",1):o.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".stackBarTexts").style("display","none"):n.selectAll(".stackBarTexts").style("display","block")}));for(var w=n.selectAll(".stackBarTexts text"),C=[],O=[],F=0;F<w._groups[0].length;F++){O.push(F);for(var L=F+1;L<w._groups[0].length;L++){p(i(d3.select(w._groups[0][F])),i(d3.select(w._groups[0][L])))&&(C.push(F),d3.select(w._groups[0][F]).style("visibility","hidden"))}}for(var P=new Set(C),A=Array.from(P),W=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(A,O),z=0;z<A.length;z++){for(var M=[],D=0;D<W.length;D++){var R=i(d3.select(w._groups[0][A[z]])),N=i(d3.select(w._groups[0][W[D]]));if(M.push(p(R,N)),p(R,N)){if(A[z]==W[D])continue;d3.select(w._groups[0][A[z]]).style("visibility","hidden")}}0==M.filter((function(t){return 1==t})).length&&W.push(A[z])}for(var T=0;T<W.length;T++)d3.select(w._groups[0][W[T]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Hn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new Yn(i.coreGroup),i.overlay=new te(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._yScaleHeight=1.05,i._barWidthPercent=.5,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["内部居中","内部居下"],i._positionChoice="内部居中",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向分类拉伸","纵向分组拉伸","纵向同步拉伸","纵向整体拉伸","横向整体展开","横向同步展开","俄罗斯方块"],i._moveStyle="纵向分类拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=0;i<(0==e.length?0:e[0].data.length);i++)for(var n=0;n<e.length;n++)parseFloat(e[n].data[i].value);for(var a=0;a<e.length;a++)for(var o=0;o<e[a].data.length;o++)0==a?e[a].data[o].value>0||0==e[a].data[o].value?(e[a].data[o].total=parseFloat(e[a].data[o].value),e[a].data[o].downtotal=0):e[a].data[o].value<0&&(e[a].data[o].downtotal=parseFloat(e[a].data[o].value),e[a].data[o].total=0):e[a].data[o].value>0||0==e[a].data[o].value?(e[a].data[o].total=e[a-1].data[o].total+parseFloat(e[a].data[o].value),e[a].data[o].downtotal=e[a-1].data[o].downtotal):e[a].data[o].value<0&&(e[a].data[o].total=e[a-1].data[o].total,e[a].data[o].downtotal=e[a-1].data[o].downtotal+parseFloat(e[a].data[o].value)),e[a].data[o].value>0||0==e[a].data[o].value?t.yScale(0)-t.yScale(e[a].data[o].value)<t._textLabel.fontSize?e[a].data[o].textShow=!1:e[a].data[o].textShow=!0:e[a].data[o].value<0&&(t.yScale(e[a].data[o].value-t.yScale(0))<t._textLabel.fontSize?e[a].data[o].textShow=!1:e[a].data[o].textShow=!0);var r=e,l=t.grid,s=t.tooltip,u=t.rectPlot,h=t.overlay,d=t.selectOverlay,_=t.clipArea,f=t.xScale,p=t.yScale,y=(t.xAxis._axisStart,t.xAxis._axisEnd),x=0;y>t.widthOfNoMargin-t.yAxis.width&&(x=y-(t.widthOfNoMargin-t.yAxis.width));var g=t.widthOfCore-x,v=t.heightOfCore,m=1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.downtotal}))})),0);m<0?(t.group.selectAll(".stack-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(p.range()[0]-p(0))+")"),t.group.selectAll(".stack-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(p.range()[0]-p(0))+")")):(t.group.selectAll(".stack-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".stack-bar-chart .axis-x-line line").attr("transform","translate(0,0)")),0!=t._clipShow.length&&(t.group.selectAll(".stack-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".stack-bar-chart .axis-x-line line").attr("transform","translate(0,0)")),h.data(f.domain()).isScalePoint(!1).bandX(f.range()[0]).bandWidth(f.step()).bandHeight(v).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],r=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));r.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),s.data(o).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+f(a)+",0)"),s.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){s.move([d3.event.offsetX,d3.event.offsetY]),d.show()})).onMouseout((function(){s.hide(),d.hide()})),u.data(r).xScale(f).yScale(p).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(t._borderColor).barWidthPercent(t._barWidthPercent).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}).fillOpacity(t._fillOpacity),l.width(g).height(v).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),d.width(f.step()).height(v).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)"),0!=t._clipShow.length?(_.width(g).height(v).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+_.id)+")"),_.update()):(_.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),_.update());var b=t.group.selectAll(".stack-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(b).remove(),u.update(),d.update(),h.update(),l.translate(t.yAxis.width,0).update(),m<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",f.range()[0]).attr("y1",p.range()[0]).attr("x2",f.range()[1]).attr("y2",p.range()[0]).attr("stroke",t._axisLineStrokeX)):t.coreGroup.selectAll(".fake-x-line").remove()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)0==i?e[i].data[n].value>0||0==e[i].data[n].value?(e[i].data[n].total=parseFloat(e[i].data[n].value),e[i].data[n].downtotal=0):e[i].data[n].value<0&&(e[i].data[n].downtotal=parseFloat(e[i].data[n].value),e[i].data[n].total=0):e[i].data[n].value>0||0==e[i].data[n].value?(e[i].data[n].total=e[i-1].data[n].total+parseFloat(e[i].data[n].value),e[i].data[n].downtotal=e[i-1].data[n].downtotal):e[i].data[n].value<0&&(e[i].data[n].total=e[i-1].data[n].total,e[i].data[n].downtotal=e[i-1].data[n].downtotal+parseFloat(e[i].data[n].value));var a=t._yRange||[],o=e.length?e[0].data.map((function(t){return t.name})):[0,1],r=e.length?[1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.downtotal}))})),0),1.1*Math.max(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))})),0)]:[0,1];t._xDomain=o,t._yDomain=[isNaN(parseFloat(a[0]))?r[0]:parseFloat(a[0]),isNaN(parseFloat(a[1]))?isNaN(parseFloat(a[0]))?r[1]:r[1]<a[0]?1.5*a[0]:r[1]:parseFloat(a[1])]}}]),e}(Tt),En=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-horizontal-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth=0,i._fillOpacity=.7,i._barCornerRadius=5,i._borderColor="#000",i._borderWidth=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;if(n.selectAll("*").remove(),n.selectAll(".stackHorizontalBar").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._strokeColor&&/\[/.test(t._strokeColor)){var a=x(t._strokeColor),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var g=o.concat(),v=g.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(v[1]>180?360-(v[1]-180):180-v[1]).x1+"%").attr("y1",y(v[1]>180?360-(v[1]-180):180-v[1]).y1+"%").attr("x2",y(v[1]>180?360-(v[1]-180):180-v[1]).x2+"%").attr("y2",y(v[1]>180?360-(v[1]-180):180-v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var m=n.append("g").selectAll("g").data(e);m.exit().remove(),m.enter().append("g").merge(m).each((function(i,n){var a=d3.select(this).selectAll("rect").data(i.data);if(a.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))a.enter().append("rect").attr("class","stackHorizontalBar").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",t._yScale.step()*t._barWidthPercent).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||2==t._moveOptions.indexOf(t._moveStyle)){var o=a.enter().append("rect").attr("class","stackHorizontalBar").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",t._yScale.step()*t._barWidthPercent).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal-e.value):void 0})).attr("width",0);0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?o.attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):o.transition().delay((function(i,a){return t._transition?n*(.9*t._duration/(e.length>0?e.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):1==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?o.attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):o.transition().delay((function(e,n){return t._transition?t._startDelay+n*(.9*t._duration/(i.data.length>0?i.data.length:1)):0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):2==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?o.attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):o.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})))}else if(3==t._moveOptions.indexOf(t._moveStyle)){var r=a.enter().append("rect").attr("class","stackHorizontalBar").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("x",(function(e){return t._xScale(0)})).attr("height",t._yScale.step()*t._barWidthPercent).attr("width",0);t._interrupt?r.attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0}))}else if(4==t._moveOptions.indexOf(t._moveStyle)||5==t._moveOptions.indexOf(t._moveStyle)){var l=a.enter().append("rect").attr("class","stackHorizontalBar").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",0).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0}));4==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?l.attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",t._yScale.step()*t._barWidthPercent):l.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",t._yScale.step()*t._barWidthPercent):5==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?l.attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",t._yScale.step()*t._barWidthPercent):l.transition().delay((function(e,n){return t._transition?t._startDelay+n*(.9*t._duration/(i.data.length>0?i.data.length:1)):0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",t._yScale.step()*t._barWidthPercent))}else if(6==t._moveOptions.indexOf(t._moveStyle)){var s=a.enter().append("rect").attr("class","stackHorizontalBar").merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return/\[/.test(t._strokeColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+n)+")":e.color)})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("x",(function(e){return e.value>0||0==e.value?t._xScale.range()[1]:e.value<0?t._xScale.range()[0]:void 0})).attr("height",t._yScale.step()*t._barWidthPercent).attr("width",0);t._interrupt?s.attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0})):s.transition().delay((function(i,a){return t._transition?n*(.9*t._duration/(e.length>0?e.length:1))+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).attr("x",(function(e){return e.value>0||0==e.value?t._xScale(e.total-e.value):e.value<0?t._xScale(e.downtotal):void 0})).attr("width",(function(e){return e.value>0||0==e.value?Math.abs(t._xScale(0)-t._xScale(e.value)):e.value<0?Math.abs(t._xScale(e.value)-t._xScale(0)):void 0}))}a.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)})),n.selectAll(".stackHorizontalBarTexts").remove();var b=n.append("g").selectAll("g").data(e);b.exit().remove(),b.enter().append("g").merge(b).each((function(e,i){var a=d3.select(this).append("g").attr("class","stackHorizontalBarTexts").selectAll("text").data(e.data);a.exit().remove();var o=a.enter().append("text").merge(a).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._textObj.colorFunc).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","start").attr("y",(function(e,i){return t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2})).attr("x",(function(e,i){if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice)return 0;if(1==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0||0==e.value)return t._xScale(e.total-e.value)+.3*t._fontSize;if(e.value<0)return t._xScale(e.downtotal)+.3*t._fontSize}else if(0==t._positionOptions.indexOf(t._positionChoice)){if(d3.selectAll(".stackHorizontalBarTexts text").attr("text-anchor","middle"),e.value>0||0==e.value)return t._xScale(e.total-e.value)+Math.abs(t._xScale(0)-t._xScale(e.value))/2;if(e.value<0)return t._xScale(e.downtotal)+Math.abs(t._xScale(e.value)-t._xScale(0))/2}})).attr("dy",t._yScale.step()*t._barWidthPercent/2+t._fontSize/2.7).style("display",t._labelShow?"block":"none");t._interrupt?o.style("opacity",1):o.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+t._duration:0).style("opacity",1),null!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||n.selectAll(".stackHorizontalBarTexts").style("display","none")}));for(var S=n.selectAll(".stackHorizontalBarTexts text"),k=[],w=[],C=0;C<S._groups[0].length;C++){w.push(C);for(var O=C+1;O<S._groups[0].length;O++){p(i(d3.select(S._groups[0][C])),i(d3.select(S._groups[0][O])))&&(k.push(C),d3.select(S._groups[0][C]).style("visibility","hidden"))}}for(var F=new Set(k),L=Array.from(F),P=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(L,w),A=0;A<L.length;A++){for(var W=[],z=0;z<P.length;z++){var M=i(d3.select(S._groups[0][L[A]])),D=i(d3.select(S._groups[0][P[z]]));if(W.push(p(M,D)),p(M,D)){if(L[A]==P[z])continue;d3.select(S._groups[0][L[A]]).style("visibility","hidden")}}0==W.filter((function(t){return 1==t})).length&&P.push(L[A])}for(var R=0;R<P.length;R++)d3.select(S._groups[0][P[R]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return ar}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Vn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-horizontal-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.yAxis.minTickDistance(1),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new En(i.coreGroup),i.overlay=new te(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._yScaleHeight=1.05,i._barWidthPercent=.5,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["内部居中","内部居左"],i._positionChoice="内部居中",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向分类拉伸","横向分组拉伸","横向同步拉伸","横向整体拉伸","百叶窗","机场翻牌","俄罗斯方块"],i._moveStyle="横向整体拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=0;i<(0==e.length?0:e[0].data.length);i++)for(var n=0;n<e.length;n++)parseFloat(e[n].data[i].value);for(var a=0;a<e.length;a++)for(var r=0;r<e[a].data.length;r++)0==a?e[a].data[r].value>0||0==e[a].data[r].value?(e[a].data[r].total=parseFloat(e[a].data[r].value),e[a].data[r].downtotal=0):e[a].data[r].value<0&&(e[a].data[r].downtotal=parseFloat(e[a].data[r].value),e[a].data[r].total=0):e[a].data[r].value>0||0==e[a].data[r].value?(e[a].data[r].total=e[a-1].data[r].total+parseFloat(e[a].data[r].value),e[a].data[r].downtotal=e[a-1].data[r].downtotal):e[a].data[r].value<0&&(e[a].data[r].total=e[a-1].data[r].total,e[a].data[r].downtotal=e[a-1].data[r].downtotal+parseFloat(e[a].data[r].value));var l=t.defs;l.selectAll("filter").remove();var s=l.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_stackHorizontalBar").attr("filterUnits","objectBoundingBox");s.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),s.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),s.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),s.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),s.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var u=e,h=t.grid,d=t.tooltip,_=t.rectPlot,f=t.overlay,p=t.selectOverlay,y=(t.clipArea,t.xScale),x=t.yScale,g=(t.xAxis._axisStart,t.xAxis._axisEnd),v=0;g>t.widthOfNoMargin-t.yAxis.width&&(v=g-(t.widthOfNoMargin-t.yAxis.width));var m=t.widthOfCore-v,b=t.heightOfCore,S=1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.downtotal}))})),0);(S<0?(d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+-(y.range()[0]-y(0))+",0)"),d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+-(y.range()[0]-y(0))+",0)")):(d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,0)")),0!=t._clipShowX.length&&(d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),d3.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,0)")),f.data(x.domain()).isScalePoint(!1).isHorizontal(!0).bandX(y.range()[0]).bandWidth(m-y.range()[0]).bandHeight(x.step()).onMouseover((function(i,n){var a=x.domain()[x.domain().length-n-1==-1?1:x.domain().length-n-1==-2?0:x.domain().length-n-1],o=[{text:a=="&-"+(x.domain().length-n)?"":a}];a&&1!=a&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+x(a)+")")),d.data(o).update(),d.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){d.move([d3.event.offsetX,d3.event.offsetY]),p.show()})).onMouseout((function(){d.hide(),p.hide()})),_.data(u).xScale(y).yScale(x).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(t._borderColor).barWidthPercent(t._barWidthPercent).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}).fillOpacity(t._fillOpacity),h.width(m).height(b).planeX(y.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),p.width(m-y.range()[0]).height(x.step()).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)"),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),h.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),h.translate(t.yAxis.width+.5,t.xAxis.height)),0!=t._clipShowX.length)?(t.mainGroup.selectAll(".clip-defs").remove(),t.mainGroup.append("defs").attr("class","clip-defs").append("clipPath").attr("id","clip-overlay-"+t.id).append("rect").attr("height",b).attr("width",m),t.coreGroup.attr("clip-path","url("+c("#clip-overlay-"+t.id)+")")):t.coreGroup.attr("clip-path","");var k=t.group.selectAll(".stack-horizontal-bar-chart .axis-y-horizontal .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(k).remove(),_.update(),p.update(),f.update(),h.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+y.range()[0]),S<0?(t.coreGroup.selectAll(".fake-y-line").remove(),this.coreGroup.append("g").attr("class","fake-y-line").append("line").attr("x1",y.range()[0]).attr("y1",x.range()[0]).attr("x2",y.range()[0]).attr("y2",x.range()[1]).attr("stroke",t._axisLineStrokeY)):t.coreGroup.selectAll(".fake-y-line").remove()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t._width-t._marginLeft-t._marginRight,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i&&i.titleHeight;var d=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(d).compute(),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=e.height,g=h-x,v=0,m=i.width,b=i.width+_;"上面"==t._axisPositonChoiceX?(g=x,v=x):g=(t._axisPositonChoiceX,h-x),e.translate(m,g).update(),i.translate(b,v).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range).yRange(a.range).clipShow(a.range).clipShowX(n.range).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)0==i?e[i].data[n].value>0||0==e[i].data[n].value?(e[i].data[n].total=parseFloat(e[i].data[n].value),e[i].data[n].downtotal=0):e[i].data[n].value<0&&(e[i].data[n].downtotal=parseFloat(e[i].data[n].value),e[i].data[n].total=0):e[i].data[n].value>0||0==e[i].data[n].value?(e[i].data[n].total=e[i-1].data[n].total+parseFloat(e[i].data[n].value),e[i].data[n].downtotal=e[i-1].data[n].downtotal):e[i].data[n].value<0&&(e[i].data[n].total=e[i-1].data[n].total,e[i].data[n].downtotal=e[i-1].data[n].downtotal+parseFloat(e[i].data[n].value));var a=t._xRange||[],o=e.length?e[0].data.map((function(t){return t.name})):[0,1],r=e.length?[1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.downtotal}))})),0),Math.max(1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))})),0)]:[0,1];t._xDomain=[isNaN(parseFloat(a[0]))?r[0]:parseFloat(a[0]),isNaN(parseFloat(a[1]))?isNaN(parseFloat(a[0]))?r[1]:r[1]<a[0]?1.5*a[0]:r[1]:parseFloat(a[1])],t._yDomain=o}}]),e}(Tt),$n=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","grouped-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,n=t._barWidthPercent,a=[],o=0;o<e.length;o++)for(var r=0;r<e[o].data.length;r++)a.push(E(e[o].data[r].value,t._numberStyle,t._decimalPlaces)+t._suffix);var l=G(a,t._fontSize,t._fontFamily),s=t.group;if(s.selectAll("*").remove(),s.selectAll(".group-bar-rects").remove(),s.selectAll(".group-bar-texts").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var u=x(t._borderColor),h=[],d=!0,_=!1,g=void 0;try{for(var v,m=u[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){var b=v.value,S=[],k=b.split(":");S.push(q(k[0])),S.push(k[1]),h.push(S)}}catch(t){_=!0,g=t}finally{try{!d&&m.return&&m.return()}finally{if(_)throw g}}var w=h.concat(),C=w.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(360-C[1]).x1+"%").attr("y1",y(360-C[1]).y1+"%").attr("x2",y(360-C[1]).x2+"%").attr("y2",y(360-C[1]).y2+"%").selectAll("stop").data(w).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(C[1]).x1+"%").attr("y1",y(C[1]).y1+"%").attr("x2",y(C[1]).x2+"%").attr("y2",y(C[1]).y2+"%").selectAll("stop").data(w).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var O=s.append("g").selectAll("g").data(e,(function(t){return t.name}));O.exit().remove(),O.enter().append("g").merge(O).each((function(i,a){var o=t._xScale.step();e.length<4&&e.length>1&&(o=t._xScale.step()-e.length+1);var r=o*n,l=d3.select(this).selectAll("rect").data(i.data);if(l.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))l.enter().append("path").attr("class","group-bar-rects").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0})).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||2==t._moveOptions.indexOf(t._moveStyle)){var s=l.enter().append("path").attr("class","group-bar-rects").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));s.attr("d",(function(i,o){return f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:t._yScale(0),width:r/e.length>0?r/e.length:0,height:0,cornerRadius:[0,0,0,0]})})),0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):1==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):s.transition().delay((function(e,n){return t._transition?.9*t._duration/(i.data.length>0?i.data.length:1)*n+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):2==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):s.transition().delay((function(i,n){return t._transition?.9*t._duration/(e.length>0?e.length:1)*a+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})))}else if(3==t._moveOptions.indexOf(t._moveStyle)||4==t._moveOptions.indexOf(t._moveStyle)||5==t._moveOptions.indexOf(t._moveStyle)){var u=l.enter().append("path").attr("class","group-bar-rects").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));u.attr("d",(function(i,o){var l=0,s=0;return i.value<0?(l=t._yScale(0),s=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(l=t._yScale(i.value),s=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:l,width:0,height:s,cornerRadius:[0,0,0,0]})})),3==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):u.transition().delay((function(e,n){return t._transition?.9*t._duration/(i.data.length>0?i.data.length:1)*n+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):4==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):u.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):5==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})):u.transition().delay((function(i,n){return t._transition?.9*t._duration/(e.length>0?e.length:1)*a+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return i.value<0?(s=t._yScale(0),u=t._yScale(i.value)-t._yScale(0)<0?0:t._yScale(i.value)-t._yScale(0)):i.value>0&&(s=t._yScale(i.value),u=t._yScale(0)-t._yScale(i.value)<0?0:t._yScale(0)-t._yScale(i.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:i.value>0?t._barCornerRadius:l})})))}l.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}));var F=t._xScale.step();e.length<4&&e.length>1&&(F=t._xScale.step()-e.length+1);var L=F*n,P=L/e.length>0?L/e.length:0,A=s.append("g").selectAll("g").data(e,(function(t){return t.name}));if(A.exit().remove(),A.enter().append("g").merge(A).each((function(i,a){var o=d3.select(this).attr("class","groupedBarTexts").selectAll("text").data(i.data);o.exit().remove();var r=o.enter().append("text").attr("class","group-bar-texts").merge(o).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._textObj.colorFunc).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return t._xScale.range()[0]+(L/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o+(L/e.length>0?L/e.length:0)/2})).attr("text-anchor","middle").attr("y",(function(e){return null==t._positionOptions||null==t._positionChoice?t._yScale(e.value):0==t._positionOptions.indexOf(t._positionChoice)?e.value<0?t._yScale(e.value)+1.05*t._fontSize:t._yScale(e.value)-.3*t._fontSize:1==t._positionOptions.indexOf(t._positionChoice)?e.value>0?t._yScale(0)-.3*t._fontSize:t._yScale(e.value)-.3*t._fontSize:void 0})).style("display",t._labelShow?"block":"none");null==t._positionOptions||null==t._positionChoice||P<l&&1==t._positionOptions.indexOf(t._positionChoice)&&r.attr("transform",(function(i,o){return i.value>0?"rotate(-90 "+(t._xScale.range()[0]+(L/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o+(L/e.length>0?L/e.length:0)/2||0)+"\n                         "+(t._yScale(i.value)+t._yScale(0)-t._yScale(i.value)-.65*t._fontSize)+" )":"rotate(-90 "+(t._xScale.range()[0]+(L/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-n)/2+t._xScale.step()*o+(L/e.length>0?L/e.length:0)/2||0)+"\n                         "+(t._yScale(i.value)-.65*t._fontSize)+" )"})).attr("text-anchor","start"),t._interrupt?r.style("opacity",1):r.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?s.selectAll(".groupedBarTexts").style("display","none"):s.selectAll(".groupedBarTexts").style("display","block")})),null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice))s.selectAll(".groupedBarTexts").style("display","none");else if(P<l&&1==t._positionOptions.indexOf(t._positionChoice)){for(var W=s.selectAll(".group-bar-texts"),z=[],M=[],D=0;D<W._groups[0].length;D++){M.push(D);for(var R=D+1;R<W._groups[0].length;R++){var N=i(d3.select(W._groups[0][D])),T=i(d3.select(W._groups[0][R])),B=N.width;N.width=N.height,N.height=B;var X=T.width;T.width=T.height,T.height=X,p(N,T)&&(z.push(D),d3.select(W._groups[0][D]).style("visibility","hidden"))}}for(var j=new Set(z),I=Array.from(j),Y=pt(I,M),H=0;H<I.length;H++){for(var V=[],$=0;$<Y.length;$++){var Z=i(d3.select(W._groups[0][I[H]])),Q=i(d3.select(W._groups[0][Y[$]])),K=Z.width;Z.width=Z.height,Z.height=K;var J=Q.width;if(Q.width=Q.height,Q.height=J,V.push(p(Z,Q)),p(Z,Q)){if(I[H]==Y[$])continue;d3.select(W._groups[0][I[H]]).style("visibility","hidden")}}0==V.filter((function(t){return 1==t})).length&&Y.push(I[H])}for(var tt=0;tt<Y.length;tt++)d3.select(W._groups[0][Y[tt]]).style("visibility","visible")}else{for(var et=s.selectAll(".group-bar-texts"),it=[],nt=[],at=0;at<et._groups[0].length;at++){nt.push(at);for(var ot=at+1;ot<et._groups[0].length;ot++){p(i(d3.select(et._groups[0][at])),i(d3.select(et._groups[0][ot])))&&(it.push(at),d3.select(et._groups[0][at]).style("visibility","hidden"))}}for(var rt=new Set(it),lt=Array.from(rt),st=pt(lt,nt),ut=0;ut<lt.length;ut++){for(var ct=[],ht=0;ht<st.length;ht++){var dt=i(d3.select(et._groups[0][lt[ut]])),_t=i(d3.select(et._groups[0][st[ht]]));if(ct.push(p(dt,_t)),p(dt,_t)){if(lt[ut]==st[ht])continue;d3.select(et._groups[0][lt[ut]]).style("visibility","hidden")}}0==ct.filter((function(t){return 1==t})).length&&st.push(lt[ut])}for(var ft=0;ft<st.length;ft++)d3.select(et._groups[0][st[ft]]).style("visibility","visible")}function pt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=parseFloat(t),this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),qn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","grouped-bar-chart"),i.grid=new Jt(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new $n(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._histogramWidth=.7,i._yScaleHeight=1.05,i._barWidthPercent=.7,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["上面","内部居下"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向整体拉伸","纵向分组拉伸","纵向分类拉伸","横向分组展开","横向同步展开","横向分类展开"],i._moveStyle="纵向整体拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=e,n=t.grid,a=t.tooltip,o=t.rectPlot,r=t.overlay,l=t.selectOverlay,s=t.clipArea,u=t.xScale,h=t.yScale,d=(t.xAxis._axisStart,t.xAxis._axisEnd),_=0;d>t.widthOfNoMargin-t.yAxis.width&&(_=d-(t.widthOfNoMargin-t.yAxis.width));var f=t.widthOfCore-_,p=t.heightOfCore,y=1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0);y<0?(t.group.selectAll(".grouped-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(h.range()[0]-h(0))+")"),t.group.selectAll(".grouped-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(h.range()[0]-h(0))+")")):(t.group.selectAll(".grouped-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".grouped-bar-chart .axis-x-line line").attr("transform","translate(0,0)")),0!=t._clipShow.length&&(t.group.selectAll(".grouped-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".grouped-bar-chart .axis-x-line line").attr("transform","translate(0,0)"));var x=t.defs;x.selectAll("filter").remove();var g=x.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");g.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),g.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),g.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),g.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),g.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),r.data(u.domain()).isScalePoint(!1).bandX(u.range()[0]).bandWidth(u.step()).bandHeight(p).onMouseover((function(i,n){var o=i,r=[{text:o=="&-"+(n+1)?"":o}],l=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));l.push({key:e.key,name:e.name,color:e.color,data:n}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),a.data(r).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+u(o)+",0)"),a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),l.show()})).onMouseout((function(){a.hide(),l.hide()})),o.data(i).xScale(u).yScale(h).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(t._borderColor).fillOpacity(t._fillOpacity).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}),n.width(f).height(p).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.width(f).height(p).paddingVertical([0,0]).transition(t._transition).duration(t._duration),l.width(u.step()).height(p).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+t.yAxis.width+",0)"),0!=t._clipShow.length?(s.width(f).height(p).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+s.id)+")"),s.update()):(s.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),s.update());var v=t.group.selectAll(".grouped-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(v).remove(),o.update(),l.update(),r.update(),n.translate(t.yAxis.width,0).update(),y<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",u.range()[0]).attr("y1",h.range()[0]).attr("x2",u.range()[1]).attr("y2",h.range()[0]).attr("stroke",t._axisLineStrokeX)):t.coreGroup.selectAll(".fake-x-line").remove()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.display,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._barWidthPercent=0==i.barWidthPercent||i.barWidthPercent?i.barWidthPercent:this._barWidthPercent,this._barCornerRadius=i.bar4CornerRadius?i.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==i.barborderWidth||i.barborderWidth?i.barborderWidth:this._borderWidth,this._borderColor=i.barborderColor?q(i.barborderColor):"",this._fillOpacity=0==i.fillOpacity||i.fillOpacity?i.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),e}(Tt),Un=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","grouped-horizontal-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t._barWidthPercent,a=t.group;if(a.selectAll("*").remove(),a.selectAll(".groupedHoizontalBar").remove(),a.selectAll(".groupedHoizontalBarTexts").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var o=x(t._borderColor),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,g=[],v=_.split(":");g.push(q(v[0])),g.push(v[1]),r.push(g)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var m=r.concat(),b=m.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(b[1]>180?360-(b[1]-180):180-b[1]).x1+"%").attr("y1",y(b[1]>180?360-(b[1]-180):180-b[1]).y1+"%").attr("x2",y(b[1]>180?360-(b[1]-180):180-b[1]).x2+"%").attr("y2",y(b[1]>180?360-(b[1]-180):180-b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(b[1]).x1+"%").attr("y1",y(b[1]).y1+"%").attr("x2",y(b[1]).x2+"%").attr("y2",y(b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var S=a.selectAll("g").data(e);S.exit().remove(),S.enter().append("g").merge(S).each((function(i,a){var o=t._yScale.step();e.length<4&&e.length>1&&(o=t._yScale.step()-e.length+1);var r=o*n,l=d3.select(this).selectAll("rect").data(i.data);if(l.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))l.enter().append("path").attr("class","groupedHoizontalBar").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0})).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||2==t._moveOptions.indexOf(t._moveStyle)){var s=l.enter().append("path").attr("class","groupedHoizontalBar").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));s.attr("d",(function(i,o){return f({x:t._xScale(0),y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:0,height:r/e.length>0?r/e.length:0,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):1==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):s.transition().delay((function(e,n){return t._transition?.9*t._duration/(i.data.length>0?i.data.length:1)*n+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):2==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):s.transition().delay((function(i,n){return t._transition?.9*t._duration/(e.length>0?e.length:1)*a+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})))}else if(3==t._moveOptions.indexOf(t._moveStyle)||4==t._moveOptions.indexOf(t._moveStyle)||5==t._moveOptions.indexOf(t._moveStyle)){var u=l.enter().append("path").attr("class","groupedHoizontalBar").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));u.attr("d",(function(i,o){var l=0,s=0;return i.value<0?(l=t._xScale(i.value),s=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(l=t._xScale(0),s=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:l,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:s,height:0,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),3==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):u.transition().delay((function(e,n){return t._transition?.9*t._duration/(i.data.length>0?i.data.length:1)*n+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):4==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):u.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):5==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):u.transition().delay((function(i,n){return t._transition?.9*t._duration/(e.length>0?e.length:1)*a+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})))}l.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}));var k=a.append("g").selectAll("g").data(e);return k.exit().remove(),k.enter().append("g").merge(k).each((function(o,r){var l=t._yScale.step();e.length<4&&e.length>1&&(l=t._yScale.step()-e.length+1);var s=l*n,u=d3.select(this).append("g").attr("class","groupedHoizontalBarTexts").selectAll("text").data(o.data);u.exit().remove();var c=u.enter().append("text").merge(u).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._textObj.colorFunc).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","start").attr("x",(function(e){return e.value>0?t._xScale(0):e.value<0?t._xScale(e.value):void 0})).attr("y",(function(i,a){return Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((s/e.length+(e.length>3||1==e.length?0:1))*r+t._yScale.step()*(1-n)/2+t._yScale.step()*a)-(s/e.length>0?s/e.length:0)})).attr("dy",(s/e.length>0?s/e.length:0)/2+t._fontSize/3).attr("dx",(function(e,i){if(null==t._positionOptions||null==t._positionChoice)return 0;if(0==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0)return t._xScale(e.value)-t._xScale(0)+.3*t._fontSize;if(e.value<0)return.3*-t._fontSize}else if(1==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0)return.3*t._fontSize;if(e.value<0)return t._xScale(0)-t._xScale(e.value)-.3*t._fontSize}else if(2==t._positionOptions.indexOf(t._positionChoice)){if(e.value<0)return.3*t._fontSize+R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily);if(e.value>0)return(t._xScale(e.value)-t._xScale(0)<0?0:t._xScale(e.value)-t._xScale(0))-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-.3*t._fontSize}})).style("display",t._labelShow?"block":"none");t._interrupt?c.style("opacity",1):c.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1),d3.selectAll(a.selectAll(".groupedHoizontalBarTexts text").nodes().filter((function(t){return t.__data__.value<0}))).attr("text-anchor","end"),null!=t._labelShow&&0!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||a.selectAll(".groupedHoizontalBarTexts").style("display","none");for(var h=a.selectAll(".groupedHoizontalBarTexts text"),d=[],_=[],f=0;f<h._groups[0].length;f++){_.push(f);for(var y=f+1;y<h._groups[0].length;y++){p(i(d3.select(h._groups[0][f])),i(d3.select(h._groups[0][y])))&&(d.push(f),d3.select(h._groups[0][f]).style("visibility","hidden"))}}for(var x=new Set(d),g=Array.from(x),v=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(g,_),m=0;m<g.length;m++){for(var b=[],S=0;S<v.length;S++){var k=i(d3.select(h._groups[0][g[m]])),w=i(d3.select(h._groups[0][v[S]]));if(b.push(p(k,w)),p(k,w)){if(g[m]==v[S])continue;d3.select(h._groups[0][g[m]]).style("visibility","hidden")}}0==b.filter((function(t){return 1==t})).length&&v.push(g[m])}for(var C=0;C<v.length;C++)d3.select(h._groups[0][v[C]]).style("visibility","visible")})),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=parseFloat(t),this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Zn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","grouped-horizontal-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.yAxis.minTickDistance(1),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new Un(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._histogramWidth=.7,i._yScaleHeight=1.05,i._barWidthPercent=.7,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["右边","内部居左","内部居右"],i._positionChoice="内部居右",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向同步拉伸","横向分组拉伸","横向分类拉伸","按分组的百叶窗","百叶窗","按分类的百叶窗"],i._moveStyle="横向同步拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=e,n=t.grid,a=t.tooltip,r=t.rectPlot,l=t.overlay,s=t.selectOverlay,u=t.xScale,h=t.yScale,d=t.gridEnd-t.gridStart,_=t.heightOfCore,f=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),p=[],y=[],x=0;x<t.activeData.length;x++)for(var g=0;g<t.activeData[x].data.length;g++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(y.push(0),p.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[x].data[g].value)>0||0==parseFloat(t.activeData[x].data[g].value)?p.push(R(E(t.activeData[x].data[g].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[x].data[g].value)<0&&y.push(R(E(t.activeData[x].data[g].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(y.push(0),p.push(0));f<0?(t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+(-(u.range()[0]-u(0))+t.gridStart)+",0)"),t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+(-(u.range()[0]-u(0))+t.gridStart)+","+-h.step()/2+")")):(t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,"+-h.step()/2+")")),0!=t._clipShowX.length&&(t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,"+-h.step()/2+")"));var v=t.defs;v.selectAll("filter").remove();var m=v.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupHorizontal").attr("filterUnits","objectBoundingBox");m.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),m.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),m.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),m.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),m.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),l.data(h.domain()).isScalePoint(!1).isHorizontal(!0).bandX(u.range()[0]).bandWidth(d).bandHeight(h.step()).onMouseover((function(i,n){var o=h.domain()[h.domain().length-n-1==-1?1:h.domain().length-n-1==-2?0:h.domain().length-n-1],r=[{text:o=="&-"+(h.domain().length-n)?"":o}];o&&1!=o&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+h(o)+")")),a.data(r).update(),a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),s.show()})).onMouseout((function(){a.hide(),s.hide()})),r.data(i).xScale(u).yScale(h).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(this._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(t._borderColor).fillOpacity(t._fillOpacity).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}),n.width(d+u.range()[0]).height(_).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.width(d).height(h.step()).shadowColor("#ccc").hide(),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),n.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),n.translate(t.yAxis.width+.5,t.xAxis.height));var b=t.group.selectAll(".grouped-horizontal-bar-chart .axis-y-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));(d3.selectAll(b).remove(),r.update(),s.update(),l.update(),n.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+t.gridStart),0!=t._clipShowX.length)?(t.mainGroup.selectAll(".clip-defs").remove(),t.mainGroup.append("defs").attr("class","clip-defs").append("clipPath").attr("id","clip-overlay-"+t.id).append("rect").attr("x",t.gridStart).attr("height",_).attr("width",d),t.coreGroup.attr("clip-path","url("+c("#clip-overlay-"+t.id)+")")):t.coreGroup.attr("clip-path","");(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&t.coreGroup.attr("clip-path","")}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t._width-t._marginLeft-t._marginRight,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i&&i.titleHeight;t.data().forEach((function(t){t.data.forEach((function(t){}))}));for(var d=[],_=[],f=[],p=0;p<t.activeData.length;p++)for(var y=0;y<t.activeData[p].data.length;y++)t.activeData[p].data[y].value<0&&f.push(t.activeData[p].data[y].value),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(_.push(0),d.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[p].data[y].value)>0||0==parseFloat(t.activeData[p].data[y].value)?d.push(R(E(t.activeData[p].data[y].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[p].data[y].value)<0&&_.push(R(E(t.activeData[p].data[y].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(_.push(0),d.push(0));var x=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(x).compute(),i.compute();var g=0==_.length?0:d3.max(_),v=c-i.width-(0==d.length?0:d3.max(d));i.compute(),n.range([g,v]),e.compute();var m=e._axisStart,b=e._axisEnd,S=0==_.length?0:d3.max(_);m<0&&(g=S+(Math.abs(m)>i.width?Math.abs(m)-i.width:0)),b>v&&(v=v-(b-v)+(0==d.length?0:d3.max(d))),t.gridStart=g,t.gridEnd=v,n.range([g,v]),a.range([h-e.height,0]);var k=i.width,w=h-e.height,C=i.width+g,O=0;((0==_.length?0:d3.max(_))>0||f.length>0)&&(C=i.width);var F=e.height;"上面"==t._axisPositonChoiceX?(w=F,O=F):w=(t._axisPositonChoiceX,h-F),e.translate(k,w).update(),i.translate(C,O).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._borderWidth,this._borderColor=e.barborderColor?q(e.barborderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range).yRange(a.range).clipShow(a.range).clipShowX(n.range).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._xRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[1.05*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.05*Math.max(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1];t._xDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])],t._yDomain=n}}]),e}(Tt),Qn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","negative-horizontal-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t._barWidthPercent,a=t.group;if(a.selectAll("*").remove(),a.selectAll(".negativeHoizontalBar").remove(),a.selectAll(".negativeHoizontalBarTexts").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var o=x(t._borderColor),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,g=[],v=_.split(":");g.push(q(v[0])),g.push(v[1]),r.push(g)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var m=r.concat(),b=m.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(b[1]>180?360-(b[1]-180):180-b[1]).x1+"%").attr("y1",y(b[1]>180?360-(b[1]-180):180-b[1]).y1+"%").attr("x2",y(b[1]>180?360-(b[1]-180):180-b[1]).x2+"%").attr("y2",y(b[1]>180?360-(b[1]-180):180-b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(b[1]).x1+"%").attr("y1",y(b[1]).y1+"%").attr("x2",y(b[1]).x2+"%").attr("y2",y(b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var S=a.selectAll("g").data(e);S.exit().remove(),S.enter().append("g").merge(S).each((function(i,a){var o=t._yScale.step();e.length<4&&e.length>1&&(o=t._yScale.step()-e.length+1);var r=o*n,l=d3.select(this).selectAll("rect").data(i.data);if(l.exit().remove(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))l.enter().append("path").attr("class","negativeHoizontalBar").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0})).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})}));else if(0==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle)||2==t._moveOptions.indexOf(t._moveStyle)){var s=l.enter().append("path").attr("class","negativeHoizontalBar").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));s.attr("d",(function(i,o){return f({x:t._xScale(0),y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:0,height:r/e.length>0?r/e.length:0,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):1==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):s.transition().delay((function(e,n){return t._transition?.9*t._duration/(i.data.length>0?i.data.length:1)*n+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):2==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):s.transition().delay((function(i,n){return t._transition?.9*t._duration/(e.length>0?e.length:1)*a+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})))}else if(3==t._moveOptions.indexOf(t._moveStyle)||4==t._moveOptions.indexOf(t._moveStyle)||5==t._moveOptions.indexOf(t._moveStyle)){var u=l.enter().append("path").attr("class","negativeHoizontalBar").merge(l).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));u.attr("d",(function(i,o){var l=0,s=0;return i.value<0?(l=t._xScale(i.value),s=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(l=t._xScale(0),s=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:l,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:s,height:0,cornerRadius:[0,0,0,0],roundCorners:[0,1,2,3],type:"horizontal"})})),3==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):u.transition().delay((function(e,n){return t._transition?.9*t._duration/(i.data.length>0?i.data.length:1)*n+t._startDelay:0})).duration(t._transition?.9*t._duration/(i.data.length>0?i.data.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):4==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):u.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):5==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?u.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})):u.transition().delay((function(i,n){return t._transition?.9*t._duration/(e.length>0?e.length:1)*a+t._startDelay:0})).duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(i,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[1]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[2]));var s=0,u=0;return i.value<0?(s=t._xScale(i.value),u=t._xScale(0)-t._xScale(i.value)<0?0:t._xScale(0)-t._xScale(i.value)):i.value>0&&(s=t._xScale(0),u=t._xScale(i.value)-t._xScale(0)<0?0:t._xScale(i.value)-t._xScale(0)),f({x:s,y:Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((r/e.length+(e.length>3||1==e.length?0:1))*a+t._yScale.step()*(1-n)/2+t._yScale.step()*o)-(r/e.length>0?r/e.length:0),width:u,height:r/e.length>0?r/e.length:0,cornerRadius:i.value>0?t._barCornerRadius:l,roundCorners:[0,1,2,3],type:"horizontal"})})))}l.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout)}));var k=a.append("g").selectAll("g").data(e);return k.exit().remove(),k.enter().append("g").merge(k).each((function(o,r){var l=t._yScale.step();e.length<4&&e.length>1&&(l=t._yScale.step()-e.length+1);var s=l*n,u=d3.select(this).append("g").attr("class","negativeHoizontalBarTexts").selectAll("text").data(o.data);u.exit().remove();var c=u.enter().append("text").merge(u).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._textObj.colorFunc).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","start").attr("x",(function(e){return e.value>0?t._xScale(0):e.value<0?t._xScale(e.value):void 0})).attr("y",(function(i,a){return Math.abs(t._yScale.range()[0]-t._yScale.range()[1])-((s/e.length+(e.length>3||1==e.length?0:1))*r+t._yScale.step()*(1-n)/2+t._yScale.step()*a)-(s/e.length>0?s/e.length:0)})).attr("dy",(s/e.length>0?s/e.length:0)/2+t._fontSize/3).attr("dx",(function(e,i){if(null==t._positionOptions||null==t._positionChoice)return 0;if(0==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0)return t._xScale(e.value)-t._xScale(0)+.3*t._fontSize;if(e.value<0)return.3*-t._fontSize}else if(1==t._positionOptions.indexOf(t._positionChoice)){if(e.value>0)return.3*t._fontSize;if(e.value<0)return t._xScale(0)-t._xScale(e.value)-.3*t._fontSize}})).style("display",t._labelShow?"block":"none");t._interrupt?c.style("opacity",1):c.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1),d3.selectAll(a.selectAll(".negativeHoizontalBarTexts text").nodes().filter((function(t){return t.__data__.value<0}))).attr("text-anchor","end"),null!=t._labelShow&&0!=t._labelShow&&null!=t._positionOptions&&null!=t._positionChoice&&-1!=t._positionOptions.indexOf(t._positionChoice)||d3.selectAll(".negativeHoizontalBarTexts").style("display","none");for(var h=a.selectAll(".negativeHoizontalBarTexts text"),d=[],_=[],f=0;f<h._groups[0].length;f++){_.push(f);for(var y=f+1;y<h._groups[0].length;y++){p(i(d3.select(h._groups[0][f])),i(d3.select(h._groups[0][y])))&&(d.push(f),d3.select(h._groups[0][f]).style("visibility","hidden"))}}for(var x=new Set(d),g=Array.from(x),v=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(g,_),m=0;m<g.length;m++){for(var b=[],S=0;S<v.length;S++){var k=i(d3.select(h._groups[0][g[m]])),w=i(d3.select(h._groups[0][v[S]]));if(b.push(p(k,w)),p(k,w)){if(g[m]==v[S])continue;d3.select(h._groups[0][g[m]]).style("visibility","hidden")}}0==b.filter((function(t){return 1==t})).length&&v.push(g[m])}for(var C=0;C<v.length;C++)d3.select(h._groups[0][v[C]]).style("visibility","visible")})),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=parseFloat(t),this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Kn=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","negative-horizontal-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.yAxis.minTickDistance(1),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new Qn(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._histogramWidth=.7,i._yScaleHeight=1.05,i._barWidthPercent=.7,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["外部","内部"],i._positionChoice="外部",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向同步拉伸","横向分组拉伸","横向分类拉伸","按分组的百叶窗","百叶窗","按分类的百叶窗"],i._moveStyle="横向同步拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=e,n=t.grid,a=t.tooltip,r=t.rectPlot,l=t.overlay,s=t.selectOverlay,u=t.xScale,h=t.yScale,d=t.gridEnd-t.gridStart,_=t.heightOfCore,f=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),p=[],y=[],x=0;x<t.activeData.length;x++)for(var g=0;g<t.activeData[x].data.length;g++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(y.push(0),p.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[x].data[g].value)>0||0==parseFloat(t.activeData[x].data[g].value)?p.push(R(E(t.activeData[x].data[g].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[x].data[g].value)<0&&y.push(R(E(t.activeData[x].data[g].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(y.push(0),p.push(0));f<0?(t.group.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+(-(u.range()[0]-u(0))+t.gridStart)+",0)"),t.group.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+(-(u.range()[0]-u(0))+t.gridStart)+","+-h.step()/2+")")):(t.group.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),t.group.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,"+-h.step()/2+")")),0!=t._clipShowX.length&&(t.group.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),t.group.selectAll(".negative-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,"+-h.step()/2+")"));var v=t.defs;v.selectAll("filter").remove();var m=v.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_negativeHorizontal").attr("filterUnits","objectBoundingBox");m.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),m.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),m.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),m.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),m.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),l.data(h.domain()).isScalePoint(!1).isHorizontal(!0).bandX(u.range()[0]).bandWidth(d).bandHeight(h.step()).onMouseover((function(i,n){var o=h.domain()[h.domain().length-n-1==-1?1:h.domain().length-n-1==-2?0:h.domain().length-n-1],r=[{text:o=="&-"+(h.domain().length-n)?"":o}];o&&1!=o&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+h(o)+")")),a.data(r).update(),a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),s.show()})).onMouseout((function(){a.hide(),s.hide()})),r.data(i).xScale(u).yScale(h).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(this._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(t._borderColor).fillOpacity(t._fillOpacity).textObj({colorFunc:function(){return q(t._textLabel.color)}}).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),n.width(d+u.range()[0]).height(_).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.width(d).height(h.step()).shadowColor("#ccc").hide(),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),n.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),n.translate(t.yAxis.width+.5,t.xAxis.height));var b=t.group.selectAll(".negative-horizontal-bar-chart .axis-y-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));(d3.selectAll(b).remove(),r.update(),s.update(),l.update(),n.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+t.gridStart),0!=t._clipShowX.length)?(t.mainGroup.selectAll(".clip-defs").remove(),t.mainGroup.append("defs").attr("class","clip-defs").append("clipPath").attr("id","clip-overlay-"+t.id).append("rect").attr("x",t.gridStart).attr("height",_).attr("width",d),t.coreGroup.attr("clip-path","url("+c("#clip-overlay-"+t.id)+")")):t.coreGroup.attr("clip-path","");(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&t.coreGroup.attr("clip-path",""),f<0?(t.coreGroup.selectAll(".fake-y-line").remove(),this.coreGroup.append("g").attr("class","fake-y-line").append("line").attr("x1",u.range()[0]-t.gridStart).attr("y1",h.range()[0]).attr("x2",u.range()[0]-t.gridStart).attr("y2",h.range()[1]).attr("stroke",t._axisLineStrokeY)):t.coreGroup.selectAll(".fake-y-line").remove()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t._width-t._marginLeft-t._marginRight,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i&&i.titleHeight;t.data().forEach((function(t){t.data.forEach((function(t){}))}));for(var d=[],_=[],f=[],p=0;p<t.activeData.length;p++)for(var y=0;y<t.activeData[p].data.length;y++)t.activeData[p].data[y].value<0&&f.push(t.activeData[p].data[y].value),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(_.push(0),d.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[p].data[y].value)>0||0==parseFloat(t.activeData[p].data[y].value)?d.push(R(E(t.activeData[p].data[y].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[p].data[y].value)<0&&_.push(R(E(t.activeData[p].data[y].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(_.push(0),d.push(0));var x=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(x).compute(),i.compute();var g=0==_.length?0:d3.max(_),v=c-i.width-(0==d.length?0:d3.max(d));i.compute(),n.range([g,v]),e.compute();var m=e._axisStart,b=e._axisEnd,S=0==_.length?0:d3.max(_);m<0&&(g=S+(Math.abs(m)>i.width?Math.abs(m)-i.width:0)),b>v&&(v=v-(b-v)+(0==d.length?0:d3.max(d))),t.gridStart=g,t.gridEnd=v,n.range([g,v]),a.range([h-e.height,0]);var k=i.width,w=h-e.height,C=i.width+g,O=0;((0==_.length?0:d3.max(_))>0||f.length>0)&&(C=i.width);var F=e.height;"上面"==t._axisPositonChoiceX?(w=F,O=F):w=(t._axisPositonChoiceX,h-F),e.translate(k,w).update(),i.translate(C,O).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._borderWidth,this._borderColor=e.barborderColor?q(e.barborderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._xRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[1.05*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.05*Math.max(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1];t._xDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])],t._yDomain=n}}]),e}(Tt),Jn="axis-group",ta="y-mix-title",ea=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-mix"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=2,i._countOfLabel=null,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickValueTexts,l=void 0;l=t.axisFunc="right"===e?d3.axisRight(i):d3.axisLeft(i);var s=null;"number"===t._type&&t._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(s=d3.format("d")),l.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(-.5).tickPadding(t._tickPadding).tickFormat(s),n.select(".axis-group").remove();var u=n.select(".axis-group").empty()?n.append("g").attr("class",Jn):n.select(".axis-group");u.transition().duration(t._transition?t._duration:0).call(l).on("start",(function(){u.selectAll(".tick text").remove(),u.selectAll(".tick").append("text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dx",(function(t,i){return"left"==e?.6*-a:"right"==e?.6*a:void 0})).attr("dy",.4*a).text((function(e,i){return r[i]+(t._unit?t._unit:"")})),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._yAxisLineWidth).style("display",t._axisLineShow?"block":"none")}));var c=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var h=n.select(".y-mix-title").empty()?n.append("g").attr("class",ta):n.select(".y-mix-title"),d=h.select("text").empty()?h.append("text"):h.select("text");R(t._title,a,t._fontFamily);h.call(o,-(this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),c/2),d.attr("y",-7).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(t._title),"second"==t._times&&(h.call(o,this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0,c/2),d.attr("y",-7).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("transform","rotate(90)").style("text-anchor","middle").text(t._title))}else n.select(".y-mix-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);Math.abs(a.range()[0]-a.range()[1]);e="category"===o?a.domain():a.ticks(t._tickCount);new Array;var s=[];if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[0],c=(Math.abs(parseFloat(u))>1?Math.round(parseFloat(u)):u)||0,h=a.domain()[1]||1;if(0!=t._countOfLabel){var d=h-c,_=t._countOfLabel,f=Math.ceil(Math.abs(d/t._countOfLabel)),p=8*Math.ceil(t._tickCount),y=d3.tickStep(c,h,p);t._countOfLabel<y&&(f=Math.ceil(Math.abs(d/y)),_=y),h+=f;for(var x=0;x<f+1;x++)s.push(c+x*_)}else s.push(c);"number"===o&&0!=t._yRange.length&&(1==t._yRange.length?isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]):(isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]),isNaN(t._yRange[1])||null==t._yRange[1]||(s[s.length-1]>t._yRange[1]&&s.pop(),s.push(t._yRange[1]))),s=Array.from(new Set(s))),0!=t._countOfLabel&&a.domain([d3.min(s),d3.max(s)]);var g=[];s.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;g.push(i)}})),g=g.filter((function(t){return t<=8})),s=s.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(g)&&(t=parseFloat(t).toFixed(d3.max(g)))}return t}))}if(i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o){for(var v=[],m=0;m<e.length;m++)v.push(E(e[m],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=v}var b=d3.max(i,(function(e){return R(e,r,t._fontFamily)}))||0;return b<=l?(i=i,n=b):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"times",value:function(t){return arguments.length?(this._times=t,this):this._times}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth+(this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3:0),t}}]),e}(Bt),ia=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","mix-line-bar-rect"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,i=t._barWidthPercent,n=[],a=0;a<e.length;a++)for(var o=0;o<e[a].data.length;o++)n.push(Number(e[a].data[o].value));G(n,t._fontSize,t._fontFamily);var r=t.group;if(r.selectAll("*").remove(),r.selectAll("g").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var l=x(t._borderColor),s=[],u=!0,h=!1,d=void 0;try{for(var _,p=l[Symbol.iterator]();!(u=(_=p.next()).done);u=!0){var g=_.value,v=[],m=g.split(":");v.push(q(m[0])),v.push(m[1]),s.push(v)}}catch(t){h=!0,d=t}finally{try{!u&&p.return&&p.return()}finally{if(h)throw d}}var b=s.concat(),S=b.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(360-S[1]).x1+"%").attr("y1",y(360-S[1]).y1+"%").attr("x2",y(360-S[1]).x2+"%").attr("y2",y(360-S[1]).y2+"%").selectAll("stop").data(b).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(S[1]).x1+"%").attr("y1",y(S[1]).y1+"%").attr("x2",y(S[1]).x2+"%").attr("y2",y(S[1]).y2+"%").selectAll("stop").data(b).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var k=r.append("g").selectAll("g").data(e,(function(t){return t.name}));return k.exit().remove(),k.enter().append("g").attr("class","mix-line-bar-bar-rects").merge(k).each((function(n,a){var o=t._xScale.step();e.length<4&&e.length>1&&(o=t._xScale.step()-e.length+1);var r=o*i,l=d3.select(this).selectAll("rect").data(n.data);l.exit().remove();var s=l.enter().append("path").attr("class","mix-line-bar-rects").merge(l).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._borderWidth||0}));s.attr("d",(function(n,o){return f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-i)/2+t._xScale.step()*o,y:t._yScale(0),width:r/e.length>0?r/e.length:0,height:0,cornerRadius:[0,0,0,0]})})),t._interrupt?s.style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(n,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return n.value<0?(s=t._yScale(0),u=t._yScale(n.value)-t._yScale(0)<0?0:t._yScale(n.value)-t._yScale(0)):n.value>0&&(s=t._yScale(n.value),u=t._yScale(0)-t._yScale(n.value)<0?0:t._yScale(0)-t._yScale(n.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-i)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:n.value>0?t._barCornerRadius:l})})):s.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("stroke",(function(e){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)})).attr("d",(function(n,o){var l=[];Array.isArray(t._barCornerRadius)&&(l.push(t._barCornerRadius[2]),l.push(t._barCornerRadius[3]),l.push(t._barCornerRadius[0]),l.push(t._barCornerRadius[1]));var s=0,u=0;return n.value<0?(s=t._yScale(0),u=t._yScale(n.value)-t._yScale(0)<0?0:t._yScale(n.value)-t._yScale(0)):n.value>0&&(s=t._yScale(n.value),u=t._yScale(0)-t._yScale(n.value)<0?0:t._yScale(0)-t._yScale(n.value)),f({x:t._xScale.range()[0]+(r/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-i)/2+t._xScale.step()*o,y:s,width:r/e.length>0?r/e.length:0,height:u,cornerRadius:n.value>0?t._barCornerRadius:l})}))})),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=parseFloat(t),this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),na=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","mix-line-bar-text"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,i=t._barWidthPercent,n=[],a=0;a<e.length;a++)for(var o=0;o<e[a].data.length;o++)n.push(E(e[a].data[o].value,t._numberStyle,t._decimalPlaces)+t._barSuffix);var r=G(n,t._fontSize,t._fontFamily),l=t.group;l.selectAll("*").remove(),l.selectAll("g").remove(),l.append("g").selectAll("g").data(e,(function(t){return t.name})).exit().remove();var s=l.append("g").selectAll("g").data(e,(function(t){return t.name}));return s.exit().remove(),s.enter().append("g").merge(s).each((function(n,a){var o=t._xScale.step();e.length<4&&e.length>1&&(o=t._xScale.step()-e.length+1);var s=o*i,u=d3.select(this).attr("class","mixLineBarTexts").selectAll("text").data(n.data);u.exit().remove();var c=u.enter().append("text").attr("class","mix-line-bar-texts").merge(u).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._barSuffix})).attr("fill",t._textObj.colorFunc).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(n,o){return t._xScale.range()[0]+(s/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-i)/2+t._xScale.step()*o+(s/e.length>0?s/e.length:0)/2})).attr("text-anchor","middle").attr("y",(function(e){return null==t._positionOptions||null==t._positionChoice?t._yScale(e.value):0==t._positionOptions.indexOf(t._positionChoice)?e.value<0?t._yScale(0)-.3*t._fontSize:t._yScale(e.value)-.3*t._fontSize:1==t._positionOptions.indexOf(t._positionChoice)?(t._yScale(0)+t._yScale(e.value))/2+.35*t._fontSize:2==t._positionOptions.indexOf(t._positionChoice)?e.value>0?t._yScale(0)-.3*t._fontSize:t._yScale(e.value)-.3*t._fontSize:void 0})).style("display",t._labelShow?"block":"none");t._interrupt?c.style("opacity",1):c.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1);var h=s/e.length>0?s/e.length:0;null==t._positionOptions||null==t._positionChoice||h<r&&2==t._positionOptions.indexOf(t._positionChoice)&&c.attr("transform",(function(n,o){return n.value>0?"rotate(-90 "+(t._xScale.range()[0]+(s/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-i)/2+t._xScale.step()*o+(s/e.length>0?s/e.length:0)/2||0)+"\n                         "+(t._yScale(n.value)+t._yScale(0)-t._yScale(n.value)-.65*t._fontSize)+" )":"rotate(-90 "+(t._xScale.range()[0]+(s/e.length+(e.length>3||1==e.length?0:1))*a+t._xScale.step()*(1-i)/2+t._xScale.step()*o+(s/e.length>0?s/e.length:0)/2||0)+"\n                         "+(t._yScale(n.value)-.65*t._fontSize)+" )"})).attr("text-anchor","start"),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice?l.selectAll(".mixLineBarTexts").style("display","none"):l.selectAll(".mixLineBarTexts").style("display","block")})),t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=parseFloat(t),this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"barSuffix",value:function(t){return arguments.length?(this._barSuffix=t,this):this._barSuffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),aa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","mix-line-bar-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._lineWidth=2,i._strokeWidth=1,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._xScale,n=t._yScale,a=t.group;a.selectAll("*").remove(),t._curve==d3.curveCardinal&&a.attr("stroke-linecap","round"),t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-line-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var o=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));o.curve(t._curve);var r=a.selectAll("path").data(e,(function(t){return t.key}));r.exit().remove();var l=r.enter().append("path").merge(r).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return o(t.data)}));t._interrupt?l.attr("stroke-dasharray",t._strokeDasharry):l.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("stroke-dasharray",(function(){var t=this.getTotalLength(),e=d3.interpolateString("0,"+t,t+","+t);return function(t){return e(t)}}));var s=a.append("g").selectAll("g").data(e,(function(t){return t.name}));s.exit().remove(),s.enter().append("g").attr("class","mix-circles").merge(s).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").attr("class","clip-scatter-plot").attr("tip",(function(t,e){return e})).merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n(t.value)||0}));t._interrupt?r.transition().duration(0).delay(0).ease(d3.easeLinear).attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("r",(function(){var e=d3.interpolate(0,t._radius);return function(t){return e(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var u=a.selectAll(".clip-scatter-plot").nodes(),h=0;h<u.length;h++)""==u[h].__data__.value||isNaN(u[h].__data__.value)?d3.select(u[h]).style("opacity","0"):d3.select(u[h]).style("opacity","1");return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),oa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-tooltip"),i._width=0,i._height=0,i._shadowColor="#000",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=t._defs;n.selectAll("#bg").remove();var a=n.append("filter").attr("x","-15%").attr("y","-25%").attr("width","135%").attr("height","150%").attr("id","bg");a.append("feFlood").attr("flood-color","black"),a.append("feComposite").attr("in","SourceGraphic");var o=i.selectAll("text").attr("class","axis-tooltip-text").data(e);o.exit().remove();o.enter().append("g").append("text").merge(o).text((function(t){return t.text})).attr("filter","url(#bg)").style("fill","white").style("fill-opacity",1).style("opacity",.8).attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("dy","0.4em").attr("font-size",10).style("transition","transform 0.15s").on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"textLength",value:function(t){return arguments.length?(this._textLength=t,this):this._textLength}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"shadowColor",value:function(t){return arguments.length?(this._shadowColor=t,this):this._shadowColor}}]),e}(at);function ra(t,e){var i=0,n=[0];e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&"折线列"==t.name&&n.push(t.index)}));for(var a={},o=[],r=t.length,l=t[0],s=[],u=1;u<r;u++)s.push(t[u].length);s.sort((function(t,e){return e-t}));for(var c=[],h=0;h<r;h++)for(var d=0;d<s[0];d++)c.push(isNaN(parseFloat(t[h][d])));if(0==c.filter((function(t,e){return 0==t})).length)return[];for(var _=1;_<s[0];_++)if(_!==i){var f=l[_];""!=f&&null!=f&&null!=f||(f="$-"+_),-1!=n.indexOf(_)?a[f]={name:f,data:[],showLegend:f!="$-"+_,type:"折线列"}:a[f]={name:f,showLegend:f!="$-"+_,data:[]}}for(var p=1;p<r;p++){var y=t[p],x=y[i];if(""!=x&&null!=x&&null!=x||(x="&-"+p),x)for(var g=0;g<s[0];g++){var v=l[g];g!==i&&(""!=l[g]&&null!=l[g]&&null!=l[g]||(v="$-"+g),a[v].data.push({name:x,showAxisText:x!="&-"+p,value:y[g],tooltipValueShow:!isNaN(parseFloat(y[g]))}))}}for(var m in a)o.push(a[m]);return o.forEach((function(t,e){t.key=t.name+"-"+e})),o}var la=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","mix-line-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new ea(i.mainGroup),i.yAxisDoubleY=new ea(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.rectPlot=new ia(i.coreGroup),i.linePlot=new aa(i.coreGroup),i.scatterPlot=new Vt(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.textPlot=new na(i.coreGroup),i.stackText=new ae(i.coreGroup),i.overlay=new te(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i.yScaleRight=d3.scaleLinear(),i.axisTooltip=new oa(i.mainGroup),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._yOrientRight="right",i._sortValue=0,i._curve=null,i._histogramWidth=.7,i._yScaleHeight=1.05,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=3.5,i._barWidthPercent=.7,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._bardisplay=!1,i._barpositionOptions=["外部居上","内部居中","内部居下"],i._barpositionChoice="外部居上",i._linedisplay=!1,i._linepositionOptions=["上面","下面"],i._linepositionChoice="上面",i._lineWidth=2,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._barSuffix="",i._lineSuffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.yAxisDoubleY,a=t.xScale,o=t.yScale,r=t.yScaleRight,l=t._xType,s=t._yType,u=t._xOrient,c=t._yOrient,h=t._yOrientRight,d=t._fontSize,_=t.widthOfNoMargin,f=t.heightOfMainGroup;a.domain(t._xDomain),o.domain(t._yDomain),r.domain(t._yDomain1),e.scaleFunc(a).allowedMaxTextHeight(.3*f).type(l).orient(u).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(o).allowedMaxTextWidth(.5*_).type(s).orient(c).title(t._yLeftName).tickShow(t._yTickShowLeft).lineStroke(t._axisLineStrokeYL).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange(t._yRange).yAxisLineWidth(t._yAxisLineWidthLeft).axisLineShow(t._yAxisShowLeft).labelDirection(t._yLabelDirectionLeft).labelAngle(t._yLabelAngleLeft).countOfLabel(t._yCountOfLabelLeft).labelSuffix(t._yLabelSuffixLeft).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),n.scaleFunc(r).allowedMaxTextWidth(.5*_).type(s).orient(h).title(t._yRightName).times("second").tickShow(t._yTickShowRight).lineStroke(t._axisLineStrokeYR).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange(t._yRightRange).yAxisLineWidth(t._yAxisLineWidthRight).axisLineShow(t._yAxisShowRight).labelDirection(t._yLabelDirectionRight).labelAngle(t._yLabelAngleRight).countOfLabel(t._yCountOfLabelRight).labelSuffix(t._yLabelSuffixRight).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var p=(f-e.allowedMaxTextHeight())/(3*d);i.tickCount(p),n.tickCount(p),i.compute(),n.compute();var y=t.activeData,x=i.width,g=n.width;0==y.filter((function(t){return"折线列"==t.type})).length&&(x=i.width,g=t._yRightName?24:0),0==y.filter((function(t){return"折线列"!=t.type})).length&&(x=t._yLeftName?24:0,g=n.width),0==y.length&&(x=t.yAxis.width,g=t.yAxisDoubleY.width);var v=0,m=_-x-g;a.range([v,m]),e.compute();var b=e._axisStart,S=e._axisEnd;b<0&&(v=Math.abs(b)>x?Math.abs(b)-x:0),S>m+g&&(m-=S-m-g),t._xAxisEnd=m,a.range([v,m]),o.range([f-e.height,0]),r.range([f-e.height,0]);var k=x,w=f-e.height,C=x+v;e.translate(k,w),i.translate(C,0);var O=m+x;n.translate(O,0),0==y.length&&(e.translate(k,w),i.translate(C,0),n.translate(O,0)),e.update(),i.update(),n.update()}},{key:"updateCore",value:function(){var t=this,e=t.activeData,n=e,a=t.grid,o=t.tooltip,r=(t.axisTooltip,t.rectPlot),l=t.textPlot,s=t.linePlot,u=t.overlay,h=(t.scatterPlot,t.selectOverlay),d=t.guideLine,_=t.stackText,f=(t.clipArea,t.xScale),g=t.yScale,v=t.yScaleRight,m=1.2*Math.min(d3.min(e.filter((function(t){return"折线列"!=t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0);m<0?(t.group.selectAll(".mix-line-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(g.range()[0]-g(0))+")"),t.group.selectAll(".mix-line-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(g.range()[0]-g(0))+")")):(t.group.selectAll(".mix-line-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".mix-line-bar-chart .axis-x-line line").attr("transform","translate(0,0)"));var b=t.yAxis.width,S=t.yAxisDoubleY.width;0==e.filter((function(t){return"折线列"==t.type})).length&&(b=t.yAxis.width,S=t._yRightName?24:0),0==e.filter((function(t){return"折线列"!=t.type})).length&&(b=t._yLeftName?24:0,S=t.yAxisDoubleY.width),0==e.length&&(b=t.yAxis.width,S=t.yAxisDoubleY.width);t.xAxis._axisStart;var k=t.xAxis._axisEnd,w=0;k>t.widthOfNoMargin-b&&(w=k-(t.widthOfNoMargin-b));var C=t.widthOfNoMargin-b-S-w,O=t.heightOfCore,F=t.defs;F.selectAll("filter").remove();var L=F.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_line").attr("filterUnits","objectBoundingBox");if(L.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),L.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),L.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),L.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),L.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),a.width(C).height(O).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),0==e.filter((function(t){return"折线列"!=t.type})).length&&a.width(C).height(O).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxisDoubleY.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),u.data(f.domain()).isScalePoint(!1).bandX(f.range()[0]).bandWidth(f.step()).bandHeight(O).onMouseover((function(e,i){o.move([d3.event.offsetX,d3.event.offsetY]).show(),h.show();var n=t.elem.node().parentNode,a=(d3.mouse(n),i);d3.selectAll(t.group.selectAll(".mix-line-bar-chart .mix-line-bar-plot circle").nodes().filter((function(t,e){return d3.select(t).attr("tip")==a}))).attr("r",1.5*t._endPointRadius),d3.selectAll(t.group.selectAll(".mix-line-bar-chart .mix-line-bar-plot circle").nodes().filter((function(t,e){return d3.select(t).attr("tip")!=a}))).attr("r",t._endPointRadius)})).onMousemove((function(i,n){var a=t.elem.node().parentNode,r=(d3.mouse(a),d3.mouse(this)[0],d3.mouse(this)[1],f.step(),n),l=i,s=[{text:l=="&-"+(r+1)?"":l}];l&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===l}));s.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+f(l)+",0)")),o.data(s).update().move([d3.event.offsetX,d3.event.offsetY]),d3.selectAll(t.group.selectAll(".mix-line-bar-chart .mix-line-bar-plot circle").nodes().filter((function(t,e){return d3.select(t).attr("tip")==r}))).attr("r",1.5*t._endPointRadius),d3.selectAll(t.group.selectAll(".mix-line-bar-chart .mix-line-bar-plot circle").nodes().filter((function(t,e){return d3.select(t).attr("tip")!=r}))).attr("r",t._endPointRadius)})).onMouseout((function(){o.hide(),h.hide(),d3.selectAll(t.group.selectAll(".mix-line-bar-chart .mix-line-bar-plot circle").nodes()).attr("r",t._endPointRadius)})),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var P=x(t._strokeColor),A=[],W=!0,z=!1,M=void 0;try{for(var D,R=P[Symbol.iterator]();!(W=(D=R.next()).done);W=!0){var N=D.value,T=[],B=N.split(":");T.push(q(B[0])),T.push(B[1]),A.push(T)}}catch(t){z=!0,M=t}finally{try{!W&&R.return&&R.return()}finally{if(z)throw M}}var G=A.concat(),X=G.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(X[1]).x1+"%").attr("y1",y(X[1]).y1+"%").attr("x2",y(X[1]).x2+"%").attr("y2",y(X[1]).y2+"%").selectAll("stop").data(G).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var j=x(t._fillColor),I=[],Y=!0,H=!1,V=void 0;try{for(var $,U=j[Symbol.iterator]();!(Y=($=U.next()).done);Y=!0){var Z=$.value,Q=[],K=Z.split(":");Q.push(q(K[0])),Q.push(K[1]),I.push(Q)}}catch(t){H=!0,V=t}finally{try{!Y&&U.return&&U.return()}finally{if(H)throw V}}var J=I.concat(),tt=J.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-2").attr("x1",y(tt[1]).x1+"%").attr("y1",y(tt[1]).y1+"%").attr("x2",y(tt[1]).x2+"%").attr("y2",y(tt[1]).y2+"%").selectAll("stop").data(J).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}r.data(n.filter((function(t){return"折线列"!=t.type}))).xScale(f).yScale(g).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._bardisplay).positionOptions(t._barpositionOptions).positionChoice(t._barpositionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(t._borderColor).fillOpacity(t._fillOpacity).textObj({colorFunc:function(){return q(t._textLabel.color)}}),s.data(e.filter((function(t){return"折线列"==t.type}))).xScale(f).yScale(v).labelShow(t._linedisplay).positionOptions(t._linepositionOptions).positionChoice(t._linepositionChoice).lineWidth(t._lineWidth).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).curve(t._curve).radius(t._endPointRadius).stroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._strokeColor).fill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-2")+")":t._fillColor).lineWidth(t._lineWidth).strokeWidth(t._strokeWidth).lineFunc(d3.line().x((function(t){return f(t.name)})).y((function(t){return v(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}))),d.x1(0).x2(C).strokeDasharray(t._gridStrokeDasharray),l.data(n.filter((function(t){return"折线列"!=t.type}))).xScale(f).yScale(g).barSuffix(t._barSuffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._bardisplay).positionOptions(t._barpositionOptions).positionChoice(t._barpositionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).borderWidth(t._borderWidth).borderColor(t._borderColor).textObj({colorFunc:function(){return q(t._textLabel.color)}}).fillOpacity(1).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),_.data(e.filter((function(t){return"折线列"==t.type}))).xScale(f).yScale(v).type("mix").suffix(t._lineSuffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._linedisplay).positionOptions(t._linepositionOptions).positionChoice(t._linepositionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),h.width(f.step()).height(O).shadowColor("#ccc").hide(),t.coreGroup.attr("transform","translate("+b+",0)");var et=t.group.selectAll(".mix-line-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));(d3.selectAll(et).remove(),r.update(),s.translate(f.step()/2,0).update(),t.group.selectAll(".mix-line-bar-chart .mix-line-bar-plot circle").attr("transform","translate("+-f.step()/2+", 0)"),l.update(),_.update(),h.update(),u.update(),a.translate(b,0).update(),0!=t._yRange.length)?(t.mainGroup.selectAll(".clip-defs-bar").remove(),t.mainGroup.append("defs").attr("class","clip-defs-bar").append("clipPath").attr("id","clip-overlay-bar-"+t.id).append("rect").attr("x",f.range()[0]).attr("y",0).attr("height",O).attr("width",C-f.range()[0]),t.coreGroup.select(".mix-line-bar-rect").attr("clip-path","url("+c("#clip-overlay-bar-"+t.id)+")"),t.coreGroup.select(".mix-line-bar-text").attr("clip-path","url("+c("#clip-overlay-bar-"+t.id)+")")):(t.coreGroup.select(".mix-line-bar-rect").attr("clip-path",""),t.coreGroup.select(".mix-line-bar-text").attr("clip-path",""));((null==t._yRange[0]&&null==t._yRange[1]||""==t._yRange[0]&&""==t._yRange[1]||null==t._yRange[0]&&null==t._yRange[1])&&(t.coreGroup.select(".mix-line-bar-rect").attr("clip-path",""),t.coreGroup.select(".mix-line-bar-text").attr("clip-path","")),0!=t._yRightRange.length)?(t.mainGroup.selectAll(".clip-defs-line").remove(),t.mainGroup.append("defs").attr("class","clip-defs-line").append("clipPath").attr("id","clip-overlay-line-"+t.id).append("rect").attr("x",2*-t._endPointRadius+f.range()[0]).attr("y",0).attr("height",O).attr("width",C+2*parseFloat(t._endPointRadius)-f.range()[0]),t.coreGroup.select(".mix-line-bar-plot").attr("clip-path","url("+c("#clip-overlay-line-"+t.id)+")"),t.coreGroup.select(".stack-texts").attr("clip-path","url("+c("#clip-overlay-line-"+t.id)+")")):(t.coreGroup.select(".mix-line-bar-plot").attr("clip-path",""),t.coreGroup.select(".stack-texts").attr("clip-path",""));(null==t._yRightRange[0]&&null==t._yRightRange[1]||""==t._yRightRange[0]&&""==t._yRightRange[1]||null==t._yRightRange[0]&&null==t._yRightRange[1])&&(t.coreGroup.select(".mix-line-bar-plot").attr("clip-path",""),t.coreGroup.select(".stack-texts").attr("clip-path","")),m<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",f.range()[0]).attr("y1",g.range()[0]).attr("x2",f.range()[1]).attr("y2",g.range()[0]).attr("stroke",t._axisLineStrokeX)):t.coreGroup.selectAll(".fake-x-line").remove();var it=t.group.selectAll(".mix-line-bar-texts").nodes(),nt=t.group.selectAll(".ranking-text-group text").nodes(),at=it.concat(nt),ot=d3.selectAll(at);if(null==t._barpositionOptions||null==t._barpositionChoice||-1==t._barpositionOptions.indexOf(t._barpositionChoice))t.group.selectAll(".mixLineBarTexts").style("display","none");else if(0==t._barpositionOptions.indexOf(t._barpositionChoice)||1==t._barpositionOptions.indexOf(t._barpositionChoice)){for(var rt=[],lt=[],st=0;st<ot._groups[0].length;st++){lt.push(st);for(var ut=st+1;ut<ot._groups[0].length;ut++){p(i(d3.select(ot._groups[0][st])),i(d3.select(ot._groups[0][ut])))&&(rt.push(st),d3.select(ot._groups[0][st]).style("visibility","hidden"))}}for(var ct=new Set(rt),ht=Array.from(ct),dt=Bt(ht,lt),_t=0;_t<ht.length;_t++){for(var ft=[],pt=0;pt<dt.length;pt++){var yt=i(d3.select(ot._groups[0][ht[_t]])),xt=i(d3.select(ot._groups[0][dt[pt]]));if(ft.push(p(yt,xt)),p(yt,xt)){if(ht[_t]==dt[pt])continue;d3.select(ot._groups[0][ht[_t]]).style("visibility","hidden")}}0==ft.filter((function(t){return 1==t})).length&&dt.push(ht[_t])}for(var gt=0;gt<dt.length;gt++)d3.select(ot._groups[0][dt[gt]]).style("visibility","visible")}else if(2==t._barpositionOptions.indexOf(t._barpositionChoice)){for(var vt=[],mt=[],bt=0;bt<ot._groups[0].length;bt++){mt.push(bt);for(var St=bt+1;St<ot._groups[0].length;St++){var kt=i(d3.select(ot._groups[0][bt])),wt=i(d3.select(ot._groups[0][St]));if(bt<it.length){var Ct=kt.width;kt.width=kt.height,kt.height=Ct,kt.x=kt.x-kt.width/2,kt.y=kt.y-kt.height}if(St<it.length){var Ot=wt.width;wt.width=wt.height,wt.height=Ot,wt.x=wt.x-wt.width/2,wt.y=wt.y-wt.height}p(kt,wt)&&(vt.push(bt),d3.select(ot._groups[0][bt]).style("visibility","hidden"))}}for(var Ft=new Set(vt),Lt=Array.from(Ft),Pt=Bt(Lt,mt),At=0;At<Lt.length;At++){for(var Wt=[],zt=0;zt<Pt.length;zt++){var Mt=i(d3.select(ot._groups[0][Lt[At]])),Dt=i(d3.select(ot._groups[0][Pt[zt]]));if(Lt[At]<it.length){var Rt=Mt.width;Mt.width=Mt.height,Mt.height=Rt,Mt.x=Mt.x-Mt.width/2,Mt.y=Mt.y-Mt.height}if(Pt[zt]<it.length){var Nt=Dt.width;Dt.width=Dt.height,Dt.height=Nt,Dt.x=Dt.x-Dt.width/2,Dt.y=Dt.y-Dt.height}if(Wt.push(p(Mt,Dt)),p(Mt,Dt)){if(Lt[At]==Pt[zt])continue;d3.select(ot._groups[0][Lt[At]]).style("visibility","hidden")}}0==Wt.filter((function(t){return 1==t})).length&&Pt.push(Lt[At])}for(var Tt=0;Tt<Pt.length;Tt++)d3.select(ot._groups[0][Pt[Tt]]).style("visibility","visible")}function Bt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y,o=i.y1,r=t.axisCopy,l=r.yl||{},s=r.yr||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeYL(q(l.axisColor)||q(i.color)).axisLineStrokeYR(q(s.axisColor)||q(i.color)).xTitle(n.name).xTickShow(n.labelShow).yTickShowLeft(a?a.labelShow:l.labelShow).yTickShowRight(a?a.labelShow:s.labelShow).xRange(n.range?n.range:[]).yRange(a?a.range:l.range).yRightRange(o?o.range:s.range).yLeftName(a?a.leftName:l.name).yLeftTitle(a?a.leftTitle:l.labelSuffix).yRightName(a?a.rightName:s.name).yRightTitle(a?a.rightTitle:s.labelSuffix).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidthLeft(a?a.axisLineWidth:l.axisLineWidth).yAxisLineWidthRight(a?a.axisLineWidth:s.axisLineWidth).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShowLeft(a?a.axisShow:l.axisShow).yAxisShowRight(a?a.axisShow:s.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirectionLeft(l.labelDirection?l.labelDirection:"自动").yLabelAngleLeft(0==l.labelAngle||l.labelAngle?l.labelAngle:0).yCountOfLabelLeft(0==l.stepOfLabel||l.stepOfLabel?l.stepOfLabel:null).yLabelSuffixLeft(l.labelSuffix?l.labelSuffix:"").yLabelDirectionRight(s.labelDirection?s.labelDirection:"自动").yLabelAngleRight(0==s.labelAngle||s.labelAngle?s.labelAngle:0).yCountOfLabelRight(0==s.stepOfLabel||s.stepOfLabel?s.stepOfLabel:null).yLabelSuffixRight(s.labelSuffix?s.labelSuffix:"")}},{key:"yLabelDirectionLeft",value:function(t){return arguments.length?(this._yLabelDirectionLeft=t,this):this._yLabelDirectionLeft}},{key:"yLabelAngleLeft",value:function(t){return arguments.length?(this._yLabelAngleLeft=parseFloat(t),this):this._yLabelAngleLeft}},{key:"yCountOfLabelLeft",value:function(t){return arguments.length?(this._yCountOfLabelLeft=parseFloat(t),this):this._yCountOfLabelLeft}},{key:"yLabelSuffixLeft",value:function(t){return arguments.length?(this._yLabelSuffixLeft=t,this):this._yLabelSuffixLeft}},{key:"yLabelDirectionRight",value:function(t){return arguments.length?(this._yLabelDirectionRight=t,this):this._yLabelDirectionRight}},{key:"yLabelAngleRight",value:function(t){return arguments.length?(this._yLabelAngleRight=parseFloat(t),this):this._yLabelAngleRight}},{key:"yCountOfLabelRight",value:function(t){return arguments.length?(this._yCountOfLabelRight=parseFloat(t),this):this._yCountOfLabelRight}},{key:"yLabelSuffixRight",value:function(t){return arguments.length?(this._yLabelSuffixRight=t,this):this._yLabelSuffixRight}},{key:"yAxisShowLeft",value:function(t){return arguments.length?(this._yAxisShowLeft=t,this):this._yAxisShowLeft}},{key:"yAxisShowRight",value:function(t){return arguments.length?(this._yAxisShowRight=t,this):this._yAxisShowRight}},{key:"yAxisLineWidthLeft",value:function(t){return arguments.length?(this._yAxisLineWidthLeft=t,this):this._yAxisLineWidthLeft}},{key:"yAxisLineWidthRight",value:function(t){return arguments.length?(this._yAxisLineWidthRight=t,this):this._yAxisLineWidthRight}},{key:"yRightRange",value:function(t){return arguments.length?(this._yRightRange=t,this):this._yRightRange}},{key:"yTickShowRight",value:function(t){return arguments.length?(this._yTickShowRight=t,this):this._yTickShowRight}},{key:"yTickShowLeft",value:function(t){return arguments.length?(this._yTickShowLeft=t,this):this._yTickShowLeft}},{key:"axisLineStrokeYL",value:function(t){return arguments.length?(this._axisLineStrokeYL=t,this):this._axisLineStrokeYL}},{key:"axisLineStrokeYR",value:function(t){return arguments.length?(this._axisLineStrokeYR=t,this):this._axisLineStrokeYR}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=ra;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"",this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._borderWidth,this._borderColor=e.barborderColor?q(e.barborderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._bardisplay=i?i.bardisplay:this._bardisplay,this._linedisplay=i?i.linedisplay:this._linedisplay,this._barpositionChoice=i.barpositionChoice?i.barpositionChoice:this._barpositionChoice,this._linepositionChoice=i.linepositionChoice?i.linepositionChoice:this._linepositionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._barSuffix=i.barSuffix?i.barSuffix:"",this._lineSuffix=i.lineSuffix?i.lineSuffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=t._yRightRange||[],a=e.length?e[0].data.map((function(t){return t.name})):[0,1],o=e.length?[1.2*Math.min(d3.min(e.filter((function(t){return"折线列"!=t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*Math.max(d3.max(e.filter((function(t){return"折线列"!=t.type})),(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1],r=e.length?[1.2*Math.min(d3.min(e.filter((function(t){return"折线列"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*Math.max(d3.max(e.filter((function(t){return"折线列"==t.type})),(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1];t._xDomain=a,t._yDomain=isNaN(o[0])&&isNaN(o[1])?o:[isNaN(parseFloat(i[0]))?o[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?o[1]:o[1]<i[0]?1.5*i[0]:o[1]:parseFloat(i[1])],t._yDomain1=isNaN(r[0])&&isNaN(r[1])?r:[isNaN(parseFloat(n[0]))?r[0]:parseFloat(n[0]),isNaN(parseFloat(n[1]))?isNaN(parseFloat(n[0]))?r[1]:r[1]<n[0]?1.5*n[0]:r[1]:parseFloat(n[1])]}}]),e}(Tt),sa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","deformed-pie"),i._stroke="#fff",i._strokeWidth=1,i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._padRadius=null,i._radius=0,i._cornerRadius=0,i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t._startAngle,a=t._endAngle,o=d3.max(e,(function(t){return Math.abs(t.value)})),r=t._radius,l=d3.scaleLinear().domain([0,o]).range([t._innerRadius,r]);"area"==t._type&&(l=d3.scaleSqrt().domain([0,o]).range([t._innerRadius,r]));var s=t.arcFunc.innerRadius(t._innerRadius).outerRadius((function(t,e){return l(Math.abs(t.data.value))})).cornerRadius(t._cornerRadius).padAngle(t._padAngle).padRadius(t._padRadius),u=t.pieFunc.value(1).startAngle(n).endAngle(a).sort(t._sortMethod);if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var h=t.group.selectAll("g.arc-group").data(u(e));h.exit().remove();var d=h.enter().append("g").attr("class","arc-group");d.append("path"),h.merge(d).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).select("path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).transition().duration(0).ease(d3.easeLinear).attrTween("d",(function(e){var i=d3.interpolateNumber(t._innerRadius,l(Math.abs(e.data.value)));return function(t){var n=i(t);return s.outerRadius(n),s(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(0==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var _=t.group.selectAll("path").data(u(e));_.exit().remove();var f=_.merge(_.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?f.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):f.transition().duration((function(i,n){return t._transition?function(i){for(var n=0,a=0;a<i;a++)n=e[a].percent/100;return n*(t._transition?.9*t._duration:0)}(n+1):0})).ease(d3.easeLinear).delay((function(i,n){return(t._transition?t._startDelay:0)+function(i){for(var n=0,a=0;a<i;a++)n+=e[a].percent/100;return n*(t._transition?.9*t._duration:0)}(n)})).attrTween("d",(function(t){var e=d3.interpolate(t.startAngle,t.endAngle);return function(i){return t.endAngle=e(i),s.outerRadius(l(Math.abs(t.data.value))),s(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(1==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var g=t.group.selectAll("path").data(u(e));g.exit().remove();var v=g.merge(g.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?v.transition().duration(0).ease(d3.easeCubicOut).delay(0).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):v.transition().duration(t._transition?.9*t._duration:0).ease(d3.easeCubicOut).delay(t._transition?t._startDelay:0).attrTween("d",(function(t){var e=d3.interpolate(t.startAngle,t.endAngle);return function(i){return t.endAngle=e(i),s.outerRadius(l(Math.abs(t.data.value))),s(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(2==t._moveOptions.indexOf(t._moveStyle)){t.group.selectAll(".pie-path").remove();var m=t.group.selectAll("path").data(u(e));m.exit().remove();var b=m.merge(m.enter().append("path")).attr("class","pie-path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?b.transition().duration(0).ease(d3.easeLinear).delay(0).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):b.transition().duration(t._transition?.9*t._duration:0).ease(d3.easeLinear).delay((function(e,i){return t._transition?t._startDelay:0})).attrTween("d",(function(t){var e=d3.interpolate(0,t.startAngle),i=d3.interpolate(0,t.endAngle);return function(n){return t.startAngle=e(n),t.endAngle=i(n),s.outerRadius(l(Math.abs(t.data.value))),s(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}else if(3==t._moveOptions.indexOf(t._moveStyle)){var S=t.group.selectAll("g.arc-group").data(u(e));S.exit().remove();var k=S.enter().append("g").attr("class","arc-group");k.append("path");var w=S.merge(k).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?w.select("path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).transition().duration(0).delay(0).ease(d3.easeLinear).attr("d",(function(e){return t.arcFunc(e)})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):w.select("path").style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.color&&/\[/.test(e.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.color&&/#/.test(e.data.color)?e.data.color:"rgb("+U(e.data.color,0)+","+U(e.data.color,1)+","+U(e.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.color&&/#/.test(e.data.color))return t._fillOpacity;var i=U(e.data.color,3)||1;return t._fillOpacity*i})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("d",(function(e){var i=d3.interpolateNumber(t._innerRadius,l(Math.abs(e.data.value)));return function(t){var n=i(t);return s.outerRadius(n),s(e)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}if(t.group.selectAll(".pie-texts").remove(),t.group.selectAll(".pie-percents").remove(),t.group.selectAll(".pie-numbers").remove(),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none");else if(1==t._positionOptions.indexOf(t._positionChoice)){var C=t.group.append("g").selectAll("g").data(u(e));C.exit().remove(),C.enter().append("g").attr("class","pie-text-groups").merge(C).each((function(e,i){d3.select(this).append("g").attr("class","pie-texts").append("text").text(t._limitWidth?X(e.data.name,t._limitWidth,t._fontSize,t._fontFamily):e.data.name).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]-1.3*t._fontSize})).style("opacity",(function(){return-1!=String(e.data.name).indexOf("$-")?0:1})),d3.select(this).append("g").attr("class","pie-percents").append("text").text(t._limitWidth?X(E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._limitWidth,t._fontSize,t._fontFamily):E(e.data.percent,t._numberStyle,t._decimalPlaces)+"%").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return j(t)[0]})).attr("y",(function(t){return j(t)[1]})),d3.select(this).append("g").attr("class","pie-numbers").append("text").text(t._limitWidth?X(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._limitWidth,t._fontSize,t._fontFamily):E(e.data.value,t._numberStyle,t._decimalPlaces)).attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("text-anchor","middle").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]+1.3*t._fontSize}))})),1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(t){return j(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(t){return j(t)[1]})),t.group.selectAll(".pie-texts text").style("display","none"),t.group.selectAll(".pie-numbers text").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(t){return j(t)[1]})),t.group.selectAll(".pie-percents text").style("display","none"),t.group.selectAll(".pie-texts text").style("display","none")):2==t._contentChoice.length&&(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(t.group.selectAll(".pie-texts text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-percents text").style("display","none")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(t.group.selectAll(".pie-percents text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]-t._fontSize/1.7})),t.group.selectAll(".pie-numbers text").style("display","block").attr("x",(function(t){return j(t)[0]})).attr("y",(function(e){return j(e)[1]+t._fontSize/1.7})),t.group.selectAll(".pie-texts text").style("display","none")))}t._interrupt?t.group.selectAll(".pie-text-groups").style("opacity",1):t.group.selectAll(".pie-text-groups").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._duration?t._startDelay+.9*t._duration:0})).style("opacity",1);for(var O=t.group.selectAll(".pie-text-groups"),F=[],L=[],P=0;P<O._groups[0].length;P++){L.push(P);for(var A=P+1;A<O._groups[0].length;A++){p(i(d3.select(O._groups[0][P])),i(d3.select(O._groups[0][A])))&&(F.push(P),d3.select(O._groups[0][P]).style("visibility","hidden"))}}for(var W=new Set(F),z=Array.from(W),M=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(z,L),D=0;D<z.length;D++){for(var R=[],N=0;N<M.length;N++){var T=i(d3.select(O._groups[0][z[D]])),B=i(d3.select(O._groups[0][M[N]]));if(R.push(p(T,B)),p(T,B)){if(z[D]==M[N])continue;d3.select(O._groups[0][z[D]]).style("visibility","hidden")}}0==R.filter((function(t){return 1==t})).length&&M.push(z[D])}for(var G=0;G<M.length;G++)d3.select(O._groups[0][M[G]]).style("visibility","visible");function j(e){var i=l(Math.abs(e.data.value))*(t._innerRadiusRatio?t._innerRadiusRatio+(1-t._innerRadiusRatio)/2:.7),n=(e.startAngle+e.endAngle)/2-Math.PI/2;return[Math.cos(n)*i,Math.sin(n)*i]}}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"limitWidth",value:function(t){return arguments.length?(this._limitWidth=t,this):this._limitWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),ua=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","deformed-pie-text"),i._stroke="#fff",i._strokeWidth=1,i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._suffix="",i._radius=0,i._cornerRadius=0,i.arcFunc=d3.arc(),i.pieFunc=d3.pie(),i._rotateDirection="clockwise",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._startAngle,n=t._endAngle,a=d3.max(e,(function(t){return Math.abs(t.value)})),o=t._radius,r=d3.scaleLinear().domain([0,a]).range([t._innerRadius,o]);t.group.interrupt().selectAll("*").interrupt(),t.group.selectAll("*").remove();t.arcFunc.innerRadius(t._innerRadius).outerRadius((function(t){return r(Math.abs(t.data.value))})).cornerRadius(t._cornerRadius);var l=t.pieFunc.value(1).startAngle(i).endAngle(n).sort(t._sortMethod),s=t.group.selectAll("g.arc-text-group").data(l(e));s.exit().remove();var u=s.enter().append("g").attr("class","arc-text-group");u.append("g");var c=s.merge(u).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?c.select("g").transition().duration(0).delay(0).ease(d3.easeLinear).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):c.select("g").transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay+.1*t._duration:0).ease(d3.easeLinear).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),ca=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","deformed-pie-chart"),e.core=e.rose=new sa(e.mainGroup),e.lineText=new lt(e.mainGroup),e.roseText=new ua(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._padAngle=0,e._innerRadiusRatio=0,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=1,e._fillOpacity=1,e._type="diameter",e._labelShow=!0,e._positionOptions=["内部径向","内部水平","外部"],e._positionChoice="内部径向",e._contentOption=["名称","百分比","数值"],e._contentChoice=["名称","百分比"],e._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["轮子","百叶窗","折扇","径向展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){for(var t=this,i=t.rose,n=t.lineText,a=t.roseText,o=t._startAngle,r=t._endAngle,l=t.widthOfNoMargin,u=t.heightOfMainGroup,h=t._fontSize,d=(t.legend.height(),[]),_=0;_<t.activeData.length;_++)d.push(parseFloat(t.activeData[_].value));for(var f=0,p=0;p<t.activeData.length;p++)f+=parseFloat(t.activeData[p].value);for(var g=0;g<t.activeData.length;g++)t.activeData[g].percent=-1==String(t.activeData[g].value/f*100).indexOf(".")?parseFloat(t.activeData[g].value/f*100):parseFloat((t.activeData[g].value/f*100).toFixed(2));var v=t.activeData.sort((function(t,e){return e.index-t.index}));v.unshift(v[v.length-1]),v.pop(v[v.length-1]);var m=.88*t.heightOfMainGroup,b=.88*t.widthOfNoMargin;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)m=.88*t.heightOfMainGroup,b=.88*t.widthOfNoMargin;else if(0==t._labelShow||0==t._positionOptions.indexOf(t._positionChoice)||1==t._positionOptions.indexOf(t._positionChoice)||-1==t._positionOptions.indexOf(t._positionChoice))m=.88*t.heightOfMainGroup,b=.88*t.widthOfNoMargin;else{var S=[];if(2==t._positionOptions.indexOf(t._positionChoice))if(1==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0]))for(var k=0;k<v.length;k++)S.push(v[k].name);else if(1==t._contentOption.indexOf(t._contentChoice[0]))for(var w=0;w<v.length;w++)S.push(E(v[w].percent,t._numberStyle,t._decimalPlaces)+"%");else if(2==t._contentOption.indexOf(t._contentChoice[0]))for(var C=0;C<v.length;C++)S.push(E(v[C].value,t._numberStyle,t._decimalPlaces)+t._suffix)}else if(2==t._contentChoice.length){if(0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var O=0;O<v.length;O++)S.push(v[O].name),S.push(E(v[O].percent,t._numberStyle,t._decimalPlaces)+"%");else if(0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1]))for(var F=0;F<v.length;F++)S.push(v[F].name),S.push(E(v[F].value,t._numberStyle,t._decimalPlaces)+t._suffix);else if(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))for(var L=0;L<v.length;L++)S.push(E(v[L].value,t._numberStyle,t._decimalPlaces)+t._suffix),S.push(E(v[L].percent,t._numberStyle,t._decimalPlaces)+"%")}else for(var P=0;P<v.length;P++)S.push(v[P].name),S.push(E(v[P].value,t._numberStyle,t._decimalPlaces)+t._suffix),S.push(E(v[P].percent,t._numberStyle,t._decimalPlaces)+"%");var A=G(S,t._textLabel.fontSize,t._textLabel.fontFamily);A>.4*t.widthOfNoMargin&&(A=.4*t.widthOfNoMargin),m=.74*t.heightOfMainGroup,b=.85*t.widthOfNoMargin-2*A}var W=b,z=m,M=s(W,z,o,r),R=M.radius,N=M.cx,T=M.cy,B=R+h,X=t.defs;X.selectAll("filter").remove();var j=X.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_deform").attr("filterUnits","objectBoundingBox");j.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),j.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),j.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),j.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),j.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var I=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*R:0);if(t._stroke&&/\[/.test(t._stroke)){var Y=x(t._stroke),H=[],V=!0,$=!1,U=void 0;try{for(var Z,Q=Y[Symbol.iterator]();!(V=(Z=Q.next()).done);V=!0){var K=Z.value,J=[],tt=K.split(":");J.push(q(tt[0])),J.push(tt[1]),H.push(J)}}catch(t){$=!0,U=t}finally{try{!V&&Q.return&&Q.return()}finally{if($)throw U}}var et=H.concat(),it=et.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(it[1]).x1+"%").attr("y1",y(it[1]).y1+"%").attr("x2",y(it[1]).x2+"%").attr("y2",y(it[1]).y2+"%").selectAll("stop").data(et).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(v).radius(R).innerRadius(I).innerRadiusRatio(t._innerRadiusRatio).type(t._type).fontSize(t._textLabel.fontSize).fontFamily(t._textLabel.fontFamily).fontColor(q(t._textLabel.color)).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).startAngle(o).endAngle(r).padAngle(t._padAngle).fillOpacity(t._fillOpacity).cornerRadius(t._cornerRadius).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){d3.select(this).transition().style("opacity",.8);var n=[{text:""+(-1!=String(e.data.name).indexOf("$-")?"":e.data.name),color:e.data.color},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().style("opacity",1),t.tooltip.hide()})),a.data(v).radius(R).innerRadius(I).startAngle(o).endAngle(r).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).onTransitionEnd((function(i,n){var a=t.roseText.arcFunc.outerRadius()(i),o=d3.select(this.parentNode),r=i.startAngle,l=i.endAngle,s="arc-path-"+i.data.key+"-"+t.id,u=e(a-h,r+.015,l-.015),c=t.defs.select("#"+s).empty()?t.defs.append("path").attr("d",u).attr("id",s):t.defs.select("#"+s).attr("d",u);0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||null==t._contentOption||null==t._contentChoice||1==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length?t.group.selectAll(".chart-label-text").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)&&(1==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])?D(o,c,-1!=String(i.data.name).indexOf("$-")?"":i.data.name,t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):1==t._contentOption.indexOf(t._contentChoice[0])?D(o,c,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentOption.indexOf(t._contentChoice[0])&&D(o,c,E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily):2==t._contentChoice.length?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(o,c,(-1!=String(i.data.name).indexOf("$-")?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%",t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?D(o,c,(-1!=String(i.data.name).indexOf("$-")?"":i.data.name+"  ")+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&D(o,c,E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","middle").attr("xml:space","preserve"):3==t._contentChoice.length&&D(o,c,(-1!=String(i.data.name).indexOf("$-")?"":i.data.name+"  ")+E(i.data.percent,t._numberStyle,t._decimalPlaces)+"%  "+(E(i.data.value,t._numberStyle,t._decimalPlaces)+t._suffix),t._textLabel.fontSize,t._textLabel.fontFamily,"53%").attr("class",t.labelTextClass).style("pointer-events","none").style("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).attr("text-anchor","start").attr("xml:space","preserve"))}));var nt=(l-W)/2+N,at=(u-z)/2+T,ot=(B-R)/2;switch(M.quadrant){case 4:nt+=ot,at+=ot;break;case 1:nt-=ot,at+=ot;break;case 2:nt-=ot,at-=ot;break;case 3:nt+=ot,at-=spcae}if(null!=t._labelShow)if(0!=t._labelShow&&2==t._positionOptions.indexOf(t._positionChoice)){var rt=t.activeData.sort((function(t,e){return e.index-t.index}));rt.unshift(rt[rt.length-1]),rt.pop(rt[rt.length-1]),n.data(rt).outerRadius(R).type("change").sizeType(t._type).innerRadius(I).cornerRadius(t._cornerRadius).startAngle(o).endAngle(r).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).values(d).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).limitWidth(.4*t.widthOfNoMargin).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.lineText.translate(nt||0,at).update(),t.group.selectAll(".outside-text-polygon").attr("display","block")}else 0!=t._labelShow&&0!=t._positionOptions.indexOf(t._positionChoice)&&1!=t._positionOptions.indexOf(t._positionChoice)&&-1!=t._positionOptions.indexOf(t._positionChoice)||t.group.selectAll(".outside-text-polygon").attr("display","none");i.translate(nt||0,at).update(),a.translate(nt,at).update()}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(e).length&&(this.innerRadiusRatio(d(0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(d(0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._cornerRadius)).strokeWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._areaBorderWidth)).stroke(q(e.borderColor)||"").type(e.sectorSizeType||this._type).padAngle(0==parseFloat(e.gapPercentage)||e.gapPercentage?e.gapPercentage/10:this._padAngle),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}}]),i}(nt),ha=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._padAngle=.01,i._labelRadiusRatio=.87,i._innerRadiusRatio=.75,i._cornerRadius=null,i._areaBorderColor="#fff",i._areaBorderWidth=0,i._fillOpacity=1,i._labelShow=!0,i._positionOptions=["外部","内部"],i._positionChoice="内部",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["轮子","百叶窗","折扇","径向展开"],i._moveStyle="径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this.innerRadiusRatio(d(0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio)).cornerRadius(d(0==e.cornerRadius||e.cornerRadius?e.cornerRadius:this._cornerRadius)).areaBorderWidth(d(0==e.borderWidth||e.borderWidth?e.borderWidth:this._areaBorderWidth)).areaBorderColor(q(e.borderColor)||"").padAngle(0==parseFloat(e.gapPercentage)||e.gapPercentage?e.gapPercentage/10:this._padAngle),this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),e}(st),da=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","funnel-polygon"),i._fontColor="#ffffff",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=d3.max(e,(function(t){return Math.abs(t.value)})),n=e.length>0?e[0].value:0,a=d3.scaleLinear().domain([0,i]).range([0,t._sWidth]),o=(t._sHeight>0?t._sHeight-(e.length-1)*t._paddingInner:0)/e.length;o=o>0?o:0;for(var r=t.group,l=[],s=0;s<e.length;s++)e[s].percent=-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)),l.push(-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)));t.group.selectAll("*").remove(),t.group.selectAll(".funnel-groups").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var u=r.selectAll("polygon").data(e);u.exit().remove();var h=u.enter().append("g").attr("class","funnel-groups").attr("transform",(function(e,i){return"translate(0, "+i*t._paddingInner+")"}));if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle))h.append("polygon").merge(u).attr("class","funnel-polygons").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).style("opacity",1).attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);else if(1==t._moveOptions.indexOf(t._moveStyle)){var d=h.append("polygon").merge(u).attr("class","funnel-polygons").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).style("opacity",1).attr("points",(function(i,r){return r==e.length-1?a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r:a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)/2+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)/2+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*r})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);t._interrupt?d.attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)})):d.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)}))}var _=t._defs;_.selectAll("filter").remove();var f=_.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_funnel").attr("filterUnits","objectBoundingBox");if(f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),f.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),f.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),f.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),f.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".funnel-text-group").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var p=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);if(t._interrupt?p.style("opacity",1):p.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),p.append("text").text((function(t,e){return t.name=="$-"+e?"":t.name})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","0.3em").style("display",t._labelShow?"block":"none"),p.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","0.3em").style("display",t._labelShow?"block":"none"),p.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","0.3em").style("display",t._labelShow?"block":"none"),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none");else if(1==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block"));else if(2==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),r.selectAll(".funnel-texts-value").style("display","none"),p.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),p.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),p.attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"})));else if(3==t._contentChoice.length&&t._labelShow){for(var g=r.selectAll(".funnel-texts-name").nodes(),v=r.selectAll(".funnel-texts-value").nodes(),m=0;m<l.length;m++)d3.select(g[m]).attr("text-anchor","end").attr("dx",-R(E(l[m],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2-parseFloat(t._fontSize)),d3.select(v[m]).attr("text-anchor","start").attr("dx",R(E(l[m],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2+parseFloat(t._fontSize));r.selectAll(".funnel-texts-percent"),p.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))}}else if(1==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var b=0,S=0;t._labelShow&&(3==t._contentChoice.length?b=(null==t._decimalPlaces?0:t._decimalPlaces)*t._fontSize*2:(2==t._contentChoice.length||1==t._contentChoice.length&&0!=t._contentOption.indexOf(t._contentChoice[0]))&&(b=(null==t._decimalPlaces?0:t._decimalPlaces)*t._fontSize)),b>.15*t._width&&(S=b-.15*t._width);var k=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);t._interrupt?k.style("opacity",1):k.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),k.append("line").attr("class","funnel-texts-line").attr("x1",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)})).attr("y1",(function(t,e){return o*(e+1)-o/2})).attr("x2",(function(e,i){return.78*t._width-S})).attr("y2",(function(t,e){return o*(e+1)-o/2})).style("stroke",(function(t){return"#bfbfbf"})).style("stroke-width",1).style("display",t._labelShow?"block":"none"),k.append("text").text((function(e,i){return X(e.name=="$-"+i?"":e.name,.18*t._width,t._fontSize,t._fontFamily)})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return.78*t._width-S})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","-0.35em").style("display",t._labelShow?"block":"none"),k.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return.78*t._width-S})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.75em").style("display",t._labelShow?"block":"none"),k.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return.78*t._width-S})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.75em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)+5)+",0)"})),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","0.35em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","0.35em"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.35em").attr("transform","translate(0, 0)")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","0.75em"),r.selectAll(".funnel-texts-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.75em").attr("transform","translate(0, 0)")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.75em").attr("transform","translate(0, 0)")):3==t._contentChoice.length&&t._labelShow}else if(2==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var w=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);t._interrupt?w.style("opacity",1):w.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),w.append("line").attr("class","funnel-texts-line").attr("x1",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)})).attr("y1",(function(t,e){return o*(e+1)-o/2})).attr("x2",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width})).attr("y2",(function(t,e){return o*(e+1)-o/2})).style("stroke",(function(t){return t.color})).style("stroke-width",1).style("display",t._labelShow?"block":"none"),w.append("text").text((function(i,o){if(o==e.length-1){var r=a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width;return X(i.name=="$-"+o?"":i.name,.96*t._width-r,t._fontSize,t._fontFamily)}var l=a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width;return X(i.name=="$-"+o?"":i.name,.96*t._width-l,t._fontSize,t._fontFamily)})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","-0.35em").style("display",t._labelShow?"block":"none"),w.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.75em").style("display",t._labelShow?"block":"none"),w.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.75em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)+5)+",0)"})),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","0.35em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","0.35em"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.35em").attr("transform","translate(0, 0)")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","0.75em"),r.selectAll(".funnel-texts-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.75em").attr("transform","translate(0, 0)")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.75em").attr("transform","translate(0, 0)")):3==t._contentChoice.length&&t._labelShow}return t}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),_a=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","funnel-chart"),i.funnel=new da(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._sortValue=null,i._labelShow=!0,i._positionOptions=["内部","外部对齐","外部跟随"],i._positionChoice="内部",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称"],i._textLabel={color:"#FFFFFF",fontFamily:"noto",fontSize:12},i._suffix="",i._borderWidth=1,i._borderColor="#FFFFFF",i._fillOpacity=1,i._gap=0,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向展开","横向同步展开"],i._moveStyle="纵向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData.filter((function(t,e){return t.value>0||0==t.value})),i=t.funnel,n=(t.AnimationArea,t.widthOfNoMargin),a=0,o=0;1!=t._positionOptions.indexOf(t._positionChoice)&&2!=t._positionOptions.indexOf(t._positionChoice)||!t._labelShow||(3==t._contentChoice.length?a=(null==t._decimalPlaces?0:t._decimalPlaces)*t._textLabel.fontSize*2:(2==t._contentChoice.length||1==t._contentChoice.length&&0!=t._contentOption.indexOf(t._contentChoice[0]))&&(a=(null==t._decimalPlaces?0:t._decimalPlaces)*t._textLabel.fontSize),a>.15*n&&(o=a-.15*n));for(var r=.69*n-o,l=.92*t.heightOfMainGroup,s=0;s<e.length;s++)e[s].percent=0==s?0:e[s-1].value-e[s].value;for(var u=0;u<e.length;u++)e[u].total=0==u?0:e[u-1].total+parseFloat(e[u].percent);if(t._borderColor&&/\[/.test(t._borderColor)){var h=x(t._borderColor),d=[],_=!0,f=!1,p=void 0;try{for(var g,v=h[Symbol.iterator]();!(_=(g=v.next()).done);_=!0){var m=g.value,b=[],S=m.split(":");b.push(q(S[0])),b.push(S[1]),d.push(b)}}catch(t){f=!0,p=t}finally{try{!_&&v.return&&v.return()}finally{if(f)throw p}}var k=d.concat(),w=k.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(w[1]).x1+"%").attr("y1",y(w[1]).y1+"%").attr("x2",y(w[1]).x2+"%").attr("y2",y(w[1]).y2+"%").selectAll("stop").data(k).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(e).width(n).sWidth(r).sHeight(l).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onTransitionEnd((function(t,e){})).onMouseover((function(e,i){d3.select(this).transition().duration(30).style("opacity",.8);var n=[{text:""+(e.name=="$-"+i?"":e.name),color:e.color},{text:e.valueLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().duration(30).style("opacity",1),t.tooltip.hide()}));var C=.155*n,O=.04*l;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||0==t._contentChoice.length||1!=t._positionOptions.indexOf(t._positionChoice)&&2!=t._positionOptions.indexOf(t._positionChoice)||1==t._labelShow&&(C=.04*n),t.funnel.translate(C,O).update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle));else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",t.heightOfMainGroup),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",0).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("height",t.heightOfMainGroup),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._gap=0==e.gapDistance||e.gapDistance?e.gapDistance:this._gap),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._suffix=i.suffix?i.suffix:"")}}]),e}(nt),fa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bee-line-chart"),i._showPoints=!1,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=3.5,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["依次绘制","同时绘制","穿针引线"],i._moveStyle="同时绘制",i._endPause=0,i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n.transition||0==n.transition?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"")}}]),e}(re),pa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stacked-linear-chart"),i.elem.attr("class","stacked-linear-chart"),i.grid=new Jt(i.coreGroup),i.areaPlot=new ri(i.coreGroup),i.linePlot=new Gi(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new Bi(i.coreGroup),i.areaStackText=new qt(i.coreGroup),i.clipArea=new Ut(i.defs),i.AnimationArea=new Zt(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=0,i._fillOpacity=.7,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向展开","起波澜","同步展示面","纵向同步拉伸","分步展示面"],i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.areaPlot,a=t.linePlot,r=(t.StackedScatterPlot,t.areaStackText),l=t.tooltip,s=t.overlay,u=t.guideLine,h=t.guideScatter,d=t.clipArea,_=(t.AnimationArea,t.xScale),f=t.yScale,p=(t.xAxis._axisStart,t.xAxis._axisEnd),g=0;p>t.widthOfNoMargin-t.yAxis.width&&(g=p-(t.widthOfNoMargin-t.yAxis.width));for(var v=t.widthOfCore-g,m=t.heightOfCore,b=0;b<e.length;b++)for(var S=0;S<e[b].data.length;S++)e[b].data[S].value=parseFloat(e[b].data[S].value),e[b].data[S].total=0==b?isNaN(parseFloat(e[b].data[S].value))?0:parseFloat(e[b].data[S].value):e[b-1].data[S].total+(isNaN(parseFloat(e[b].data[S].value))?0:parseFloat(e[b].data[S].value));Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0);if(i.width(v).height(m).planeX(_.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).xScale(_).yScale(f).fillOpacity(t._fillOpacity).curve(t._curve).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).moveOptions(t._moveOptions).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var k=x(t._strokeColor),w=[],C=!0,O=!1,F=void 0;try{for(var L,P=k[Symbol.iterator]();!(C=(L=P.next()).done);C=!0){var A=L.value,W=[],z=A.split(":");W.push(q(z[0])),W.push(z[1]),w.push(W)}}catch(t){O=!0,F=t}finally{try{!C&&P.return&&P.return()}finally{if(O)throw F}}var M=w.concat(),D=M.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(D[1]).x1+"%").attr("y1",y(D[1]).y1+"%").attr("x2",y(D[1]).x2+"%").attr("y2",y(D[1]).y2+"%").selectAll("stop").data(M).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var R=x(t._fillColor),N=[],T=!0,B=!1,G=void 0;try{for(var X,j=R[Symbol.iterator]();!(T=(X=j.next()).done);T=!0){var I=X.value,Y=[],H=I.split(":");Y.push(q(H[0])),Y.push(H[1]),N.push(Y)}}catch(t){B=!0,G=t}finally{try{!T&&j.return&&j.return()}finally{if(B)throw G}}var V=N.concat(),$=V.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y($[1]).x1+"%").attr("y1",y($[1]).y1+"%").attr("x2",y($[1]).x2+"%").attr("y2",y($[1]).y2+"%").selectAll("stop").data(V).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(e).xScale(_).yScale(f).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).mainGroup(t.mainGroup).curve(t._curve).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).moveOptions(t._moveOptions).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).lineWidth(t._lineWidth).radius(t._endPointRadius).radiusFill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).radiusStroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).radiusWidth(t._strokeWidth),h.xScale(_).yScale(f).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),u.y1(0).y2(m).stroke("#c6c6c6").strokeDasharray("0 0"),s.data(_.domain()).bandWidth(_.step()).bandHeight(m).bandX(_.range()[0]).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],r=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));r.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),l.data(o).update(),u.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+_(a)+",0)"),h.data(r).update(),l.move([d3.event.offsetX,d3.event.offsetY]).show(),u.show(),h.show()})).onMousemove((function(){l.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){l.hide(),u.hide(),h.hide()}));var U=t.defs;U.selectAll("filter").remove();var Z=U.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_stacklinear").attr("filterUnits","objectBoundingBox");Z.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),Z.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),Z.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),Z.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),Z.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),r.data(e).xScale(_).yScale(f).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(d.width(v).height(m).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+d.id)+")"),d.update()):(d.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),d.update()),h.elem.style("pointer-events","none");var Q=t.group.selectAll(".stacked-linear-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));if(d3.selectAll(Q).remove(),i.update(),s.update(),n.update(),a.update(),r.update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))t.coreGroup.select(".area-plot").attr("clip-path",""),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","");else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)+_.range()[0]).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).attr("width",v+2*parseFloat(t._endPointRadius)-_.range()[0]),t.coreGroup.select(".area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-parseFloat(t._lineWidth)-2*parseFloat(t._endPointRadius)).attr("x",2*-parseFloat(t._endPointRadius)+_.range()[0]).attr("height",t._height+2*parseFloat(t._lineWidth)+2*parseFloat(t._endPointRadius)).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",v+2*parseFloat(t._endPointRadius)-_.range()[0]),t.coreGroup.select(".area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}else t.coreGroup.select(".area-plot").attr("clip-path",""),t.coreGroup.select(".stack-area-line-plot").attr("clip-path","")}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);e.compute(),i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.display,r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(o).length&&(this._lineWidth=0==o.lineWidth||o.lineWidth?d(o.lineWidth):this._lineWidth,this._curve=o.lineType?r[o.lineType]:d3.curveLinear,this._endPointRadius=0==o.endPointRadius||o.endPointRadius?o.endPointRadius:this._endPointRadius,this._strokeWidth=0==o.endPointBorderWidth||o.endPointBorderWidth?o.endPointBorderWidth:this._strokeWidth,this._strokeColor=o.endPointBorderColor?q(o.endPointBorderColor):"",this._fillColor=o.endPointFillColor?q(o.endPointFillColor):"",this._fillOpacity=0==o.fillOpacity||o.fillOpacity?o.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)e[i].data[n].value=parseFloat(e[i].data[n].value),e[i].data[n].total=0==i?isNaN(parseFloat(e[i].data[n].value))?0:parseFloat(e[i].data[n].value):e[i-1].data[n].total+(isNaN(parseFloat(e[i].data[n].value))?0:parseFloat(e[i].data[n].value));var a=t._yRange||[],o=e.length?e[0].data.map((function(t){return t.name})):[0,1],r=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0),1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))]:[0,1];t._xDomain=o,t._yDomain=[isNaN(parseFloat(a[0]))?r[0]:parseFloat(a[0]),isNaN(parseFloat(a[1]))?isNaN(parseFloat(a[0]))?r[1]:r[1]<a[0]?1.5*a[0]:r[1]:parseFloat(a[1])]}}]),e}(Tt),ya=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","smooth-line-chart"),i._showPoints=!1,i._curve=d3.curveCardinal,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=0,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["依次绘制","同时绘制","穿针引线"],i._moveStyle="同时绘制",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveCardinal,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"")}}]),e}(re),xa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rect-plot"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth=0,i._fillOpacity=.7,i._barCornerRadius=5,i._borderColor="#000",i._borderWidth=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=e._data,n=e.group;n.selectAll("*").remove(),i.forEach((function(t,i){if(t.color&&/\[/.test(t.color)){var n=x(t.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();e.group.append("linearGradient").attr("id",e.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=n.selectAll("rect").data(i,(function(t){return t.key}));a.exit().remove();var o=a.enter().append("g").attr("class","symmetric-rect").append("rect").merge(a).style("fill",(function(t,i){return t.color&&/\[/.test(t.color)?"url("+c("#"+e.id+"-index-"+i)+")":t.color&&/#/.test(t.color)?t.color:"rgb("+U(t.color,0)+","+U(t.color,1)+","+U(t.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return e._fillOpacity;var i=U(t.color,3)||1;return e._fillOpacity*i})).style("stroke",(function(t,i){return e._strokeColor||(/\[/.test(t.color)?"url("+c("#"+e.id+"-index-"+i)+")":t.color)})).style("stroke-width",(function(t){return e._strokeWidth||0}));if(this._rectObj?(o.attr("x",e._rectObj.xFunc),o.attr("y",this._rectObj.yFunc),o.attr("width",this._rectObj.widthFunc),o.attr("height",this._rectObj.heightFunc)):o.attr("x",(function(t){return t.value})).attr("y",(function(t){return t.value})).attr("width",(function(t){return t.value})).attr("height",(function(t){return t.value})),this._textObj){n.selectAll(".symmetric-texts").remove();var r=n.append("g").attr("class","symmetric-texts").selectAll("text").data(i,(function(t){return t.key}));r.exit().remove();var l=r.enter().append("g").append("text").merge(r).text(this._textObj.textFunc).attr("fill",e._textObj.colorFunc).attr("font-size",e._textObj.fontSize).attr("font-family",e._textObj.fontFamily).attr("x",this._textObj.xFunc).attr("y",this._textObj.yFunc).attr("dx",this._textObj.dxFunc).attr("dy",this._textObj.dyFunc).attr("text-anchor","middle").style("display",(function(e,i){return t._textObj.labelShow&&e.textShow?"block":"none"}));e._interrupt?l.style("opacity",1):l.style("opacity",0).transition().duration(e._transition?.1*e._duration:0).delay(e._transition?e._startDelay+.9*e._duration:0).style("opacity",1)}return o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),e}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at);function ga(t,e){var i=0,n=[];if(e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&0!=t.configurable&&n.push(t.index-1)})),P(t,[i],2))return[];var a=z(t,e),o=a[0],r=a.slice(1),l=o.slice(1),s=[],u=[],c=[],d=r.map((function(t){return t.slice(1)}));return l.forEach((function(t,e){s.push({name:t,data:[]})})),r.forEach((function(t){var e=0;t.slice(1).forEach((function(t){e+=""==t||isNaN(parseFloat(t))||null==t||null==t?0:parseFloat(t)})),u.push(e)})),d.forEach((function(t,e){c.push(t.map((function(t){return 0==u[e]?0:(t/u[e]*100).toFixed(2)})))})),r.forEach((function(t,e){s.forEach((function(i,n){i.data.push({name:""==t[0]?"&-"+e:t[0],type:i.name,value:""==t[n+1]||isNaN(parseFloat(t[n+1]))||null==t[n+1]||null==t[n+1]?0:parseFloat(t[n+1]),total:u[e],rate:c[e][n]+"%"})}))})),s.forEach((function(t,e){t.key=h(t.name)+"-"+e})),s}var va=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","symmetric-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new xa(i.coreGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="top",i._yOrient="left",i._sortValue=null,i._curve=d3.curveCardinal,i._yScaleHeight=1.05,i._shapeType="rect",i._histogramWidth=.5,i._barCornerRadius=[0,0,0,0],i._borderWidth=0,i._borderColor="",i._fillOpacity=1,i._centralAxisWidth="1",i._centralAxisColor="#000000",i._labelShow=!1,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="淡入",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.tooltip,a=t.rectPlot,r=t.xScale,l=t.yScale,s=(t.xAxis._axisStart,t.xAxis._axisEnd),u=0;s>t.widthOfNoMargin-t.yAxis.width&&(u=s-(t.widthOfNoMargin-t.yAxis.width));for(var h=t.widthOfCore-u,d=t.heightOfCore,_=0;_<e.length;_++)for(var f=0;f<e[_].data.length;f++){var p=Math.abs(r.domain()[0])+Math.abs(r.domain()[1]);e[_].data[f].rate.replace(/\%$/,"")/p*r.range()[1]<R(E(e[_].data[f].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)?e[_].data[f].textShow=!1:e[_].data[f].textShow=!0}if(t.mainGroup.selectAll(".linear-gradient").remove(),t._borderColor&&/\[/.test(t._borderColor)){var g=x(t._borderColor),v=[],m=!0,b=!1,S=void 0;try{for(var k,w=g[Symbol.iterator]();!(m=(k=w.next()).done);m=!0){var C=k.value,O=[],F=C.split(":");O.push(q(F[0])),O.push(F[1]),v.push(O)}}catch(t){b=!0,S=t}finally{try{!m&&w.return&&w.return()}finally{if(b)throw S}}var L=v.concat(),P=L.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(P[1]).x1+"%").attr("y1",y(P[1]).y1+"%").attr("x2",y(P[1]).x2+"%").attr("y2",y(P[1]).y2+"%").selectAll("stop").data(L).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._centralAxisColor&&/\[/.test(t._centralAxisColor)){var A=x(t._centralAxisColor),W=[],z=!0,M=!1,D=void 0;try{for(var N,T=A[Symbol.iterator]();!(z=(N=T.next()).done);z=!0){var B=N.value,G=[],X=B.split(":");G.push(q(X[0])),G.push(X[1]),W.push(G)}}catch(t){M=!0,D=t}finally{try{!z&&T.return&&T.return()}finally{if(M)throw D}}var j=W.concat(),I=j.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(I[1]).x1+"%").attr("y1",y(I[1]).y1+"%").attr("x2",y(I[1]).x2+"%").attr("y2",y(I[1]).y2+"%").selectAll("stop").data(j).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}(a.data(t.drawData).xScale(r).yScale(l).width(t.widthOfNoMargin).height(t.heightOfMainGroup).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).defs(t.defs).rectObj({xFunc:function(t,e){return r(t.x)},yFunc:function(e,i){return"上面"==t._axisPositonChoiceX?l(e.name)+l.step()*(1-t._histogramWidth)/2+t.xAxis.height:l(e.name)+l.step()*(1-t._histogramWidth)/2},widthFunc:function(t){var e=Math.abs(r.domain()[0])+Math.abs(r.domain()[1]);return t.rate.replace(/\%$/,"")/e*r.range()[1]},heightFunc:function(e){return l.step()*t._histogramWidth}}).textObj({xFunc:function(t,e){var i=Math.abs(r.domain()[0])+Math.abs(r.domain()[1]),n=t.rate.replace(/\%$/,"")/i*r.range()[1];return r(t.x)+n/2},yFunc:function(e,i){return"上面"==t._axisPositonChoiceX?l(e.name)+l.step()*(1-t._histogramWidth)/2+t.xAxis.height:l(e.name)+l.step()*(1-t._histogramWidth)/2},dxFunc:0,dyFunc:function(e){return l.step()*t._histogramWidth/2+t._textLabel.fontSize/2.7},colorFunc:function(){return q(t._textLabel.color)},textFunc:function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix},fontSize:t._textLabel.fontSize,fontFamily:t._textLabel.fontFamily,labelShow:t._labelShow}).fillOpacity(t._fillOpacity).onMousemove((function(e,i){var a=t.elem.node().parentNode,o=(d3.mouse(a),[{text:"&-"==e.name.slice(0,2)?"":e.name},{text:e.type,color:e.color},{text:"数值:"+E(e.value,t._numberStyle,t._decimalPlaces)},{text:"比例:"+E(e.rate.replace(/\%$/,""),t._numberStyle,t._decimalPlaces)+"%"}]);n.show(),n.data(o).update().move([d3.event.offsetX,d3.event.offsetY]),d3.select(this).style("cursor","pointer")})).onMouseout((function(){n.hide()})),i.width(h).height(d).planeX(r.range()[0]).xTickLocations(t.xAxis.tickLocations.slice()).yTickLocations(t.yAxis.tickLocations.slice()).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),i.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,0),i.translate(t.yAxis.width+.5,t.xAxis.height)),a.update(),i.update(),t._interrupt)?(t.mainGroup.selectAll(".axis-x-line").interrupt().style("opacity",1),t.mainGroup.selectAll(".axis-y-line").interrupt().style("opacity",1),t.mainGroup.selectAll(".plane-grid").interrupt().style("opacity",1),t.mainGroup.selectAll(".symmetric-line").interrupt().style("opacity",1),t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",t._height),t.mainGroup.select(".rect-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".axis-x-line").interrupt().style("opacity",0).transition().duration(t._transition?.2*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1),t.mainGroup.selectAll(".axis-y-line").interrupt().style("opacity",0).transition().duration(t._transition?.2*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1),t.mainGroup.selectAll(".plane-grid").interrupt().style("opacity",0).transition().duration(t._transition?.2*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1),t.mainGroup.selectAll(".symmetric-line").interrupt().style("opacity",0).transition().duration(t._transition?.2*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1),t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",0).transition().duration(t._transition?1e3*t._duration*.7:0).delay(t._transition?1e3*t._startDelay+1e3*t._duration*.2:0).attr("height",t._height),t.mainGroup.select(".rect-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e);this.rawData=t.dataSrc.data[0];var n=ga;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._histogramWidth=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._histogramWidth,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._centralAxisWidth=0==e.centralAxisWidth||e.centralAxisWidth?e.centralAxisWidth:this._centralAxisWidth,this._centralAxisColor=e.centralAxisColor?q(e.centralAxisColor):this._centralAxisColor),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData||[];t.drawData=function(t,e,i){for(var n=[],a=[],o=[],r=i.slice(1).map((function(t){return t.slice(1)})),l=[],s=[],u=[],c=[],h=t.length>0?t[0].data.length:0,d=[],_=0;_<h;_++){for(var f=[],p=0;p<t.length;p++)f.push(t[p].data[_].value);d.push(f)}var y=Math.floor(e.length/2);if(t.forEach((function(t){a.push(t.key.split("-")[1])})),r.forEach((function(t){var e=[];a.forEach((function(i){e.push(t[i])}))})),d.forEach((function(t){var e=0;t.forEach((function(t){e+=""==t||isNaN(parseFloat(t))||null==t||null==t?0:parseFloat(t)})),l.push(e)})),d.forEach((function(t,e){o.push(t.map((function(t){return 0==l[e]?0:(t/l[e]*100).toFixed(2)})))})),-1!=a.indexOf(y.toString())&&e.length%2!=0&&1!=e.length){var x=a.indexOf(y.toString());o.forEach((function(t,e){var i=-t[x]/2,n=t[x]/2;s.push([]),s[e][x]=-(t[x]/2).toFixed(2);for(var a=x-1;a>=0;a--)s[e][a]=parseFloat((-t[a]+s[e][a+1]).toFixed(2)),i+=-t[a];for(var o=x+1;o<t.length;o++)s[e][o]=parseFloat((s[e][o-1]+ +t[o-1]).toFixed(2)),n+=+t[o];u.push(i),c.push(n)}))}else{for(var g=-1,v=0;v<a.length;v++){if(+a[v]>=y){g=v;break}if(v==a.length-1){g=v+1;break}}o.forEach((function(t,e){var i=0,n=+t[g]||0;s.push([]),s[e][g]=0;for(var a=g-1;a>=0;a--)s[e][a]=parseFloat((-t[a]+s[e][a+1]).toFixed(2)),i+=-t[a];for(var o=g+1;o<t.length;o++)s[e][o]=parseFloat((s[e][o-1]+ +t[o-1]).toFixed(2)),n+=+t[o];u.push(i),c.push(n)}))}return t.forEach((function(t,e){t.data.forEach((function(t,i){t.x=s[i][e],t.rate=o[i][e]+"%"}))})),t.forEach((function(t){t.range=[Math.min.apply(null,u),Math.max.apply(null,c)],t.data.forEach((function(t){n.push(t)}))})),n}(e,t.data(),t.rawData)||[];var i=[],n=[];e[0]&&(e[0].data.forEach((function(t){n.push(t.name)})),i=[Math.floor(e[0].range[0])-5,Math.ceil(e[0].range[1])+5]),t._xDomain=""==i?[-100,100]:i,t._yDomain=""==n?[0,1]:n.reverse()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,h=t.widthOfNoMargin,d=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*d).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection("横排").labelAngle(0).countOfLabel(t._xCountOfLabel).labelSuffix("%").numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*h).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i&&i.titleHeight;var _=t._tickCount?t._tickCount:(h-i.allowedMaxTextWidth())/(2*u);e.tickCount(_).compute(),i.compute();var f=0,p=h-i.width;i.compute(),n.range([f,p]),e.compute();var y=e._axisStart,x=e._axisEnd;if(y<0&&(f=Math.abs(y)>i.width?Math.abs(y)-i.width:0),x>p&&(p-=x-p),n.range([f,p]),a.range([d-e.height,0]),"上面"==t._axisPositonChoiceX){var g=i.width,v=e.height,m=i.width+f,b=e.height;e.translate(g,v).update(),i.translate(m,b).update(),this.coreGroup.selectAll("line").remove(),this.coreGroup.append("line").attr("class","symmetric-line").attr("x1",n(0)+1e-4).attr("y1",e.height).attr("x2",n(0)).attr("y2",a.range()[0]+e.height).attr("stroke-width",t._centralAxisWidth).attr("stroke",/\[/.test(t._centralAxisColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._centralAxisColor)}else{var S=i.width,k=d-e.height,w=i.width+f;e.translate(S,k).update(),i.translate(w,0).update(),this.coreGroup.selectAll("line").remove(),this.coreGroup.append("line").attr("class","symmetric-line").attr("x1",n(0)+1e-4).attr("y1",0).attr("x2",n(0)).attr("y2",a.range()[0]).attr("stroke-width",t._centralAxisWidth).attr("stroke",/\[/.test(t._centralAxisColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._centralAxisColor)}}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"上面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return""!=t.name}));t.legend.data(e).shapeType("rect").onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}}]),e}(Tt);var ma=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","simple-line-circle-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._lineWidth=2,i._strokeWidth=1,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._xScale,n=t._yScale,a=t.group;if(a.selectAll("*").remove(),t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)){a.selectAll("g").remove();var o=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));o.curve(t._curve),a.selectAll("path").remove();var r=a.selectAll("path").data(e,(function(t){return t.key}));r.exit().remove();r.enter().append("path").merge(r).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return o(t.data)}));a.selectAll("g").remove();var l=a.append("g").selectAll("g").data(e,(function(t){return t.name}));l.exit().remove(),l.enter().append("g").merge(l).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n(t.value)||0})).attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var s=a.selectAll(".clip-scatter-plot").nodes(),u=0;u<s.length;u++)""==s[u].__data__.value||isNaN(s[u].__data__.value)?d3.select(s[u]).style("opacity","0"):d3.select(s[u]).style("opacity","1")}else if(0==t._moveOptions.indexOf(t._moveStyle)){a.selectAll("g").remove();var h=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));h.curve(t._curve),a.selectAll("path").remove();var d=a.selectAll("path").data(e,(function(t){return t.key}));d.exit().remove();var _=d.enter().append("path").merge(d).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return h(t.data)}));t._interrupt?_.attr("stroke-dasharray",t._strokeDasharry):_.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("stroke-dasharray",(function(){var t=this.getTotalLength(),e=d3.interpolateString("0,"+t,t+","+t);return function(t){return e(t)}})),a.selectAll("g").remove();var f=a.append("g").selectAll("g").data(e,(function(t){return t.name}));f.exit().remove(),f.enter().append("g").merge(f).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n(t.value)||0}));t._interrupt?r.transition().duration(0).delay(0).ease(d3.easeLinear).attr("r",t._radius).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):r.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attrTween("r",(function(){var e=d3.interpolate(0,t._radius);return function(t){return e(t)}})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var p=a.selectAll(".clip-scatter-plot").nodes(),g=0;g<p.length;g++)""==p[g].__data__.value||isNaN(p[g].__data__.value)?d3.select(p[g]).style("opacity","0"):d3.select(p[g]).style("opacity","1")}else if(1==t._moveOptions.indexOf(t._moveStyle)){var v=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._xScale.bandwidth()/2})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));v.curve(t._curve),a.selectAll("path").remove();var m=a.selectAll("path").data(e,(function(t){return t.key}));m.exit().remove();var b=m.enter().append("path").merge(m).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return v(t.data)})).style("opacity",0);t._interrupt?b.style("opacity",1):b.transition().delay((function(i,n){return 0==n?t._transition?t._startDelay+.2*t._duration:0:n*(t._transition?.7*t._duration/e.length:0)+(t._transition?t._startDelay+.2*t._duration:0)})).duration(t._transition?.7*t._duration/e.length:0).style("opacity",1);var S=a.append("g").selectAll("g").data(e,(function(t){return t.name}));S.exit().remove(),S.enter().append("g").merge(S).each((function(e,a){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").attr("class","clip-scatter-plot").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+a)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t){return i(t.name)+i.bandwidth()/2||0})).attr("cy",(function(t){return n.range()[0]}));t._interrupt?r.transition().duration(0).delay(0).ease(d3.easeLinear).attr("cy",(function(t){return n(t.value)||0})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd):r.transition().duration(t._transition?.2*t._duration:0).delay(t._transition?t._startDelay:0).ease(d3.easeLinear).attr("cy",(function(t){return n(t.value)||0})).on("start",t._onTransitionStart).on("end",t._onTransitionEnd)}));for(var k=a.selectAll(".clip-scatter-plot").nodes(),w=0;w<k.length;w++)""==k[w].__data__.value||isNaN(k[w].__data__.value)?d3.select(k[w]).style("opacity","0"):d3.select(k[w]).style("opacity","1")}return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),ba=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","simple-line-texts"),i._xScale=null,i._yScale=null,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a=t._xScale,o=t._yScale;n.selectAll("*").remove(),n.selectAll("filter").remove();var r=t._defs.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_simpleLine").attr("filterUnits","objectBoundingBox");r.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),r.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),r.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),r.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),r.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var l=n.selectAll("g").data(e,(function(t){return t.name}));l.exit().remove(),l.enter().append("g").attr("class","simple-text-group").merge(l).each((function(e){var i=d3.select(this).selectAll("text").data(e.data);i.exit().remove();var n=i.enter().append("text").attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return o(t.value)||0})).merge(i).text((function(e){return isNaN(parseFloat(e.value))?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return o(t.value)||0})).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?n.style("opacity",1):n.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1)})),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".simple-text-group text").style("display","none"):0==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".simple-text-group text").attr("dy",.4*-t._fontSize):1==t._positionOptions.indexOf(t._positionChoice)&&n.selectAll(".simple-text-group text").attr("dy",1.3*t._fontSize);for(var s=n.selectAll(".simple-text-group text"),u=[],c=[],h=0;h<s._groups[0].length;h++){c.push(h);for(var d=h+1;d<s._groups[0].length;d++){p(i(d3.select(s._groups[0][h])),i(d3.select(s._groups[0][d])))&&(u.push(h),d3.select(s._groups[0][h]).style("visibility","hidden"))}}for(var _=new Set(u),f=Array.from(_),y=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(f,c),x=0;x<f.length;x++){for(var g=[],v=0;v<y.length;v++){var m=i(d3.select(s._groups[0][f[x]])),b=i(d3.select(s._groups[0][y[v]]));if(g.push(p(m,b)),p(m,b)){if(f[x]==y[v])continue;d3.select(s._groups[0][f[x]]).style("visibility","hidden")}}0==g.filter((function(t){return 1==t})).length&&y.push(f[x])}for(var S=0;S<y.length;S++)d3.select(s._groups[0][y[S]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at);function Sa(t,e){var i=0,n=1;if(e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&(n=t.index)})),P(t,[i,n])||!A(t,n))return[];var a={},o=[],r=t.length,l=t[0][n];""!=l&&null!=l&&null!=l||(l="$-0"),a[l]={name:l,dataScreen:!0,showLegend:"$-0"!=l,data:[]};for(var s=0,u=1;u<r;u++){var c=t[u],h=c[i];if(""!=h&&null!=h&&null!=h||(h="&-"+u),h){var d=l;1==u?s=isNaN(parseFloat(t[1][n]))?0:parseFloat(t[1][n]):s+=isNaN(parseFloat(c[n]))?0:parseFloat(c[n]),a[d].data.push({name:h,showAxisText:h!="&-"+u,value:c[n],total:s})}}for(var _ in a)o.push(a[_]);return o.forEach((function(t,e){t.key=t.name+"-"+e})),o}var ka=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","simple-line-chart"),i.grid=new Jt(i.coreGroup),i.linePlot=new ma(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new oe(i.coreGroup),i.SimpleLineText=new ba(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._showPoints=!0,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#fff",i._fillColor="",i._endPointRadius=3.5,i._labelShow=!1,i._positionOptions=["上面","下面"],i._positionChoice="上面",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同时绘制","穿针引线"],i._moveStyle="",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.linePlot,a=t.clipArea,r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.guideScatter,h=t.SimpleLineText,d=t.xScale,_=t.yScale,f=(t.xAxis._axisStart,t.xAxis._axisEnd),p=0;f>t.widthOfNoMargin-t.yAxis.width&&(p=f-(t.widthOfNoMargin-t.yAxis.width));var g=t.widthOfCore-p,v=t.heightOfCore;Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0);if(i.width(g).height(v).planeX(d.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var m=x(t._strokeColor),b=[],S=!0,k=!1,w=void 0;try{for(var C,O=m[Symbol.iterator]();!(S=(C=O.next()).done);S=!0){var F=C.value,L=[],P=F.split(":");L.push(q(P[0])),L.push(P[1]),b.push(L)}}catch(t){k=!0,w=t}finally{try{!S&&O.return&&O.return()}finally{if(k)throw w}}var A=b.concat(),W=A.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(W[1]).x1+"%").attr("y1",y(W[1]).y1+"%").attr("x2",y(W[1]).x2+"%").attr("y2",y(W[1]).y2+"%").selectAll("stop").data(A).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var z=x(t._fillColor),M=[],D=!0,R=!1,N=void 0;try{for(var T,B=z[Symbol.iterator]();!(D=(T=B.next()).done);D=!0){var G=T.value,X=[],j=G.split(":");X.push(q(j[0])),X.push(j[1]),M.push(X)}}catch(t){R=!0,N=t}finally{try{!D&&B.return&&B.return()}finally{if(R)throw N}}var I=M.concat(),Y=I.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(Y[1]).x1+"%").attr("y1",y(Y[1]).y1+"%").attr("x2",y(Y[1]).x2+"%").attr("y2",y(Y[1]).y2+"%").selectAll("stop").data(I).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).xScale(d).yScale(_).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).curve(t._curve).radius(t._endPointRadius).stroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).fill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).lineWidth(t._lineWidth).strokeWidth(t._strokeWidth).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt),s.y1(0).y2(v).stroke("#c6c6c6").strokeDasharray("0 0"),u.xScale(d).yScale(_).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),l.data(d.domain()).isScalePoint(!1).bandX(d.range()[0]).bandWidth(d.step()).bandHeight(v).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],l=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));l.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:("$-0"==e.name?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),r.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show(),s.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+(d(a)+d.bandwidth()/2)+",0)"),u.data(l).update().show()})).onMousemove((function(){r.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){r.hide(),s.hide(),u.hide()})),h.data(e).xScale(d).yScale(_).type("mix").defs(t.defs).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).suffix(t._suffix).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(a.width(g).height(v).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+a.id)+")"),a.update()):(a.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),a.update()),u.elem.style("pointer-events","none");var H=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(H).remove(),l.update(),i.update(),n.update(),h.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=Sa;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"");var r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"")}}]),e}(Tt),wa="axis-group",Ca="x-title",Oa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis x"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._hmsShow=null,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=[],u=0;u<l.length;u++){var c=new Date(l[u]);t._hmsShow?s.push(c.toLocaleDateString()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()):s.push(c.toLocaleDateString())}l=s;var h=void 0;(h=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(.5).tickPadding(t._tickPadding).tickFormat(t._tickFormat);var d=n.select(".axis-group").empty()?n.append("g").attr("class",wa):n.select(".axis-group"),_=t._labelAngle;"自动"==t._labelDirection&&(_=r),d.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).call(h).on("start",(function(i,n){d.selectAll(".tick text").remove(),d.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),d.select("path").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),"竖排"==t._labelDirection?d.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i,n){var a=B(l[n],t._fontSize,t._fontFamily)-t._fontSize,o=I(t._fontSize,_,0,t._labelDirection,e),r=Math.sin(Math.abs(o.angle)*Math.PI/180)*a,s=Math.cos(Math.abs(o.angle)*Math.PI/180)*a;return"top"==e?"translate("+(o.x+(o.angle<0?-r+(-90==o.angle?a/2:0):r-(90==o.angle?a/2:0)))+","+(o.y-s)+")":"translate("+(o.x+(o.angle<0?-(-90==o.angle?a/2:0):90==o.angle?a/2:0))+","+o.y+")"})).append("text").text((function(t,e){return l[e]})).each((function(i,n){var o=d3.select(this),r=o.text().split("").reverse();"rev"==I(t._fontSize,_,0,t._labelDirection,e).flag&&(r=o.text().split(""));for(var l,s=[],u=0,c=0,h=+o.attr("x"),d=+o.attr("y"),f=o.text(null).append("tspan").attr("x",h).attr("y",d);l=r.pop();)s.push(l),f.text(s.join("")),f.node().getComputedTextLength()>t._fontSize&&(0==c||++u,s.pop(),f.text(s.join("")),s=[l],f=o.append("tspan").attr("x",h).attr("y",u*parseFloat(.9*a*1.2)+d).text(l)),c++})).style("text-anchor",(function(i){return I(t._fontSize,_,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,_,0,t._labelDirection,e).angle+")"})):"横排"==t._labelDirection?d.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,_,0,t._labelDirection,e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){return l[e]})).style("text-anchor",(function(i){return I(t._fontSize,_,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,_,0,t._labelDirection,e).angle+")"})):"自动"==t._labelDirection&&d.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,_,0,"横排",e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){return l[e]})).style("text-anchor",(function(i){return I(t._fontSize,_,0,"横排",e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,_,0,"横排",e).angle+")"}))}));var f=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)})),p=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(f).remove(),d3.selectAll(p).remove();var y=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var x=n.select(".x-title").empty()?n.append("g").attr("class",Ca):n.select(".x-title"),g=x.select("text").empty()?x.append("text"):x.select("text");l.length,d3.max(l,(function(e){return R(e,a,t._fontFamily)}));"top"===e?(x.call(o,y/2+Math.abs(i.range()[0]),-(this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0))),g.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",-6-.2*a).text(t._title)):(x.call(o,y/2+Math.abs(i.range()[0]),this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)),g.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",a+6).text(t._title))}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0,o=0,r=0,l=!1,s=t._scaleFunc.range()[0],u=t._scaleFunc.range()[1];function c(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a,t._tickTextWidth=o,t._rotateFlag=l,t._axisStart=s,t._axisEnd=u}var h=t._scaleFunc,d=t._type,_=t._fontSize,f=(t._minTickDistance,t._allowedMaxTextHeight),p=Math.abs(h.range()[0]-h.range()[1]),y=void 0,x=void 0;if("自动"==t._labelDirection){if(ht(),function(){var l=!1;y=p/e.length;for(var s=[],u=0;u<e.length;u++){var h=new Date(e[u]);t._hmsShow?s.push(h.toLocaleDateString()+" "+h.getHours()+":"+h.getMinutes()+":"+h.getSeconds()):s.push(h.toLocaleDateString())}(x=d3.max(s,(function(e){return R(e,_,t._fontFamily)}))||0)<y&&(n=0,a=1.125*_,o=R((i=e)[0],_,t._fontFamily)/2||0,r=R(i[0],_,t._fontFamily)/2||0,t._tickShow||(o=0),c(),l=!0);return l}())return t;for(var g=[],v=0;v<e.length;v++){var m=new Date(e[v]);t._hmsShow?g.push(m.toLocaleDateString()+" "+m.getHours()+":"+m.getMinutes()+":"+m.getSeconds()):g.push(m.toLocaleDateString())}i=g,n="top"===t._orient?45:-45,n=I(t._fontSize,n,0,"横排",t._orient).angle;var b=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0,S=b?_:0;x=Math.sqrt(Math.pow(b,2)+Math.pow(S,2));var k=180*Math.atan2(S,b)/Math.PI,w=0;n>0?w=n+k:n<0&&(w=n-k);var C=Math.sin(Math.abs(w)*Math.PI/180),O=Math.cos(Math.abs(w)*Math.PI/180);x*C<f?(a=x*C,o=R((i=i)[0],_,t._fontFamily)*O||0,r=R(i[0],_,t._fontFamily)*O||0,t._tickShow||(o=0),l=!1):(a=f,i=i.map((function(e){return X(e,a/C,_,t._fontFamily)})),o=R(i[0],_,t._fontFamily)*O||0,r=R(i[0],_,t._fontFamily)*O||0,a=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))*C||0,t._tickShow||(o=0),l=!0);var F=p/e.length;if("category"===d&&2*_>F){var L=Math.ceil(2*_/F);e=e.filter((function(t,e){return e%L==0}))}return s=t._tickShow&&e.length>0?h(e[0])-o:s,c(),t}if("横排"==t._labelDirection){ht();for(var P=[],A=0;A<e.length;A++){var W=new Date(e[A]);t._hmsShow?P.push(W.toLocaleDateString()+" "+W.getHours()+":"+W.getMinutes()+":"+W.getSeconds()):P.push(W.toLocaleDateString())}i=P,n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var z=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0,M=z?_:0,D=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,N=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),T=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),G=z*T+M*N,j=M*T+z*N;if(x=G,j<f)a=j,i=i,o=G,r=G,t._tickShow||(o=0),l=!0;else{a=f,i=i.map((function(e){return X(e,a/N,_,t._fontFamily)}));var Y=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,H=Y*T+M*N;o=H,r=H,a=M*T+Y*N,t._tickShow||(o=0),l=!0}D%180!=0&&90!=Math.abs(n)||(o/=2,r/=2);var E=p/e.length;if(r*(D%180==0||90==Math.abs(n)?2:1)>E){var V=Math.ceil(r*(D%180==0||90==Math.abs(n)?2:1)*1.2/E);e=e.filter((function(t,e){return e%V==0})),i=i.filter((function(t,e){return e%V==0}))}if("top"==t._orient){var $=1;(n>90||n<0&&n>-90)&&($=-1),s=t._tickShow&&e.length>0?h(e[0])-o*$:s,u=t._tickShow&&e.length>0?h(e[e.length-1])-o*$:u,n%180!=0&&90!=Math.abs(n)||(s=t._tickShow&&e.length>0?h(e[0])-o:s,u=t._tickShow&&e.length>0?h(e[e.length-1])+o:u)}else{var q=-1;(n>90||n<0&&n>-90)&&(q=1),s=t._tickShow&&e.length>0?h(e[0])-o*q:s,u=t._tickShow&&e.length>0?h(e[e.length-1])-o*q:u,n%180!=0&&90!=Math.abs(n)||(s=t._tickShow&&e.length>0?h(e[0])-o:s,u=t._tickShow&&e.length>0?h(e[e.length-1])+o:u)}return c(),t}if("竖排"==t._labelDirection){ht();for(var U=[],Z=0;Z<e.length;Z++){var Q=new Date(e[Z]);t._hmsShow?U.push(Q.toLocaleDateString()+" "+Q.getHours()+":"+Q.getMinutes()+":"+Q.getSeconds()):U.push(Q.toLocaleDateString())}i=U,i=U,n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var K=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,J=K?_:0,tt=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,et=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),it=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),nt=J*it+K*et,at=K*it+J*et;if(x=nt,at<f)a=at,i=i,o=nt,r=nt,t._tickShow||(o=0),l=!0;else{a=f,i=i.map((function(e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}(e,a/it,_,t._fontFamily)}));var ot=d3.max(i,(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,rt=J*it+ot*et;o=rt,r=rt,a=ot*it+J*et,t._tickShow||(o=0),l=!0}0==tt&&(o/=2,r/=2),90==Math.abs(tt)&&(a=0==x?0:_,o/=2,r/=2);var lt=p/e.length;if(r*(0==Math.abs(tt)||90==Math.abs(tt)?2:1)>lt){var st=Math.ceil(r*(0==Math.abs(tt)||90==Math.abs(tt)?2:1)*1.2/lt);e=e.filter((function(t,e){return e%st==0})),i=i.filter((function(t,e){return e%st==0}))}if("top"==t._orient){var ut=1;n>0&&n<90&&(ut=-1),s=t._tickShow&&e.length>0?h(e[0])-o*ut:s,u=t._tickShow&&e.length>0?h(e[e.length-1])-o*ut:u,0!=Math.abs(n)&&90!=Math.abs(n)||(s=t._tickShow&&e.length>0?h(e[0])-o:s,u=t._tickShow&&e.length>0?h(e[e.length-1])+o:u)}else{var ct=-1;n>0&&n<90&&(ct=1),s=t._tickShow&&e.length>0?h(e[0])-o*ct:s,u=t._tickShow&&e.length>0?h(e[e.length-1])-o*ct:u,n%180!=0&&90!=Math.abs(n)||(s=t._tickShow&&e.length>0?h(e[0])-o:s,u=t._tickShow&&e.length>0?h(e[e.length-1])+o:u)}return c(),t}function ht(){if(""==h.domain())return!1;for(var t=[1,2,6,12,24,48,168],i=new Date(h.domain()[0]),n=new Date(h.domain()[1]),a=parseInt(n.getTime()-i.getTime()),o=!1,r=0,l=0;l<t.length;l++)if(a/(36e5*t[l])<=12){o=!0,r=36e5*t[l];break}if(o)for(var s=0;!(h.domain()[0]+r*s>=h.domain()[1]);s++)e.push(h.domain()[0]+r*s);else{var u=i.toLocaleDateString().split("/"),c=n.toLocaleDateString().split("/");if(c[0]-u[0]>=3){r=Math.ceil((c[0]-u[0])/12);for(var d=0;!(+new Date(i).setFullYear(parseInt(u[0])+d*r)>=h.domain()[1]);d++)e.push(+new Date(i).setFullYear(parseInt(u[0])+d*r))}else if(a<=31536e6)for(var _=0;!(+new Date(i).setMonth(parseInt(u[1])-1+_)>=h.domain()[1]);_++)e.push(+new Date(i).setMonth(parseInt(u[1])-1+_));else for(var f=0;!(+new Date(i).setMonth(parseInt(u[1])-1+3*f)>=h.domain()[1]);f++)e.push(+new Date(i).setMonth(parseInt(u[1])-1+3*f))}}}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"hmsShow",value:function(t){return arguments.length?(this._hmsShow=t,this):this._hmsShow}},{key:"height",get:function(){var t=this,e=this._scaleFunc,i=(Math.abs(e.range()[0]-e.range()[1]),this._tickValueTexts.length,d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),0);return this.isShow&&(i=this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.125*this._fontSize:0)),i}}]),e}(Bt);function Fa(t,e){var i=0,n=1,a=2,o=3;if(e.forEach((function(t){"任务"===t.name?i=t.index:"起始时间"===t.name?n=t.index:"终止时间"===t.name?a=t.index:"说明"===t.name&&(o=t.index)})),P(t,[i,n,a]))return[];var r={},l=[],s=t.slice(1).map((function(t){return t[i]})),u=t.slice(1);for(var c in u.forEach((function(t,e){l.push({name:""==s[e]||null==s[e]||null==s[e]?"&-"+e:s[e],data:[{name:""==s[e]||null==s[e]||null==s[e]?"&-"+e:s[e],showLegend:""!=s[e]&&null!=s[e]&&null!=s[e],timeStart:null==t[n]||!isNaN(t[n])||isNaN(Date.parse(t[n]))?"":t[n],timeEnd:null==t[a]||!isNaN(t[a])||isNaN(Date.parse(t[a]))?"":t[a],tip:t[o]}]})})),r)l.push(r[c]);return l.forEach((function(t,e){t.key=t.name+"-"+e})),l}var La=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","gantt-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new Oa(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(1),i.AnimationArea=new Zt(i.defs),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new ji(i.coreGroup),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=-1,i._curve=d3.curveCardinal,i._barWidthPercent=.5,i._barCornerRadius=0,i._borderWidth=0,i._borderColor="none",i._fillOpacity=1,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=function(t){var e=[];return t.forEach((function(t){e.push(t.data[0])})),e}(t.activeData).filter((function(t,e){return""!=t.timeStart})).filter((function(t,e){return""!=t.timeEnd})),i=t.grid,n=t.tooltip,a=t.rectPlot,r=t.xScale,l=t.yScale,s=(t.xAxis._axisStart,t.xAxis._axisEnd),u=0;s>t.widthOfNoMargin-t.yAxis.width&&(u=s-(t.widthOfNoMargin-t.yAxis.width));var h=t.widthOfCore-u,d=t.heightOfCore;t.AnimationArea;if(t._borderColor&&/\[/.test(t._borderColor)){var _=x(t._borderColor),f=[],p=!0,g=!1,v=void 0;try{for(var m,b=_[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var S=m.value,k=[],w=S.split(":");k.push(q(w[0])),k.push(w[1]),f.push(k)}}catch(t){g=!0,v=t}finally{try{!p&&b.return&&b.return()}finally{if(g)throw v}}var C=f.concat(),O=C.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(O[1]).x1+"%").attr("y1",y(O[1]).y1+"%").attr("x2",y(O[1]).x2+"%").attr("y2",y(O[1]).y2+"%").selectAll("stop").data(C).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}(a.data(e).xScale(r).yScale(l).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).rectObj({xFunc:function(t){return r(+new Date(t.timeStart))},yFunc:function(e){return l(e.name)+l.step()*(1-t._barWidthPercent)/2},widthFunc:function(t){return r(+new Date(t.timeEnd))-r(+new Date(t.timeStart))},heightFunc:function(){return l.step()*t._barWidthPercent}}).fillOpacity(t._fillOpacity).onMousemove((function(e,i){var a=t.elem.node().parentNode,o=(d3.mouse(a),[{text:e.name=="&-"+i?"":e.name,color:e.color},{text:null==e.tip||null==e.tip?"":e.tip},{text:"起始时间: "+e.timeStart},{text:"终止时间: "+e.timeEnd}]);e.tip||(o=[{text:e.name=="&-"+i?"":e.name,color:e.color},{text:"起始时间: "+e.timeStart},{text:"终止时间: "+e.timeEnd}]),n.show(),n.data(o).update().move([d3.event.offsetX,d3.event.offsetY]),d3.select(this).style("cursor","pointer")})).onMouseout((function(){n.hide()})),i.width(h).height(d).planeX(r.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(0)).yTickLocations(t.yAxis.tickLocations.slice(0)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),i.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),i.translate(t.yAxis.width+.5,t.xAxis.height)),a.update(),i.update(),t._interrupt)?(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("x",-t._borderWidth).attr("y",-t._borderWidth).attr("height",t._height).attr("width",h+2*t._borderWidth),t.coreGroup.select(".rect-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("x",-t._borderWidth).attr("y",-t._borderWidth).attr("width",0).attr("height",t._height).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",h+2*t._borderWidth),t.coreGroup.select(".rect-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY||"transparent").fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix);i&&i.titleHeight;i.compute();var d=0,_=c-i.width;i.compute(),n.range([d,_]),e.compute();var f=e._axisStart,p=e._axisEnd;f<0&&(d=Math.abs(f)>i.width?Math.abs(f)-i.width:0),p>_&&(_-=p-_),n.range([d,_]),a.range([h-e.height,0]);var y=i.width,x=h-e.height,g=i.width+d,v=0;"上面"==t._axisPositonChoiceX?(x=e.height,v=e.height):x=(t._axisPositonChoiceX,h-e.height),e.translate(y,x).update(),i.translate(g,v).update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.data[0].showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=Fa;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t,e=this,i=e.data().filter((function(t,e){return""!=t.data[0].timeStart})).filter((function(t,e){return""!=t.data[0].timeEnd})),n=e.activeData.filter((function(t,e){return""!=t.data[0].timeStart})).filter((function(t,e){return""!=t.data[0].timeEnd})),a=e.activeData.length?e.activeData.map((function(t){return t.name})):[0,1],o=!1,r=[];i.forEach((function(t){o||(t.data[0].timeStart.split(" ").length>1&&(o=!0),t.data[0].timeEnd.split(" ").length>1&&(o=!0))})),n.forEach((function(t){r.push(+new Date(t.data[0].timeStart)),r.push(+new Date(t.data[0].timeEnd))})),t=""!=r.length?[Math.min.apply(null,r),Math.max.apply(null,r)]:[0,1],e._xDomain=t,e._yDomain=a,e.xAxis.hmsShow(o)}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.display;0!==Object.getOwnPropertyNames(a).length&&(this._barWidthPercent=0==a.barWidthPercent||a.barWidthPercent?a.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==a.barCornerRadius||a.barCornerRadius?a.barCornerRadius:this._barCornerRadius,this._borderWidth=0==a.borderWidth||a.borderWidth?a.borderWidth:this._borderWidth,this._borderColor=a.borderColor?q(a.borderColor):"",this._fillOpacity=0==a.fillOpacity||a.fillOpacity?a.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}}]),e}(Tt);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Pa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Aa(t,e){return t(e={exports:{}},e.exports),e.exports}var Wa=Aa((function(t,e){var i;i=function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}return i.m=t,i.c=e,i.p="",i(0)}([function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),o=(i(2),i(6).default),r='<div class="__wc_loading_wrapper__"><div style="padding-left: 60px;" class="__wc_loading_wrapper_item__"><div class="__wc_loading_wrapper_item_inner__">',l="</div></div></div>",s=e.Js2WordCloud=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),window.wordcloudContainer=e,this._container=e,this._wrapper=null,this._canvas=null,this._maskCanvas=null,this._dataMask=null,this._tooltip=null,this._wordcloud2=null,this._option=null}return n(t,[{key:"setOption",value:function(t){var e=this;this._option=o.copy(t,!0),this._init(t);var i=this._option.hover;this._option.fontFamily=this._option.fontFamily||"Microsoft YaHei,Helvetica,Times,serif",this._fixWeightFactor(this._option),this._maskCanvas=null,t.tooltip&&!0===t.tooltip.show&&(this._tooltip||(this._tooltip=window.document.createElement("div"),this._tooltip.className="__wc_tooltip__",this._tooltip.style.backgroundColor=t.tooltip.backgroundColor||"rgba(0, 0, 0, 0.701961)",this._tooltip.style.color="#fff",this._tooltip.style.padding="5px",this._tooltip.style.borderRadius="5px",this._tooltip.style.fontSize="12px",this._tooltip.style.fontFamily=t.fontFamily||this._option.fontFamily,this._tooltip.style.lineHeight=1.4,this._tooltip.style.webkitTransition="left 0.2s, top 0.2s",this._tooltip.style.mozTransition="left 0.2s, top 0.2s",this._tooltip.style.transition="left 0.2s, top 0.2s",this._tooltip.style.position="absolute",this._tooltip.style.whiteSpace="nowrap",this._tooltip.style.zIndex=999,this._tooltip.style.display="none",this._container.appendChild(this._tooltip),this._container.onmouseout=function(){e._tooltip.style.display="none"}),this._option.hover=function(n,a,o){if(n){var r=n[0]+": "+n[1];"function"==typeof e._option.tooltip.formatter&&(r=e._option.tooltip.formatter(n)),e._tooltip.innerHTML=r;var l=document.querySelector(".page-size span")?Number.parseInt(document.querySelector(".page-size span").innerHTML)/100:1;e._tooltip.style.top=o.offsetY/l+10+t.transY+20+"px",e._tooltip.style.left=o.offsetX/l+15+24+"px",e._tooltip.style.display="block",e._container.style.cursor="pointer"}else e._tooltip.style.display="none",e._container.style.cursor="default";i&&i(n,a,o)}),function(t){t.list&&t.list.sort((function(t,e){return e[1]-t[1]}))}(this._option),this._option&&/\.(jpg|png)$/.test(this._option.imageShape)?h.call(this,this._option):"circle"===this._option.shape?c.call(this,this._option):u.call(this,this._option)}},{key:"on",value:function(){}},{key:"showLoading",value:function(t){var e,i="正在加载...",n='<div class="__wc_loading__"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>';if(t)if(t.backgroundColor&&(this._dataMask.style.backgroundColor=t.backgroundColor),e=void 0===t.text?i:t.text,"spin"===t.effect){this._showMask(r+n+e+l);var a=this._dataMask.childNodes[0].childNodes[0],o=a.style.paddingLeft;a.style.paddingLeft=parseInt(o)+45+"px"}else this._showMask(r+e+l);else this._showMask(r+n+i+l)}},{key:"hideLoading",value:function(){this._dataMask&&(this._dataMask.style.display="none")}},{key:"resize",value:function(){this._canvas.width=this._container.clientWidth,this._canvas.height=this._container.clientHeight,u.call(this,this._option)}},{key:"_init",value:function(t){var e=this._container.clientWidth,i=this._container.clientHeight;this._canvas=window.document.createElement("canvas"),this._canvas.width=e-50,this._canvas.height=i,this._canvas.height=t.mainHeight,this._canvas.style.opacity=0,this._canvas.style.position="absolute",this._canvas.style.zIndex="1",this._canvas.style.left="24px",this._canvas.style.top=t.transY+20+"px",this._container.appendChild(this._canvas)}},{key:"_fixWeightFactor",value:function(t){if(t.maxFontSize="number"==typeof t.maxFontSize?t.maxFontSize:60,t.minFontSize="number"==typeof t.minFontSize?t.minFontSize:12,t.list&&t.list.length>0){for(var e=t.list[0][1],i=0,n=0,a=t.list.length;n<a;n++)e>t.list[n][1]&&(e=t.list[n][1]),i<t.list[n][1]&&(i=t.list[n][1]);if(i>e){var o="number"==typeof t.fontSizeFactor?t.fontSizeFactor:.1,r=(t.maxFontSize-t.minFontSize)/(Math.pow(i,o)-Math.pow(e,o)),l=t.maxFontSize-r*Math.pow(i,o);t.weightFactor=function(t){return Math.ceil(r*Math.pow(t,o)+l)}}else t.weightFactor=function(e){return t.minFontSize}}}},{key:"_showMask",value:function(t){this._dataMask&&(this._dataMask.innerHTML=t,this._dataMask.style.display=""===t?"none":"block")}},{key:"_dataEmpty",value:function(){return!this._option||!this._option.list||this._option.list.length<=0}}]),t}();function u(t){if(this._maskCanvas){t.clearCanvas=!1;var e=window.document.createElement("canvas").getContext("2d");e.fillStyle=t.backgroundColor||"#fff",e.fillRect(0,0,1,1);var i=e.getImageData(0,0,1,1).data,n=window.document.createElement("canvas");n.width=this._canvas.width,n.height=this._canvas.height;var o=n.getContext("2d");o.drawImage(this._maskCanvas,0,0,this._maskCanvas.width,this._maskCanvas.height,0,0,n.width,n.height);for(var s=o.getImageData(0,0,n.width,n.height),u=o.createImageData(s),c=0;c<s.data.length;c+=4)s.data[c+3]>128?(u.data[c]=i[0],u.data[c+1]=i[1],u.data[c+2]=i[2],u.data[c+3]=i[3]):(u.data[c]=i[0],u.data[c+1]=i[1],u.data[c+2]=i[2],u.data[c+3]=i[3]?i[3]-1:1);o.putImageData(u,0,0),(o=this._canvas.getContext("2d")).clearRect(0,0,this._canvas.width,this._canvas.height),o.drawImage(n,0,0)}if(this._dataEmpty()&&t&&t.noDataLoadingOption){var h="";t.noDataLoadingOption.textStyle&&("string"==typeof t.noDataLoadingOption.textStyle.color&&(h+="color: "+t.noDataLoadingOption.textStyle.color+";"),"number"==typeof t.noDataLoadingOption.textStyle.fontSize&&(h+="font-size: "+t.noDataLoadingOption.textStyle.fontSize+"px;")),"string"==typeof t.noDataLoadingOption.backgroundColor&&(this._dataMask.style.backgroundColor=t.noDataLoadingOption.backgroundColor);var d=t.noDataLoadingOption.text||"";this._showMask(r+'<span class="__wc_no_data_text__" style="'+h+'">'+d+"</span>"+l)}else this._showMask(""),this._wordcloud2=a(this._canvas,t)}function c(t){this._maskCanvas=window.document.createElement("canvas"),this._maskCanvas.width=500,this._maskCanvas.height=500;var e=this._maskCanvas.getContext("2d");e.fillStyle="#000000",e.beginPath(),e.arc(250,250,240,0,2*Math.PI,!0),e.closePath(),e.fill();for(var i=e.getImageData(0,0,this._maskCanvas.width,this._maskCanvas.height),n=e.createImageData(i),a=0;a<i.data.length;a+=4){var o=i.data[a]+i.data[a+1]+i.data[a+2];i.data[a+3]<128||o>384?(n.data[a]=n.data[a+1]=n.data[a+2]=255,n.data[a+3]=0):(n.data[a]=n.data[a+1]=n.data[a+2]=0,n.data[a+3]=255)}e.putImageData(n,0,0),u.call(this,t)}function h(t){var e=this,i=window.document.createElement("img");i.crossOrigin="Anonymous",i.onload=function(){e._maskCanvas=window.document.createElement("canvas"),e._maskCanvas.width=i.width,e._maskCanvas.height=i.height;var n=e._maskCanvas.getContext("2d");n.drawImage(i,0,0,i.width,i.height);for(var a=n.getImageData(0,0,e._maskCanvas.width,e._maskCanvas.height),o=n.createImageData(a),r=0;r<a.data.length;r+=4){var l=a.data[r]+a.data[r+1]+a.data[r+2];a.data[r+3]<128||l>384?(o.data[r]=o.data[r+1]=o.data[r+2]=255,o.data[r+3]=0):(o.data[r]=o.data[r+1]=o.data[r+2]=0,o.data[r+3]=255)}n.putImageData(o,0,0),u.call(e,t)},i.onerror=function(){u.call(this,t)},i.src=t.imageShape}t.exports=s},function(t,e,i){var n;(function(){window.setImmediate||(window.setImmediate=window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var t=[void 0],e="zero-timeout-message";return window.addEventListener("message",(function(i){if("string"==typeof i.data&&i.data.substr(0,e.length)===e){i.stopImmediatePropagation();var n=parseInt(i.data.substr(e.length),36);t[n]&&(t[n](),t[n]=void 0)}}),!0),window.clearImmediate=function(e){t[e]&&(t[e]=void 0)},function(i){var n=t.length;return t.push(i),window.postMessage(e+n.toString(36),"*"),n}}()||function(t){window.setTimeout(t,0)}),window.clearImmediate||(window.clearImmediate=window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(t){window.clearTimeout(t)}),function(i){var a=function(){var t=document.createElement("canvas");if(!t||!t.getContext)return!1;var e=t.getContext("2d");return!!(e.getImageData&&e.fillText&&Array.prototype.some&&Array.prototype.push)}(),o=function(){if(a){for(var t,e,i=document.createElement("canvas").getContext("2d"),n=20;n;){if(i.font=n.toString(10)+"px sans-serif",i.measureText("Ｗ").width===t&&i.measureText("m").width===e)return n+1;t=i.measureText("Ｗ").width,e=i.measureText("m").width,n--}return 0}}(),r=function(t){for(var e,i,n=t.length;n;e=Math.floor(Math.random()*n),i=t[--n],t[n]=t[e],t[e]=i);return t},l=function(t,e){if(a){Array.isArray(t)||(t=[t]),t.forEach((function(e,i){if("string"==typeof e){if(t[i]=document.getElementById(e),!t[i])throw"The element id specified is not found."}else if(!e.tagName&&!e.appendChild)throw"You must pass valid HTML elements, or ID of the element."}));var i={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null,mainHeight:0,transX:0,transY:0,startDelay:0,duration:0,transition:!1,tooltipScale:1};if(e)for(var n in e)n in i&&(i[n]=e[n]);if("function"!=typeof i.weightFactor){var l=i.weightFactor;i.weightFactor=function(t){return t*l}}if("function"!=typeof i.shape)switch(i.shape){case"circle":default:i.shape="circle";break;case"cardioid":i.shape=function(t){return 1-Math.sin(t)};break;case"diamond":case"square":i.shape=function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))};break;case"triangle-forward":i.shape=function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"triangle":case"triangle-upright":i.shape=function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"pentagon":i.shape=function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))};break;case"star":i.shape=function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}i.gridSize=Math.max(Math.floor(i.gridSize),4);var s,u,c,h,d,_,f=i.gridSize,p=f-i.maskGapWidth,y=Math.abs(i.maxRotation-i.minRotation),x=Math.min(i.maxRotation,i.minRotation),g=Math.max(i.maxRotation,i.minRotation);switch(i.color){case"random-dark":_=function(){return M(10,50)};break;case"random-light":_=function(){return M(50,90)};break;default:"function"==typeof i.color&&(_=i.color)}var v=null;"function"==typeof i.classes&&(v=i.classes);var m,b=!1,S=[],k=function(t){var e,i,n=t.currentTarget,a=n.getBoundingClientRect(),o=document.querySelector(".page-size span")?Number.parseInt(document.querySelector(".page-size span").innerHTML)/100:1;t.touches?(e=t.touches[0].clientX/o,i=t.touches[0].clientY/o):(e=t.clientX/o,i=t.clientY/o);var r=e-a.left,l=i-a.top,s=Math.floor(r*(n.width/a.width||1)/f),u=Math.floor(l*(n.height/a.height||1)/f);return S[s][u]},w=function(t){var e=k(t);m!==e&&(m=e,e?i.hover(e.item,e.dimension,t):i.hover(void 0,void 0,t))},C=function(t){var e=k(t);e&&(i.click(e.item,e.dimension,t),t.preventDefault())},O=[],F=function(t){if(O[t])return O[t];var e=8*t,n=e,a=[];for(0===t&&a.push([h[0],h[1],0]);n--;){var o=1;"circle"!==i.shape&&(o=i.shape(n/e*2*Math.PI)),a.push([h[0]+t*o*Math.cos(-n/e*2*Math.PI),h[1]+t*o*Math.sin(-n/e*2*Math.PI)*i.ellipticity,n/e*2*Math.PI])}return O[t]=a,a},L=function(){return i.abortThreshold>0&&(new Date).getTime()-void 0>i.abortThreshold},P=window.wordcloudContainer.querySelector(".word-cloud-chart .main-group");P.innerHTML="";var A=document.createElementNS("http://www.w3.org/2000/svg","g");P.appendChild(A);var W=function(e,i,n,a,o){e>=u||i>=c||e<0||i<0||(s[e][i]=!1,n&&t[0].getContext("2d").fillRect(e*f,i*f,p,p),b&&(S[e][i]={item:o,dimension:a}))},z=function(e){var n,a,l;Array.isArray(e)?(n=e[0],a=e[1]):(n=e.word,a=e.weight,l=e.attributes);var h=0===i.rotateRatio||Math.random()>i.rotateRatio?0:0===y?x:x<0&&g>0?x+Math.round(Math.random())*y:x+Math.random()*y,p=function(t,e,n){var a=i.weightFactor(e);if(a<=i.minSize)return!1;var r=1;a<o&&(r=function(){for(var t=2;t*a<o;)t+=2;return t}());var l=document.createElement("canvas"),s=l.getContext("2d",{willReadFrequently:!0});s.font=i.fontWeight+" "+(a*r).toString(10)+"px "+i.fontFamily;var u=s.measureText(t).width/r,c=Math.max(a*r,s.measureText("m").width,s.measureText("Ｗ").width)/r,h=u+2*c,d=3*c,_=Math.ceil(h/f),p=Math.ceil(d/f);h=_*f,d=p*f;var y=-u/2,x=.4*-c,g=Math.ceil((h*Math.abs(Math.sin(n))+d*Math.abs(Math.cos(n)))/f),v=Math.ceil((h*Math.abs(Math.cos(n))+d*Math.abs(Math.sin(n)))/f),m=v*f,b=g*f;l.setAttribute("width",m),l.setAttribute("height",b),s.scale(1/r,1/r),s.translate(m*r/2,b*r/2),s.rotate(-n),s.font=i.fontWeight+" "+(a*r).toString(10)+"px "+i.fontFamily,s.fillStyle="#000",s.textBaseline="middle",s.fillText(t,y*r,(x+.5*a)*r);var S=s.getImageData(0,0,m,b).data;if(L())return!1;for(var k,w,C,O=[],F=v,P=[g/2,v/2,g/2,v/2];F--;)for(k=g;k--;){C=f;t:for(;C--;)for(w=f;w--;)if(S[4*((k*f+C)*m+(F*f+w))+3]){O.push([F,k]),F<P[3]&&(P[3]=F),F>P[1]&&(P[1]=F),k<P[0]&&(P[0]=k),k>P[2]&&(P[2]=k);break t}}return{mu:r,occupied:O,bounds:P,gw:v,gh:g,fillTextOffsetX:y,fillTextOffsetY:x,fillTextWidth:u,fillTextHeight:c,fontSize:a}}(n,a,h);if(!p)return!1;if(L())return!1;if(!i.drawOutOfBound){var m=p.bounds;if(m[1]-m[3]+1>u||m[2]-m[0]+1>c)return!1}for(var S=d+1,k=function(o){var r=Math.floor(o[0]-p.gw/2),y=Math.floor(o[1]-p.gh/2);if(p.gw,p.gh,!function(t,e,n,a,o){for(var r=o.length;r--;){var l=t+o[r][0],h=e+o[r][1];if(l>=u||h>=c||l<0||h<0){if(!i.drawOutOfBound)return!1}else if(!s[l][h])return!1}return!0}(r,y,0,0,p.occupied))return!1;!function(e,n,a,o,r,l,s,u,c){var h,d=a.fontSize;h=_?_(o,r,d,l,s):i.color,v?v(o,r,d,l,s):i.classes;var p=a.bounds;p[3],p[0],p[1],p[3],p[2],p[0],t.forEach((function(t){var r=document.createElementNS("http://www.w3.org/2000/svg","text"),l="";l="rotate("+-u/Math.PI*180+" "+((e+a.gw/2)*f+a.fillTextOffsetX+a.fillTextWidth/2)+" "+((n+a.gh/2)*f+a.fillTextOffsetY+a.fillTextHeight/2)+")",1!==a.mu&&(l+="translateX(-"+a.fillTextWidth/4+"px) scale("+1/a.mu+")");var s={font:i.fontWeight+" "+d*a.mu+"px "+i.fontFamily},c={transform:l,webkitTransform:l,msTransform:l,x:(e+a.gw/2)*f+a.fillTextOffsetX+"px",y:(n+a.gh/2)*f+a.fillTextOffsetY+"px",dy:"0.8em"};for(var _ in h&&(s.fill=h),r.textContent=o,s)r.style[_]=s[_];if(c)for(var p in c)r.setAttribute(p,c[p]);A.appendChild(r)}))}(r,y,p,n,a,d-S,o[2],h);var x={};return x.gx=r,x.gy=y,x.info=p,x.word=n,x.weight=a,x.distance=d-S,x.theta=o[2],x.rotateDeg=h,x.attributes=l,function(e,n,a,o,r,l){var s,h,d=r.occupied,_=i.drawMask;if(_&&((s=t[0].getContext("2d")).save(),s.fillStyle=i.maskColor),b){var p=r.bounds;h={x:(e+p[3])*f,y:(n+p[0])*f,w:(p[1]-p[3]+1)*f,h:(p[2]-p[0]+1)*f}}for(var y=d.length;y--;){var x=e+d[y][0],g=n+d[y][1];x>=u||g>=c||x<0||g<0||W(x,g,_,h,l)}_&&s.restore()}(r,y,0,0,p,e),!0};S--;){var w=F(d-S);if(i.shuffle&&(w=[].concat(w),r(w)),w.some(k))return!0}return!1};!function(){var e=t[0];if(e.getContext)u=Math.ceil(e.width/f),c=Math.ceil(e.height/f);else{var n=e.getBoundingClientRect();u=Math.ceil(n.width/f),c=Math.ceil(n.height/f)}if(function(e,i,n){if(i)return!t.some((function(t){var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,!0,i,n||{}),!t.dispatchEvent(a)}),this);t.forEach((function(t){var a=document.createEvent("CustomEvent");a.initCustomEvent(e,!0,i,n||{}),t.dispatchEvent(a)}),this)}("wordcloudstart",!0)){var a,o,r;if(h=i.origin?[i.origin[0]/f,i.origin[1]/f]:[u/2,c/2],d=Math.floor(Math.sqrt(u*u+c*c)),s=[],!e.getContext||i.clearCanvas)for(t.forEach((function(t){if(t.getContext){var e=t.getContext("2d");e.fillStyle=i.backgroundColor,e.clearRect(0,0,u*(f+1),c*(f+1)),e.fillRect(0,0,u*(f+1),c*(f+1))}else t.textContent="",t.style.backgroundColor=i.backgroundColor,t.style.position="relative"})),a=u;a--;)for(s[a]=[],o=c;o--;)s[a][o]=!0;else{var l=document.createElement("canvas").getContext("2d");l.fillStyle=i.backgroundColor,l.fillRect(0,0,1,1);var _,p,y=l.getImageData(0,0,1,1).data,x=e.getContext("2d").getImageData(0,0,u*f,c*f).data;for(a=u;a--;)for(s[a]=[],o=c;o--;){p=f;t:for(;p--;)for(_=f;_--;)for(r=4;r--;)if(x[4*((o*f+p)*u*f+(a*f+_))+r]!==y[r]){s[a][o]=!1;break t}!1!==s[a][o]&&(s[a][o]=!0)}x=l=y=void 0}if(i.hover||i.click){for(b=!0,a=u+1;a--;)S[a]=[];i.hover&&e.addEventListener("mousemove",w),i.click&&(e.addEventListener("click",C),e.addEventListener("touchstart",C),e.addEventListener("touchend",(function(t){t.preventDefault()})),e.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),e.addEventListener("wordcloudstart",(function t(){e.removeEventListener("wordcloudstart",t),e.removeEventListener("mousemove",w),e.removeEventListener("click",C),m=void 0}))}r=0;for(var g=0;g<i.list.length;g++)z(i.list[g])}}()}function M(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"}};l.isSupported=a,l.minFontSize=o,i.WordCloud=l,void 0===(n=function(){return l}.apply(e,[]))||(t.exports=n)}(this)}).call(window)},function(t,e,i){var n=i(3);"string"==typeof n&&(n=[[t.id,n,""]]),i(5)(n,{}),n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(4)()).push([t.id,"@-webkit-keyframes __wc_loading_animation__ {\r\n  50% {\r\n    opacity: 0.3;\r\n    -webkit-transform: scale(0.4);\r\n            transform: scale(0.4); }\r\n\r\n  100% {\r\n    opacity: 1;\r\n    -webkit-transform: scale(1);\r\n            transform: scale(1); } }\r\n\r\n@keyframes __wc_loading_animation__ {\r\n  50% {\r\n    opacity: 0.3;\r\n    -webkit-transform: scale(0.4);\r\n            transform: scale(0.4); }\r\n\r\n  100% {\r\n    opacity: 1;\r\n    -webkit-transform: scale(1);\r\n            transform: scale(1); } }\r\n\r\n.__wc_loading_wrapper__ {\r\n  display: table;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n.__wc_loading_wrapper_item__ {\r\n  display: table-cell;\r\n  vertical-align: middle;\r\n  text-align: center;\r\n  position: relative;\r\n  padding-right: 60px;\r\n  line-height: 1.4;\r\n}\r\n.__wc_loading_wrapper_item_inner__ {\r\n  position: relative;\r\n  text-align: left;\r\n  display: inline-block;\r\n}\r\n\r\n.__wc_loading__ {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: -40px;\r\n  margin-top: -6px;\r\n}\r\n\r\n  .__wc_loading__ > div:nth-child(1) {\r\n    top: 15px;\r\n    left: 0;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(2) {\r\n    top: 10.22726px;\r\n    left: 10.22726px;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.12s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.12s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(3) {\r\n    top: 0;\r\n    left: 15px;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.24s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.24s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(4) {\r\n    top: -10.22726px;\r\n    left: 10.22726px;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.36s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.36s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(5) {\r\n    top: -15px;\r\n    left: 0;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.48s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.48s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(6) {\r\n    top: -10.22726px;\r\n    left: -10.22726px;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.6s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.6s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(7) {\r\n    top: 0;\r\n    left: -15px;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.72s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.72s infinite linear; }\r\n  .__wc_loading__ > div:nth-child(8) {\r\n    top: 10.22726px;\r\n    left: -10.22726px;\r\n    -webkit-animation: __wc_loading_animation__ 1s 0.84s infinite linear;\r\n            animation: __wc_loading_animation__ 1s 0.84s infinite linear; }\r\n  .__wc_loading__ > div {\r\n    background-color: #d3d3d3;\r\n    width: 10px;\r\n    height: 10px;\r\n    border-radius: 100%;\r\n    margin: 2px;\r\n    -webkit-animation-fill-mode: both;\r\n            animation-fill-mode: both;\r\n    position: absolute; \r\n  }",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var i=this[e];i[2]?t.push("@media "+i[2]+"{"+i[1]+"}"):t.push(i[1])}return t.join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},a=0;a<this.length;a++){var o=this[a][0];"number"==typeof o&&(n[o]=!0)}for(a=0;a<e.length;a++){var r=e[a];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),t.push(r))}},t}},function(t,e,i){var n={},a=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}},o=a((function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())})),r=a((function(){return document.head||document.getElementsByTagName("head")[0]})),l=null,s=0,u=[];function c(t,e){for(var i=0;i<t.length;i++){var a=t[i],o=n[a.id];if(o){o.refs++;for(var r=0;r<o.parts.length;r++)o.parts[r](a.parts[r]);for(;r<a.parts.length;r++)o.parts.push(p(a.parts[r],e))}else{var l=[];for(r=0;r<a.parts.length;r++)l.push(p(a.parts[r],e));n[a.id]={id:a.id,refs:1,parts:l}}}}function h(t){for(var e=[],i={},n=0;n<t.length;n++){var a=t[n],o=a[0],r={css:a[1],media:a[2],sourceMap:a[3]};i[o]?i[o].parts.push(r):e.push(i[o]={id:o,parts:[r]})}return e}function d(t,e){var i=r(),n=u[u.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),u.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(e)}}function _(t){t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function f(t){var e=document.createElement("style");return e.type="text/css",d(t,e),e}function p(t,e){var i,n,a;if(e.singleton){var o=s++;i=l||(l=f(e)),n=g.bind(null,i,o,!1),a=g.bind(null,i,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return e.rel="stylesheet",d(t,e),e}(e),n=m.bind(null,i),a=function(){_(i),i.href&&URL.revokeObjectURL(i.href)}):(i=f(e),n=v.bind(null,i),a=function(){_(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else a()}}t.exports=function(t,e){void 0===(e=e||{}).singleton&&(e.singleton=o()),void 0===e.insertAt&&(e.insertAt="bottom");var i=h(t);return c(i,e),function(t){for(var a=[],o=0;o<i.length;o++){var r=i[o];(l=n[r.id]).refs--,a.push(l)}for(t&&c(h(t),e),o=0;o<a.length;o++){var l;if(0===(l=a[o]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete n[l.id]}}}};var y,x=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function g(t,e,i,n){var a=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=x(e,a);else{var o=document.createTextNode(a),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}function v(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function m(t,e){var i=e.css,n=e.sourceMap;n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var a=new Blob([i],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});for(var i="function"==typeof Symbol&&"symbol"===m(Symbol.iterator)?function(t){return void 0===t?"undefined":m(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":m(t)},n={},a=["Null","Undefined","Number","Boolean","String","Object","Function","Array","RegExp","Date"],o=0;o<a.length;o++)n["[object "+a[o]+"]"]=a[o].toLowerCase();function r(t){return n[Object.prototype.toString.call(t)]||"Object"}e.default={copy:function(t,e){if(null===t||"object"!=(void 0===t?"undefined":i(t)))return t;var n,a,o,l=function(t,e){return r(t)===e}(t,"array")?[]:{};for(n in t)o=r(a=t[n]),l[n]=!e||"array"!==o&&"object"!==o?a:this.copy(a);return l}}}])},t.exports=i()})),za=Pa(Wa),Ma=(Wa.Js2WordCloud,function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","word-cloud-chart"),i._container=t,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="",i._endPause=0,i._fontFamily="noto",i._fontSizeMax="45",i._fontSizeMin="13",i._outerImgUrl="circle.png",i._outerShape="circle",i._textDirection="横向",i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t._data;d3.select(t._container).selectAll("canvas").remove(),d3.select(t._container).selectAll("div").remove(),t.mainGroup.selectAll("*").remove();for(var i=[],n=0;n<e.length;n++)i.push([e[n].name,parseFloat(e[n].value)]);var a=0,o=0,r=0,l=0;"横向"==t._textDirection?(o=0,r=0,l=0):"对角线"==t._textDirection?(o=-.7854,r=.7854,l=1):"横竖混排"==t._textDirection?(o=1.5708,r=1.5708,l=.5):"横斜混排"==t._textDirection&&(o=.7854,r=.7854,l=.5);t.widthOfNoMargin,t.heightOfNoMargin;var s=t.hideHeight,u=t.hideUnitHeight,c=(t.hideSourceHeight,this._titleText&&this._titleShow&&this._titlePadding,this._unitWord&&this._unitShow?this._unitPadding:0),h=(this._sourceWord&&this._sourceShow&&this._sourcePadding,this._titleText&&this._titleShow?this.title.height()-.4*this._titleFontSize+this._titlePadding:0);(new RegExp("^方正[一-龥]+$").test(this._titleFontFamily)||"站酷高端黑"==this._titleFontFamily)&&(h=this._titleText&&this._titleShow?this.title.height()-.2*this._titleFontSize+this._titlePadding:0);var d=this._unitWord&&this._unitShow?1.125*parseFloat(this._unitFontSize)+this._unitPadding:0,_=this._sourceWord&&this._sourceShow?1.125*parseFloat(this._sourceFontSize)+this._sourcePadding:0,f=this.heightOfNoMargin-h-d-_,p=(this._unitWord&&this._unitShow&&this._unitFontSize,(s||0)-(this._titleText&&this._titleShow?.15*this._titleFontSize:0)+(u||0)+c);"bottom"!=this._titleY&&this._titleText&&this._titleShow||(p=(u||0)+c);var y=document.querySelector(".page-size span")?Number.parseInt(document.querySelector(".page-size span").innerHTML)/100:1,x={tooltip:{show:t._tooltipShow,formatter:function(e){return e[0]+"："+E(e[1],t._numberStyle,t._decimalPlaces)}},list:i,fontFamily:t._fontFamily,fontWeight:"bold",fontSizeFactor:1,maxFontSize:parseFloat(t._fontSizeMax),minFontSize:parseFloat(t._fontSizeMin),minRotation:o,maxRotation:r,rotateRatio:l,size:.1,shape:t._outerShape,backgroundColor:"transparent",color:function(){return a++,t._data[a-1].color},ellipticity:1,gridSize:5,classes:t.id,mainHeight:f,transY:p,transition:t._transition,startDelay:1e3*parseFloat(t._startDelay),duration:1e3*parseFloat(t._duration),tooltipScale:y};new za(t._container).setOption(x)}},{key:"updateLegend",value:function(){}},{key:"configLegend",value:function(){}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._fontFamily=e.fontFamily?e.fontFamily:this._fontFamily,this._fontSizeMax=e.fontSizeMax?e.fontSizeMax:this._fontSizeMax,this._fontSizeMin=e.fontSizeMin?e.fontSizeMin:this._fontSizeMin,this._outerImgUrl=e.outerImgUrl?e.outerImgUrl:this._outerImgUrl,this._outerShape=e.outerShape?e.outerShape:this._outerShape,this._textDirection=e.textDirection?e.textDirection:this._textDirection),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}}]),e}(nt)),Da=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","relative-radar"),e._lineFunc=null,e._startAngle=0,e._endAngle=2*Math.PI,e._radius=100,e._stroke=null,e._borderWidth=2,e._strokeDasharry="",e._transition=!0,e}return w(n,t),S(n,[{key:"update",value:function(){for(var t=this,n=t._data,a=t._startAngle,o=t._endAngle,r=t._radius,l=t._deadData[0].data.length,s=2*Math.PI/l,u=[],h=[],d=function(t){for(var e=[],i=0;i<n.length;i++)e.push(n[i].data[t].value);n.length>0?(u.push([0,d3.max(e)]),h.push(d3.range(6).map((function(t){return d3.max(e)/5*t})))):(u.push([0,1]),h.push(d3.range(6).map((function(t){return.2*t}))))},_=0;_<(n.length>0?n[0].data.length:0);_++)d(_);for(var f=d3.scaleLinear().domain([0,1]).range([0,r]).clamp(!0),g=[],v=0;v<n.length;v++){g[v]=[];for(_=0;_<n[v].data.length;_++){var m=n[v].data[_].value;f=d3.scaleLinear().domain(u[_]).range([0,r]).clamp(!0),g[v][_]=f(m)}}for(var b=[],S=0;S<g.length;S++)for(var k=g[S],w="",C=[],O=0;O<l;O++){var F=k[O],L=F*Math.sin(O*s),P=-F*Math.cos(O*s);w+=L+","+P+" ",C.push({x:L,y:P,value:n[S].data[O].value}),b[S]={polygon:w,points:C}}for(var A=5;A>0;A--)for(var W=[],z=r/5*A,M=0;M<l;M++){var R=z*Math.sin(M*s),N=-z*Math.cos(M*s);W.push({x:R,y:N})}for(var T=h.length>0?h[0].length-1:0;T>=0;T--){for(var B=[],G=0;G<h.length;G++)0!=h[G][T]&&B.push(h[G][T]);B.length}var I=t.group;I.selectAll("*").remove(),t.group.selectAll("linearGradient").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var Y=t._lineFunc||d3.line().x((function(t){return t.x})).y((function(t){return t.y}));Y.curve(t._curve);var H=t._lineFunc||d3.line().x((function(t){return 0})).y((function(t){return 0}));H.curve(t._curve),I.selectAll(".radar-area-point").remove(),I.selectAll(".relative-polygon").remove(),I.selectAll(".circle-g").remove();var V=I.append("g").selectAll("g").data(b);V.exit().remove(),V.enter().append("g").attr("class","radar-area-point").merge(V).each((function(e,i){var a=d3.select(this).append("path").attr("class","relative-polygon").attr("d",(function(t,e){return H(b[i].points)})).style("fill",(function(e){return n[i].color&&/\[/.test(n[i].color)?"url("+c("#"+t.id+"-index-"+i)+")":n[i].color&&/#/.test(n[i].color)?n[i].color:"rgb("+U(n[i].color,0)+","+U(n[i].color,1)+","+U(n[i].color,2)+")"})).style("fill-opacity",(function(e){if(n[i].color&&/#/.test(n[i].color))return t._fillOpacity;var a=U(n[i].color,3)||1;return t._fillOpacity*a})).style("stroke",(function(e,a){return/\[/.test(n[i].color)?"url("+c("#"+t.id+"-index-"+i)+")":n[i].color})).style("stroke-width",t._lineWidth);null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?a.attr("d",(function(t,e){return Y(b[i].points)})):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?a.attr("d",(function(t,e){return Y(b[i].points)})):a.transition().delay((function(e,i){return t._transition?.1*t._duration+t._startDelay:0})).duration(t._transition?.8*t._duration:0).attr("d",(function(t,e){return Y(b[i].points)})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?a.attr("d",(function(t,e){return Y(b[i].points)})):a.transition().delay((function(e,a){return t._transition?i*(.8*t._duration/(n.length>0?n.length:0))+.1*t._duration+t._startDelay:0})).duration(t._transition?.8*t._duration/(n.length>0?n.length:0):0).attr("d",(function(t,e){return Y(b[i].points)})));var o=d3.select(this).selectAll("circle").data(e.points);o.exit().remove();var r=o.enter().append("circle").attr("class","circle-g").merge(o).attr("cx",0).attr("cy",0).style("stroke",t._strokeColor||(/\[/.test(n[i].color)?"url("+c("#"+t.id+"-index-"+i)+")":n[i].color)).style("stroke-width",t._strokeWidth||0).attr("r",0).attr("fill",t._fillColor||(/\[/.test(n[i].color)?"url("+c("#"+t.id+"-index-"+i)+")":n[i].color));null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?r.attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?r.attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):r.attr("r",0).transition().delay(t._transition?.1*t._duration+t._startDelay:0).duration(t._transition?.8*t._duration:0).attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?r.attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})):r.attr("r",0).transition().delay(t._transition?i*(.8*t._duration/(n.length>0?n.length:0))+.1*t._duration+t._startDelay:0).duration(t._transition?.8*t._duration/(n.length>0?n.length:0):0).attr("r",t._endPointRadius).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})))})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);for(var $=[],Z=0;Z<l;Z++){for(var Q=[],K=0;K<b.length;K++)Q.push(b[K].points[Z].value);$.push(d3.max(Q))}I.selectAll(".polygon-radar-texts").remove();var J=I.append("g").selectAll("g").data(n);J.exit().remove(),J.enter().append("g").merge(J).each((function(e,i){var n=d3.select(this).append("g").selectAll("text").data(b[i].points);n.exit().remove();var a=n.enter().append("text").attr("class","polygon-radar-texts").merge(n).text((function(e,i){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",t._fontColor).attr("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(t,e){return t.value==$[e]?t.x+.06*r*(e*s==1.5*Math.PI?-1:Math.sin(e*s))||0:t.x-.06*r*Math.sin(e*s)||0})).attr("y",(function(e,i){return e.value==$[i]?e.y+.06*r*(i*s==0?1.5:Math.cos(i*s))+(i*s==0?t._fontSize/2.5:0)||0:e.y-.06*r*(i*s==Math.PI?-1.5:Math.cos(i*s))+(i*s==Math.PI?t._fontSize/2.5:0)||0})).attr("text-anchor",(function(t,e){return e*s==0||e*s==Math.PI?"middle":e*s>Math.PI&&t.value!=$[e]?"start":e*s>Math.PI&&t.value==$[e]||e*s>0&&e*s<Math.PI&&t.value!=$[e]?"end":void 0})).attr("dy",(function(t,e){if(t.value==$[e])if(t.value==d3.max($)){if(e*s<Math.PI/2||e*s>1.5*Math.PI)return"0.8em";if(e*s>Math.PI/2&&e*s<1.5*Math.PI)return"-0.8em";if(e*s==Math.PI/2||e*s==1.5*Math.PI)return"1.2em"}else{if(e*s==0)return"0.2em";if(e*s==Math.PI)return"0";if(e*s<Math.PI/2||e*s>1.5*Math.PI)return"0.6em";if(e*s>Math.PI/2&&e*s<1.5*Math.PI)return"-0.6em";if(e*s==Math.PI/2||e*s==1.5*Math.PI)return"1em"}else if(t.value!=$[e])return e*s==0||e*s>Math.PI&&e*s<1.5*Math.PI?"0.3em":"0.2em"})).style("display",t._labelShow?"block":"none");t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().delay(t._transition?.9*t._duration+t._startDelay:0).duration(t._transition?.1*t._duration:0).style("opacity",1)}));for(var tt=[],et=1.1*r,it=0;it<l;it++){var nt=et*Math.sin(it*s),at=-et*Math.cos(it*s);tt.push({x:nt,y:at})}var ot=n.length>0?n[0].data.map((function(t){return-1!=String(t.name).indexOf("&-")?"":t.name})):[],rt=ot.length,lt=(o-a)/(rt>0?rt:1);I.selectAll(".angle-text").remove();var st=I.append("g").selectAll("text").data(tt);st.exit().remove();var ut=st.enter().append("text").attr("class","angle-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0){if("水平"==t._xLabelDirection){var o=Math.cos(a+lt*i-Math.PI/2)*(r+10),l=t._mainWidth/2-Math.abs(o);return X(ot[i],l,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var s=Math.sin(a+lt*i-Math.PI/2)*(r+10),u=t._mainHeight/2-Math.abs(s);return j(ot[i],u,t._themeFontSize,t._themeFontFamily)}}})).attr("x",(function(t,e){var i=a+lt*e;return Math.cos(i-Math.PI/2)*(r+10)})).attr("y",(function(t,e){var i=a+lt*e;return Math.sin(i-Math.PI/2)*(r+10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)ut.attr("transform",(function(e,i){var n=a+lt*i;return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,0)":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+.5*t._themeFontSize+")":"translate(0,"+.8*t._themeFontSize+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".angle-text").remove();var ct=t.group.append("g").selectAll("text").data(tt);ct.exit().remove(),ct.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(a+lt*e)/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none").text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(ot[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",r+5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(a+lt*e)/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(a+lt*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(r+5)+",0)":null}))}else{I.selectAll(".tick-text").remove();var ht=t.group.selectAll("g.text-group").data(tt);ht.exit().remove();ht.enter().append("g").attr("class","text-group").merge(ht).each((function(i,o){d3.select(this);var l=r+10,s=a+lt*o,u=d3.select(this.parentNode),c="arc-path-"+o+"-"+t.id,h=e(l+.6*t._themeFontSize,s-lt/2+.015,s+lt/2-.015),d=t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);n.length>0&&D(u,d,ot[o],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none")}))}1==t._interrupt?ut.style("opacity",1).style("display",t._showX?"block":"none"):ut.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none");for(var dt=0;dt<l;dt++)dt*s==0||dt*s==Math.PI?d3.select(I.selectAll(".angle-text").nodes()[dt]).attr("text-anchor","middle"):dt*s>Math.PI?d3.select(I.selectAll(".angle-text").nodes()[dt]).attr("text-anchor","end"):dt*s>0&&dt*s<Math.PI&&d3.select(I.selectAll(".angle-text").nodes()[dt]).attr("text-anchor","start");if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var _t=t.group.selectAll(".angle-text"),ft=[],pt=[],yt=0;yt<_t._groups[0].length;yt++){pt.push(yt);for(var xt=yt+1;xt<_t._groups[0].length;xt++){p(i(d3.select(_t._groups[0][yt])),i(d3.select(_t._groups[0][xt])))&&(ft.push(yt),d3.select(_t._groups[0][yt]).style("opacity","0"))}}for(var gt=new Set(ft),vt=Array.from(gt),mt=jt(vt,pt),bt=0;bt<vt.length;bt++){for(var St=[],kt=0;kt<mt.length;kt++){var wt=i(d3.select(_t._groups[0][vt[bt]])),Ct=i(d3.select(_t._groups[0][mt[kt]]));if(St.push(p(wt,Ct)),p(wt,Ct)){if(vt[bt]==mt[kt])continue;d3.select(_t._groups[0][vt[bt]]).remove()}}0==St.filter((function(t){return 1==t})).length&&mt.push(vt[bt])}for(var Ot=0;Ot<mt.length;Ot++)d3.select(_t._groups[0][mt[Ot]]).style("opacity","1")}for(var Ft=I.selectAll(".polygon-radar-texts"),Lt=[],Pt=[],At=0;At<Ft._groups[0].length;At++){Pt.push(At);for(var Wt=At+1;Wt<Ft._groups[0].length;Wt++){p(i(d3.select(Ft._groups[0][At])),i(d3.select(Ft._groups[0][Wt])))&&(Lt.push(At),d3.select(Ft._groups[0][At]).style("visibility","hidden"))}}for(var zt=new Set(Lt),Mt=Array.from(zt),Dt=jt(Mt,Pt),Rt=0;Rt<Mt.length;Rt++){for(var Nt=[],Tt=0;Tt<Dt.length;Tt++){var Bt=i(d3.select(Ft._groups[0][Mt[Rt]])),Gt=i(d3.select(Ft._groups[0][Dt[Tt]]));if(Nt.push(p(Bt,Gt)),p(Bt,Gt)){if(Mt[Rt]==Dt[Tt])continue;d3.select(Ft._groups[0][Mt[Rt]]).style("visibility","hidden")}}0==Nt.filter((function(t){return 1==t})).length&&Dt.push(Mt[Rt])}for(var Xt=0;Xt<Dt.length;Xt++)d3.select(Ft._groups[0][Dt[Xt]]).style("visibility","visible");function jt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"deadData",value:function(t){return arguments.length?(this._deadData=t,this):this._deadData}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),Ra=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.gridPolygon=new mn(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.radar=new Da(i.coreGroup),i._startAngle=0,i._endAngle=2*Math.PI,i._showPoints=!0,i._fillOpacity=0,i._curve=d3.curveLinearClosed,i._lineWidth=2,i._strokeWidth=1,i._strokeColor="#FFFFFF",i._fillColor="",i._endPointRadius=3.5,i._labelShow=!1,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同时径向展开","依次径向展开"],i._moveStyle="同时径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var e=t.activeData,i=t.gridPolygon,n=t.radar,a=(t.tooltip,t.widthOfCore,t.heightOfCore,t.widthOfNoMargin),r=t.heightOfMainGroup,l=(t._fontSize,t._startAngle,t._endAngle,0),s=void 0,u=void 0,h=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"";"水平"==t._xLabelDirection&&1==t._xTickShow?(s=d3.max(h.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),u=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(s=d3.max(h.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),u=d3.max(h.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(s=t._fontSize,u=t._fontSize):(s=0,u=0),s=s<.4*a*.88?s:.4*a*.88,u=u<.4*r*.88?u:.4*r*.88,l="外部"==t._axisPositonChoice?Math.min(.88*a/2-s,.88*r/2-u):.88*Math.min(a,r)/2;var d=t.defs;d.selectAll("filter").remove();var _=d.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_relativeRadar").attr("filterUnits","objectBoundingBox");if(_.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),_.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),_.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),_.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),_.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var f=x(t._strokeColor),p=[],g=!0,v=!1,m=void 0;try{for(var b,S=f[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),p.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=p.concat(),F=O.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var L=x(t._fillColor),P=[],A=!0,W=!1,z=void 0;try{for(var M,D=L[Symbol.iterator]();!(A=(M=D.next()).done);A=!0){var N=M.value,T=[],B=N.split(":");T.push(q(B[0])),T.push(B[1]),P.push(T)}}catch(t){W=!0,z=t}finally{try{!A&&D.return&&D.return()}finally{if(W)throw z}}var G=P.concat(),X=G.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(X[1]).x1+"%").attr("y1",y(X[1]).y1+"%").attr("x2",y(X[1]).x2+"%").attr("y2",y(X[1]).y2+"%").selectAll("stop").data(G).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).deadData(t.sortedDataCopy).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).labelShow(t._labelShow).radius(l).curve(t._curve).endPointRadius(t._endPointRadius).strokeWidth(t._strokeWidth).strokeColor(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).lineWidth(t._lineWidth).fillOpacity(t._fillOpacity).fillColor(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).showX(t._xTickShow).xLabelDirection(t._xLabelDirection).mainWidth(a).mainHeight(r).defs(t.defs).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(i,n){var a=[{text:e[n].name=="$-"+(n+1)?"":e[n].name,color:e[n].color}];e[n].data.forEach((function(e,i){a.push({text:(e.name=="&-"+(i+1)?"":e.name)+": "+E(e.value,t._numberStyle,t._decimalPlaces),color:"none"})})),d3.select(this).style("stroke-opacity",.8).style("stroke-width",1.5*t._lineWidth);var o=t.group.selectAll(".radar-area-point").nodes(),r=t.group.selectAll(".relative-radar .relative-polygon").nodes();d3.selectAll(o[n].childNodes).style("r",1.5*t._endPointRadius),d3.select(r[n]).transition().style("stroke-width",1.5*t._borderWidth),t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(e,i){d3.select(this).style("stroke-opacity",.8).style("stroke-width",1.5*t._lineWidth);var n=t.group.selectAll(".radar-area-point").nodes(),a=t.group.selectAll(".relative-radar .relative-polygon").nodes();d3.select(a[i]).style("stroke-width",1.5*t._lineWidth),d3.selectAll(n[i].childNodes).style("r",1.5*t._endPointRadius),t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e,i){d3.select(this).style("stroke-opacity",1).style("stroke-width",t._lineWidth);var n=t.group.selectAll(".radar-area-point").nodes(),a=t.group.selectAll(".relative-radar .relative-polygon").nodes();d3.select(a[i]).style("stroke-width",t._lineWidth),d3.selectAll(n[i].childNodes).style("r",t._endPointRadius),t.tooltip.hide()})),i.sectorCount(e[0]?e[0].data.length:1).radius(l).fillOpacity(null==t._fillOpacity?0:t._fillOpacity).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridLineStyle?t._gridStrokeDasharray:"").gridLineWidth(t._gridLineWidth);var j=(t._width-t._marginLeft-t._marginRight)/2;t.gridPolygon.translate(j,r/2+(e.length>0&&3==e[0].data.length?l/4:0)).update(),t.coreGroup.call(o,j,r/2+(e.length>0&&3==e[0].data.length?l/4:0)),i.update(),n.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=bn;return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"水平").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:""),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"");var r={straight:d3.curveLinearClosed,step:d3.curveStepAfter,curve:d3.curveCardinalClosed};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinearClosed,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"widthOfNoMargin",get:function(){var t=this._width-this._marginLeft-this._marginRight;return t>0?t:0}}]),e}(vt),Na=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","contrastive-funnel-polygon"),i._fontColor="#ffffff",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._maxValue,n=e.length>0?e[0].value:0,a=d3.scaleLinear().domain([0,i]).range([0,t._sWidth]),o=(t._sHeight>0?t._sHeight-(e.length-1)*t._paddingInner:0)/e.length;o=o>0?o:0;for(var r=t.group,l=[],s=0;s<e.length;s++)e[s].percent=-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)),l.push(-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)));t.group.selectAll("*").remove(),t.group.selectAll(".funnel-groups").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var u=r.selectAll("polygon").data(e);u.exit().remove();var h=u.enter().append("g").attr("class","funnel-groups").attr("transform",(function(e,i){return"translate(0, "+i*t._paddingInner+")"}));if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle))h.append("polygon").merge(u).attr("class","funnel-polygons").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).style("opacity",1).attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)})).style("display",(function(t){return t.tooltipValueShow?"block":"none"})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);else if(1==t._moveOptions.indexOf(t._moveStyle)){var d=h.append("polygon").merge(u).attr("class","funnel-polygons").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).style("opacity",1).attr("points",(function(i,r){return r==e.length-1?a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r:a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)/2+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)/2+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*r})).style("display",(function(t){return t.tooltipValueShow?"block":"none"})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);t._interrupt?d.attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)})):d.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)}))}if(0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".funnel-text-group").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var _=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);if(t._interrupt?_.style("opacity",1):_.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),_.append("text").text((function(t,e){return t.name=="$-"+e?"":t.name})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","1em").style("display",t._labelShow?"block":"none"),_.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","1em").style("display",t._labelShow?"block":"none"),_.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","1em").style("display",t._labelShow?"block":"none"),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none");else if(1==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block"));else if(2==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),r.selectAll(".funnel-texts-value").style("display","none"),_.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),_.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),_.attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"})));else if(3==t._contentChoice.length&&t._labelShow){for(var f=r.selectAll(".funnel-texts-name").nodes(),p=r.selectAll(".funnel-texts-value").nodes(),g=0;g<l.length;g++)d3.select(f[g]).attr("text-anchor","end").attr("dx",-R(E(l[g],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2-parseFloat(t._fontSize)),d3.select(p[g]).attr("text-anchor","start").attr("dx",R(E(l[g],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2+parseFloat(t._fontSize));r.selectAll(".funnel-texts-percent"),_.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))}}else if(1==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var v=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);t._interrupt?v.style("opacity",1):v.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),v.append("text").text((function(t,e){return(t.name=="$-"+e?"":t.name)+(t.firstName=="$-"+e+1?"":t.firstName)})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","-0.1em").style("display",t._labelShow?"block":"none"),v.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","1em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(-R((e.name=="$-"+i?"":e.name)+(e.firstName=="$-"+i+1?"":e.firstName),t._fontSize,t._fontFamily)/2+R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)+5)+",0)"})),v.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","1em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+-R((e.name=="$-"+i?"":e.name)+(e.firstName=="$-"+i+1?"":e.firstName),t._fontSize,t._fontFamily)/2+",0)"})),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","0.5em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","middle").attr("dy","0.5em").attr("transform","translate(0, 0)"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","middle").attr("dy","0.5em").attr("transform","translate(0, 0)")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","middle").attr("transform","translate(0, 0)"),r.selectAll(".funnel-texts-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","middle").attr("transform","translate(0, 0)")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","middle").attr("transform","translate(0, 0)").attr("dy","-0.1em"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","middle").attr("transform","translate(0, 0)").attr("dy","1em")):3==t._contentChoice.length&&t._labelShow}else if(2==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var m=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);if(t._interrupt?m.style("opacity",1):m.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),m.append("text").text((function(t,e){return(t.name=="$-"+e?"":t.name)+(t.firstName=="$-"+e+1?"":t.firstName)})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","0.3em").style("display",t._labelShow?"block":"none"),m.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","0.3em").style("display",t._labelShow?"block":"none"),m.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","0.3em").style("display",t._labelShow?"block":"none"),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none");else if(1==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block"));else if(2==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),r.selectAll(".funnel-texts-value").style("display","none"),m.attr("transform",(function(e,i){return"translate("+(R((e.name=="$-"+i?"":e.name)+(e.firstName=="$-"+i+1?"":e.firstName),t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),m.attr("transform",(function(e,i){return"translate("+(R((e.name=="$-"+i?"":e.name)+(e.firstName=="$-"+i+1?"":e.firstName),t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),m.attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"})));else if(3==t._contentChoice.length&&t._labelShow){for(var b=r.selectAll(".funnel-texts-name").nodes(),S=r.selectAll(".funnel-texts-value").nodes(),k=0;k<l.length;k++)d3.select(b[k]).attr("text-anchor","end").attr("dx",-R(E(l[k],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2-parseFloat(t._fontSize)),d3.select(S[k]).attr("text-anchor","start").attr("dx",R(E(l[k],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2+parseFloat(t._fontSize));r.selectAll(".funnel-texts-percent"),m.attr("transform",(function(e,i){return"translate("+(R((e.name=="$-"+i?"":e.name)+(e.firstName=="$-"+i+1?"":e.firstName),t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))}}return t}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ta=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","contrastive-funnel-bg"),i._fontColor="#ffffff",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._maxValue,n=e.length>0?e[0].value:0,a=d3.scaleLinear().domain([0,i]).range([0,t._sWidth]),o=(t._sHeight>0?t._sHeight-(e.length-1)*t._paddingInner:0)/e.length;o=o>0?o:0;for(var r=t.group,l=[],s=0;s<e.length;s++)e[s].percent=-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)),l.push(-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)));t.group.selectAll("*").remove(),t.group.selectAll(".bg-funnel-groups").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-bg-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var u=r.selectAll("polygon").data(e);u.exit().remove();var h=u.enter().append("g").attr("class","bg-funnel-groups").attr("transform",(function(e,i){return"translate(0, "+i*t._paddingInner+")"}));if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle))h.append("polygon").merge(u).attr("class","bg-funnel-polygons").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-bg-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-bg-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).style("opacity",1).attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)})).style("display",(function(t){return t.tooltipValueShow?"block":"none"})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);else if(1==t._moveOptions.indexOf(t._moveStyle)){var d=h.append("polygon").merge(u).attr("class","bg-funnel-polygons").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-bg-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-bg-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).style("opacity",1).attr("points",(function(i,r){return r==e.length-1?a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r:a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)/2+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)/2+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*r})).style("display",(function(t){return t.tooltipValueShow?"block":"none"})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);t._interrupt?d.attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)})):d.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("points",(function(i,r){return r==e.length-1?a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(i.value)/2+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1):a(e[r].total)/2+(t._sWidth-a(n))/2+","+o*r+"\n        "+(a(i.value)+a(e[r].total)/2+(t._sWidth-a(n))/2)+","+o*r+" \n        "+(a(e[r+1].value)+a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)+" \n        "+(a(e[r+1].total)/2+(t._sWidth-a(n))/2)+","+o*(r+1)}))}if(0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".funnel-text-group").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var _=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);t._interrupt?_.style("opacity",1):_.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),_.append("text").text((function(i,o){if(o==e.length-1){var r=a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width;return X(i.firstName=="$-"+o+1?"":i.firstName,.96*t._width-r,t._fontSize,t._fontFamily)}var l=a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width;return X(i.firstName=="$-"+o+1?"":i.firstName,.96*t._width-l,t._fontSize,t._fontFamily)})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2+.11*t._width:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)+.11*t._width})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.35em").style("display",t._labelShow?"block":"none"),0!=t._labelShow&&null!=t._labelShow&&null!=t._contentOption&&null!=t._contentChoice&&0!=t._contentChoice.length||r.selectAll(".funnel-texts-name").style("display","none")}else if(1==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var f=0,p=0;t._labelShow&&(3==t._contentChoice.length?f=(null==t._decimalPlaces?0:t._decimalPlaces)*t._fontSize*2:(2==t._contentChoice.length||1==t._contentChoice.length&&0!=t._contentOption.indexOf(t._contentChoice[0]))&&(f=(null==t._decimalPlaces?0:t._decimalPlaces)*t._fontSize)),f>.15*t._width&&(p=f-.15*t._width);var g=h.append("g").merge(u).attr("class","funnel-text-group").style("opacity",0);t._interrupt?g.style("opacity",1):g.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),g.append("line").attr("class","funnel-texts-line").attr("x1",(function(i,o){return o==e.length-1?a(i.value)+a(e[o].total)/2-a(e[o].value)/4+(t._sWidth-a(n))/2:a(i.value)+a(e[o].total)/2+(t._sWidth-a(n))/2-(e[o].value-e[o+1].value>0?a(e[o].value-e[o+1].value)/4:-a(e[o+1].value-e[o].value)/4)})).attr("y1",(function(t,e){return o*(e+1)-o/2})).attr("x2",(function(e,i){return.78*t._width-p})).attr("y2",(function(t,e){return o*(e+1)-o/2})).style("stroke",(function(t){return"#bfbfbf"})).style("stroke-width",1).style("display",t._labelShow?"block":"none"),g.append("text").text((function(e,i){return X((e.name=="$-"+i?"":e.name)+(e.firstName=="$-"+i+1?"":e.firstName),.18*t._width,t._fontSize,t._fontFamily)})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return.78*t._width-p})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","-0.35em").style("display",t._labelShow?"block":"none"),g.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return.78*t._width-p})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.75em").style("display",t._labelShow?"block":"none"),g.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e,i){return.78*t._width-p})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","start").attr("dy","0.75em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)+5)+",0)"})),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","0.35em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","0.35em"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.35em").attr("transform","translate(0, 0)")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","0.75em"),r.selectAll(".funnel-texts-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.75em").attr("transform","translate(0, 0)")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("dy","-0.35em"),r.selectAll(".funnel-texts-value").style("display","block").attr("dy","0.75em").attr("transform","translate(0, 0)")):3==t._contentChoice.length&&t._labelShow}return t}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ba=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","contrastive-bg-text"),i._fontColor="#ffffff",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._maxValue,n=e.length>0?e[0].value:0,a=d3.scaleLinear().domain([0,i]).range([0,t._sWidth]),o=(t._sHeight>0?t._sHeight-(e.length-1)*t._paddingInner:0)/e.length;o=o>0?o:0;for(var r=t.group,l=[],s=0;s<e.length;s++)e[s].percent=-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)),l.push(-1==String(e[s].value/i*100).indexOf(".")?parseFloat(e[s].value/i*100):parseFloat((e[s].value/i*100).toFixed(2)));if(t.group.selectAll("*").remove(),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)||2==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)t.group.selectAll(".funnel-text-group").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){t.group.selectAll(".funnel-text-group").remove();var u=r.selectAll("g").data(e);u.exit().remove();var c=u.enter().append("g").attr("class","funnel-text-group").style("opacity",0);if(t._interrupt?c.style("opacity",1):c.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),c.append("text").text((function(t,e){return t.name=="$-"+e?"":t.name})).attr("class","funnel-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","-0.1em").style("display",t._labelShow?"block":"none"),c.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","funnel-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","-0.1em").style("display",t._labelShow?"block":"none"),c.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","funnel-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(i,o){return a(i.value)/2+a(e[o].total)/2+(t._sWidth-a(n))/2})).attr("y",(function(t,e){return o*(e+1)-o/2})).attr("text-anchor","middle").attr("dy","-0.1em").style("display",t._labelShow?"block":"none"),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length)r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none");else if(1==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","block"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block"),r.selectAll(".funnel-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block"));else if(2==t._contentChoice.length&&t._labelShow)0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),r.selectAll(".funnel-texts-value").style("display","none"),c.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", "+i*t._paddingInner+")"}))):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(r.selectAll(".funnel-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-percent").style("display","none"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),c.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", "+i*t._paddingInner+")"}))):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(r.selectAll(".funnel-texts-name").style("display","none"),r.selectAll(".funnel-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-0.3em"),r.selectAll(".funnel-texts-value").style("display","block").attr("text-anchor","start").attr("dx","0.3em"),c.attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", "+i*t._paddingInner+")"})));else if(3==t._contentChoice.length&&t._labelShow){for(var h=r.selectAll(".funnel-texts-name").nodes(),d=r.selectAll(".funnel-texts-value").nodes(),_=0;_<l.length;_++)d3.select(h[_]).attr("text-anchor","end").attr("dx",-R(E(l[_],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2-parseFloat(t._fontSize)),d3.select(d[_]).attr("text-anchor","start").attr("dx",R(E(l[_],t._numberStyle,t._decimalPlaces),t._fontSize,t._fontFamily)/2+parseFloat(t._fontSize));r.selectAll(".funnel-texts-percent"),c.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", "+i*t._paddingInner+")"}))}}return t}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"sWidth",value:function(t){return arguments.length?(this._sWidth=t,this):this._sWidth}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"sHeight",value:function(t){return arguments.length?(this._sHeight=t,this):this._sHeight}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at);function Ga(t,e){var i=0,n=1,a=2;if(e.forEach((function(t){"objCol"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&("实际值"==t.name?n=t.index:a=t.index)})),P(t,[i],2))return[];if(!A(t,n)||!A(t,a))return[];for(var o={},r=[],l=t.length,s=t[0],u=[],c=1;c<l;c++)u.push(t[c].length);u.sort((function(t,e){return e-t}));for(var d=1;d<l;d++){var _=t[d],f=_[i];if(""!=f&&null!=f&&null!=f||(f="$-"+d),f){for(var p={name:f,showLegend:f!="$-"+d,data:[]},y=0;y<u[0];y++)if(y==n||y==a){var x=s[y];""!=x&&null!=x&&null!=x||(x="&-"+y),x&&(y==n&&p.data.push({name:x,value:""==_[y]||isNaN(parseFloat(_[y]))||null==_[y]||null==_[y]||parseFloat(_[y])<0?0:_[y],tooltipValueShow:!(isNaN(parseFloat(_[y]))||parseFloat(_[y])<0),type:"实际值"}),y==a&&p.data.push({name:x,value:""==_[y]||isNaN(parseFloat(_[y]))||null==_[y]||null==_[y]||parseFloat(_[y])<0?0:_[y],tooltipValueShow:!(isNaN(parseFloat(_[y]))||parseFloat(_[y])<0)}))}r.push(p)}}for(var g in o)r.push(o[g]);return r.forEach((function(t,e){t.key=h(t.name)+"-"+e})),r}var Xa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","contrasitive-funnel-chart"),i.funnelBg=new Ta(i.mainGroup),i.funnel=new Na(i.mainGroup),i.contrastiveBgText=new Ba(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._sortValue=null,i._labelShow=!1,i._positionOptions=["主体展示","内外展示","仅内部"],i._positionChoice="主体展示",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称"],i._textLabel={color:"#FFFFFF",fontFamily:"noto",fontSize:12},i._suffix="",i._borderWidth=1,i._borderColor="#FFFFFF",i._fillOpacity=1,i._gap=0,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向展开","横向同步展开"],i._moveStyle="纵向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.funnelBg,n=t.funnel,a=t.contrastiveBgText,o=(t.AnimationArea,t.widthOfNoMargin),r=0,l=0;1==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow&&(3==t._contentChoice.length?r=(null==t._decimalPlaces?0:t._decimalPlaces)*t._textLabel.fontSize*2:(2==t._contentChoice.length||1==t._contentChoice.length&&0!=t._contentOption.indexOf(t._contentChoice[0]))&&(r=(null==t._decimalPlaces?0:t._decimalPlaces)*t._textLabel.fontSize),r>.15*o&&(l=r-.15*o));for(var s=.69*o-l,u=.92*t.heightOfMainGroup,h=0;h<e.length;h++)for(var d=0;d<e[h].data.length;d++)e[h].data[d].diff=0==h?0:e[h-1].data[d].value-e[h].data[d].value;for(var _=0;_<e.length;_++)for(var f=0;f<e[_].data.length;f++)e[_].data[f].total=0==_?0:e[_-1].data[f].total+parseFloat(e[_].data[f].diff);for(var p=[],g=[],v=0;v<e.length;v++){p[v]={},g[v]={},p[v].color=e[v].color,p[v].firstName=e[v].name,g[v].color=e[v].color,g[v].firstName=e[v].name;for(var m=0;m<e[v].data.length;m++)"实际值"==e[v].data[m].type?(p[v].name=e[v].data[m].name,p[v].value=e[v].data[m].value,p[v].total=e[v].data[m].total,p[v].tooltipValueShow=e[v].data[m].tooltipValueShow):(g[v].name=e[v].data[m].name,g[v].value=e[v].data[m].value,g[v].total=e[v].data[m].total,g[v].tooltipValueShow=e[v].data[m].tooltipValueShow)}var b=d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}));if(t._borderColor&&/\[/.test(t._borderColor)){var S=x(t._borderColor),k=[],w=!0,C=!1,O=void 0;try{for(var F,L=S[Symbol.iterator]();!(w=(F=L.next()).done);w=!0){var P=F.value,A=[],W=P.split(":");A.push(q(W[0])),A.push(W[1]),k.push(A)}}catch(t){C=!0,O=t}finally{try{!w&&L.return&&L.return()}finally{if(C)throw O}}var z=k.concat(),M=z.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(M[1]).x1+"%").attr("y1",y(M[1]).y1+"%").attr("x2",y(M[1]).x2+"%").attr("y2",y(M[1]).y2+"%").selectAll("stop").data(z).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(g).maxValue(b).width(o).sWidth(s).sHeight(u).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onTransitionEnd((function(t,e){})).onMouseover((function(i,n){var a=[{text:""+(e[n].showLegend?e[n].name:""),color:i.color},{text:("&-"==e[n].data[0].name.slice(0,2)?"":e[n].data[0].name)+": "+(e[n].data[0].tooltipValueShow?E(e[n].data[0].value,t._numberStyle,t._decimalPlaces):"")},{text:("&-"==e[n].data[1].name.slice(0,2)?"":e[n].data[1].name)+": "+(e[n].data[1].tooltipValueShow?E(e[n].data[1].value,t._numberStyle,t._decimalPlaces):"")}];t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide()})),n.data(p).maxValue(b).width(o).sWidth(s).sHeight(u).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onTransitionEnd((function(t,e){})).onMouseover((function(i,n){var a=[{text:""+(e[n].showLegend?e[n].name:""),color:i.color},{text:("&-"==e[n].data[0].name.slice(0,2)?"":e[n].data[0].name)+": "+(e[n].data[0].tooltipValueShow?E(e[n].data[0].value,t._numberStyle,t._decimalPlaces):"")},{text:("&-"==e[n].data[1].name.slice(0,2)?"":e[n].data[1].name)+": "+(e[n].data[1].tooltipValueShow?E(e[n].data[1].value,t._numberStyle,t._decimalPlaces):"")}];t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide()})),a.data(g).maxValue(b).width(o).sWidth(s).sHeight(u).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var D=.155*o,R=.04*u;if(null==t._labelShow||null==t._positionOptions||null==t._positionChoice||2==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length||0!=t._positionOptions.indexOf(t._positionChoice)&&1!=t._positionOptions.indexOf(t._positionChoice)||1==t._labelShow&&(D=.04*o),t.funnel.translate(D,R).update(),t.funnelBg.translate(D,R).update(),t.contrastiveBgText.translate(D,R).update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle));else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",t.heightOfMainGroup),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",0).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("height",t.heightOfMainGroup),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=Ga;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._gap=0==e.gapDistance||e.gapDistance?e.gapDistance:this._gap),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n.transition||0==n.transition?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._suffix=i.suffix?i.suffix:"")}}]),e}(nt),ja=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-circle"),i._fontColor="#ffffff",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data.sort((function(t,e){return Math.abs(e.value)-Math.abs(t.value)}));t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var i=d3.max(e,(function(t){return Math.abs(t.value)}));e.length>0&&e[0].value;if("diameter"==t._bubbleSizeType){for(var n=d3.scaleLinear().domain([0,i]).range([0,t._maxRadius]),a=t.group,o=0;o<e.length;o++)e[o].percent=-1==String(e[o].value/i*100).indexOf(".")?parseFloat(e[o].value/i*100):parseFloat((e[o].value/i*100).toFixed(2));t.group.selectAll(".stack-circle-groups").remove();var r=a.selectAll("circle").data(e);r.exit().remove();var l=r.enter().append("g").attr("class","stack-circle-groups").append("circle").merge(r).attr("class","stack-circles").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._bubbleBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._bubbleBorderWidth||0).attr("r",(function(t,e){return n(t.value)})).attr("transform",(function(t,e){return"translate(0, "+n(t.total)+")"})).style("opacity",0).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);if(t._interrupt?l.style("opacity",1):l.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0})).style("opacity",1),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","none"),a.selectAll(".stack-circle-text-group").remove(),a.selectAll(".outer-circle-texts-name").style("display","none"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","none"),a.selectAll(".outer-circle-texts-line").style("display","none"),a.selectAll(".outer-circle-text-group").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){a.selectAll(".outer-circle-texts-name").style("display","none"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","none"),a.selectAll(".outer-circle-texts-line").style("display","none"),a.selectAll(".stack-circle-text-group").remove();var s=t.group.append("g").attr("class","stack-circle-text-group").selectAll("g").data(e);s.exit().remove();var u=s.enter().append("g");u.append("text").text((function(t,e){return t.name=="$-"+e?"":t.name})).attr("class","stack-circle-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t,i){return i==e.length-1?-n(t.value):-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).attr("text-anchor","end").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)/2-5)+","+t._maxRadius+")"})),u.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","stack-circle-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t,i){return i==e.length-1?-n(t.value):-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)/2+5)+","+t._maxRadius+")"})),u.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","stack-circle-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t,i){return i==e.length-1?-n(t.value):-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).attr("text-anchor","middle").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate(0,"+t._maxRadius+")"})),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","none"),a.selectAll(".stack-circle-text-group").remove(),a.selectAll(".outer-circle-texts-name").style("display","none"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","none"),a.selectAll(".outer-circle-texts-line").style("display","none"),a.selectAll(".outer-circle-text-group").remove()):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(a.selectAll(".stack-circle-texts-name").style("display","block").attr("text-anchor","middle").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","block").attr("text-anchor","middle").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".stack-circle-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","block").attr("text-anchor","middle").attr("transform","translate(0,"+t._maxRadius+")")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(a.selectAll(".stack-circle-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-2.5").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".stack-circle-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","2.5").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".stack-circle-texts-value").style("display","none"),u.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(a.selectAll(".stack-circle-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-2.5").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","block").attr("text-anchor","start").attr("dx","2.5").attr("transform","translate(0,"+t._maxRadius+")"),u.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-2.5").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".stack-circle-texts-value").style("display","block").attr("text-anchor","start").attr("dx","2.5").attr("transform","translate(0,"+t._maxRadius+")"),u.attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):3==t._contentChoice.length&&t._labelShow&&u.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))}else if(1==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","none"),a.selectAll(".outer-circle-text-group").remove();var h=t.group.append("g").attr("class","outer-circle-text-group").selectAll("g").data(e);h.exit().remove();var d=h.enter().append("g");d.append("line").attr("class","outer-circle-texts-line").attr("x1",0).attr("y1",(function(t,i){return i==e.length-1?2*-n(t.value)-1e-5:2*-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)-1e-5})).attr("x2",.32*t._width).attr("y2",(function(t,i){return i==e.length-1?2*-n(t.value):2*-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",1).style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate(0,"+(t._maxRadius+.5)+")"}));d.append("text").text((function(e,i){return X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily)})).attr("class","outer-circle-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",.32*t._width+2).attr("y",(function(t,i){return i==e.length-1?2*-n(t.value):2*-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate(0,"+t._maxRadius+")"}));var _=d.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","outer-circle-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",.32*t._width+2).attr("y",(function(t,i){return i==e.length-1?2*-n(t.value):2*-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){var n=X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily);return"translate("+(R(n,t._fontSize,t._fontFamily)+R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)+10)+","+t._maxRadius+")"}));d.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","outer-circle-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",.32*t._width+2).attr("y",(function(t,i){return i==e.length-1?2*-n(t.value):2*-n(e[i].value-e[i+1].value)-2*n(e[i+1].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){var n=X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily);return"translate("+(R(n,t._fontSize,t._fontFamily)+5)+","+t._maxRadius+")"}));0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(a.selectAll(".stack-circle-texts-name").style("display","none"),a.selectAll(".stack-circle-texts-percent").style("display","none"),a.selectAll(".stack-circle-texts-value").style("display","none"),a.selectAll(".stack-circle-text-group").remove(),a.selectAll(".outer-circle-texts-name").style("display","none"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","none"),a.selectAll(".outer-circle-texts-line").style("display","none"),a.selectAll(".outer-circle-text-group").remove()):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(a.selectAll(".outer-circle-texts-name").style("display","block").attr("text-anchor","start").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(a.selectAll(".outer-circle-texts-name").style("display","none"),a.selectAll(".outer-circle-texts-percent").style("display","block").attr("text-anchor","start").attr("transform","translate(0,"+t._maxRadius+")"),a.selectAll(".outer-circle-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(a.selectAll(".outer-circle-texts-name").style("display","none"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","block").attr("text-anchor","start").attr("transform","translate(0,"+t._maxRadius+")")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(a.selectAll(".outer-circle-texts-name").style("display","block"),a.selectAll(".outer-circle-texts-percent").style("display","block"),_.attr("transform",(function(e,i){var n=X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily);return"translate("+(R(n,t._fontSize,t._fontFamily)+5)+","+t._maxRadius+")"})),a.selectAll(".outer-circle-texts-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(a.selectAll(".outer-circle-texts-name").style("display","block"),a.selectAll(".outer-circle-texts-percent").style("display","none"),a.selectAll(".outer-circle-texts-value").style("display","block")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(a.selectAll(".outer-circle-texts-name").style("display","none"),_.attr("transform",(function(e,i){return"translate("+(R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)+5)+","+t._maxRadius+")"})),a.selectAll(".outer-circle-texts-value").style("display","block").attr("transform","translate(0,"+t._maxRadius+")")):3==t._contentChoice.length&&t._labelShow}t._interrupt?(a.selectAll(".stack-circle-text-group").style("opacity",1),a.selectAll(".outer-circle-text-group").style("opacity",1)):(a.selectAll(".stack-circle-text-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1),a.selectAll(".outer-circle-text-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1))}else{for(var f=d3.scaleSqrt().domain([0,i]).range([0,t._maxRadius]),p=t.group,g=0;g<e.length;g++)e[g].percent=-1==String(e[g].value/i*100).indexOf(".")?parseFloat(e[g].value/i*100):parseFloat((e[g].value/i*100).toFixed(2));t.group.selectAll(".stack-circle-groups").remove();var v=p.selectAll("circle").data(e);v.exit().remove();var m=v.enter().append("g").attr("class","stack-circle-groups").append("circle").merge(v).attr("class","stack-circles").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return t._bubbleBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._bubbleBorderWidth||0).attr("r",(function(t,e){return f(t.value)})).attr("transform",(function(t,e){return"translate(0, "+(f(i)-f(t.value))+")"})).style("opacity",0).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);if(t._interrupt?m.style("opacity",1):m.transition().duration(t._transition?.9*t._duration/(e.length>0?e.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e.length:1)*n:0})).style("opacity",1),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)||0==t._contentChoice.length)p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","none"),p.selectAll(".stack-circle-text-group").remove(),p.selectAll(".outer-circle-texts-name").style("display","none"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","none"),p.selectAll(".outer-circle-texts-line").style("display","none"),p.selectAll(".outer-circle-text-group").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){p.selectAll(".outer-circle-texts-name").style("display","none"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","none"),p.selectAll(".outer-circle-texts-line").style("display","none"),p.selectAll(".stack-circle-text-group").remove();var b=t.group.append("g").attr("class","stack-circle-text-group").selectAll("g").data(e);b.exit().remove();var S=b.enter().append("g");S.append("text").text((function(t,e){return t.name=="$-"+e?"":t.name})).attr("class","stack-circle-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t,i){return i==e.length-1?-f(t.value):-(f(e[i].value)-f(e[i+1].value))-2*f(e[i+1].value)})).attr("text-anchor","end").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)/2-5)+","+t._maxRadius+")"})),S.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","stack-circle-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t,i){return i==e.length-1?-f(t.value):-(f(e[i].value)-f(e[i+1].value))-2*f(e[i+1].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate("+(R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)/2+5)+","+t._maxRadius+")"})),S.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","stack-circle-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t,i){return i==e.length-1?-f(t.value):-(f(e[i].value)-f(e[i+1].value))-2*f(e[i+1].value)})).attr("text-anchor","middle").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate(0,"+t._maxRadius+")"})),0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","none"),p.selectAll(".stack-circle-text-group").remove(),p.selectAll(".outer-circle-texts-name").style("display","none"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","none"),p.selectAll(".outer-circle-texts-line").style("display","none"),p.selectAll(".outer-circle-text-group").remove()):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(p.selectAll(".stack-circle-texts-name").style("display","block").attr("text-anchor","middle").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","block").attr("text-anchor","middle").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".stack-circle-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","block").attr("text-anchor","middle").attr("transform","translate(0,"+t._maxRadius+")")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(p.selectAll(".stack-circle-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-2.5").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".stack-circle-texts-percent").style("display","block").attr("text-anchor","start").attr("dx","2.5").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".stack-circle-texts-value").style("display","none"),S.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(p.selectAll(".stack-circle-texts-name").style("display","block").attr("text-anchor","end").attr("dx","-2.5").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","block").attr("text-anchor","start").attr("dx","2.5").attr("transform","translate(0,"+t._maxRadius+")"),S.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","block").attr("text-anchor","end").attr("dx","-2.5").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".stack-circle-texts-value").style("display","block").attr("text-anchor","start").attr("dx","2.5").attr("transform","translate(0,"+t._maxRadius+")"),S.attr("transform",(function(e,i){return"translate("+(R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily))/2+", 0)"}))):3==t._contentChoice.length&&t._labelShow&&S.attr("transform",(function(e,i){return"translate("+(R(e.name=="$-"+i?"":e.name,t._fontSize,t._fontFamily)-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily))/2+", 0)"}))}else if(1==t._positionOptions.indexOf(t._positionChoice)&&t._labelShow){p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","none"),p.selectAll(".outer-circle-text-group").remove();var k=t.group.append("g").attr("class","outer-circle-text-group").selectAll("g").data(e);k.exit().remove();var w=k.enter().append("g");w.append("line").attr("class","outer-circle-texts-line").attr("x1",0).attr("y1",(function(t,i){return i==e.length-1?2*-f(t.value)-1e-5:2*-f(e[i].value)-1e-5})).attr("x2",.32*t._width).attr("y2",(function(t,i){return i==e.length-1?2*-f(t.value):2*-f(e[i].value)})).style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",1).style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate(0,"+(t._maxRadius+.5)+")"}));w.append("text").text((function(e,i){return X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily)})).attr("class","outer-circle-texts-name").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",.32*t._width+2).attr("y",(function(t,i){return i==e.length-1?2*-f(t.value):2*-f(e[i].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){return"translate(0,"+t._maxRadius+")"}));var C=w.append("text").text((function(e){return E(e.percent,t._numberStyle,t._decimalPlaces)+"%"})).attr("class","outer-circle-texts-percent").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",.32*t._width+2).attr("y",(function(t,i){return i==e.length-1?2*-f(t.value):2*-f(e[i].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){var n=X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily);return"translate("+(R(n,t._fontSize,t._fontFamily)+R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)+10)+","+t._maxRadius+")"}));w.append("text").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("class","outer-circle-texts-value").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",.32*t._width+2).attr("y",(function(t,i){return i==e.length-1?2*-f(t.value):2*-f(e[i].value)})).attr("text-anchor","start").attr("dy","0.5em").style("display",t._labelShow?"block":"none").attr("transform",(function(e,i){var n=X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily);return"translate("+(R(n,t._fontSize,t._fontFamily)+5)+","+t._maxRadius+")"}));0==t._labelShow||null==t._labelShow||null==t._contentOption||null==t._contentChoice||0==t._contentChoice.length?(p.selectAll(".stack-circle-texts-name").style("display","none"),p.selectAll(".stack-circle-texts-percent").style("display","none"),p.selectAll(".stack-circle-texts-value").style("display","none"),p.selectAll(".stack-circle-text-group").remove(),p.selectAll(".outer-circle-texts-name").style("display","none"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","none"),p.selectAll(".outer-circle-texts-line").style("display","none"),p.selectAll(".outer-circle-text-group").remove()):1==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])?(p.selectAll(".outer-circle-texts-name").style("display","block").attr("text-anchor","start").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","none")):1==t._contentOption.indexOf(t._contentChoice[0])?(p.selectAll(".outer-circle-texts-name").style("display","none"),p.selectAll(".outer-circle-texts-percent").style("display","block").attr("text-anchor","start").attr("transform","translate(0,"+t._maxRadius+")"),p.selectAll(".outer-circle-texts-value").style("display","none")):2==t._contentOption.indexOf(t._contentChoice[0])&&(p.selectAll(".outer-circle-texts-name").style("display","none"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","block").attr("text-anchor","start").attr("transform","translate(0,"+t._maxRadius+")")):2==t._contentChoice.length&&t._labelShow?0==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1])||1==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(p.selectAll(".outer-circle-texts-name").style("display","block"),p.selectAll(".outer-circle-texts-percent").style("display","block"),C.attr("transform",(function(e,i){var n=X(e.name=="$-"+i?"":e.name,.36*t._width-R(E(e.percent,t._numberStyle,t._decimalPlaces)+"%",t._fontSize,t._fontFamily)-R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)-10,t._fontSize,t._fontFamily);return"translate("+(R(n,t._fontSize,t._fontFamily)+5)+","+t._maxRadius+")"})),p.selectAll(".outer-circle-texts-value").style("display","none")):0==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&0==t._contentOption.indexOf(t._contentChoice[1])?(p.selectAll(".outer-circle-texts-name").style("display","block"),p.selectAll(".outer-circle-texts-percent").style("display","none"),p.selectAll(".outer-circle-texts-value").style("display","block")):(1==t._contentOption.indexOf(t._contentChoice[0])&&2==t._contentOption.indexOf(t._contentChoice[1])||2==t._contentOption.indexOf(t._contentChoice[0])&&1==t._contentOption.indexOf(t._contentChoice[1]))&&(p.selectAll(".outer-circle-texts-name").style("display","none"),C.attr("transform",(function(e,i){return"translate("+(R(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,t._fontSize,t._fontFamily)+5)+","+t._maxRadius+")"})),p.selectAll(".outer-circle-texts-value").style("display","block").attr("transform","translate(0,"+t._maxRadius+")")):3==t._contentChoice.length&&t._labelShow}t._interrupt?(p.selectAll(".stack-circle-text-group").style("opacity",1),p.selectAll(".outer-circle-text-group").style("opacity",1)):(p.selectAll(".stack-circle-text-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1),p.selectAll(".outer-circle-text-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1))}return t}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"bubbleSizeType",value:function(t){return arguments.length?(this._bubbleSizeType=t,this):this._bubbleSizeType}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"bubbleBorderWidth",value:function(t){return arguments.length?(this._bubbleBorderWidth=t,this):this._bubbleBorderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ia=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","stack-circle-chart"),i.stackCircle=new ja(i.mainGroup),i._sortValue=null,i._labelShow=!1,i._positionOptions=["内部居中","外部"],i._positionChoice="内部居中",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称","数值"],i._textLabel={color:"#FFFFFF",fontFamily:"noto",fontSize:12},i._suffix="",i._bubbleSizeType="diameter",i._bubbleBorderColor="",i._bubbleBorderWidth=0,i._fillOpacity=1,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=[];if("linear"==t._colors.type){var i=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],n=d3.scaleLinear().domain([t.activeData.length-1,0]).range(i);e=function(t){for(var e,i,n=t.length,a=0;a<n-1;a++){e=a;for(var o=a+1;o<n;o++)t[o].value<t[e].value&&(e=o);i=t[a],t[a]=t[e],t[e]=i}return t}(t.activeData).map((function(t,e){return t.color=n(e),t}))}else e=t.activeData.filter((function(t,e){return t.value>0||0==t.value}));var a=t.stackCircle,o=t.widthOfNoMargin,r=.86*t.heightOfMainGroup,l=.56*t.widthOfNoMargin;null==t._labelShow||null==t._positionOptions||null==t._positionChoice?(r=.88*t.heightOfMainGroup,l=.88*t.widthOfNoMargin):0!=t._labelShow&&0!=t._positionOptions.indexOf(t._positionChoice)&&-1!=t._positionOptions.indexOf(t._positionChoice)&&0!=t._contentChoice.length||(r=.88*t.heightOfMainGroup,l=.88*t.widthOfNoMargin);for(var u=s(l,r,t._startAngle,t._endAngle),h=u.radius,d=d3.max(e,(function(t){return Math.abs(t.value)})),_=0;_<e.length;_++)e[_].total=parseFloat(d)-parseFloat(e[_].value);if(t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var f=x(t._bubbleBorderColor),p=[],g=!0,v=!1,m=void 0;try{for(var b,S=f[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),p.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=p.concat(),F=O.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(e).maxRadius(h).width(t.widthOfNoMargin).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).bubbleSizeType(t._bubbleSizeType).bubbleBorderColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).bubbleBorderWidth(t._bubbleBorderWidth).fillOpacity(t._fillOpacity).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onTransitionEnd((function(t,e){})).onMouseover((function(e,i){d3.select(this).transition().duration(30).style("opacity",.8);var n=[{text:""+(e.name=="$-"+i?"":e.name),color:e.color},{text:e.valueLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().duration(30).style("opacity",1),t.tooltip.hide()}));var L=u.cx+(o-l)/2,P=t.heightOfMainGroup/2;null==t._labelShow||null==t._positionOptions||null==t._positionChoice||0==t._contentChoice.length||1==t._positionOptions.indexOf(t._positionChoice)&&1==t._labelShow&&(L=h+.04*o),t.stackCircle.translate(L||0,P).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=[];if("linear"==t._colors.type){var i=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],n=d3.scaleLinear().domain([t.activeData.length-1,0]).range(i);(e=function(t){for(var e,i,n=t.length,a=0;a<n-1;a++){e=a;for(var o=a+1;o<n;o++)t[o].value<t[e].value&&(e=o);i=t[a],t[a]=t[e],t[e]=i}return t}(t.activeData).map((function(t,e){return t.color=n(e),t})).filter((function(t,e){return 1==t.showLegend}))).reverse()}else e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._bubbleSizeType=e.bubbleSizeType?e.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._bubbleBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._bubbleBorderWidth,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._suffix=i.suffix?i.suffix:"")}}]),e}(nt),Ya=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-area-plot"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=d3.area().x((function(t){return t.x})).y0((function(t){return t.top})).y1((function(t){return t.bottom})).defined((function(t){return!isNaN(parseFloat(t.top))}));i.curve(t._curve);var n=t.group;n.selectAll("*").remove();var a=[];if(e.length>0)for(var o=0;o<e[0].data.length;o++)if(o!=e[0].data.length-1){var r={},l={},s={},u={},h={};l.x=t._xScale(e[0].data[o].name),l.y=t._yScale(e[0].data[o].value),s.x=t._xScale(e[0].data[o+1].name),s.y=t._yScale(e[0].data[o+1].value),u.x=t._xScale(e[0].data[o].name),u.y=t._yScale(e[0].data[o].total-e[0].data[o].value),h.x=t._xScale(e[0].data[o+1].name),h.y=t._yScale(e[0].data[o+1].total-e[0].data[o+1].value),r.a=l,r.b=s,r.c=u,r.d=h,a.push(r)}for(var d=[],_=0;_<a.length;_++)0==U(a[_].a,a[_].b,a[_].c,a[_].d)||d.push(U(a[_].a,a[_].b,a[_].c,a[_].d));var f=[];if(d.length>0){var p=e[0].data,g=[],v=[];p.forEach((function(e,i){var n={};t._xScale(e.name)<=d[0].x&&(n.top=t._yScale(e.value),n.bottom=t._yScale(e.total-e.value),n.x=t._xScale(e.name),g.push(n))}));var m={};if(m.top=d[0].y,m.bottom=d[0].y,m.x=d[0].x,g.push(m),f.push(g),d.length>1)for(var b=function(e){var i=[],n={};n.top=d[e].y,n.bottom=d[e].y,n.x=d[e].x,i.unshift(n),p.forEach((function(n,a){var o={};t._xScale(n.name)>=d[e].x&&t._xScale(n.name)<=d[e+1].x&&(o.top=t._yScale(n.value),o.bottom=t._yScale(n.total-n.value),o.x=t._xScale(n.name),i.push(o))}));var a={};a.top=d[e+1].y,a.bottom=d[e+1].y,a.x=d[e+1].x,i.push(a),i.length>0&&f.push(i)},S=0;S<d.length-1;S++)b(S);p.forEach((function(e,i){var n={};t._xScale(e.name)>=d[d.length-1].x&&(n.top=t._yScale(e.value),n.bottom=t._yScale(e.total-e.value),n.x=t._xScale(e.name),v.push(n))}));var k={};k.top=d[d.length-1].y,k.bottom=d[d.length-1].y,k.x=d[d.length-1].x,v.unshift(k),f.push(v)}else{var w=e.length>0?e[0].data:[],C=[];w.forEach((function(e,i){var n={};n.top=t._yScale(e.value),n.bottom=t._yScale(e.total-e.value),n.x=t._xScale(e.name),C.push(n)})),f.push(C)}for(var O=[{offset:0,stopColour:e.length>0?e[0].colorTop:""}],F=0,L=0;L<d.length;L++){var P={};P.stopColour=F%2==0?e.length>0?e[0].colorTop:"":e.length>0?e[0].colorBottom:"",P.offset=(d[L].x-t._xScale.range()[0]-.2*t._xScale.step())/(t._xScale.range()[1]-t._xScale.range()[0]-.4*t._xScale.step());var A={};A.stopColour=0==!(F%2)?e.length>0?e[0].colorTop:"":e.length>0?e[0].colorBottom:"",A.offset=(d[L].x-t._xScale.range()[0]-.2*t._xScale.step())/(t._xScale.range()[1]-t._xScale.range()[0]-.4*t._xScale.step());var W={};W.stopColour=0==!(F%2)?e.length>0?e[0].colorTop:"":e.length>0?e[0].colorBottom:"",W.offset=1,F++,O.push(P),L==d.length-1&&A.offset<1&&O.push(W)}var z=d3.pairs(O),M=Math.abs(t._xScale.range()[1]-t._xScale.range()[0]-.4*t._xScale.step()),D=Math.abs(t._yScale.range()[1]-t._yScale.range()[0]);if(z.forEach((function(e,i){t.group.append("defs").attr("class","area-defs").append("clipPath").attr("id","area-overlay-"+t.id+"-index-"+i).append("rect").attr("width",e[1].offset*M-e[0].offset*M).attr("y",0).attr("x",.2*t._xScale.step()+e[0].offset*M).attr("height",D)})),0==d.length){if(e.length>0&&e[0].colorTop&&/\[/.test(e[0].colorTop)){var R=x(e[0].colorTop),N=[],T=!0,B=!1,G=void 0;try{for(var X,j=R[Symbol.iterator]();!(T=(X=j.next()).done);T=!0){var I=X.value,Y=[],H=I.split(":");Y.push(q(H[0])),Y.push(H[1]),N.push(Y)}}catch(t){B=!0,G=t}finally{try{!T&&j.return&&j.return()}finally{if(B)throw G}}var E=N.concat(),V=E.pop();t.group.append("linearGradient").attr("id",t.id+"-index-0").attr("x1",y(V[1]).x1+"%").attr("y1",y(V[1]).y1+"%").attr("x2",y(V[1]).x2+"%").attr("y2",y(V[1]).y2+"%").selectAll("stop").data(E).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}else z.forEach((function(e,i){if(e[1].stopColour&&/\[/.test(e[1].stopColour)){var n=x(e[1].stopColour),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var $=n.selectAll("path").data(f,(function(t){return t.key}));function U(t,e,i,n){var a=(e.y-t.y)*(n.x-i.x)-(t.x-e.x)*(i.y-n.y);if(0==a)return!1;var o=((e.x-t.x)*(n.x-i.x)*(i.y-t.y)+(e.y-t.y)*(n.x-i.x)*t.x-(n.y-i.y)*(e.x-t.x)*i.x)/a,r=-((e.y-t.y)*(n.y-i.y)*(i.x-t.x)+(e.x-t.x)*(n.y-i.y)*t.y-(n.x-i.x)*(e.y-t.y)*i.y)/a;return(o-t.x)*(o-e.x)<=0&&(r-t.y)*(r-e.y)<=0&&(o-i.x)*(o-n.x)<=0&&(r-i.y)*(r-n.y)<=0&&{x:o,y:r}}return $.exit().remove(),$.enter().append("path").merge($).style("fill",(function(i,n){return 0==e.length?"":0==e[0].showArea?"transparent":0==d.length?e[0].colorTop&&/\[/.test(e[0].colorTop)?"url("+c("#"+t.id+"-index-0")+")":e[0].colorTop:z[n][1].stopColour&&/\[/.test(z[n][1].stopColour)?"url("+c("#"+t.id+"-index-"+n)+")":z[n][1].stopColour})).style("fill-opacity",t._fillOpacity).attr("d",(function(t){return i(t)})),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}}]),e}(at),Ha=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","ranking-line-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i._stroke=null,i._lineWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-line-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var i=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);var n=t.group.selectAll("path").data(e,(function(t){return t.key}));n.exit().remove();var a=n.enter().append("path").merge(n).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry);return t._interrupt?a.interrupt().attr("d",(function(t){return i(t.data)})):a.interrupt().transition().duration(t._transition?t._duration:0).attr("d",(function(t){return i(t.data)})),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),Ea=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-area-circle"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=[];if(e.length>0)for(var n=0;n<e[0].data.length;n++)if(n!=e[0].data.length-1){var a={},o={},r={},l={},s={};o.x=t._xScale(e[0].data[n].name),o.y=t._yScale(e[0].data[n].value),r.x=t._xScale(e[0].data[n+1].name),r.y=t._yScale(e[0].data[n+1].value),l.x=t._xScale(e[0].data[n].name),l.y=t._yScale(e[0].data[n].total-e[0].data[n].value),s.x=t._xScale(e[0].data[n+1].name),s.y=t._yScale(e[0].data[n+1].total-e[0].data[n+1].value),a.a=o,a.b=r,a.c=l,a.d=s,i.push(a)}for(var u=[],h=0;h<i.length;h++)0==f(i[h].a,i[h].b,i[h].c,i[h].d)||u.push(f(i[h].a,i[h].b,i[h].c,i[h].d));var d=t.group;d.selectAll("*").remove(),e.forEach((function(e,i){if(t._strokeColor&&/\[/.test(t._strokeColor)){var n=x(t._strokeColor),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-circle-index-0").attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var _=d.selectAll("circle").data(u);function f(t,e,i,n){var a=(e.y-t.y)*(n.x-i.x)-(t.x-e.x)*(i.y-n.y);if(0==a)return!1;var o=((e.x-t.x)*(n.x-i.x)*(i.y-t.y)+(e.y-t.y)*(n.x-i.x)*t.x-(n.y-i.y)*(e.x-t.x)*i.x)/a,r=-((e.y-t.y)*(n.y-i.y)*(i.x-t.x)+(e.x-t.x)*(n.y-i.y)*t.y-(n.x-i.x)*(e.y-t.y)*i.y)/a;return(o-t.x)*(o-e.x)<=0&&(r-t.y)*(r-e.y)<=0&&(o-i.x)*(o-n.x)<=0&&(r-i.y)*(r-n.y)<=0&&{x:o,y:r}}return _.exit().remove(),_.enter().append("circle").merge(_).attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})).style("fill",t._radiusFill||(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-circle-index-0")+")":t._strokeColor)).style("stroke",t._radiusStroke||(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-circle-index-0")+")":t._strokeColor)).style("stroke-width",t._radiusWidth).attr("r",t._radius),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"radiusFill",value:function(t){return arguments.length?(this._radiusFill=t,this):this._radiusFill}},{key:"radiusStroke",value:function(t){return arguments.length?(this._radiusStroke=t,this):this._radiusStroke}},{key:"radiusWidth",value:function(t){return arguments.length?(this._radiusWidth=t,this):this._radiusWidth}}]),e}(at),Va=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-area-texts"),i._xScale=null,i._yScale=null,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a=t._xScale,o=t._yScale;n.selectAll("*").remove();var r=n.selectAll("g").data(e);r.exit().remove(),r.enter().append("g").attr("class","range-area-text-group").merge(r).each((function(i,n){var r=d3.select(this).selectAll("text").data(i.data);r.exit().remove(),r.enter().append("text").attr("class","range-area-text").attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return t.value&&o(t.value)||0})).merge(r).text((function(e){return isNaN(parseFloat(e.value))?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){return a(e.name)+("mix"==t._type?a.bandwidth()/2:0)||0})).attr("y",(function(t){return t.value&&o(t.value)||0})).attr("dy",(function(i,n){return e.length>1?null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?0:0==t._positionOptions.indexOf(t._positionChoice)?i.value==d3.max([e[0].data[n].value,e[1].data[n].value])?-6:t._fontSize/1.3+6:void 0:-6})).attr("text-anchor","middle").style("display",t._labelShow?"block":"none")}));var l=t._pointData,s=[];if(l.length>0)for(var u=0;u<l[0].data.length;u++)if(u!=l[0].data.length-1){var c={},h={},d={},_={},f={};h.x=t._xScale(l[0].data[u].name),h.y=t._yScale(l[0].data[u].value),d.x=t._xScale(l[0].data[u+1].name),d.y=t._yScale(l[0].data[u+1].value),_.x=t._xScale(l[0].data[u].name),_.y=t._yScale(l[0].data[u].total-l[0].data[u].value),f.x=t._xScale(l[0].data[u+1].name),f.y=t._yScale(l[0].data[u+1].total-l[0].data[u+1].value),c.a=h,c.b=d,c.c=_,c.d=f,s.push(c)}for(var y=[],x=0;x<s.length;x++)0==v(s[x].a,s[x].b,s[x].c,s[x].d)||y.push(v(s[x].a,s[x].b,s[x].c,s[x].d));n.selectAll(".point-texts").remove();var g=n.append("g").attr("class","point-texts").selectAll("text").data(y);function v(t,e,i,n){var a=(e.y-t.y)*(n.x-i.x)-(t.x-e.x)*(i.y-n.y);if(0==a)return!1;var o=((e.x-t.x)*(n.x-i.x)*(i.y-t.y)+(e.y-t.y)*(n.x-i.x)*t.x-(n.y-i.y)*(e.x-t.x)*i.x)/a,r=-((e.y-t.y)*(n.y-i.y)*(i.x-t.x)+(e.x-t.x)*(n.y-i.y)*t.y-(n.x-i.x)*(e.y-t.y)*i.y)/a;return(o-t.x)*(o-e.x)<=0&&(r-t.y)*(r-e.y)<=0&&(o-i.x)*(o-n.x)<=0&&(r-i.y)*(r-n.y)<=0&&{x:o,y:r}}g.exit().remove(),g.enter().append("text").attr("class","range-area-text").merge(g).text((function(e){return E(t._yScale.invert(e.y).toFixed(1),t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t){return t.x||0})).attr("y",(function(t){return t.y||0})).attr("dy",-9.5).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").style("display",t._labelShow?"block":"none"),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".range-area-text").style("display","none"):1==t._positionOptions.indexOf(t._positionChoice)?(n.selectAll(".range-area-text").attr("dy",-6),n.selectAll(".point-texts text").attr("dy",-9.5)):2==t._positionOptions.indexOf(t._positionChoice)&&(n.selectAll(".range-area-text").attr("dy",t._fontSize/1.3+6),n.selectAll(".point-texts text").attr("dy",t._fontSize/1.3+9.5)),t._interrupt?n.selectAll(".range-area-text").style("opacity",1):n.selectAll(".range-area-text").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1);for(var m=n.selectAll(".range-area-text"),b=[],S=[],k=0;k<m._groups[0].length;k++){S.push(k);for(var w=k+1;w<m._groups[0].length;w++){p(i(d3.select(m._groups[0][k])),i(d3.select(m._groups[0][w])))&&(b.push(k),d3.select(m._groups[0][k]).style("visibility","hidden"))}}for(var C=new Set(b),O=Array.from(C),F=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(O,S),L=0;L<O.length;L++){for(var P=[],A=0;A<F.length;A++){var W=i(d3.select(m._groups[0][O[L]])),z=i(d3.select(m._groups[0][F[A]]));if(P.push(p(W,z)),p(W,z)){if(O[L]==F[A])continue;d3.select(m._groups[0][O[L]]).style("visibility","hidden")}}0==P.filter((function(t){return 1==t})).length&&F.push(O[L])}for(var M=0;M<F.length;M++)d3.select(m._groups[0][F[M]]).style("visibility","visible");return t}},{key:"pointData",value:function(t){return arguments.length?(this._pointData=t,this):this._pointData}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at);function $a(t,e){var i=0,n=!1,a=[];if(e.forEach((function(t){"objCol"===t.function?(i=t.index,n=t.isLegend):"vCol"===t.function&&a.push(t.index)})),P(t,[i],2))return[];if(!A(t,a[0])||!A(t,a[1]))return[];var o={},r=[],l=t.length,s=t[0];if(n){for(var u=[],c=1;c<l;c++)u.push(t[c].length);u.sort((function(t,e){return e-t}));for(var d=1;d<l;d++){var _=t[d],f=_[i];""!=f&&null!=f&&null!=f||(f="$-"+d);var p=!0;if(""!=f&&null!=f&&null!=f||""!=_[1]&&null!=_[1]&&null!=_[1]||""!=_[2]&&null!=_[2]&&null!=_[2]||(p=!1),f){for(var y={name:f,dataScreen:p,showLegend:f!="$-"+d,data:[]},x=0;x<u[0];x++){var g=s[x];""!=g&&null!=g&&null!=g||(g="&-"+x),g&&(x==a[0]&&y.data.push({name:g,showAxisText:g!="&-"+x,value:""==_[x]||null==_[x]||isNaN(parseFloat(_[x]))?null:parseFloat(_[x])}),x==a[1]&&y.data.push({name:g,showAxisText:g!="&-"+x,value:""==_[x]||null==_[x]||isNaN(parseFloat(_[x]))?null:parseFloat(_[x])}))}r.push(y)}}}else{for(var v=[],m=1;m<l;m++)v.push(t[m].length);v.sort((function(t,e){return e-t}));for(var b=1;b<v[0];b++){var S=t[b];if(-1!=a.indexOf(b)){var k=s[b];""!=s[b]&&null!=s[b]&&null!=s[b]||(k="$-"+b);var w=!0;""!=s[b]&&null!=s[b]&&null!=s[b]||""!=S[1]&&null!=S[1]&&null!=S[1]||""!=S[2]&&null!=S[2]&&null!=S[2]||(w=!1),o[k+"-"+b]={name:k,dataScreen:w,showLegend:k!="$-"+b,data:[]}}}for(var C=1;C<l;C++){var O=t[C],F=O[i];if(""!=F&&null!=F&&null!=F||(F="&-"+C),F)for(var L=0;L<v[0];L++)if(-1!=a.indexOf(L)){var W=s[L];""!=s[L]&&null!=s[L]&&null!=s[L]||(W="$-"+L),W&&o[W+"-"+L].data.push({name:F,showAxisText:F!="&-"+C,value:(""==O[L]||null==O[L])&&0!=O[L]||isNaN(parseFloat(O[L]))?null:parseFloat(O[L])})}}for(var z in o)r.push(o[z])}return r.forEach((function(t,e){t.key=h(t.name)+"-"+e})),r}var qa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-area-chart"),i.elem.attr("class","range-area-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(5),i.areaPlot=new Ya(i.coreGroup),i.linePlot=new Ha(i.coreGroup),i.rangeAreaCircle=new Ea(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new Vt(i.coreGroup),i.rangeAreaText=new Va(i.coreGroup),i.clipArea=new Ut(i.defs),i.AnimationArea=new Zt(i.defs),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=2,i._strokeColor="",i._fillColor="#fff",i._endPointRadius=3.5,i._fillOpacity=.7,i._labelShow=!1,i._positionOptions=["外部","居上","居下"],i._positionChoice="外部",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.areaPlot,a=t.linePlot,r=(t.StackedScatterPlot,t.rangeAreaText),l=t.rangeAreaCircle,s=t.tooltip,u=t.overlay,h=t.guideLine,d=t.guideScatter,_=t.clipArea,f=(t.AnimationArea,t.xScale),p=t.yScale,g=(t.xAxis._axisStart,t.xAxis._axisEnd),v=0;g>t.widthOfNoMargin-t.yAxis.width&&(v=g-(t.widthOfNoMargin-t.yAxis.width));for(var m=t.widthOfCore-v,b=t.heightOfCore,S=0;S<e.length;S++)for(var k=0;k<e[S].data.length;k++)e[S].data[k].value=isNaN(parseFloat(e[S].data[k].value))?0:parseFloat(e[S].data[k].value),e[S].data[k].total=0==S?isNaN(parseFloat(e[S].data[k].value))?0:parseFloat(e[S].data[k].value):e[S-1].data[k].total+(isNaN(parseFloat(e[S].data[k].value))?0:parseFloat(e[S].data[k].value));Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0);i.width(m).height(b).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth);var w="",C="";if(e.length>1){var O=d3.max([e[0].data[0].value,e[1].data[0].value]);O==e[0].data[0].value?(w=e[0].color,C=e[1].color):O==e[1].data[0].value&&(w=e[1].color,C=e[0].color)}var F=[];if(e.length>1?(e[1].showArea=!0,e[1].colorTop=w,e[1].colorBottom=C,F.push(e[1])):1==e.length?(e[0].showArea=!1,F.push(e[0])):F.push(),n.data(F).xScale(f).yScale(p).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).curve(t._curve).areaFunc(d3.area().x((function(t){return f(t.name)})).y0((function(t){return p(t.total-t.value)})).y1((function(t){return p(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}))),a.data(e).xScale(f).yScale(p).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).mainGroup(t.mainGroup).curve(t._curve).lineWidth(t._lineWidth).lineFunc(d3.line().x((function(t){return f(t.name)})).y((function(t){return p(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}))),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var L=x(t._strokeColor),P=[],A=!0,W=!1,z=void 0;try{for(var M,D=L[Symbol.iterator]();!(A=(M=D.next()).done);A=!0){var R=M.value,N=[],T=R.split(":");N.push(q(T[0])),N.push(T[1]),P.push(N)}}catch(t){W=!0,z=t}finally{try{!A&&D.return&&D.return()}finally{if(W)throw z}}var B=P.concat(),G=B.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(G[1]).x1+"%").attr("y1",y(G[1]).y1+"%").attr("x2",y(G[1]).x2+"%").attr("y2",y(G[1]).y2+"%").selectAll("stop").data(B).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var X=x(t._fillColor),j=[],I=!0,Y=!1,H=void 0;try{for(var V,$=X[Symbol.iterator]();!(I=(V=$.next()).done);I=!0){var U=V.value,Z=[],Q=U.split(":");Z.push(q(Q[0])),Z.push(Q[1]),j.push(Z)}}catch(t){Y=!0,H=t}finally{try{!I&&$.return&&$.return()}finally{if(Y)throw H}}var K=j.concat(),J=K.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(J[1]).x1+"%").attr("y1",y(J[1]).y1+"%").attr("x2",y(J[1]).x2+"%").attr("y2",y(J[1]).y2+"%").selectAll("stop").data(K).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}l.data(F).xScale(f).yScale(p).strokeWidth(2).strokeColor(e[0]?e[0].color:"transparent").radius(t._endPointRadius).radiusFill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).radiusStroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).radiusWidth(t._strokeWidth),d.xScale(f).yScale(p).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),h.y1(0).y2(b).stroke("#c6c6c6").strokeDasharray("0 0"),u.data(f.domain()).bandWidth(f.step()).bandHeight(b).bandX(f.range()[0]).onMouseover((function(i,n){var a=i,o=[{text:a=="&-"+(n+1)?"":a}],r=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===a}));r.push({key:e.key,name:e.name,color:e.color,data:n}),o.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),s.data(o).update(),h.x(0).update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate("+f(a)+",0)"),d.data(r).update(),s.move([d3.event.offsetX,d3.event.offsetY]).show(),h.show(),d.show()})).onMousemove((function(){s.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){s.hide(),h.hide(),d.hide()}));var tt=t.defs;tt.selectAll("filter").remove();var et=tt.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_stacklinear").attr("filterUnits","objectBoundingBox");et.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),et.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),et.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),et.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),et.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),r.data(e).pointData(F).xScale(f).yScale(p).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length?(_.width(m).height(b).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+_.id)+")"),_.update()):(_.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),_.update()),d.elem.style("pointer-events","none");var it=t.group.selectAll(".stacked-linear-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));(d3.selectAll(it).remove(),i.update(),u.update(),n.update(),a.update(),l.update(),r.update(),t._interrupt)?(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("height",t._height).attr("width",m),t.coreGroup.select(".range-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".ranking-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".range-area-circle").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("height",t._height).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",m),t.coreGroup.select(".range-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".ranking-line-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".range-area-circle").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.display,r={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(o).length&&(this._lineWidth=0==o.lineWidth||o.lineWidth?d(o.lineWidth):this._lineWidth,this._curve=o.lineType?r[o.lineType]:d3.curveLinear,this._endPointRadius=0==o.endPointRadius||o.endPointRadius?o.endPointRadius:this._endPointRadius,this._strokeWidth=0==o.endPointBorderWidth||o.endPointBorderWidth?o.endPointBorderWidth:this._strokeWidth,this._strokeColor=o.endPointBorderColor?q(o.endPointBorderColor):"",this._fillColor=o.endPointFillColor?q(o.endPointFillColor):"",this._fillOpacity=0==o.fillOpacity||o.fillOpacity?o.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._positionChoice=e.positionChoice?e.positionChoice:this._positionChoice,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=$a;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),e}(Tt),Ua=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-bar-plot"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth="",i._fillOpacity=1,i._barCornerRadius=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;t.group.selectAll("*").remove(),n.selectAll("rect").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t._xScale.step()*t._barWidthPercent,o=n.selectAll("rect").data(e,(function(t){return t.key}));o.exit().remove();var r=o.enter().append("g").append("path").merge(o).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){var n=0;return null==e.data[0].value&&null==e.data[1].value?n=0:d3.min([e.data[0].value,e.data[1].value])==e.data[0].value?n=t._yScale(d3.min([e.data[0].value,e.data[1].value])):d3.min([e.data[0].value,e.data[1].value])==e.data[1].value&&(n=t._yScale(d3.max([e.data[0].value,e.data[1].value]))),_({x:t._xScale(e.name)+t._xScale.step()*(1-t._barWidthPercent)/2,y:n,width:a,height:0,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?r.style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){return _({x:t._xScale(e.name)+t._xScale.step()*(1-t._barWidthPercent)/2,y:null==e.data[0].value&&null==e.data[1].value?0:t._yScale(d3.max([e.data[0].value,e.data[1].value])),width:a,height:null==e.data[0].value||null==e.data[1].value?0:Math.abs(t._yScale(e.data[0].value)-t._yScale(e.data[1].value)),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):r.transition().duration(t._transition?.9*t._duration:0).delay((function(e,i){return t._transition?t._startDelay:0})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){return _({x:t._xScale(e.name)+t._xScale.step()*(1-t._barWidthPercent)/2,y:null==e.data[0].value&&null==e.data[1].value?0:t._yScale(d3.max([e.data[0].value,e.data[1].value])),width:a,height:null==e.data[0].value||null==e.data[1].value?0:Math.abs(t._yScale(e.data[0].value)-t._yScale(e.data[1].value)),cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})),n.selectAll(".range-bar-textGroup").remove();var l=n.append("g").selectAll("g").data(e);l.exit().remove(),l.enter().append("g").attr("class","range-bar-textGroup").merge(l).each((function(e,i){var n=d3.select(this).selectAll("text").data(e.data);n.exit().remove();var o=n.enter().append("text").attr("class","range-bar-text").merge(n).text((function(i){return null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?"":0==t._positionOptions.indexOf(t._positionChoice)?null==e.data[0].value&&null==e.data[1].value||null==e.data[0].value||null==e.data[1].value?"":E(i.value,t._numberStyle,t._decimalPlaces)+t._suffix:1==t._positionOptions.indexOf(t._positionChoice)?null==e.data[0].value&&null==e.data[1].value||null==e.data[0].value||null==e.data[1].value?"":E(d3.max([e.data[0].value,e.data[1].value])-d3.min([e.data[0].value,e.data[1].value]),t._numberStyle,t._decimalPlaces)+t._suffix:void 0})).attr("text-anchor","middle").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("x",t._xScale(e.name)+t._xScale.step()*(1-t._barWidthPercent)/2+a/2).attr("y",(function(i,n){return null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?t._yScale(i.value):0==t._positionOptions.indexOf(t._positionChoice)?i.value==d3.max([e.data[0].value,e.data[1].value])?(null==e.data[0].value&&null==e.data[1].value?0:t._yScale(d3.max([e.data[0].value,e.data[1].value])))-6:(null==e.data[0].value&&null==e.data[1].value?0:t._yScale(d3.min([e.data[0].value,e.data[1].value])))+t._fontSize/1.3+6:1==t._positionOptions.indexOf(t._positionChoice)?null==e.data[0].value&&null==e.data[1].value?0:t._yScale(d3.max([e.data[0].value,e.data[1].value]))+Math.abs(t._yScale(e.data[0].value)-t._yScale(e.data[1].value))/2+t._fontSize/1.3/2:void 0})).style("display",t._labelShow?"block":"none");t._interrupt?o.style("opacity",1):o.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1)})),r.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".range-bar-text").style("display","none"):n.selectAll(".range-bar-text").style("display","block");for(var s=n.selectAll(".range-bar-text"),u=[],h=[],d=0;d<s._groups[0].length;d++){h.push(d);for(var f=d+1;f<s._groups[0].length;f++){p(i(d3.select(s._groups[0][d])),i(d3.select(s._groups[0][f])))&&(u.push(d),d3.select(s._groups[0][d]).style("visibility","hidden"))}}for(var g=new Set(u),v=Array.from(g),m=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(v,h),b=0;b<v.length;b++){for(var S=[],k=0;k<m.length;k++){var w=i(d3.select(s._groups[0][v[b]])),C=i(d3.select(s._groups[0][m[k]]));if(S.push(p(w,C)),p(w,C)){if(v[b]==m[k])continue;d3.select(s._groups[0][v[b]]).style("visibility","hidden")}}0==S.filter((function(t){return 1==t})).length&&m.push(v[b])}for(var O=0;O<m.length;O++)d3.select(s._groups[0][m[O]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=parseFloat(t),this):this._barCornerRadius}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Za=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-bar-chart"),i.grid=new Jt(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new Ua(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._yScaleHeight=1.05,i._barWidthPercent=.5,i._barCornerRadius=0,i._borderWidth=0,i._borderColor="none",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["上下","内部差值"],i._positionChoice="上下",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=e,n=t.grid,a=t.tooltip,o=t.rectPlot,r=t.overlay,l=t.selectOverlay,s=t.clipArea,u=t.xScale,h=t.yScale,d=(t.xAxis._axisStart,t.xAxis._axisEnd),_=0;d>t.widthOfNoMargin-t.yAxis.width&&(_=d-(t.widthOfNoMargin-t.yAxis.width));var f=t.widthOfCore-_,p=t.heightOfCore,g=1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0);g<0?(t.group.selectAll(".range-bar-chart .axis-x-line path").attr("transform","translate(0, "+-(h.range()[0]-h(0))+")"),t.group.selectAll(".range-bar-chart .axis-x-line line").attr("transform","translate(0, "+-(h.range()[0]-h(0))+")")):(t.group.selectAll(".range-bar-chart .axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".range-bar-chart .axis-x-line line").attr("transform","translate(0,0)"));var v=t.defs;v.selectAll("filter").remove();var m=v.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");if(m.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),m.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),m.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),m.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),m.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),r.data(u.domain()).isScalePoint(!1).bandWidth(u.step()).bandHeight(p).bandX(u.range()[0]).onMouseover((function(i,n){var o=i,r=[{text:o=="$-"+(n+1)?"":o,color:e.length>0?e[n].color:""}];e.length>0&&r.push({text:(null==e[n].data[0].value?"":E(e[n].data[0].value,t._numberStyle,t._decimalPlaces))+"->"+(null==e[n].data[1].value?"":E(e[n].data[1].value,t._numberStyle,t._decimalPlaces))}),a.data(r).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+u(o)+",0)"),a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),l.show()})).onMouseout((function(){a.hide(),l.hide()})),t._borderColor&&/\[/.test(t._borderColor)){var b=x(t._borderColor),S=[],k=!0,w=!1,C=void 0;try{for(var O,F=b[Symbol.iterator]();!(k=(O=F.next()).done);k=!0){var L=O.value,P=[],A=L.split(":");P.push(q(A[0])),P.push(A[1]),S.push(P)}}catch(t){w=!0,C=t}finally{try{!k&&F.return&&F.return()}finally{if(w)throw C}}var W=S.concat(),z=W.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(z[1]).x1+"%").attr("y1",y(z[1]).y1+"%").attr("x2",y(z[1]).x2+"%").attr("y2",y(z[1]).y2+"%").selectAll("stop").data(W).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}o.data(i).xScale(u).yScale(h).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}).fillOpacity(t._fillOpacity),n.width(f).height(p).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.width(f).height(p).paddingVertical([0,0]).transition(t._transition).duration(t._duration),l.width(u.step()).height(p).shadowColor("#ccc").hide();var M=t.yAxis.width+1;t.coreGroup.attr("transform","translate("+M+",0)"),0!=t._clipShow.length?(s.width(f).height(p).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+s.id)+")"),s.update()):(s.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),s.update());var D=t.group.selectAll(".range-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(D).remove(),o.update(),l.update(),r.update(),n.translate(M,0).update(),g<0?(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",u.range()[0]).attr("y1",h.range()[0]).attr("x2",u.range()[1]).attr("y2",h.range()[0]).attr("stroke",t._axisLineStrokeX)):t.coreGroup.selectAll(".fake-x-line").remove()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(2*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]);var x=t.activeData,g=d3.scaleLinear().range([0,h-e.height]).domain([Math.min(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(x,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]),v=d3.scaleLinear().domain([0,h-e.height]).range([Math.min(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(x,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]),m=0;t._labelShow&&"上下"==t._positionChoice&&g(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})))<parseFloat(t._textLabel.fontSize)&&(m=v(-parseFloat(t._textLabel.fontSize))),a.domain([Math.min(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0)+m,1.1*d3.max(x,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]),a.range([h-e.height,0]);var b=i.width,S=h-e.height,k=i.width+_;e.translate(b,S).update(),i.translate(k,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=$a;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e.map((function(t){return t.name})):[0,1],a=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),e}(Tt),Qa=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-horizontal-bar-plot"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth="",i._fillOpacity=1,i._barCornerRadius=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;t.group.selectAll("*").remove(),n.selectAll("rect").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=t._yScale.step()*t._barWidthPercent,o=n.selectAll("rect").data(e,(function(t){return t.key}));o.exit().remove();var r=o.enter().append("g").append("path").merge(o).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",(function(e){return t._strokeWidth||0})).attr("d",(function(e,i){var n=0;return null==e.data[0].value&&null==e.data[1].value?n=0:d3.min([e.data[0].value,e.data[1].value])==e.data[0].value?n=t._xScale(d3.min([e.data[0].value,e.data[1].value])):d3.min([e.data[0].value,e.data[1].value])==e.data[1].value&&(n=t._xScale(d3.max([e.data[0].value,e.data[1].value]))),_({x:n,y:t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2,width:0,height:a,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})}));t._interrupt?r.style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){return _({x:null==e.data[0].value&&null==e.data[1].value?0:t._xScale(d3.min([e.data[0].value,e.data[1].value])),y:t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2,width:null==e.data[0].value||null==e.data[1].value?0:Math.abs(t._xScale(e.data[0].value)-t._xScale(e.data[1].value)),height:a,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})):r.transition().duration(t._transition?.9*t._duration:0).delay((function(e,i){return t._transition?t._startDelay:0})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("d",(function(e,i){return _({x:null==e.data[0].value&&null==e.data[1].value?0:t._xScale(d3.min([e.data[0].value,e.data[1].value])),y:t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2,width:null==e.data[0].value||null==e.data[1].value?0:Math.abs(t._xScale(e.data[0].value)-t._xScale(e.data[1].value)),height:a,cornerRadius:t._barCornerRadius,roundCorners:[0,1,2,3]})})),n.selectAll(".range-horizontal-bar-textGroup").remove();var l=n.append("g").selectAll("g").data(e);l.exit().remove(),l.enter().append("g").attr("class","range-horizontal-bar-textGroup").merge(l).each((function(e,i){var n=d3.select(this).selectAll("text").data(e.data);n.exit().remove();var o=n.enter().append("text").attr("class","range-horizontal-bar-text").merge(n).text((function(i){return null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?"":0==t._positionOptions.indexOf(t._positionChoice)?null==e.data[0].value&&null==e.data[1].value||null==e.data[0].value||null==e.data[1].value?"":E(i.value,t._numberStyle,t._decimalPlaces)+t._suffix:1==t._positionOptions.indexOf(t._positionChoice)?null==e.data[0].value&&null==e.data[1].value||null==e.data[0].value||null==e.data[1].value?"":E(d3.max([e.data[0].value,e.data[1].value])-d3.min([e.data[0].value,e.data[1].value]),t._numberStyle,t._decimalPlaces)+t._suffix:void 0})).attr("text-anchor","middle").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("y",t._yScale(e.name)+t._yScale.step()*(1-t._barWidthPercent)/2+a/2+t._fontSize/1.3/2).attr("x",(function(i,n){return null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?0:0==t._positionOptions.indexOf(t._positionChoice)?i.value==d3.max([e.data[0].value,e.data[1].value])?(null==e.data[0].value&&null==e.data[1].value?0:t._xScale(d3.max([e.data[0].value,e.data[1].value])))+R((E(i.value,t._numberStyle,t._decimalPlaces)+t._suffix).toString(),t._fontSize,t._fontFamily)/2+6:(null==e.data[0].value&&null==e.data[1].value?0:t._xScale(d3.min([e.data[0].value,e.data[1].value])))-R((E(i.value,t._numberStyle,t._decimalPlaces)+t._suffix).toString(),t._fontSize,t._fontFamily)/2-6:1==t._positionOptions.indexOf(t._positionChoice)?null==e.data[0].value&&null==e.data[1].value?0:t._xScale(d3.min([e.data[0].value,e.data[1].value]))+Math.abs(t._xScale(e.data[0].value)-t._xScale(e.data[1].value))/2:void 0})).style("display",t._labelShow?"block":"none");t._interrupt?o.style("opacity",1):o.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1)})),r.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);for(var s=n.selectAll(".range-horizontal-bar-text"),u=[],h=[],d=0;d<s._groups[0].length;d++){h.push(d);for(var f=d+1;f<s._groups[0].length;f++){p(i(d3.select(s._groups[0][d])),i(d3.select(s._groups[0][f])))&&(u.push(d),d3.select(s._groups[0][d]).style("visibility","hidden"))}}for(var g=new Set(u),v=Array.from(g),m=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(v,h),b=0;b<v.length;b++){for(var S=[],k=0;k<m.length;k++){var w=i(d3.select(s._groups[0][v[b]])),C=i(d3.select(s._groups[0][m[k]]));if(S.push(p(w,C)),p(w,C)){if(v[b]==m[k])continue;d3.select(s._groups[0][v[b]]).style("visibility","hidden")}}0==S.filter((function(t){return 1==t})).length&&m.push(v[b])}for(var O=0;O<m.length;O++)d3.select(s._groups[0][m[O]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=parseFloat(t),this):this._barCornerRadius}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ka=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","range-horizontal-bar-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.yAxis.minTickDistance(1),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new Qa(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._histogramWidth=.7,i._yScaleHeight=1.05,i._barWidthPercent=.5,i._barCornerRadius=0,i._borderWidth=0,i._borderColor="none",i._fillOpacity=1,i._labelShow=!1,i._positionOptions=["左右","内部差值"],i._positionChoice="左右",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=e,n=t.grid,a=t.tooltip,r=t.rectPlot,l=t.overlay,s=t.selectOverlay,u=t.xScale,h=t.yScale,d=t.gridEnd-t.gridStart,_=t.heightOfCore,f=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),p=[],g=[],v=0;v<t.activeData.length;v++)for(var m=0;m<t.activeData[v].data.length;m++)null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(g.push(0),p.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[v].data[m].value)>0||0==parseFloat(t.activeData[v].data[m].value)?p.push(R(E(t.activeData[v].data[m].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[v].data[m].value)<0&&g.push(R(E(t.activeData[v].data[m].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(g.push(0),p.push(0));f<0?(d3.selectAll(".range-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate("+(-(u.range()[0]-u(0))+t.gridStart)+",0)"),d3.selectAll(".range-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate("+(-(u.range()[0]-u(0))+t.gridStart)+",0)")):(d3.selectAll(".range-horizontal-bar-chart .axis-y-horizontal path").attr("transform","translate(0,0)"),d3.selectAll(".range-horizontal-bar-chart .axis-y-horizontal line").attr("transform","translate(0,0)"));var b=t.defs;b.selectAll("filter").remove();var S=b.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupHorizontal").attr("filterUnits","objectBoundingBox");if(S.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),S.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),S.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),S.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),S.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),l.data(h.domain()).isScalePoint(!1).isHorizontal(!0).bandX(u.range()[0]).bandWidth(d).bandHeight(h.step()).onMouseover((function(i,n){var o=h.domain()[h.domain().length-n-1==-1?1:h.domain().length-n-1==-2?0:h.domain().length-n-1],r=h.domain().length-n-1==-1?1:h.domain().length-n-1==-2?0:h.domain().length-n-1,l=[{text:o=="$-"+(r+1)?"":o,color:e.length>0?e[n].color:""}];e.length>0&&l.push({text:(null==e[r].data[0].value?"":E(e[r].data[0].value,t._numberStyle,t._decimalPlaces))+"->"+(null==e[r].data[1].value?"":E(e[r].data[1].value,t._numberStyle,t._decimalPlaces))}),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+h(o)+")"),a.data(l).update(),a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),s.show()})).onMouseout((function(){a.hide(),s.hide()})),t._borderColor&&/\[/.test(t._borderColor)){var k=x(t._borderColor),w=[],C=!0,O=!1,F=void 0;try{for(var L,P=k[Symbol.iterator]();!(C=(L=P.next()).done);C=!0){var A=L.value,W=[],z=A.split(":");W.push(q(z[0])),W.push(z[1]),w.push(W)}}catch(t){O=!0,F=t}finally{try{!C&&P.return&&P.return()}finally{if(O)throw F}}var M=w.concat(),D=M.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(D[1]).x1+"%").attr("y1",y(D[1]).y1+"%").attr("x2",y(D[1]).x2+"%").attr("y2",y(D[1]).y2+"%").selectAll("stop").data(M).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}r.data(i).xScale(u).yScale(h).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}).fillOpacity(t._fillOpacity),n.width(d+u.range()[0]).height(_).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.width(d).height(h.step()).shadowColor("#ccc").hide(),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),n.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),n.translate(t.yAxis.width+.5,t.xAxis.height));var N=t.group.selectAll(".range-horizontal-bar-chart .axis-y-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(N).remove(),r.update(),s.update(),l.update(),n.update(),t.group.selectAll(".selectOverlay-rect").attr("x",""+t.gridStart)}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t._width-t._marginLeft-t._marginRight,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i&&i.titleHeight;t.data().forEach((function(t){t.data.forEach((function(t){}))}));for(var d=[],_=[],f=[],p=0;p<t.activeData.length;p++)for(var y=0;y<t.activeData[p].data.length;y++)t.activeData[p].data[y].value<0&&f.push(t.activeData[p].data[y].value),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(_.push(0),d.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[p].data[y].value)>0||0==parseFloat(t.activeData[p].data[y].value)?d.push(R(E(t.activeData[p].data[y].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[p].data[y].value)<0&&_.push(R(E(t.activeData[p].data[y].value,t._numberStyle,t._decimalPlaces)+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(_.push(0),d.push(0));var x=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(x).compute(),i.compute();var g=0==_.length?0:d3.max(_),v=c-i.width-(0==d.length?0:d3.max(d));i.compute(),n.range([g,v]),e.compute();var m=e._axisStart,b=e._axisEnd,S=0==_.length?0:d3.max(_);m<0&&(g=S+(Math.abs(m)>i.width?Math.abs(m)-i.width:0)),b>v&&(v=v-(b-v)+(0==d.length?0:d3.max(d))),t.gridStart=g,t.gridEnd=v,n.range([g,v]),a.range([h-e.height,0]);var k=i.width,w=h-e.height,C=i.width+g,O=0;((0==_.length?0:d3.max(_))>0||f.length>0)&&(C=i.width);var F=e.height;"上面"==t._axisPositonChoiceX?(w=F,O=F):w=(t._axisPositonChoiceX,h-F),e.translate(k,w).update(),i.translate(C,O).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=$a;return i.dataSolveFunc(n),i}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=(t._yRange,e.length?e.map((function(t){return t.name})):[0,1]),n=e.length?[1.05*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.05*Math.max(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1];t._xDomain=n,t._yDomain=i}}]),e}(Tt),Ja=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polar-stack-bar"),e._stroke="#fff",e._strokeWidth=1,e._barWidthPercent="1",e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._radius=0,e._cornerRadius=0,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t._startAngle,o=t._endAngle,r=t._radius,l=t._innerRadius,s=t.group,u=d3.max(n,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))||1,h=t._maxValue||u,d=[0,1.1*h];if(t._isPolar)if(null==t._count)d=v(0,h,Math.ceil(r/t._themeFontSize/3));else if(d=[],0!=t._count){var _=h-0,f=t._count,g=Math.ceil(Math.abs(_/t._count)),m=Math.ceil((r-t._innerRadius)/t._themeFontSize*2),b=d3.tickStep(0,h,m);t._count<b&&(g=Math.ceil(Math.abs(_/b)),f=b),h+=g;for(var S=0;S<g+1;S++)d.push(0+S*f)}else d.push(0);var k=d3.scaleLinear().domain([d3.min(d),d3.max(d)]).range([t._innerRadius,r]);t._rScale=k;var w=n.length>0?n[0].data.length:0,C=2*Math.PI/(w>0?w:1),O=t.arcFunc.innerRadius((function(t){return k(Math.abs(t.data.total)-Math.abs(t.data.value))})).outerRadius((function(t){return k(Math.abs(t.data.total))})).cornerRadius(t._cornerRadius).startAngle((function(e){return e.startAngle+C*(1-parseFloat(t._barWidthPercent))/2})).endAngle((function(e){return e.endAngle-C*(1-parseFloat(t._barWidthPercent))/2})),F=t.pieFunc.value(1).startAngle(a).endAngle(o).sort(t._sortMethod),L=d3.arc().innerRadius(t._innerRadius).outerRadius(r).startAngle(a).endAngle(o);t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("path").attr("d",L()),t.group.selectAll("*").remove(),t.group.selectAll("g.polar-stack-bar-group").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var P=t.group.append("g").attr("clip-path","").selectAll("g.polar-stack-bar-group").data(n);P.exit().remove();P.enter().append("g").attr("class","polar-stack-bar-group").merge(P).each((function(e,i){var a=d3.select(this).selectAll("path").data(F(e.data));a.exit().remove();var o=a.enter().append("path").attr("class","polar-stack-bars").merge(a).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).style("fill",(function(n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("fill-opacity",(function(i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))o.attr("d",(function(t){return O(t)}));else if(0==t._moveOptions.indexOf(t._moveStyle)){t._interrupt?o.attr("d",(function(t){return O(t)})):n.length>0&&o.transition().duration(t._transition?.8*t._duration/(n.length>0?n.length:1):0).delay(t._transition?t._startDelay+.1*t._duration+i*(.8*t._duration/(n.length>0?n.length:1)):0).ease(d3.easeCubicOut).attrTween("d",(function(t){var e=d3.interpolateNumber(k(Math.abs(t.data.total)-Math.abs(t.data.value)),k(Math.abs(t.data.total)));return function(i){var n=e(i);return O.outerRadius(n),O(t)}}))}else if(1==t._moveOptions.indexOf(t._moveStyle)){t._interrupt?o.attr("d",(function(t){return O(t)})):o.transition().duration(t._transition?.8*t._duration/(e.data.length>0?e.data.length:1):0).ease(d3.easeLinear).delay((function(i,n){return t._transition?t._startDelay+function(i){for(var n=0,a=0;a<i;a++)n+=t._transition?.8*t._duration/(e.data.length>0?e.data.length:1):0;return n}(n):0})).attrTween("d",(function(t){var e=d3.interpolate(t.startAngle,t.endAngle);return function(i){return t.endAngle=e(i),O(t)}}))}}));t.group.append("g").selectAll("g").data(F(0==n.length?0:n[0].data)).enter().append("g").transition().on("start",t._onTransitionStart).on("end",t._onTransitionEnd);var A=t.group.append("g").attr("class","rose-pie-xAxis");A.append("path").attr("class","rose-pie-xAxis").attr("d",(function(i,n){return"内部"==t._axisPositonChoice?e(l-.5*t._xAxisLineWidth,a,o):e(r-.5*t._xAxisLineWidth,a,o)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?A.style("opacity",1):A.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);var W=0==n.length?0:n[0].data.length,z=n.length>0?n[0].data.map((function(t){return t.name})):[],M=(o-a)/(W||1),N=[],T=void 0;if(T="外部"==t._axisPositonChoice?r+5:l-5,n.length>0)for(var B=0;B<W+1;B++){var G=T*Math.sin(a+B*M),I=-T*Math.cos(a+B*M);N.push({x:G,y:I})}else N=[{x:T*Math.sin(a),y:-T*Math.cos(a)},{x:T*Math.sin(o),y:-T*Math.cos(o)}];var Y=(o-a)/(W>0?W:1),H=s.selectAll(".area-lines").data(d3.range(n.length>0?W+1:0));H.exit().remove();var E=H.enter().append("line").attr("class","area-lines").merge(H).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=a+Y*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?r:l)})).attr("y1",(function(e,i){var n=a+Y*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?r:l)})).attr("x2",(function(e,i){var n=a+Y*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?r+5:l-5)})).attr("y2",(function(e,i){var n=a+Y*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?r+5:l-5)}));s.selectAll(".tick-text").remove();var V=s.append("g").selectAll("text").data(N);V.exit().remove();var $=V.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice){if("水平"==t._xLabelDirection){var o=Math.cos(a+Y*(i+.5)-Math.PI/2)*(r+10),s=t._mainWidth/2-Math.abs(o);return X(z[i],s,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var u=Math.sin(a+Y*(i+.5)-Math.PI/2)*(r+10),c=t._mainHeight/2-Math.abs(u);return j(z[i],c,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection)return X(z[i],(l-10)/2,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(z[i],(l-10)/2,t._themeFontSize,t._themeFontFamily)}})).attr("x",(function(e,i){var n=a+Y*(i+.5);return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(r+10):Math.cos(n-Math.PI/2)*(l-10)})).attr("y",(function(e,i){var n=a+Y*(i+.5);return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(r+10):Math.sin(n-Math.PI/2)*(l-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)$.attr("transform",(function(e,i){var n=a+Y*(i+.5);return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:0)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var Z=t.group.append("g").selectAll("text").data(N);Z.exit().remove();var Q=Z.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(a+Y*(e+.5))/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?Q.text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(z[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",r+5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(r+5)+",0)":null})):Q.text((function(e,i){var n=l-5-parseFloat(t._themeFontSize)>0?l-5-parseFloat(t._themeFontSize):0;return X(z[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",l-5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(a+Y*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(l-5)+",0)":null}))}else{s.selectAll(".tick-text").remove();var K=t.group.selectAll("g.text-group").data(N);K.exit().remove();K.enter().append("g").attr("class","text-group").merge(K).each((function(i,o){d3.select(this);var s=r+10;"内部"==t._axisPositonChoice&&(s=l-10-t._themeFontSize);var u=a+Y*(o+.5),c=d3.select(this.parentNode),h="arc-path-"+o+"-"+t.id,d=e(s+.5*t._themeFontSize,u+Y/2+.015,u-Y/2-.015);"clockwise"==t._rotateDirection&&(d=e(s+.6*t._themeFontSize,u-Y/2+.015,u+Y/2-.015));var _=t._defs.select("#"+h).empty()?t._defs.append("path").attr("d",d).attr("id",h):t._defs.select("#"+h).attr("d",d);n.length>0&&D(c,_,z[o],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none");d3.select(this).select("path"),_.node().getTotalLength(),R(z[o],t._themeFontSize,t._themeFontFamily)}))}1==t._interrupt?(E.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),$.style("opacity",1).style("display",t._showX?"block":"none")):(E.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),$.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var J=0;J<W;J++){var tt=(J+.5)*Y+a;"外部"==t._axisPositonChoice?0==tt||tt==Math.PI?d3.select(s.selectAll(".tick-text").nodes()[J]).attr("text-anchor","middle"):tt>Math.PI||tt<0&&tt>-Math.PI?d3.select(s.selectAll(".tick-text").nodes()[J]).attr("text-anchor","end"):d3.select(s.selectAll(".tick-text").nodes()[J]).attr("text-anchor","start"):tt>0&&tt<Math.PI||tt>2*-Math.PI&&tt<-Math.PI?d3.select(s.selectAll(".tick-text").nodes()[J]).attr("text-anchor","end"):tt>Math.PI&&tt<2*Math.PI||tt<0&&tt>-Math.PI?d3.select(s.selectAll(".tick-text").nodes()[J]).attr("text-anchor","start"):d3.select(s.selectAll(".tick-text").nodes()[J]).attr("text-anchor","middle")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var et=t.group.selectAll(".tick-text"),it=[],nt=[],at=0;at<et._groups[0].length;at++){nt.push(at);for(var ot=at+1;ot<et._groups[0].length;ot++){p(i(d3.select(et._groups[0][at])),i(d3.select(et._groups[0][ot])))&&(it.push(at),d3.select(et._groups[0][at]).style("opacity","0"))}}for(var rt=new Set(it),lt=Array.from(rt),st=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(lt,nt),ut=0;ut<lt.length;ut++){for(var ct=[],ht=0;ht<st.length;ht++){var dt=i(d3.select(et._groups[0][lt[ut]])),_t=i(d3.select(et._groups[0][st[ht]]));if(ct.push(p(dt,_t)),p(dt,_t)){if(lt[ut]==st[ht])continue;d3.select(et._groups[0][lt[ut]]).remove()}}0==ct.filter((function(t){return 1==t})).length&&st.push(lt[ut])}for(var ft=0;ft<st.length;ft++)d3.select(et._groups[0][st[ft]]).style("opacity","1")}}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}}]),n}(at),to=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polar-stack-bar-text"),e._stroke="#fff",e._strokeWidth=1,e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._radius=0,e._cornerRadius=0,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t._startAngle,o=t._endAngle,r=t._radius,l=d3.max(n,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))||1,s=t._maxValue||l,u=[0,1.1*s];if(t._isPolar)if(null==t._count)u=v(0,s,Math.ceil(r/t._themeFontSize/3));else if(u=[],0!=t._count){var c=s-0,h=t._count,d=Math.ceil(Math.abs(c/t._count)),_=Math.ceil((r-t._innerRadius)/t._themeFontSize*2),f=d3.tickStep(0,s,_);t._count<f&&(d=Math.ceil(Math.abs(c/f)),h=f),s+=d;for(var y=0;y<d+1;y++)u.push(0+y*h)}else u.push(0);var x=d3.scaleLinear().domain([d3.min(u),d3.max(u)]).range([t._innerRadius,r]),g=(t.arcFunc.innerRadius((function(t){return x(Math.abs(t.data.total)-Math.abs(t.data.value))})).outerRadius((function(t){return x(Math.abs(t.data.total))})).cornerRadius(t._cornerRadius),t.pieFunc.value(1).startAngle(a).endAngle(o).sort(t._sortMethod)),m=d3.arc().innerRadius(t._innerRadius).outerRadius(r).startAngle(a).endAngle(o);t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-text-"+t.id).append("path").attr("d",m()),t.group.selectAll("*").remove(),t.group.selectAll("g.polar-stack-bar-text-group").remove();var b=t.group.append("g").attr("clip-path","").selectAll("g.polar-stack-bar-text-group").data(n);b.exit().remove();b.enter().append("g").attr("class","polar-stack-bar-text-group").merge(b).each((function(i,n){var a=d3.select(this).selectAll("g").data(g(i.data));a.exit().remove();for(var o=a.enter().append("g"),r=0;r<i.data.length;r++){var l=x(Math.abs(i.data[r].total)),s=g(i.data)[r].startAngle,u=g(i.data)[r].endAngle,c="arc-path-"+r+"-"+n+"-"+t.id,h=e(l-t._fontSize/1.3/2-6,s+.015,u-.015);t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h)}var d=o.append("text").style("text-anchor","middle").style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy","0.35em");d.append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#arc-path-"+i+"-"+n+"-"+t.id})).text((function(e,i){var a=t._defs.select("#arc-path-"+i+"-"+n+"-"+t.id).node().getTotalLength();return X(E(e.data.value.toString(),t._numberStyle,t._decimalPlaces)+t._suffix,a,t._fontSize,t._fontFamily)})).style("display",t._labelShow?"block":"none"),t._interrupt?d.style("opacity",1):d.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration:0})).style("opacity",1)}));for(var S=t.group.selectAll(".pie-text-groups"),k=[],w=[],C=0;C<S._groups[0].length;C++){w.push(C);for(var O=C+1;O<S._groups[0].length;O++){p(i(d3.select(S._groups[0][C])),i(d3.select(S._groups[0][O])))&&(k.push(C),d3.select(S._groups[0][C]).style("opacity","0"))}}for(var F=new Set(k),L=Array.from(F),P=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(L,w),A=0;A<L.length;A++){for(var W=[],z=0;z<P.length;z++){var M=i(d3.select(S._groups[0][L[A]])),D=i(d3.select(S._groups[0][P[z]]));if(W.push(p(M,D)),p(M,D)){if(L[A]==P[z])continue;d3.select(S._groups[0][L[A]]).style("opacity","0")}}0==W.filter((function(t){return 1==t})).length&&P.push(L[A])}for(var R=0;R<P.length;R++)d3.select(S._groups[0][P[R]]).style("opacity","1")}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"maxValue",value:function(t){return arguments.length?(this._maxValue=t,this):this._maxValue}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),eo=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","polar-stack-bar-chart"),e.core=e.rose=new Ja(e.mainGroup),e.grid=new gt(e.mainGroup),e.roseText=new to(e.mainGroup),e.radialAxis=new mt(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._labelRadiusRatio=.8,e._innerRadiusRatio=0,e._cornerRadius=0,e._stroke="#fff",e._strokeWidth=0,e._barWidthPercent="1",e._fillOpacity=1,e._labelShow=!1,e._textLabelShow=!1,e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["径向展开","顺时针展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this,e=t.activeData;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);t._fontCopy?t._fontFamily:t._textLabel.fontFamily;for(var i=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,n=(t._fontCopy?t._fontColor:q(t._textLabel.color),t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily),a=t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize,o=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),r=t.rose,l=t.grid,u=t.roseText,h=t.radialAxis,d=t._startAngle,_=t._endAngle,f=t.widthOfNoMargin,p=t.heightOfMainGroup,g=(t._fontSize,.88*f),v=.88*p,m=s(g,v,d,_),b=0;b<e.length;b++)for(var S=0;S<e[b].data.length;S++)0==b?e[b].data[S].value>0||0==e[b].data[S].value?(e[b].data[S].total=parseFloat(e[b].data[S].value),e[b].data[S].downtotal=0):e[b].data[S].value<0&&(e[b].data[S].downtotal=parseFloat(e[b].data[S].value),e[b].data[S].total=0):e[b].data[S].value>0||0==e[b].data[S].value?(e[b].data[S].total=e[b-1].data[S].total+parseFloat(e[b].data[S].value),e[b].data[S].downtotal=e[b-1].data[S].downtotal):e[b].data[S].value<0&&(e[b].data[S].total=e[b-1].data[S].total,e[b].data[S].downtotal=e[b-1].data[S].downtotal+parseFloat(e[b].data[S].value));Math.round(d3.max(t.activeData.map((function(t){return t.value}))));var k=d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))||1,w=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"",C=0,O=void 0,F=void 0;"水平"==t._xLabelDirection&&1==t._xTickShow?(O=d3.max(w.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),F=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(O=d3.max(w.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),F=d3.max(w.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(O=t._fontSize,F=t._fontSize):(O=0,F=0),O=O<.4*g?O:.4*g,F=F<.4*v?F:.4*v,C="外部"==t._axisPositonChoice?Math.min(g/2-O,v/2-F):.88*Math.min(f,p)/2;var L=d3.scaleLinear().domain([0,C]).range([0,k]);t._textLabelShow&&(k=L(parseFloat(C)+parseFloat(1.1*i)+6));for(var P=C,A=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*C:0),W=0;W<(0==e.length?0:e[0].data.length);W++)for(var z=0;z<e.length;z++)parseFloat(e[z].data[W].value);if(t._stroke&&/\[/.test(t._stroke)){var M=x(t._stroke),D=[],N=!0,T=!1,B=void 0;try{for(var G,X=M[Symbol.iterator]();!(N=(G=X.next()).done);N=!0){var j=G.value,I=[],Y=j.split(":");I.push(q(Y[0])),I.push(Y[1]),D.push(I)}}catch(t){T=!0,B=t}finally{try{!N&&X.return&&X.return()}finally{if(T)throw B}}var H=D.concat(),V=H.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(V[1]).x1+"%").attr("y1",y(V[1]).y1+"%").attr("x2",y(V[1]).x2+"%").attr("y2",y(V[1]).y2+"%").selectAll("stop").data(H).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}r.data(e).radius(C).innerRadius(A).startAngle(d).endAngle(_).fillOpacity(t._fillOpacity).cornerRadius(t._cornerRadius).barWidthPercent(t._barWidthPercent).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).showX(t._xTickShow).xAxisShow(t._xAxisShow).xAxisLineWidth(t._xAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).mainWidth(g).mainHeight(v).axisPositonChoice(t._axisPositonChoice).defs(t.defs).maxValue(k).onTransitionEnd(t.activeData.length>0?t._onTransitionEnd():null).onMouseover((function(i,n){d3.select(this).transition().style("opacity",.8);var a=[{text:""+(i.data.name=="&-"+(n+1)?"":i.data.name)}];e.forEach((function(e,i){a.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(e.data[n].value,t._numberStyle,t._decimalPlaces),color:e.color})})),t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().style("opacity",1),t.tooltip.hide()}));var $=t.defs;$.selectAll("filter").remove();var U=$.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_rose").attr("filterUnits","objectBoundingBox");U.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),U.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),U.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),U.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),U.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),u.data(e).radius(C).innerRadius(A).startAngle(d).endAngle(_).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).defs(t.defs).labelShow(t._labelShow).fontSize(a).fontColor(q(o)).fontFamily(n).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).themeFontSize(t._fontSize).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).maxValue(k).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),h.data(t.activeData).radius(C).innerRadius(A).startAngle(d).endAngle(_).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(f).mainHeight(p).suffix(t._yLabelSuffix).maxValue(k).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var Z=f/2,Q=p/2,K=m.quadrant,J=void 0;switch(J=Math.abs(_-d)==Math.PI/2?C/2:0,K){case 4:Z+=J,Q+=J;break;case 1:Z-=J,Q+=J;break;case 2:Z-=J,Q-=J;break;case 3:Z+=J,Q-=spcae}r.translate(Z,Q).update(),u.translate(Z,Q).update(),h.translate(Z,Q).update(),l.donutCount(t._isPolar?h._polarCount:6).sectorCount(0==t.activeData.length?0:t.activeData[0].data.length).startAngle(d).endAngle(_).radius(P).innerRadius(A).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),l.translate(Z,Q).update();var tt=t.mainGroup.selectAll(".donut-grid-line").nodes();tt.length>0&&(t._totalAngle>=2*Math.PI?t._yAxisShow?(d3.select(tt[0]).remove(),d3.select(tt[tt.length-1]).remove()):"clockwise"==t._rotateDirection?d3.select(tt[0]).remove():d3.select(tt[tt.length-1]).remove():t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(tt[0]).remove():d3.select(tt[tt.length-1]).remove()));var et=t.mainGroup.selectAll(".donut-grid-arc-path").nodes();et.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(et[0]).remove():t._xAxisShow&&(t._isPolar&&Math.round(Math.abs(h._polarCount[h._polarCount.length-1]))===Math.round(C)?d3.select(et[et.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"_onTransitionEnd",value:function(){var t=this,i=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,n=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,a=t._fontCopy?t._fontColor:q(t._textLabel.color);t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,t._labelShow&&(t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize),t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),t._startAngle,t._endAngle,t.widthOfNoMargin,t.heightOfMainGroup;return function(o,r){var l=0;l=t.activeData.length>0?t.rose._rScale(t.activeData[t.activeData.length-1].data[r].total):0;var s=d3.select(this.parentNode),u=o.startAngle,c=o.endAngle,h="arc-path-text-"+r+"-"+t.id,d=e(l+n/2+6,u+.015,c-.015);D(s,t.defs.select("#"+h).empty()?t.defs.append("path").attr("d",d).attr("id",h):t.defs.select("#"+h).attr("d",d),o.data.name.toString(),n,i).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(a)).style("font-size",n).style("font-family",i).style("display",t._textLabelShow?"block":"none")}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setPublicOption",this).call(this,t);var e=t.polarAxis,n=e.x||{},a=e.y||{};this.axisLineStroke(q(e.color)).axisLineStrokeX(q(n.axisColor)||q(e.color)).axisLineStrokeY(q(a.axisColor)||q(e.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._cornerRadius=0==e.cornerRadius||e.cornerRadius?d(e.cornerRadius):this._cornerRadius,this._stroke=e.areaBorderColor?q(e.areaBorderColor):"",this._strokeWidth=0==e.areaBorderWidth||e.areaBorderWidth?d(e.areaBorderWidth):this._areaBorderWidth,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?d(e.barWidthPercent):this._barWidthPercent,this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?d(e.innerRadiusRatio):this._innerRadiusRatio,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"computeDomain",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)0==i?e[i].data[n].value>0||0==e[i].data[n].value?(e[i].data[n].total=parseFloat(e[i].data[n].value),e[i].data[n].downtotal=0):e[i].data[n].value<0&&(e[i].data[n].downtotal=parseFloat(e[i].data[n].value),e[i].data[n].total=0):e[i].data[n].value>0||0==e[i].data[n].value?(e[i].data[n].total=e[i-1].data[n].total+parseFloat(e[i].data[n].value),e[i].data[n].downtotal=e[i-1].data[n].downtotal):e[i].data[n].value<0&&(e[i].data[n].total=e[i-1].data[n].total,e[i].data[n].downtotal=e[i-1].data[n].downtotal+parseFloat(e[i].data[n].value));var a=t._yRange||[],o=e.length?e[0].data.map((function(t){return t.name})):[0,1],r=e.length?[1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.downtotal}))})),0),1.1*Math.max(d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total+1}))})),0)]:[0,1];t._xDomain=o,t._yDomain=[isNaN(parseFloat(a[0]))?r[0]:parseFloat(a[0]),isNaN(parseFloat(a[1]))?isNaN(parseFloat(a[0]))?r[1]:r[1]<a[0]?1.5*a[0]:r[1]:parseFloat(a[1])]}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),i}(vt),io=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","polar-stack-donut-bar-chart"),e.core=e.rose=new Ja(e.mainGroup),e.grid=new gt(e.mainGroup),e.roseText=new to(e.mainGroup),e.radialAxis=new mt(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._labelRadiusRatio=.65,e._innerRadiusRatio=.3,e._strokeWidth=0,e._stroke="#fff",e._barWidthPercent="1",e._fillOpacity=1,e._labelShow=!1,e._textLabelShow=!1,e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["径向展开","顺时针展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this,e=t.activeData;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);t._fontCopy?t._fontFamily:t._textLabel.fontFamily;for(var i=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,n=(t._fontCopy?t._fontColor:q(t._textLabel.color),t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily),a=t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize,o=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),r=t.rose,l=t.grid,u=t.roseText,h=t.radialAxis,d=t._startAngle,_=t._endAngle,f=t.widthOfNoMargin,p=t.heightOfMainGroup,g=(t._fontSize,.88*f),v=.88*p,m=s(g,v,d,_),b=0;b<e.length;b++)for(var S=0;S<e[b].data.length;S++)0==b?e[b].data[S].value>0||0==e[b].data[S].value?(e[b].data[S].total=parseFloat(e[b].data[S].value),e[b].data[S].downtotal=0):e[b].data[S].value<0&&(e[b].data[S].downtotal=parseFloat(e[b].data[S].value),e[b].data[S].total=0):e[b].data[S].value>0||0==e[b].data[S].value?(e[b].data[S].total=e[b-1].data[S].total+parseFloat(e[b].data[S].value),e[b].data[S].downtotal=e[b-1].data[S].downtotal):e[b].data[S].value<0&&(e[b].data[S].total=e[b-1].data[S].total,e[b].data[S].downtotal=e[b-1].data[S].downtotal+parseFloat(e[b].data[S].value));Math.round(d3.max(t.activeData.map((function(t){return t.value}))));var k=d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))||1,w=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"",C=0,O=void 0,F=void 0;"水平"==t._xLabelDirection&&1==t._xTickShow?(O=d3.max(w.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),F=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(O=d3.max(w.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),F=d3.max(w.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(O=t._fontSize,F=t._fontSize):(O=0,F=0),O=O<.4*g?O:.4*g,F=F<.4*v?F:.4*v,C="外部"==t._axisPositonChoice?Math.min(g/2-O,v/2-F):.88*Math.min(f,p)/2;var L=d3.scaleLinear().domain([0,C]).range([0,k]);t._textLabelShow&&(k=L(parseFloat(C)+parseFloat(1.1*i)+6));for(var P=C,A=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*C:0),W=0;W<(0==e.length?0:e[0].data.length);W++)for(var z=0;z<e.length;z++)parseFloat(e[z].data[W].value);if(t._stroke&&/\[/.test(t._stroke)){var M=x(t._stroke),D=[],N=!0,T=!1,B=void 0;try{for(var G,X=M[Symbol.iterator]();!(N=(G=X.next()).done);N=!0){var j=G.value,I=[],Y=j.split(":");I.push(q(Y[0])),I.push(Y[1]),D.push(I)}}catch(t){T=!0,B=t}finally{try{!N&&X.return&&X.return()}finally{if(T)throw B}}var H=D.concat(),V=H.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(V[1]).x1+"%").attr("y1",y(V[1]).y1+"%").attr("x2",y(V[1]).x2+"%").attr("y2",y(V[1]).y2+"%").selectAll("stop").data(H).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}r.data(e).radius(C).innerRadius(A).barWidthPercent(t._barWidthPercent).startAngle(d).endAngle(_).cornerRadius(t._cornerRadius).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).showX(t._xTickShow).xAxisShow(t._xAxisShow).xAxisLineWidth(t._xAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).mainWidth(g).mainHeight(v).axisPositonChoice(t._axisPositonChoice).defs(t.defs).maxValue(k).onTransitionEnd(t.activeData.length>0?t._onTransitionEnd():null).onMouseover((function(i,n){d3.select(this).transition().style("opacity",.8);var a=[{text:""+(i.data.name=="&-"+(n+1)?"":i.data.name)}];e.forEach((function(e,i){a.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(e.data[n].value,t._numberStyle,t._decimalPlaces),color:e.color})})),t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().style("opacity",1),t.tooltip.hide()}));var $=t.defs;$.selectAll("filter").remove();var U=$.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_rose").attr("filterUnits","objectBoundingBox");U.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),U.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),U.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),U.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),U.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),u.data(e).radius(C).innerRadius(A).startAngle(d).endAngle(_).cornerRadius(t._cornerRadius).stroke(t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).defs(t.defs).labelShow(t._labelShow).fontSize(a).fontColor(q(o)).fontFamily(n).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).themeFontSize(t._fontSize).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).maxValue(k).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),h.data(t.activeData).radius(C).innerRadius(A).startAngle(d).endAngle(_).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(f).mainHeight(p).suffix(t._yLabelSuffix).maxValue(k).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).maxValue(k).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var Z=f/2,Q=p/2,K=m.quadrant,J=void 0;switch(J=Math.abs(_-d)==Math.PI/2?C/2:0,K){case 4:Z+=J,Q+=J;break;case 1:Z-=J,Q+=J;break;case 2:Z-=J,Q-=J;break;case 3:Z+=J,Q-=spcae}r.translate(Z,Q).update(),u.translate(Z,Q).update(),h.translate(Z,Q).update(),l.donutCount(t._isPolar?h._polarCount:6).sectorCount(0==t.activeData.length?0:t.activeData[0].data.length).startAngle(d).endAngle(_).radius(P).innerRadius(A).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),l.translate(Z,Q).update();var tt=t.mainGroup.selectAll(".donut-grid-line").nodes();tt.length>0&&(t._totalAngle>=2*Math.PI?t._yAxisShow?(d3.select(tt[0]).remove(),d3.select(tt[tt.length-1]).remove()):"clockwise"==t._rotateDirection?d3.select(tt[0]).remove():d3.select(tt[tt.length-1]).remove():t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(tt[0]).remove():d3.select(tt[tt.length-1]).remove()));var et=t.mainGroup.selectAll(".donut-grid-arc-path").nodes();et.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(et[0]).remove():t._xAxisShow&&(t._isPolar&&Math.round(Math.abs(h._polarCount[h._polarCount.length-1]))===Math.round(C)?d3.select(et[et.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"_onTransitionEnd",value:function(){var t=this,i=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,n=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,a=t._fontCopy?t._fontColor:q(t._textLabel.color);t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,t._labelShow&&(t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize),t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),t._startAngle,t._endAngle,t.widthOfNoMargin,t.heightOfMainGroup;return function(o,r){var l=0;l=t.activeData.length>0?t.rose._rScale(t.activeData[t.activeData.length-1].data[r].total):0;var s=d3.select(this.parentNode),u=o.startAngle,c=o.endAngle,h="arc-path-text-"+r+"-"+t.id,d=e(l+n/2+6,u+.015,c-.015);D(s,t.defs.select("#"+h).empty()?t.defs.append("path").attr("d",d).attr("id",h):t.defs.select("#"+h).attr("d",d),o.data.name.toString(),n,i).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(a)).style("font-size",n).style("font-family",i).style("display",t._textLabelShow?"block":"none")}}},{key:"setPublicOption",value:function(t){k(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setPublicOption",this).call(this,t);var e=t.polarAxis,n=e.x||{},a=e.y||{};this.axisLineStroke(q(e.color)).axisLineStrokeX(q(n.axisColor)||q(e.color)).axisLineStrokeY(q(a.axisColor)||q(e.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._cornerRadius=0==e.cornerRadius||e.cornerRadius?d(e.cornerRadius):this._cornerRadius,this._stroke=e.areaBorderColor?q(e.areaBorderColor):"",this._strokeWidth=0==e.areaBorderWidth||e.areaBorderWidth?d(e.areaBorderWidth):this._areaBorderWidth,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?d(e.barWidthPercent):this._barWidthPercent,this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?d(e.innerRadiusRatio):this._innerRadiusRatio,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),i}(vt),no=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","rose-donut-chart"),e.core=e.rose=new _t(e.mainGroup),e.grid=new gt(e.mainGroup),e.roseText=new ft(e.mainGroup),e.radialAxis=new mt(e.mainGroup),e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._labelRadiusRatio=.65,e._innerRadiusRatio=.3,e._strokeWidth=1,e._stroke="#fff",e._barWidthPercent="1",e._fillOpacity=1,e._labelShow=!1,e._textLabelShow=!1,e._textPositionChoice="内部",e._numberPositionChoice="内部",e._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},e._suffix="",e._unitShow=!1,e._unitWord="",e._unitFontSize="12",e._unitFontColor="#8C8C8C",e._unitFontFamily="Noto Sans",e._unitX="left",e._unitY="top",e._sourceShow=!1,e._sourceWord="",e._sourceFontSize="12",e._sourceFontColor="#5c6066",e._sourceFontFamily="Noto Sans",e._sourceX="left",e._sourceY="bottom",e._transition=!1,e._easeStyle="",e._duration=0,e._startDelay=0,e._moveOptions=["径向展开","顺时针展开","逆时针展开"],e._moveStyle="径向展开",e._endPause=0,e._interrupt=!1,e}return w(i,t),S(i,[{key:"updateCore",value:function(){var t=this;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);t._fontCopy?t._fontFamily:t._textLabel.fontFamily;var e=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,i=(t._fontCopy?t._fontColor:q(t._textLabel.color),t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,t._labelShow?t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize:0),n=(t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),d3.max(t.activeData,(function(t){return Math.abs(t.value)}))||1),a=t.rose,o=t.grid,r=t.roseText,l=t.radialAxis,u=t._startAngle,h=t._endAngle,d=t.widthOfNoMargin,_=t.heightOfMainGroup,f=(t._fontSize,.88*d),p=.88*_,g=s(f,p,u,h),v=(Math.round(d3.max(t.activeData.map((function(t){return t.value})))),t.activeData.map((function(t){return t.name}))||""),m=void 0,b=void 0,S=0;"水平"==t._xLabelDirection&&1==t._xTickShow?(m=d3.max(v.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),b=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(m=d3.max(v.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),b=d3.max(v.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(m=t._fontSize,b=t._fontSize):(m=0,b=0),m=m<.4*f?m:.4*f,b=b<.4*p?b:.4*p,S="外部"==t._axisPositonChoice?Math.min(f/2-m,p/2-b):.88*Math.min(d,_)/2;var k=d3.scaleLinear().domain([0,S]).range([0,n]);"外部"==t._textPositionChoice&&"外部"==t._numberPositionChoice?n=k(parseFloat(S)+parseFloat(1.1*e)+parseFloat(1.1*i)+6):"外部"==t._textPositionChoice?n=k(parseFloat(S)+parseFloat(1.1*e)+6):"外部"==t._numberPositionChoice&&(n=k(parseFloat(S)+parseFloat(1.1*i)+6));for(var w=S,C=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*S:0),O=0,F=0;F<t.activeData.length;F++)O+=t.activeData[F].value;for(var L=0;L<t.activeData.length;L++)t.activeData[L].percent=parseFloat(t.activeData[L].value/O*100).toFixed(1);if(t._stroke&&/\[/.test(t._stroke)){var P=x(t._stroke),A=[],W=!0,z=!1,M=void 0;try{for(var D,N=P[Symbol.iterator]();!(W=(D=N.next()).done);W=!0){var T=D.value,B=[],G=T.split(":");B.push(q(G[0])),B.push(G[1]),A.push(B)}}catch(t){z=!0,M=t}finally{try{!W&&N.return&&N.return()}finally{if(z)throw M}}var X=A.concat(),j=X.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(j[1]).x1+"%").attr("y1",y(j[1]).y1+"%").attr("x2",y(j[1]).x2+"%").attr("y2",y(j[1]).y2+"%").selectAll("stop").data(X).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(t.activeData).radius(S).innerRadius(C).startAngle(u).endAngle(h).barWidthPercent(t._barWidthPercent).cornerRadius(t._cornerRadius).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).fillOpacity(t._fillOpacity).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).themeFontSize(t._fontSize).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).showX(t._xTickShow).xAxisShow(t._xAxisShow).xAxisLineWidth(t._xAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).mainWidth(f).mainHeight(p).axisPositonChoice(t._axisPositonChoice).defs(t.defs).maxValue(n).onMouseover((function(e,i){d3.select(this).transition().style("opacity",.8);var n=[{text:""+(e.data.name=="$-"+i?"":e.data.name),color:e.data.color},{text:e.data.valueLabel+": "+E(e.data.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().style("opacity",1),t.tooltip.hide()}));var I=t.defs;I.selectAll("filter").remove();var Y=I.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_rose").attr("filterUnits","objectBoundingBox");Y.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),Y.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),Y.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),Y.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),Y.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),r.data(t.activeData).radius(S).innerRadius(C).startAngle(u).endAngle(h).cornerRadius(t._cornerRadius).stroke(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._stroke).strokeWidth(t._strokeWidth).sortMethod(t._sortMethod).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).themeFontSize(t._fontSize).range(t._yRange).count(t._yCountOfLabel).isPolar(t._isPolar).maxValue(n).onTransitionEnd(t._onTransitionEnd()),l.data(t.activeData).radius(S).innerRadius(C).startAngle(u).endAngle(h).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(d).mainHeight(_).suffix(t._yLabelSuffix).count(t._yCountOfLabel).isPolar(t._isPolar).maxValue(n||1).range(t._yRange).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var H=d/2,V=_/2,$=g.quadrant,U=void 0;switch(U=Math.abs(h-u)==Math.PI/2?S/2:0,$){case 4:H+=U,V+=U;break;case 1:H-=U,V+=U;break;case 2:H-=U,V-=U;break;case 3:H+=U,V-=spcae}a.translate(H,V).update(),r.translate(H,V).update(),l.translate(H,V).update(),o.donutCount(t._isPolar?l._polarCount:6).sectorCount(t.activeData.length).startAngle(u).endAngle(h).radius(w).innerRadius(C).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),o.translate(H,V).update();var Z=t.mainGroup.selectAll(".donut-grid-line").nodes();Z.length>0&&(t._totalAngle>=2*Math.PI?t._yAxisShow?(d3.select(Z[0]).remove(),d3.select(Z[Z.length-1]).remove()):"clockwise"==t._rotateDirection?d3.select(Z[0]).remove():d3.select(Z[Z.length-1]).remove():t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(Z[0]).remove():d3.select(Z[Z.length-1]).remove()));var Q=t.mainGroup.selectAll(".donut-grid-arc-path").nodes();Q.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(Q[0]).remove():t._xAxisShow&&(t._isPolar&&Math.round(Math.abs(l._polarCount[l._polarCount.length-1]))===Math.round(S)?d3.select(Q[Q.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"_onTransitionEnd",value:function(){var t=this,i=t._fontCopy?t._fontFamily:t._textLabel.fontFamily,n=t._textLabelShow?t._fontCopy?t._fontSize:t._textLabel.fontSize:0,a=t._fontCopy?t._fontColor:q(t._textLabel.color),o=t._fontCopy?t._textLabel.fontFamily:t._numberLabel.fontFamily,r=t._labelShow?t._fontCopy?t._textLabel.fontSize:t._numberLabel.fontSize:0,l=t._fontCopy?q(t._textLabel.color):q(t._numberLabel.color),u=t._startAngle,c=t._endAngle,h=s(.88*t.widthOfNoMargin,.88*t.heightOfMainGroup,u,c).radius-.55*n-6-5;t._innerRadius||t._innerRadiusRatio&&t._innerRadiusRatio;return function(s,u){var c=t.roseText.arcFunc.outerRadius()(s),h=d3.select(this.parentNode),d=s.startAngle,_=s.endAngle;if("内部"==t._textPositionChoice){var f="arc-path-text-"+s.data.key+"-"+t.id,p=e(c-n/2-6,d+.015,_-.015);D(h,t.defs.select("#"+f).empty()?t.defs.append("path").attr("d",p).attr("id",f):t.defs.select("#"+f).attr("d",p),s.data.name.toString(),n,i).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(a)).style("font-size",n).style("font-family",i).style("display",t._textLabelShow?"block":"none")}else if("外部"==t._textPositionChoice){var y="arc-path-text-"+s.data.key+"-"+t.id,x=e(c+n/2+6+("内部"==t._numberPositionChoice?0:1.1*r),d+.015,_-.015);D(h,t.defs.select("#"+y).empty()?t.defs.append("path").attr("d",x).attr("id",y):t.defs.select("#"+y).attr("d",x),s.data.name.toString(),n,i).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(a)).style("font-size",n).style("font-family",i).style("display",t._textLabelShow?"block":"none")}if("内部"==t._numberPositionChoice){var g="arc-path-"+s.data.key+"-"+t.id,v=e(c-.9*r/2-6-("外部"==t._textPositionChoice?0:1.1*n),d+.015,_-.015);D(h,t.defs.select("#"+g).empty()?t.defs.append("path").attr("d",v).attr("id",g):t.defs.select("#"+g).attr("d",v),E(s.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,r,o).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(l)).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}else if("外部"==t._numberPositionChoice){var m="arc-path-"+s.data.key+"-"+t.id,b=e(c+.9*r/2+6,d+.015,_-.015);D(h,t.defs.select("#"+m).empty()?t.defs.append("path").attr("d",b).attr("id",m):t.defs.select("#"+m).attr("d",b),E(s.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,r,o).classed(t.labelTextClass,!0).style("pointer-events","none").style("fill",q(l)).style("font-size",r).style("font-family",o).style("display",t._labelShow?"block":"none")}}}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setPublicOption",value:function(t){k(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setPublicOption",this).call(this,t);var e=t.polarAxis,n=e.x||{},a=e.y||{};this.axisLineStroke(q(e.color)).axisLineStrokeX(q(n.axisColor)||q(e.color)).axisLineStrokeY(q(a.axisColor)||q(e.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!this._fontCopy||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:"",this._textPositionChoice=i.textLabel&&i.textLabel.positionChoice?i.textLabel.positionChoice:this._textPositionChoice,this._numberPositionChoice=i.numberLabel&&i.numberLabel.positionChoice?i.numberLabel.positionChoice:this._numberPositionChoice),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._cornerRadius=0==e.cornerRadius||e.cornerRadius?d(e.cornerRadius):this._cornerRadius,this._stroke=e.areaBorderColor?q(e.areaBorderColor):"",this._strokeWidth=0==e.areaBorderWidth||e.areaBorderWidth?d(e.areaBorderWidth):this._areaBorderWidth,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?d(e.barWidthPercent):this._barWidthPercent,this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?d(e.innerRadiusRatio):this._innerRadiusRatio,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"padAngle",value:function(t){return arguments.length?(this._padAngle=t,this):this._padAngle}},{key:"areaBorderWidth",value:function(t){return arguments.length?(this._areaBorderWidth=t,this):this._areaBorderWidth}},{key:"areaBorderColor",value:function(t){return arguments.length?(this._areaBorderColor=t,this):this._areaBorderColor}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}}]),i}(vt),ao=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bullet-plot"),i.overlay=new yi(i.group),i._width=400,i._height=400,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._zeroLineStroke="#000",i._gapPadding=10,i._allowedMaxTextWidth=100,i._xScale=d3.scaleLinear(),i._mainLeft=0,i._mainWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data.output||[],i=t._data.legendData;t.group.selectAll("*").remove();for(var n="transparent",a="transparent",o=[],r=0;r<i.length;r++)"targetValue"==i[r].tips&&(n=i[r].color),"actualValue"==i[r].tips&&(a=i[r].color),"range"==i[r].tips&&o.push(i[r].color);var l=t._width,s=t._height,u=t._fontSize,h=t._fontFamily,d=(t._gapPadding,.125*s),_=t._labelShow?.8*t._labelFontSize+5:0,f=t._showX?t._fontSize+5:0,p=d+f+_,g=p*e.length+d/2*(e.length-1);g>s?(d=(s-(_+f)*e.length)/(e.length+(e.length-1)/2),p=d+f+_):(d=.067*l,l<s&&(d=.125*s),(g=(p=d+f+_)*e.length+d/2*(e.length-1))>s&&(d=(s-(_+f)*e.length)/(e.length+(e.length-1)/2),p=d+f+_));var v=d3.max(e,(function(t){return R(t.name,u,h)})),m=v>t._allowedMaxTextWidth,b=e.length>0?Math.min(v,t._allowedMaxTextWidth):0+t._gapPadding;t._showY||(b=0);for(var S=l-b-0,k=[],w=[],C=0;C<e.length;C++)e[C].actualValue<0?w.push(E(e[C].actualValue,t._numberStyle,t._decimalPlaces)):k.push(E(e[C].actualValue,t._numberStyle,t._decimalPlaces)),e[C].targetValue<0?w.push(E(e[C].targetValue,t._numberStyle,t._decimalPlaces)):k.push(E(e[C].targetValue,t._numberStyle,t._decimalPlaces));var O=G(w,t._labelFontSize,t._labelFontFamily)+R(t._suffix,t._labelFontSize,t._labelFontFamily)||0,F=G(k,t._labelFontSize,t._labelFontFamily)+R(t._suffix,t._labelFontSize,t._labelFontFamily)||0;return function(){var i=t.group.selectAll(".bullet-plot-group").data(e,(function(t){return t.key}));i.exit().remove();var r=i.enter().append("g").attr("class","bullet-plot-group").merge(i).style("font-size",u+"px").style("font-family",h).each((function(e,i){var r=d3.select(this),l=d3.max([e.targetValue,e.actualValue].concat(e.range));e.targetValue<0&&e.actualValue<0&&(l=d3.max([e.targetValue,e.actualValue,0]));var s=d3.min([e.targetValue,e.actualValue,0].concat(e.range)),_=t._xScale.domain([s,l]).range([10+O,S-F]).clamp(!0);0==t._labelShow&&(_=t._xScale.domain([s,l]).range([10,S]).clamp(!0));for(var f=[],p=0;p<e.range.length;p++)f.push({value:e.range[p],color:o[p],index:i});(r.select(".left-name").empty()?r.append("text").attr("class","left-name"):r.select(".left-name")).attr("x",0).attr("y",d/2).attr("dy","0.5em").style("text-anchor","end").style("fill",t._fontColor).text((function(t){return m?X(t.name,b,u,h):t.name})).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("display",t._showY?"block":"none"),r.selectAll(".positive-rect").remove(),r.selectAll(".negative-rect").remove(),r.selectAll(".actual-rect").remove(),r.selectAll(".target-line").remove(),r.selectAll(".tick").remove(),r.selectAll(".actual-text").remove(),r.selectAll(".target-text").remove();var g=f.filter((function(t){return t.value>0})),v=f.filter((function(t){return t.value<0}));(r.select(".positive-rect").empty()?r.selectAll("rect").data(g).enter().append("rect").attr("class","positive-rect"):r.select(".positive-rect")).style("fill",(function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-pos-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-pos-"+i)+")"}return e.color})).style("fill-opacity",(function(e){return t._fillOpacity})).attr("x",(function(t,e){return _(0==e?0:g[e-1].value)})).attr("y",0).attr("width",(function(t,e){return(0==e?_(t.value)-_(0):_(g[e].value-g[e-1].value)-_(0))<0?0:0==e?_(t.value)-_(0):_(g[e].value-g[e-1].value)-_(0)})).attr("height",d<0?0:d).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),(r.select(".negative-rect").empty()?r.append("g").selectAll("rect").data(v).enter().append("rect").attr("class","negative-rect"):r.select(".negative-rect")).style("fill",(function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-neg-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-neg-"+i)+")"}return e.color})).style("fill-opacity",(function(e){return t._fillOpacity})).attr("x",(function(t,e){return _(v[e].value)})).attr("y",0).attr("width",(function(t,e){return(0==e?_(0)-_(t.value):_(v[e-1].value)-_(v[e].value))<0?0:0==e?_(0)-_(t.value):_(v[e-1].value)-_(v[e].value)})).attr("height",d<0?0:d).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),(r.select(".actual-rect").empty()?r.append("rect").attr("class","actual-rect"):r.select(".actual-rect")).style("fill",(function(e,i){if(a&&/\[/.test(a)){var n=x(a),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=n[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var p=o.concat(),g=p.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-act-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-act-"+i)+")"}return a})).style("fill-opacity",(function(e){return t._fillOpacity})).attr("x",(function(){return e.actualValue>0?_(0):_(e.actualValue)})).attr("y",.3*d).attr("width",(function(){return e.actualValue>0?_(e.actualValue)-_(0)<0?0:_(e.actualValue)-_(0):_(0)-_(e.actualValue)<0?0:_(0)-_(e.actualValue)})).attr("height",.4*d<0?0:.4*d).on("mouseover",t._onMouseover).on("mousemove",t._onRectMousemove).on("mouseout",t._onMouseout),(r.select(".target-line").empty()?r.append("rect").attr("class","target-line"):r.select(".target-line")).attr("x",_(e.targetValue)).attr("y",.2*d).attr("width",0==e.targetValue?0:3).attr("height",.6*d).style("fill",(function(e,i){if(n&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var p=o.concat(),g=p.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-tar-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-tar-"+i)+")"}return n})).on("mouseover",t._onMouseover).on("mousemove",t._onLineMousemove).on("mouseout",t._onMouseout),(r.select(".actual-text").empty()?r.append("text").attr("class","actual-text"):r.select(".actual-text")).attr("x",(function(){return e.actualValue>0?_(e.actualValue)+5:_(e.actualValue)-5})).attr("y",.5*d).attr("dy","0.4em").style("text-anchor",e.actualValue>0?"start":"end").style("fill",t._labelFontColor).text(E(e.actualValue,t._numberStyle,t._decimalPlaces)+t._suffix).attr("visibility",0==e.actualValue?"hidden":"visible").attr("font-size",t._labelFontSize).attr("font-family",t._labelFontFamily).attr("display",t._labelShow?"block":"none"),(r.select(".target-text").empty()?r.append("text").attr("class","target-text"):r.select(".target-text")).attr("x",_(e.targetValue)).attr("y",-5).style("text-anchor","middle").style("fill",t._labelFontColor).text(E(e.targetValue,t._numberStyle,t._decimalPlaces)+t._suffix).attr("visibility",0==e.targetValue?"hidden":"visible").attr("font-size",t._labelFontSize).attr("font-family",t._labelFontFamily).attr("display",t._labelShow?"block":"none");var k=d3.max(e.range,(function(e){return R(E(e,t._numberStyle,t._decimalPlaces),u,h)})),w=d3.format("d"),C=(r.select(".tick").empty()?r.selectAll("g").data(_.ticks(S/k/4),(function(t){return w(t)})).enter().append("g").attr("class","tick"):r.select(".tick")).attr("transform",(function(t,e){return"translate("+_(t)+",0)"})).style("opacity",1);C.append("line").attr("x1",0).attr("x2",0).attr("y1",d).attr("y2",d+5).attr("stroke",t._xLineStroke).attr("stroke-width",t._xLineWidth||1).attr("display",t._xLineShow?"block":"none"),C.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",d+5).style("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("display",t._showX?"block":"none").text((function(e){return E(w(e),t._numberStyle,t._decimalPlaces)}))})).attr("transform",(function(t,e){return"translate("+b+", "+(_+p*e+d/2*e)+")"}));t._interrupt?(r.style("opacity",1),t.group.selectAll(".actual-text").style("opacity",1),t.group.selectAll(".target-text").style("opacity",1)):(r.style("opacity",0).transition().duration(t._transition?t._duration/(e.length>0?e.length:1):0).delay((function(i,n){return t._transition?t._startDelay+n*(t._duration/(e.length>0?e.length:1)):0})).style("opacity",1),t.group.selectAll(".actual-text").style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),t.group.selectAll(".target-text").style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1))}(),t._mainLeft=b,t._mainWidth=S,t._mainHeight=p*e.length+d/2*(e.length-1),t}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"labelFontFamily",value:function(t){return arguments.length?(this._labelFontFamily=t,this):this._labelFontFamily}},{key:"labelFontSize",value:function(t){return arguments.length?(this._labelFontSize=parseFloat(t),this):this._labelFontSize}},{key:"labelFontColor",value:function(t){return arguments.length?(this._labelFontColor=t,this):this._labelFontColor}},{key:"gridStroke",value:function(t){return arguments.length?(this._gridStroke=t,this):this._gridStroke}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"onLineMousemove",value:function(t){return arguments.length?(this._onLineMousemove="function"==typeof t?t:function(){},this):this._onLineMousemove}},{key:"onRectMousemove",value:function(t){return arguments.length?(this._onRectMousemove="function"==typeof t?t:function(){},this):this._onRectMousemove}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"xLineStroke",value:function(t){return arguments.length?(this._xLineStroke=t,this):this._xLineStroke}},{key:"xLineWidth",value:function(t){return arguments.length?(this._xLineWidth=t,this):this._xLineWidth}},{key:"xLineShow",value:function(t){return arguments.length?(this._xLineShow=t,this):this._xLineShow}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"xScale",get:function(){return this._xScale}},{key:"yScale",get:function(){return this._yScale}},{key:"mainLeft",get:function(){return this._mainLeft}},{key:"mainWidth",get:function(){return this._mainWidth}}]),e}(at),oo=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=this.generateColorList(t.length),i=t.categories,n=t.output,a=[];return i&&i.forEach((function(t,i){var n=e[i];a.push({name:t.name,tips:t.tips,color:n})})),{output:n,legendData:a}}}]),e}(it);function ro(t,e){var i=0,n=1,a=2,o=3,r=4,l=5,s=6;if(e.forEach((function(t){"对象"===t.name||"标题"===t.name?(i=t.index,t.isLegend):"目标值"===t.name?n=t.index:"实际值"===t.name?a=t.index:"最小值"===t.name?o=t.index:"节点1"==t.name?r=t.index:"节点2"==t.name?l=t.index:"节点3"==t.name&&(s=t.index)})),P(t,[i],2))return[];var u=t,c=[],d=u.length,_=u[0],f=[];n?f.push({name:_[n],tips:"targetValue"}):f.push({name:"",tips:"targetValue"}),a?f.push({name:_[a],tips:"actualValue"}):f.push({name:"",tips:"actualValue"}),r?f.push({name:_[r],tips:"range"}):f.push({name:"",tips:"range"}),l?f.push({name:_[l],tips:"range"}):f.push({name:"",tips:"range"}),s?f.push({name:_[s],tips:"range"}):f.push({name:"",tips:"range"});for(var p=[],y=[],x=1;x<d;x++)y.push(u[x].length);y.sort((function(t,e){return e-t}));for(var g=0;g<d;g++)for(var v=0;v<y[0];v++)p.push(isNaN(parseFloat(u[g][v])));if(0==p.filter((function(t,e){return 0==t})).length)return[];for(var m=1;m<d;m++){var b=u[m],S={name:0==b[i]||b[i]?b[i]:"",minValue:""==b[o]||isNaN(parseFloat(b[o]))||null==b[o]||null==b[o]?0:parseFloat(b[o]),targetValue:""==b[n]||isNaN(parseFloat(b[n]))||null==b[n]||null==b[n]?0:parseFloat(b[n]),actualValue:""==b[a]||isNaN(parseFloat(b[a]))||null==b[a]||null==b[a]?0:parseFloat(b[a]),range:[]};r?S.range.push(""==b[r]||isNaN(parseFloat(b[r]))||null==b[r]||null==b[r]?0:parseFloat(b[r])):S.range.push(0),l?S.range.push(""==b[l]||isNaN(parseFloat(b[l]))||null==b[l]||null==b[l]?0:parseFloat(b[l])):S.range.push(0),s?S.range.push(""==b[s]||isNaN(parseFloat(b[s]))||null==b[s]||null==b[s]?0:parseFloat(b[s])):S.range.push(0),c.push(S)}return c.forEach((function(t,e){t.key=h(t.name)+"-"+e})),{output:c,categories:f}}var lo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","bullet-chart"),i.core=new ao(i.mainGroup),i.overlay=new te(i.mainGroup),i.guideLine=new Et(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._sortValue=0,i._labelShow=!1,i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="纵向出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"update",value:function(){return this._interrupt=!1,this._titlePadding=this._unitWord&&this._unitShow?this._titlePadding:15,this.styleSvg(),this.sortData(),this.removeLabelText(),this.updateTitle(),this.updateUnit(),this.updateSource(),this.updateLegend(),this.updateCore(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateCore",value:function(){var t=this,e=t._data,i=t.core,n=t.tooltip,a=(t.overlay,t.guideLine),o=t.widthOfNoMargin,r=t.heightOfMainGroup;t.AnimationArea,i.xScale;a.y1(0).y2(r).stroke("#c6c6c6").strokeDasharray("0 0"),i.data(e).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).width(o).height(r).showX(t._xTickShow).showY(t._yTickShow).xLineStroke(t._axisLineStrokeX).xLineWidth(t._xAxisLineWidth).xLineShow(t._xAxisShow).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).labelFontSize(t._textLabel.fontSize).labelFontColor(q(t._textLabel.color)).labelFontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).zeroLineStroke(t._axisLineStroke).allowedMaxTextWidth(o/5).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMousemove((function(e,i){var a=t._data.legendData,o=[{text:t._data.output[e.index].name=="&-"+i?"":t._data.output[e.index].name},{text:a.filter((function(t){return"actualValue"==t.tips}))[0].name+"："+E(t._data.output[e.index].actualValue,t._numberStyle,t._decimalPlaces),color:a.filter((function(t){return"actualValue"==t.tips}))[0].color}];n.show(),n.data(o).update().move([d3.event.offsetX,d3.event.offsetY]),d3.select(this).style("cursor","pointer")})).onLineMousemove((function(e,i){var a=t._data.legendData,o=[{text:e.name=="&-"+i?"":e.name},{text:a.filter((function(t){return"targetValue"==t.tips}))[0].name+"："+E(e.targetValue,t._numberStyle,t._decimalPlaces),color:a.filter((function(t){return"targetValue"==t.tips}))[0].color},{text:a.filter((function(t){return"actualValue"==t.tips}))[0].name+"："+E(e.actualValue,t._numberStyle,t._decimalPlaces),color:a.filter((function(t){return"actualValue"==t.tips}))[0].color}];n.show(),n.data(o).update().move([d3.event.offsetX,d3.event.offsetY]),d3.select(this).style("cursor","pointer")})).onRectMousemove((function(e,i){var a=t._data.legendData,o=[{text:e.name=="&-"+i?"":e.name},{text:a.filter((function(t){return"actualValue"==t.tips}))[0].name+"："+E(e.actualValue,t._numberStyle,t._decimalPlaces),color:a.filter((function(t){return"actualValue"==t.tips}))[0].color}];n.show(),n.data(o).update().move([d3.event.offsetX,d3.event.offsetY]),d3.select(this).style("cursor","pointer")})).onMouseout((function(){n.hide()})),t.core.update();var l=t.core._mainHeight;l<r?t.mainGroup.select(".bullet-plot").attr("transform","translate(0,"+(r-l)/2+")"):t.mainGroup.select(".bullet-plot").attr("transform","translate(0,0)")}},{key:"buildOption",value:function(t,e){var i=new oo(t,e),n=ro;return i.dataSolveFunc(n),i}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"sortData",value:function(){}},{key:"configLegend",value:function(){var t=this._data.legendData.filter((function(t,e){return""!=t.name}));this.legend.data(t)}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.display:this._labelShow,this._textLabel=e.textLabel?e.textLabel:this._textLabel,this._suffix=e.suffix?e.suffix:""),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}}]),e}(Tt),so="deformed-bar-group",uo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","deformed-bar"),i.defs=i.elem.append("defs"),i._width=400,i._height=400,i._icon={width:400,height:400,path:"M -200 200 L 200 200 C 20 200 20 0 0 -200 C -20 0 -20 200 -200 200 Z"},i._backFill="#ccc",i._countOfOneRow=20,i._padding=2,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=(t._width,t._height,t._xScale),a=t._yScale,o=t._icon;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t._borderColor&&/\[/.test(t._borderColor)){var r=x(t._borderColor),l=[],s=!0,u=!1,h=void 0;try{for(var d,_=r[Symbol.iterator]();!(s=(d=_.next()).done);s=!0){var f=d.value,g=[],v=f.split(":");g.push(q(v[0])),g.push(v[1]),l.push(g)}}catch(t){u=!0,h=t}finally{try{!s&&_.return&&_.return()}finally{if(u)throw h}}var m=l.concat(),b=m.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-left-0").attr("x1",y(360-b[1]).x1+"%").attr("y1",y(360-b[1]).y1+"%").attr("x2",y(360-b[1]).x2+"%").attr("y2",y(360-b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-right-0").attr("x1",y(b[1]).x1+"%").attr("y1",y(b[1]).y1+"%").attr("x2",y(b[1]).x2+"%").attr("y2",y(b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var S=t.group.selectAll("."+so).data(e,(function(t){return t.key}));S.exit().remove();var k=S.enter().append("g").attr("class",so).merge(S).append("g").attr("transform",(function(e,i){return"rotate(0 "+(t._xScale.range()[0]+n.bandwidth()+n.bandwidth()*i)+","+a(0)+")"})),w=k.append("path").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){return/\[/.test(t._borderColor)?e.value<0?"url("+c("#"+t.id+"-main-border-index-left-0")+")":"url("+c("#"+t.id+"-main-border-index-right-0")+")":t._borderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).attr("stroke-width",t._borderWidth||0).attr("transform",(function(e,i){return"translate("+(t._xScale.range()[0]+n.bandwidth()+n.bandwidth()*i)+","+a(0)+") scale(0)"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);if(t._interrupt?(k.transition().duration(0).delay(0).attr("transform",(function(e,i){return"rotate(0 "+(t._xScale.range()[0]+n.bandwidth()+n.bandwidth()*i)+","+(a(e.value)+(a(0)-a(e.value))/2)+")"})),w.transition().duration(0).delay(0).attr("d",(function(t,e){var i=2*n.bandwidth()/o.width,r=(a(0)-a(t.value))/o.height;return"M "+-200*i+" "+200*r+" L "+200*i+" "+200*r+" C "+20*i+" "+200*r+" "+20*i+" 0 0 "+-200*r+" C "+-20*i+" 0 "+-20*i+" "+200*r+" "+-200*i+" "+200*r+" Z"})).attr("transform",(function(e,i){return"translate("+(t._xScale.range()[0]+n.bandwidth()+n.bandwidth()*i)+","+(a(e.value)+(a(0)-a(e.value))/2)+") scale(1) "})).each(t._onTransitionStart).each(t._onTransitionEnd)):(k.attr("transform",(function(e,i){return"rotate(0 "+(t._xScale.range()[0]+n.bandwidth()+n.bandwidth()*i)+","+(a(e.value)+(a(0)-a(e.value))/2)+")"})),w.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t,e){var i=2*n.bandwidth()/o.width,r=(a(0)-a(t.value))/o.height;return"M "+-200*i+" "+200*r+" L "+200*i+" "+200*r+" C "+20*i+" "+200*r+" "+20*i+" 0 0 "+-200*r+" C "+-20*i+" 0 "+-20*i+" "+200*r+" "+-200*i+" "+200*r+" Z"})).attr("transform",(function(e,i){return"translate("+(t._xScale.range()[0]+n.bandwidth()+n.bandwidth()*i)+","+(a(e.value)+(a(0)-a(e.value))/2)+") scale(1) "})).each(t._onTransitionStart).each(t._onTransitionEnd)),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice))t.group.selectAll(".deform-text").remove();else if(0==t._positionOptions.indexOf(t._positionChoice)){t.group.selectAll(".deform-text").remove();var C=t.group.selectAll("text").data(e);C.exit().remove();var O=C.enter().append("text").attr("class","deform-text").merge(C).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t){return n(t.name)+n.bandwidth()})).attr("y",(function(t){return a(t.value)||0})).attr("dy",(function(e){return e.value<0?t._fontSize/2+5:"-5"})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?O.style("opacity",1):O.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}else if(1==t._positionOptions.indexOf(t._positionChoice)){t.group.selectAll(".deform-text").remove();var F=t.group.selectAll("text").data(e);F.exit().remove();var L=F.enter().append("text").attr("class","deform-text").merge(F).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t){return n(t.name)+n.bandwidth()})).attr("y",(function(t){return a(0)||0})).attr("dy",(function(e){return e.value<0?.9*t._fontSize+5:"-5"})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?L.style("opacity",1):L.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}for(var P=t.group.selectAll(".deform-text"),A=[],W=[],z=0;z<P._groups[0].length;z++){W.push(z);for(var M=z+1;M<P._groups[0].length;M++){p(i(d3.select(P._groups[0][z])),i(d3.select(P._groups[0][M])))&&(A.push(z),d3.select(P._groups[0][z]).style("visibility","hidden"))}}for(var D=new Set(A),R=Array.from(D),N=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(R,W),T=0;T<R.length;T++){for(var B=[],G=0;G<N.length;G++){var X=i(d3.select(P._groups[0][R[T]])),j=i(d3.select(P._groups[0][N[G]]));if(B.push(p(X,j)),p(X,j)){if(R[T]==N[G])continue;d3.select(P._groups[0][R[T]]).style("visibility","hidden")}}0==B.filter((function(t){return 1==t})).length&&N.push(R[T])}for(var I=0;I<N.length;I++)d3.select(P._groups[0][N[I]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),co=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","deformed-bar-chart"),i.grid=new Jt(i.coreGroup),i.core=new uo(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xTickShow=!0,i._yTickShow=!0,i._borderColor="",i._borderWidth=0,i._fillOpacity=.6,i._labelShow=!1,i._positionOptions=["上面","内部居下"],i._positionChoice="内部居下",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="纵向同步拉伸",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.core,a=t.tooltip,r=t.clipArea,l=t.overlay,s=t.selectOverlay,u=(t.xAxis._axisStart,t.xAxis._axisEnd),h=0;u>t.widthOfNoMargin-t.yAxis.width&&(h=u-(t.widthOfNoMargin-t.yAxis.width));var d=t.widthOfCore-h,_=t.heightOfCore,f=t.xScale;t.yScale;i.width(d).height(_).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).xScale(t.xScale).yScale(t.yScale).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveoptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).borderColor(t._borderColor).borderWidth(t._borderWidth).fillOpacity(t._fillOpacity).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),l.data(f.domain()).isScalePoint(!1).isDeformedBar(!0).bandX(f.range()[0]).bandWidth(f.step()).bandHeight(_).onMouseover((function(i,n){if(null!=e[n]){var o=[{text:""+(e[n].name=="$-"+n?"":e[n].name),color:e[n].color},{text:e[n].valueLabel+": "+E(e[n].value,t._numberStyle,t._decimalPlaces)}];a.data(o).update().move([d3.event.offsetX,d3.event.offsetY]).show()}t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+(f(i)+f.bandwidth()/2)+",0)")})).onMousemove((function(t,i){a.move([d3.event.offsetX,d3.event.offsetY]),s.show(),null==e[i]&&s.hide()})).onMouseout((function(){a.hide(),s.hide()})),s.width(f.step()).height(_).shadowColor("#ccc").hide(),t.coreGroup.call(o,t.yAxis.width+.5,0),r.width(d).height(_).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),r.update(),0!=t._yRange.length&&(0==isNaN(parseFloat(t._yRange[0]))||0==isNaN(parseFloat(t._yRange[1]))?t.coreGroup.attr("clip-path","url("+c("#"+r.id)+")"):t.coreGroup.attr("clip-path",""));var p=t.group.selectAll(".deformed-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="$-"+e}));d3.selectAll(p).remove(),i.update(),n.update(),s.update(),l.update()}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange([]).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.textTransX(n.bandwidth()/2).translate(x,g).update(),i.translate(v,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e.map((function(t){return t.name})):[0,1];n.push("");var a=void 0;if(e.length){var o=1.05*d3.min(e,(function(t){return+t.value})),r=1.05*d3.max(e,(function(t){return+t.value}));a=o<0?r<=0?[o,0]:[o,r]:[0,r]}else a=[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._borderWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._borderWidth,this._borderColor=e.barborderColor?q(e.barborderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),e}(Tt),ho=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","multiple-bubble"),i.overlay=new yi(i.group),i._width=400,i._height=400,i._fontSize=12,i._fontFamily="sans-serif",i._fontColor="#000",i._zeroLineStroke="#000",i._gapPadding=10,i._allowedMaxTextWidth=100,i._xScale=d3.scalePoint().padding(1),i._mainLeft=0,i._mainWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data||[];t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=t._width,a=t._height,o=t._fontSize,r=t._fontFamily,l=(t._gapPadding,.125*a),s=t._showX?t._fontSize+5:0,u=l+s+0,h=u*e.length+l/2*(e.length-1);h>a?(l=(a-(0+s)*e.length)/(e.length+(e.length-1)/2),u=l+s+0):(l=.067*n,n<a&&(l=.125*a),(h=(u=l+s+0)*e.length+l/2*(e.length-1))>a&&(l=(a-(0+s)*e.length)/(e.length+(e.length-1)/2),u=l+s+0));var d=d3.max(e,(function(t){return R(t.name,o,r)})),_=d>t._allowedMaxTextWidth,f=e.length>0?Math.min(d,t._allowedMaxTextWidth):0+t._gapPadding;t._showY||(f=0);var g=n-f-0;!function(){var i=t.group,n=i.selectAll(".bubble-grid-group").data(e,(function(t){return t.key}));n.exit().remove(),n.enter().append("g").attr("class","bubble-grid-group").merge(n).each((function(e,i){var n=d3.select(this),a=e.data.length?e.data.map((function(t){return t.name})):[0,1],s=t._xScale.domain(a).range([10,g]),u=d3.max(a,(function(t){return R(t,o,r)})),c=(d3.format("d"),g/a.length);if(1.1*u>c){var h=Math.ceil(1.1*u/c);a=a.filter((function(t,e){return e%h==0}))}(n.select(".grid").empty()?n.append("g").selectAll("g").data(a).enter().append("g").attr("class","grid"):n.select(".grid")).attr("transform",(function(t,e){return"translate("+s(t)+",0)"})).style("opacity",1).append("line").attr("x1",0).attr("x2",0).attr("y1",0==i?-l/4:-l+.3*(t._showX?t._fontSize:0)).attr("y2",l/2).attr("stroke",t._gridStroke).attr("stroke-width",t._gridLineWidth||0).style("stroke-dasharray",t._strokeDasharray).attr("display",t._gridShowY?"block":"none");n.append("line").attr("x1",10).attr("x2",g).attr("y1",l/2).attr("y2",l/2).attr("stroke",t._gridStroke).attr("stroke-width",t._gridLineWidth||0).style("stroke-dasharray",t._strokeDasharray).attr("display",t._gridShowX?"block":"none")})).attr("transform",(function(t,e){return"translate("+f+", "+(0+u*e+l/2*e)+")"}));var a=i.selectAll(".bubble-plot-group").data(e,(function(t){return t.key}));a.exit().remove(),a.enter().append("g").attr("class","bubble-plot-group").merge(a).style("font-size",o+"px").style("font-family",r).each((function(i,n){var a=d3.select(this),s=i.data.length?i.data.map((function(t){return t.name})):[0,1],h=t._xScale.domain(s).range([10,g]),d=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),p=d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))})),y=d3.scaleSqrt().domain([d,p]).range([0,1.2*u/2]);"diameter"==t._bubbleSizeType&&(y=d3.scaleLinear().domain([d,p]).range([0,1.2*u/2])),(a.select(".left-name").empty()?a.append("text").attr("class","left-name"):a.select(".left-name")).attr("x",0).attr("y",l/2).attr("dy","0.5em").style("text-anchor","end").style("fill",t._fontColor).text((function(t){return _?X(i.name,f,o,r):i.name})).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("display",t._showY?"block":"none"),a.selectAll(".tick").remove();var x=d3.max(s,(function(t){return R(t,o,r)})),v=(d3.format("d"),g/s.length);if(1.1*x>v){var m=Math.ceil(1.1*x/v);s=s.filter((function(t,e){return e%m==0}))}var b=(a.select(".tick").empty()?a.selectAll("g").data(s).enter().append("g").attr("class","tick"):a.select(".tick")).attr("transform",(function(t,e){return"translate("+h(t)+",0)"})).style("opacity",1);b.append("line").attr("x1",0).attr("x2",0).attr("y1",l/2).attr("y2",l/2+5).attr("stroke",t._xLineStroke).attr("stroke-width",t._xLineWidth||1).attr("display",t._showX?"block":"none"),b.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",l/2+5).style("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("display",t._showX?"block":"none").text((function(t){return t})),(a.select(".axis-path").empty()?a.append("line").attr("class","axis-path"):a.select(".axis-path")).attr("x1",10).attr("x2",g).attr("y1",l/2).attr("y2",l/2).attr("stroke",t._xLineStroke).attr("stroke-width",t._xLineWidth||0).attr("display",t._xLineShow?"block":"none");a.append("line").attr("x1",10).attr("x2",10).attr("y1",0).attr("y2",n==e.length-1?l:u+l/2).attr("stroke",t._yLineStroke).attr("stroke-width",t._yLineWidth||0).attr("display",t._yLineShow?"block":"none"),a.append("line").attr("x1",4).attr("x2",10).attr("y1",l/2).attr("y2",l/2).attr("stroke",t._yLineStroke).attr("stroke-width",t._yLineWidth||0).attr("display",t._yLineShow?"block":"none");var S=a.select(".circles").empty()?a.selectAll("circle").data(i.data).enter().append("circle").attr("class","circles"):a.select(".circles");S.style("fill",(function(e){return i.color&&/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color&&/#/.test(i.color)?i.color:"rgb("+U(i.color,0)+","+U(i.color,1)+","+U(i.color,2)+")"})).style("fill-opacity",(function(e){if(i.color&&/#/.test(i.color))return t._fillOpacity;var n=U(i.color,3)||1;return t._fillOpacity*n})).style("stroke",t._bubbleBorderColor||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color)).style("stroke-width",t._bubbleBorderWidth||0).attr("cx",(function(t,e){return h(t.name)})).attr("cy",l/2).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),1==t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?S.transition().duration(0).delay(0).attrTween("r",(function(t,e){e=d3.interpolate(0,y(t.value));return function(t){return e(t)}})):0==t._moveOptions.indexOf(t._moveStyle)?S.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attrTween("r",(function(t,e){e=d3.interpolate(0,y(t.value));return function(t){return e(t)}})):1==t._moveOptions.indexOf(t._moveStyle)?S.transition().duration(t._transition?t._duration/(i.data.length>0?i.data.length:1):0).delay((function(e,n){return t._transition?t._startDelay+t._duration/(i.data.length>0?i.data.length:1)*n:0})).attrTween("r",(function(t,e){e=d3.interpolate(0,y(t.value));return function(t){return e(t)}})):2==t._moveOptions.indexOf(t._moveStyle)&&S.transition().duration(t._transition?t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+t._duration/(e.length>0?e.length:1)*n:0).attrTween("r",(function(t,e){e=d3.interpolate(0,y(t.value));return function(t){return e(t)}}))})).attr("transform",(function(t,e){return"translate("+f+", "+(0+u*e+l/2*e)+")"}));var s=i.selectAll(".bubble-label-group").data(e,(function(t){return t.key}));s.exit().remove(),s.enter().append("g").attr("class","bubble-label-group").merge(s).each((function(i,n){var a=d3.select(this),o=i.data.length?i.data.map((function(t){return t.name})):[0,1],r=t._xScale.domain(o).range([10,g]),s=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),c=d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}));d3.scaleSqrt().domain([s,c]).range([0,1.2*u/2]);"diameter"==t._bubbleSizeType&&d3.scaleLinear().domain([s,c]).range([0,1.2*u/2]);var h=a.selectAll("text").data(i.data);h.exit().remove();var d=h.enter().append("text").attr("class","bubble-text").merge(h).attr("x",(function(t,e){return r(t.name)+f})).attr("y",l/2+(0+u*n+l/2*n)).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._labelFontColor).style("font-size",t._labelFontSize).style("font-family",t._labelFontFamily).attr("text-anchor","middle").attr("dy","0.4em").style("display",t._labelShow?"block":"none");t._interrupt?d.style("opacity",1):d.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay((function(e,i){return t._transition?t._startDelay+t._duration:0})).style("opacity",1)}))}(),t._mainLeft=f,t._mainWidth=g,t._mainHeight=u*e.length+l/2*(e.length-1);for(var v=t.group.selectAll(".bubble-text"),m=[],b=[],S=0;S<v._groups[0].length;S++){b.push(S);for(var k=S+1;k<v._groups[0].length;k++){p(i(d3.select(v._groups[0][S])),i(d3.select(v._groups[0][k])))&&(m.push(S),d3.select(v._groups[0][S]).style("visibility","hidden"))}}for(var w=new Set(m),C=Array.from(w),O=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(C,b),F=0;F<C.length;F++){for(var L=[],P=0;P<O.length;P++){var A=i(d3.select(v._groups[0][C[F]])),W=i(d3.select(v._groups[0][O[P]]));if(L.push(p(A,W)),p(A,W)){if(C[F]==O[P])continue;d3.select(v._groups[0][C[F]]).style("visibility","hidden")}}0==L.filter((function(t){return 1==t})).length&&O.push(C[F])}for(var z=0;z<O.length;z++)d3.select(v._groups[0][O[z]]).style("visibility","visible");return t}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"labelFontFamily",value:function(t){return arguments.length?(this._labelFontFamily=t,this):this._labelFontFamily}},{key:"labelFontSize",value:function(t){return arguments.length?(this._labelFontSize=parseFloat(t),this):this._labelFontSize}},{key:"labelFontColor",value:function(t){return arguments.length?(this._labelFontColor=t,this):this._labelFontColor}},{key:"gridStroke",value:function(t){return arguments.length?(this._gridStroke=t,this):this._gridStroke}},{key:"gridShowX",value:function(t){return arguments.length?(this._gridShowX=t,this):this._gridShowX}},{key:"gridShowY",value:function(t){return arguments.length?(this._gridShowY=t,this):this._gridShowY}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"zeroLineStroke",value:function(t){return arguments.length?(this._zeroLineStroke=t,this):this._zeroLineStroke}},{key:"showZeroLine",value:function(t){return arguments.length?(this._showZeroLine=t,this):this._showZeroLine}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"onLineMousemove",value:function(t){return arguments.length?(this._onLineMousemove="function"==typeof t?t:function(){},this):this._onLineMousemove}},{key:"onRectMousemove",value:function(t){return arguments.length?(this._onRectMousemove="function"==typeof t?t:function(){},this):this._onRectMousemove}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"bubbleSizeType",value:function(t){return arguments.length?(this._bubbleSizeType=t,this):this._bubbleSizeType}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"bubbleBorderWidth",value:function(t){return arguments.length?(this._bubbleBorderWidth=t,this):this._bubbleBorderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"xLineStroke",value:function(t){return arguments.length?(this._xLineStroke=t,this):this._xLineStroke}},{key:"xLineWidth",value:function(t){return arguments.length?(this._xLineWidth=t,this):this._xLineWidth}},{key:"xLineShow",value:function(t){return arguments.length?(this._xLineShow=t,this):this._xLineShow}},{key:"yLineStroke",value:function(t){return arguments.length?(this._yLineStroke=t,this):this._yLineStroke}},{key:"yLineWidth",value:function(t){return arguments.length?(this._yLineWidth=t,this):this._yLineWidth}},{key:"yLineShow",value:function(t){return arguments.length?(this._yLineShow=t,this):this._yLineShow}},{key:"strokeDasharray",value:function(t){return arguments.length?(this._strokeDasharray=t,this):this._strokeDasharray}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"xScale",get:function(){return this._xScale}},{key:"yScale",get:function(){return this._yScale}},{key:"mainLeft",get:function(){return this._mainLeft}},{key:"mainWidth",get:function(){return this._mainWidth}}]),e}(at),_o=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","multiple-bubble-chart"),i.core=new ho(i.mainGroup),i.overlay=new te(i.mainGroup),i.guideLine=new Et(i.mainGroup),i.xAxis=new mi(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._sortValue=0,i._labelShow=!1,i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._bubbleSizeType="area",i._bubbleBorderColor="",i._bubbleBorderWidth=0,i._fillOpacity=.9,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同步出现","横向出现","纵向出现"],i._moveStyle="同步出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateAxis",value:function(){var t=this,e=t.xAxis;e.scaleFunc(d3.scaleLinear().range([0,t.widthOfNoMargin])).title(t._xTitle).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(!1).axisLineShow(!1).tickShow(!1),e.translate(0,t.heightOfMainGroup-e.height+5).update()}},{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.core,n=t.tooltip,a=(t.overlay,t.guideLine),o=t.widthOfNoMargin,r=t.heightOfCore;t.AnimationArea,i.xScale;if(a.y1(0).y2(r).stroke("#c6c6c6").strokeDasharray("0 0"),t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var l=x(t._bubbleBorderColor),s=[],u=!0,h=!1,d=void 0;try{for(var _,f=l[Symbol.iterator]();!(u=(_=f.next()).done);u=!0){var p=_.value,g=[],v=p.split(":");g.push(q(v[0])),g.push(v[1]),s.push(g)}}catch(t){h=!0,d=t}finally{try{!u&&f.return&&f.return()}finally{if(h)throw d}}var m=s.concat(),b=m.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(b[1]).x1+"%").attr("y1",y(b[1]).y1+"%").attr("x2",y(b[1]).x2+"%").attr("y2",y(b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(e).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).width(o).height(r).gridStroke(t._gridStroke).gridShowX(t._gridShowX).gridShowY(t._gridShowY).gridLineWidth(t._gridLineWidth).showX(t._xTickShow).showY(t._yTickShow).strokeDasharray(t._gridStrokeDasharray).xLineStroke(t._axisLineStrokeX).xLineWidth(t._xAxisLineWidth).xLineShow(t._xAxisShow).yLineStroke(t._axisLineStrokeY).yLineWidth(t._yAxisLineWidth).yLineShow(t._yAxisShow).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).labelFontSize(t._numberLabel.fontSize).labelFontColor(q(t._numberLabel.color)).labelFontFamily(t._numberLabel.fontFamily).labelShow(t._labelShow).zeroLineStroke(t._axisLineStroke).showZeroLine(t._xTickShow).allowedMaxTextWidth(o/5).bubbleSizeType(t._bubbleSizeType).bubbleBorderColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).bubbleBorderWidth(t._bubbleBorderWidth).fillOpacity(t._fillOpacity).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){var a=[{text:""+(-1!=String(e.subName).indexOf("$-")?"":e.subName),color:e.color},{text:(-1!=String(e.name).indexOf("&-")?"":e.name)+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];n.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){n.hide()})),t.core.update();var S=t.core._mainHeight;S<r?t.mainGroup.select(".multiple-bubble").attr("transform","translate(0,"+(r-S)/2+")"):t.mainGroup.select(".multiple-bubble").attr("transform","translate(0,0)")}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.display,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._bubbleSizeType=i.bubbleSizeType?i.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=i.bubbleBorderColor?q(i.bubbleBorderColor):"",this._bubbleBorderWidth=0==i.bubbleBorderWidth||i.bubbleBorderWidth?i.bubbleBorderWidth:this._bubbleBorderWidth,this._fillOpacity=0==i.fillOpacity||i.fillOpacity?i.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(e).length&&(e.display||0==e.display?(this._labelShow=e.display||0==e.display?e.display:this._labelShow,this._numberLabel=e.textLabel?e.textLabel:this._numberLabel,this._suffix=""):(this._labelShow=e.numberLabel?e.numberLabel.show:this._labelShow,this._numberLabel=e.numberLabel?e.numberLabel:this._numberLabel,this._suffix=e.numberLabel&&e.numberLabel.suffix?e.numberLabel.suffix:"")),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}}]),e}(Tt),fo=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polar-bubble"),e._lineFunc=null,e._startAngle=0,e._endAngle=2*Math.PI,e._radius=100,e._stroke=null,e._borderWidth=2,e._strokeDasharry="",e._transition=!0,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t._startAngle,o=t._endAngle,r=t._radius,l=n.length?n.map((function(t){return t.name})):[0,1],s=d3.scaleBand().domain(l).range([0,r]),u=n.length?[d3.min(n,(function(t){return d3.min(t.data,(function(t){return parseFloat(+t.value)}))})),d3.max(n,(function(t){return d3.max(t.data,(function(t){return parseFloat(+t.value)}))}))]:[0,1],h=d3.scaleSqrt().domain(u).range([t._minRadius,t._maxRadius]);"diameter"==t._bubbleSizeType&&(h=d3.scaleLinear().domain(u).range([t._minRadius,t._maxRadius]));for(var d=t._deadData[0].data.length,_=Math.abs(o-a)==2*Math.PI?(o-a)/(d||1):(o-a)/(d-1||1),f=[],g=0;g<n.length;g++){f[g]=[];for(var v=0;v<n[g].data.length;v++)f[g][v]=s(n[g].name)+s.bandwidth()/2}for(var m=[],b=0;b<f.length;b++)for(var S=f[b],k="",w=[],C=0;C<d;C++){var O=S[C],F=O*Math.sin(a+C*_),L=-O*Math.cos(a+C*_);k+=F+","+L+" ",w.push({x:F,y:L,value:n[b].data[C].value,name:n[b].data[C].name,subName:n[b].data[C].subName}),m[b]={polygon:k,points:w}}t.group.selectAll("*").remove(),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var P=t.group;t._startAngle>Math.PI/2&&t._startAngle<1.5*Math.PI&&(parseFloat(t._yLabelAngle)<=0?t._yLabelAngle=parseFloat(t._yLabelAngle)+180:t._yLabelAngle=parseFloat(t._yLabelAngle)-180);var A=l,W=A,z=d3.scalePoint().domain(l).range([r,0]),M=(d3.max(A,(function(e){return R(e,t._themeFontSize,t._themeFontFamily)})),t._themeFontSize),D=[];if("横排"==t._yLabelDirection){W=W.map((function(e){return X(e,r,t._themeFontSize,t._themeFontFamily)}));var N=d3.max(W,(function(e){return R(e,t._themeFontSize,t._themeFontFamily)}))||0,T=t._themeFontSize,G=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),I=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180));W.forEach((function(e){var i=R(e,t._themeFontSize,t._themeFontFamily)/(90==Math.abs(t._yLabelAngle)?2:1);D.push(T*I+i*G)})),M=T*I+N*G}else{W=W.map((function(e){return j(e,r,t._themeFontSize,t._themeFontFamily)}));var H=d3.max(W,(function(e){return B(e,t._themeFontSize,t._themeFontFamily)}))||0,V=t._themeFontSize,$=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),Z=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180));W.forEach((function(e){var i=B(e,t._themeFontSize,t._themeFontFamily)/(Math.abs(t._yLabelAngle)%180==0?2:1);D.push(i*Z+V*$)})),M=H*Z+V*$}var Q=r/A.length;Math.min(.9*t._mainWidth,.9*t._mainHeight);if("clockwise"==t._rotateDirection?"横排"==t._yLabelDirection?t._yLabelAngle:t._yLabelAngle<=0&&t._yLabelAngle>-90||t._yLabelAngle>90&&t._yLabelAngle:"横排"==t._yLabelDirection?t._yLabelAngle:t._yLabelAngle>=0&&t._yLabelAngle<90||t._yLabelAngle<-90&&t._yLabelAngle,t._polarCount=A.length-1>0?A.length-1:0,M>Q){var K=Math.ceil(M/Q);A=A.filter((function(t,e){return e%K==0})),W=W.filter((function(t,e){return e%K==0})),D=D.filter((function(t,e){return e%K==0})),t._polarCount=A.length-1>0?A.length-1:0}var J=d3.axisRight().tickSizeOuter(-.5).tickValues(A).scale(z);"clockwise"==t._rotateDirection&&(J=d3.axisLeft().tickSizeOuter(-.5).tickValues(A).scale(z)),P.selectAll(".circle-g").remove();var tt=P.append("g").attr("class","circle-group").selectAll("g").data(n);tt.exit().remove(),tt.enter().append("g").attr("class","circle-g").merge(tt).each((function(e,i){var a=d3.select(this).selectAll("circle").data(m[i].points);a.exit().remove();var o=a.enter().append("circle").attr("class","circle-"+i).attr("cx",0).attr("cy",0).merge(a).style("fill",(function(n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})).style("stroke",t._bubbleBorderColor||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._bubbleBorderWidth||0);o.attr("cx",(function(t){return t.x||0})).attr("cy",(function(t){return t.y||0})),1==t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?o.transition().duration(0).delay(0).attrTween("r",(function(t,e){e=d3.interpolate(0,h(t.value));return function(t){return e(t)}})):0==t._moveOptions.indexOf(t._moveStyle)?o.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attrTween("r",(function(t,e){e=d3.interpolate(0,h(t.value));return function(t){return e(t)}})):1==t._moveOptions.indexOf(t._moveStyle)?o.transition().duration(t._transition?.9*t._duration/(e.data.length>0?e.data.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.data.length>0?e.data.length:1)*n:0})).attrTween("r",(function(t,e){e=d3.interpolate(0,h(t.value));return function(t){return e(t)}})):2==t._moveOptions.indexOf(t._moveStyle)&&o.transition().duration(t._transition?.9*t._duration/(n.length>0?n.length:1):0).delay(t._transition?t._startDelay+.9*t._duration/(n.length>0?n.length:1)*i:0).attrTween("r",(function(t,e){e=d3.interpolate(0,h(t.value));return function(t){return e(t)}})),o.on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout)}));var et=P.append("g").attr("class","number-group").selectAll("g").data(n);et.exit().remove(),et.enter().append("g").attr("class","number-g").merge(et).each((function(e,i){var n=d3.select(this).selectAll("text").data(m[i].points);n.exit().remove();var a=n.enter().append("text").attr("class","bubble-text").merge(n).text((function(i,n){return 0==e.data[n].value?"":E(e.data[n].value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t,e){return t.x||0})).attr("y",(function(t){return t.y||0})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").attr("dy","0.4em").style("display",t._labelShow?"block":"none");t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+t._duration:0})).style("opacity",1)}));for(var it=t.group.selectAll(".bubble-text"),nt=[],at=[],ot=0;ot<it._groups[0].length;ot++){at.push(ot);for(var rt=ot+1;rt<it._groups[0].length;rt++){p(d3.select(it._groups[0][ot]).node().getBoundingClientRect(),d3.select(it._groups[0][rt]).node().getBoundingClientRect())&&(nt.push(ot),d3.select(it._groups[0][ot]).style("visibility","hidden"))}}for(var lt=new Set(nt),st=Array.from(lt),ut=yt(st,at),ct=0;ct<st.length;ct++){for(var ht=[],dt=0;dt<ut.length;dt++){var _t=d3.select(it._groups[0][st[ct]]).node().getBoundingClientRect(),ft=d3.select(it._groups[0][ut[dt]]).node().getBoundingClientRect();if(ht.push(p(_t,ft)),p(_t,ft)){if(st[ct]==ut[dt])continue;d3.select(it._groups[0][st[ct]]).style("visibility","hidden")}}0==ht.filter((function(t){return 1==t})).length&&ut.push(st[ct])}for(var pt=0;pt<ut.length;pt++)d3.select(it._groups[0][ut[pt]]).style("visibility","visible");function yt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}for(var xt=[],gt=1.05*r+5,vt=0;vt<d;vt++){var mt=gt*Math.sin(a+vt*_),bt=-gt*Math.cos(a+vt*_);xt.push({x:mt,y:bt})}var St=t._sectorCount||1,kt=(o-a)/St;P.append("path").attr("class","xAxis-path").attr("d",(function(i,n){return e(r-.5*t._xAxisLineWidth,"clockwise"==t._rotateDirection?a:o,"clockwise"==t._rotateDirection?o:a)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none");var wt=P.selectAll(".bubble-lines").data(d3.range(St+1));wt.exit().remove();var Ct=wt.enter().append("line").attr("class","bubble-lines").merge(wt).style("fill","none").style("stroke",t._stroke).attr("x1",(function(t,e){var i=a+kt*e;return Math.cos(i-Math.PI/2)*r})).attr("y1",(function(t,e){var i=a+kt*e;return Math.sin(i-Math.PI/2)*r})).attr("x2",(function(t,e){var i=a+kt*e;return Math.cos(i-Math.PI/2)*(r+5)})).attr("y2",(function(t,e){var i=a+kt*e;return Math.sin(i-Math.PI/2)*(r+5)})),Ot=n.length>0?n[0].data.map((function(t){return t.name})):[];P.selectAll(".angle-text").remove();var Ft=P.append("g").selectAll("text").data(xt);Ft.exit().remove();var Lt=Ft.enter().append("text").attr("class","angle-text").text((function(e,i){if(n.length>0){if("水平"==t._xLabelDirection){var o=Math.abs(Math.cos(a+kt*i-Math.PI/2)*(r+10)),l=t._mainWidth/2-Math.abs(o);return X(Ot[i],l,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var s=Math.abs(Math.sin(a+kt*i-Math.PI/2)*(r+10)),u=t._mainHeight/2-Math.abs(s);return j(Ot[i],u,t._themeFontSize,t._themeFontFamily)}}})).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).attr("x",(function(t,e){var i=a+kt*e;return Math.cos(i-Math.PI/2)*(r+10)})).attr("y",(function(t,e){var i=a+kt*e;return Math.sin(i-Math.PI/2)*(r+10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)Lt.attr("transform",(function(e,i){var n=a+kt*i;return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,0)":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+.4*t._themeFontSize+")":"translate(0,"+.8*t._themeFontSize+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".angle-text").remove();var Pt=t.group.append("g").selectAll("text").data(xt);Pt.exit().remove(),Pt.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(a+kt*e)/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none").text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(Ot[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",r+10).attr("dy",".35em").style("text-anchor",(function(e,i){var n=180*(a+kt*i)/Math.PI+("clockwise"==t._rotateDirection?0:360);return n-90<270&&n-90>90?"end":null})).attr("transform",(function(e,i){var n=180*(a+kt*i)/Math.PI+("clockwise"==t._rotateDirection?0:360);return n-90<270&&n-90>90?"rotate(180 "+(r+10)+",0)":null}))}else{P.selectAll(".angle-text").remove();var At=t.group.selectAll("g.text-group").data(xt);At.exit().remove();At.enter().append("g").attr("class","text-group").merge(At).each((function(i,o){var l=d3.select(this),s=a+kt*o,u=r+10,c="arc-path-"+o+"-"+t.id,h=e(u+.5*t._themeFontSize,s+kt/2+.015,s-kt/2-.015);"clockwise"==t._rotateDirection&&(h=e(u+.6*t._themeFontSize,s-kt/2+.015,s+kt/2-.015));t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);var d=l.append("text").style("text-anchor","middle").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).attr("dy","0.35em");d.append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#arc-path-"+o+"-"+t.id})).text((function(e,i){var a=n.length>0?n[0].data:[],r=a.length>0?a[o].name=="&-"+(o+1)?"":a[o].name:"",l=t._defs.select("#arc-path-"+o+"-"+t.id).node().getTotalLength();return X(r.toString(),l,t._themeFontSize,t._themeFontFamily)})),1==t._interrupt?d.style("opacity",1).style("display",t._showX?"block":"none"):d.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none")}))}1==t._interrupt?(Ct.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),Lt.style("opacity",1).style("display",t._showX?"block":"none")):(Ct.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),Lt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var Wt=0;Wt<d;Wt++)0==Math.abs(Wt*_+a)||Math.abs(Wt*_+a)==Math.PI?d3.select(P.selectAll(".angle-text").nodes()[Wt]).attr("text-anchor","middle"):Wt*_+a>Math.PI||Wt*_+a<0&&Wt*_+a>-Math.PI?d3.select(P.selectAll(".angle-text").nodes()[Wt]).attr("text-anchor","end"):d3.select(P.selectAll(".angle-text").nodes()[Wt]).attr("text-anchor","start");var zt=P.append("g").attr("class","polar-bubble-axis").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).call(J);if(1==t._interrupt?zt.style("opacity",1):zt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1),P.select(".polar-bubble-axis").attr("transform","translate(-0.5, "+-r+") rotate("+180*t._startAngle/Math.PI+" 0.5 "+r+")"),P.selectAll(".polar-bubble-axis .tick line").style("stroke",t._axisLineStrokeY).style("stroke-width",t._yAxisLineWidth).style("display",t._yAxisShow?"block":"none"),"横排"==t._yLabelDirection?(P.selectAll(".polar-bubble-axis .tick text").remove(),P.selectAll(".polar-bubble-axis .tick").append("text").text((function(t,e){return W[e]})).attr("transform",(function(e,i){var n=Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right"),a="clockwise"==t._rotateDirection?-8:8,o=.4*t._themeFontSize;return"translate("+(a+n.x)+","+(o+n.y)+")rotate("+t._yLabelAngle+")"})).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("text-anchor",Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right").anchor).style("display",t._showY?"block":"none")):(P.selectAll(".polar-bubble-axis .tick text").remove(),P.selectAll(".polar-bubble-axis .tick").append("text").text((function(t,e){return W[e]})).each((function(e,i){for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),h=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),h.text(r.join("")),h.node().getComputedTextLength()>0&&(0==s||++l,r.pop(),h.text(r.join("")),r=[n],h=a.append("tspan").attr("x",u).attr("y",l*parseFloat(.9*t._themeFontSize*1.2)+c).text(n)),s++})).attr("transform",(function(e,i){var n=Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right",W[i]);return"translate("+n.x+","+n.y+")rotate("+t._yLabelAngle+")"})).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("text-anchor",(function(e,i){return Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right",W[i]).anchor})).style("display",t._showY?"block":"none")),P.select(".polar-bubble-axis path").style("stroke",t._axisLineStrokeY).style("stroke-width",t._yAxisLineWidth).style("display",t._yAxisShow?"block":"none"),"水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var Mt=t.group.selectAll(".angle-text"),Dt=[],Rt=[],Nt=0;Nt<Mt._groups[0].length;Nt++){Rt.push(Nt);for(var Tt=Nt+1;Tt<Mt._groups[0].length;Tt++){p(i(d3.select(Mt._groups[0][Nt])),i(d3.select(Mt._groups[0][Tt])))&&(Dt.push(Nt),d3.select(Mt._groups[0][Nt]).style("opacity","0"))}}for(var Bt=new Set(Dt),Gt=Array.from(Bt),Xt=yt(Gt,Rt),jt=0;jt<Gt.length;jt++){for(var It=[],Yt=0;Yt<Xt.length;Yt++){var Ht=i(d3.select(Mt._groups[0][Gt[jt]])),Et=i(d3.select(Mt._groups[0][Xt[Yt]]));if(It.push(p(Ht,Et)),p(Ht,Et)){if(Gt[jt]==Xt[Yt])continue;d3.select(Mt._groups[0][Gt[jt]]).remove()}}0==It.filter((function(t){return 1==t})).length&&Xt.push(Gt[jt])}for(var Vt=0;Vt<Xt.length;Vt++)d3.select(Mt._groups[0][Xt[Vt]]).style("opacity","1")}function yt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"deadData",value:function(t){return arguments.length?(this._deadData=t,this):this._deadData}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"tickTextColor",value:function(t){return arguments.length?(this._tickTextColor=t,this):this._tickTextColor}},{key:"tickTextSize",value:function(t){return arguments.length?(this._tickTextSize=t,this):this._tickTextSize}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"bubbleSizeType",value:function(t){return arguments.length?(this._bubbleSizeType=t,this):this._bubbleSizeType}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"bubbleBorderWidth",value:function(t){return arguments.length?(this._bubbleBorderWidth=t,this):this._bubbleBorderWidth}},{key:"minRadius",value:function(t){return arguments.length?(this._minRadius=parseFloat(t),this):this._minRadius}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=parseFloat(t),this):this._maxRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),po="grid-arc-path",yo="grid-line",xo=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.elem=t.append("g").attr("class","polar-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=5,e}return w(i,t),S(i,[{key:"update",value:function(){var t=this,i=t._startAngle,n=t._endAngle,a=t._radius,o=t.group.style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray);!function(){if(!t._showX)return void o.selectAll(".grid-arc-path").remove();var r=t._donutCount,l=o.selectAll(".grid-arc-path").data(d3.range(r));l.exit().remove(),l.enter().append("path").attr("class",po).merge(l).attr("d",(function(t,o){return e(a/r*(o+1),i,n)}))}(),function(){if(!t._showY)return void o.selectAll(".grid-line").remove();var e=t._sectorCount||1,r=(n-i)/e,l=o.selectAll(".grid-line").data(d3.range(e+1));l.exit().remove(),l.enter().append("line").attr("class",yo).merge(l).attr("x1",0).attr("y1",0).attr("x2",(function(t,e){var n=i+r*e;return Math.cos(n-Math.PI/2)*a})).attr("y2",(function(t,e){var n=i+r*e;return Math.sin(n-Math.PI/2)*a}))}()}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=parseFloat(t),this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}}]),i}(pt),go=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","polar-bubble-chart"),i.grid=new xo(i.mainGroup),i.polarBubble=new fo(i.mainGroup),i._sortValue=null,i._donutCount=5,i._fillOpacity=.9,i._endPointRadius=3.5,i._borderWidth=2,i._labelShow=!1,i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._bubbleSizeType="area",i._bubbleBorderColor="",i._bubbleBorderWidth=0,i._minRadius=0,i._maxRadius=20,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同步出现","顺时针出现","径向出现"],i._moveStyle="同步出现",i._endPause=0,i._interrupt=!1,i._startAngle=0,i._endAngle=2*Math.PI,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;t._interrupt?t.group.selectAll(".polar-grid").interrupt().style("opacity",1):t.group.selectAll(".polar-grid").interrupt().style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var e=t.activeData,i=t.polarBubble,n=t.grid,a=t.tooltip,o=(t._fontSize,t.widthOfNoMargin),r=t.heightOfMainGroup,l=0,s=void 0,u=void 0,h=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"";if("水平"==t._xLabelDirection&&1==t._xTickShow?(s=d3.max(h.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),u=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(s=d3.max(h.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),u=d3.max(h.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(s=t._fontSize,u=t._fontSize):(s=0,u=0),s=s<.4*o*.88?s:.4*o*.88,u=u<.4*r*.88?u:.4*r*.88,l="外部"==t._axisPositonChoice?Math.min(.88*o/2-s,.88*r/2-u):.88*Math.min(o,r)/2,"clockwise"==t._rotateDirection?(t._startAngle=t._startAngle,t._endAngle=t._startAngle+t._totalAngle):(t._startAngle=t._startAngle,t._endAngle=t._startAngle-t._totalAngle),t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var d=x(t._bubbleBorderColor),_=[],f=!0,p=!1,g=void 0;try{for(var v,m=d[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var b=v.value,S=[],k=b.split(":");S.push(q(k[0])),S.push(k[1]),_.push(S)}}catch(t){p=!0,g=t}finally{try{!f&&m.return&&m.return()}finally{if(p)throw g}}var w=_.concat(),C=w.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(C[1]).x1+"%").attr("y1",y(C[1]).y1+"%").attr("x2",y(C[1]).x2+"%").attr("y2",y(C[1]).y2+"%").selectAll("stop").data(w).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(e).radius(l).deadData(t.sortedDataCopy).labelShow(t._labelShow).donutCount(t._donutCount).sectorCount(e[0]?Math.abs(t._endAngle-t._startAngle)==2*Math.PI?e[0].data.length:e[0].data.length-1:1).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).tickTextColor(t._fontColor).translate(o/2,r/2).defs(t.defs).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).bubbleSizeType(t._bubbleSizeType).bubbleBorderColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).bubbleBorderWidth(t._bubbleBorderWidth).minRadius(t._minRadius).maxRadius(t._maxRadius).fillOpacity(t._fillOpacity).startAngle(t._startAngle).endAngle(t._endAngle).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(o).mainHeight(r).fontSize(t._numberLabel.fontSize).fontColor(q(t._numberLabel.color)).fontFamily(t._numberLabel.fontFamily).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){var n=[{text:""+(-1!=String(e.subName).indexOf("$-")?"":e.subName),color:e.color},{text:(-1!=String(e.name).indexOf("&-")?"":e.name)+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];a.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){a.hide()})),"clockwise"==t._rotateDirection?(t._startAngleGrid=t._startAngle,t._endAngleGrid=t._startAngle+t._totalAngle):(t._startAngleGrid=t._startAngle-t._totalAngle,t._endAngleGrid=t._startAngle),i.update(),n.radius(l).donutCount(t._isPolar?i._polarCount:5).sectorCount(e[0]?Math.abs(t._endAngle-t._startAngle)==2*Math.PI?e[0].data.length:e[0].data.length-1:1).startAngle(t._startAngleGrid).endAngle(t._endAngleGrid).translate(o/2,r/2).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth),n.update();var O=t.mainGroup.selectAll(".grid-arc-path").nodes();t._xAxisShow&&0!=t._xAxisLineWidth&&d3.select(O[O.length-1]).remove()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(0!=a.labelShow&&!a.labelShow||a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"水平").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range||[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:""),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._bubbleSizeType=e.bubbleSizeType?e.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._bubbleBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._bubbleBorderWidth,this._minRadius=0==e.minRadius||e.minRadius?e.minRadius:this._minRadius,this._maxRadius=0==e.maxRadius||e.maxRadius?e.maxRadius:this._maxRadius,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(i.display||0==i.display?(this._labelShow=i.display||0==i.display?i.display:this._labelShow,this._numberLabel=i.textLabel?i.textLabel:this._numberLabel,this._suffix=""):(this._labelShow=i.numberLabel?i.numberLabel.show:this._labelShow,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""))}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}}]),e}(vt),vo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","punch-bubble"),i._xScale=null,i._yScale=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t._xScale,a=t._yScale,o=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),r=d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))})),l=d3.scaleSqrt().domain([o,r]).range([t._minRadius,t._maxRadius]);"diameter"==t._bubbleSizeType&&(l=d3.scaleLinear().domain([o,r]).range([t._minRadius,t._maxRadius]));var s=t.group;s.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var u=s.append("g").selectAll("g").data(e,(function(t){return t.name}));u.exit().remove(),u.enter().append("g").merge(u).each((function(i,o){var r=d3.select(this).selectAll("circle").data(i.data);r.exit().remove();var s=r.enter().append("circle").attr("class","punch-bubbles").merge(r).style("fill",(function(e){return i.color&&/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+o)+")":i.color&&/#/.test(i.color)?i.color:"rgb("+U(i.color,0)+","+U(i.color,1)+","+U(i.color,2)+")"})).style("fill-opacity",(function(e){if(i.color&&/#/.test(i.color))return t._fillOpacity;var n=U(i.color,3)||1;return t._fillOpacity*n})).style("stroke",t._bubbleBorderColor||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+o)+")":i.color)).style("stroke-width",t._bubbleBorderWidth||0).attr("cx",(function(t,e){return n(t.name)+n.bandwidth()/2})).attr("cy",a(i.name)+a.bandwidth()/2),u=d3.select(this).selectAll("text").data(i.data);u.exit().remove();var h=u.enter().append("text").attr("class","bubble-text").merge(u).text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t,e){return n(t.name)+n.bandwidth()/2})).attr("y",a(i.name)+a.bandwidth()/2).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").attr("dy","0.4em").style("display",t._labelShow?"block":"none");t._interrupt?h.style("opacity",1):h.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay+t._duration:0})).style("opacity",1),1==t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?s.transition().duration(0).delay(0).attrTween("r",(function(t,e){e=d3.interpolate(0,l(t.value));return function(t){return e(t)}})):0==t._moveOptions.indexOf(t._moveStyle)?s.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attrTween("r",(function(t,e){e=d3.interpolate(0,l(t.value));return function(t){return e(t)}})):1==t._moveOptions.indexOf(t._moveStyle)?s.transition().duration(t._transition?t._duration/(i.data.length>0?i.data.length:1):0).delay((function(e,n){return t._transition?t._startDelay+t._duration/(i.data.length>0?i.data.length:1)*n:0})).attrTween("r",(function(t,e){e=d3.interpolate(0,l(t.value));return function(t){return e(t)}})):2==t._moveOptions.indexOf(t._moveStyle)&&s.transition().duration(t._transition?t._duration/(e.length>0?e.length:1):0).delay(t._transition?t._startDelay+t._duration/(e.length>0?e.length:1)*o:0).attrTween("r",(function(t,e){e=d3.interpolate(0,l(t.value));return function(t){return e(t)}})),s.on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout)}));for(var h=t.group.selectAll(".bubble-text"),d=[],_=[],f=0;f<h._groups[0].length;f++){_.push(f);for(var g=f+1;g<h._groups[0].length;g++){p(i(d3.select(h._groups[0][f])),i(d3.select(h._groups[0][g])))&&(d.push(f),d3.select(h._groups[0][f]).style("visibility","hidden"))}}for(var v=new Set(d),m=Array.from(v),b=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(m,_),S=0;S<m.length;S++){for(var k=[],w=0;w<b.length;w++){var C=i(d3.select(h._groups[0][m[S]])),O=i(d3.select(h._groups[0][b[w]]));if(k.push(p(C,O)),p(C,O)){if(m[S]==b[w])continue;d3.select(h._groups[0][m[S]]).style("visibility","hidden")}}0==k.filter((function(t){return 1==t})).length&&b.push(m[S])}for(var F=0;F<b.length;F++)d3.select(h._groups[0][b[F]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"bubbleSizeType",value:function(t){return arguments.length?(this._bubbleSizeType=t,this):this._bubbleSizeType}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"bubbleBorderWidth",value:function(t){return arguments.length?(this._bubbleBorderWidth=t,this):this._bubbleBorderWidth}},{key:"minRadius",value:function(t){return arguments.length?(this._minRadius=parseFloat(t),this):this._minRadius}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=parseFloat(t),this):this._maxRadius}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),mo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","punch-bubble-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.punchBubble=new vo(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleBand(),i._xType="category",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._curve=d3.curveCardinal,i._histogramWidth=.7,i._yScaleHeight=1.05,i._labelShow=!1,i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._bubbleSizeType="area",i._bubbleBorderColor="",i._bubbleBorderWidth=0,i._minRadius=0,i._maxRadius=20,i._fillOpacity=.9,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同步出现","横向出现","纵向出现"],i._moveStyle="同步出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.tooltip,a=t.punchBubble,r=t.xScale,l=t.yScale,s=(t.xAxis._axisStart,t.xAxis._axisEnd),u=0;s>t.widthOfNoMargin-t.yAxis.width&&(u=s-(t.widthOfNoMargin-t.yAxis.width));var h=t.widthOfCore-u,d=t.heightOfCore,_=t.defs;_.selectAll("filter").remove();var f=_.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");if(f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),f.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),f.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),f.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),f.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var p=x(t._bubbleBorderColor),g=[],v=!0,m=!1,b=void 0;try{for(var S,k=p[Symbol.iterator]();!(v=(S=k.next()).done);v=!0){var w=S.value,C=[],O=w.split(":");C.push(q(O[0])),C.push(O[1]),g.push(C)}}catch(t){m=!0,b=t}finally{try{!v&&k.return&&k.return()}finally{if(m)throw b}}var F=g.concat(),L=F.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(L[1]).x1+"%").attr("y1",y(L[1]).y1+"%").attr("x2",y(L[1]).x2+"%").attr("y2",y(L[1]).y2+"%").selectAll("stop").data(F).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(e).xScale(r).yScale(l).fontSize(t._numberLabel.fontSize).fontColor(q(t._numberLabel.color)).fontFamily(t._numberLabel.fontFamily).labelShow(t._labelShow).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).bubbleSizeType(t._bubbleSizeType).bubbleBorderColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).bubbleBorderWidth(t._bubbleBorderWidth).minRadius(t._minRadius).maxRadius(t._maxRadius).fillOpacity(t._fillOpacity).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){var a=[{text:""+(-1!=String(e.subName).indexOf("$-")?"":e.subName),color:e.color},{text:(-1!=String(e.name).indexOf("&-")?"":e.name)+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];n.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){n.hide()}));var P=t.xAxis.tickLocations.map((function(t){return t+r.bandwidth()/2})),A=t.yAxis.tickLocations.map((function(t){return t+l.bandwidth()/2}));i.width(h).height(d).planeX(r.range()[0]).xTickLocations(P).yTickLocations(A).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),i.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),i.translate(t.yAxis.width+.5,t.xAxis.height));var W=t.group.selectAll(".grouped-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));d3.selectAll(W).remove(),a.update(),i.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u);e.compute(),i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_,m=0;"上面"==t._axisPositonChoiceX?(g=e.height,m=e.height):g=(t._axisPositonChoiceX,h-e.height),e.translate(x,g).update(),i.translate(v,m).update()}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.display,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._bubbleSizeType=i.bubbleSizeType?i.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=i.bubbleBorderColor?q(i.bubbleBorderColor):"",this._bubbleBorderWidth=0==i.bubbleBorderWidth||i.bubbleBorderWidth?i.bubbleBorderWidth:this._bubbleBorderWidth,this._minRadius=0==i.minRadius||i.minRadius?i.minRadius:this._minRadius,this._maxRadius=0==i.maxRadius||i.maxRadius?i.maxRadius:this._maxRadius,this._fillOpacity=0==i.fillOpacity||i.fillOpacity?i.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(e.display||0==e.display?(this._labelShow=e.display||0==e.display?e.display:this._labelShow,this._numberLabel=e.textLabel?e.textLabel:this._numberLabel,this._suffix=""):(this._labelShow=e.numberLabel?e.numberLabel.show:this._labelShow,this._numberLabel=e.numberLabel?e.numberLabel:this._numberLabel,this._suffix=e.numberLabel&&e.numberLabel.suffix?e.numberLabel.suffix:""))}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=(t._yRange,e.length?e[0].data.map((function(t){return t.name})):[0,1]),n=e.length?e.map((function(t){return t.name})):[0,1];t._xDomain=i,t._yDomain=n}}]),e}(Tt),bo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-area-plot"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(0)})).y1((function(e){return t._yScale(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));n.curve(t._curve);var a=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScaleRight(0)})).y1((function(e){return t._yScaleRight(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));a.curve(t._curve);var o=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));o.curve(t._curve);var r=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScaleRight(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));r.curve(t._curve);var l=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScale(e.value)})).y1((function(e){return t._yScale(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));l.curve(t._curve);var s=t._areaFunc||d3.area().x((function(e){return t._xScale(e.name)})).y0((function(e){return t._yScaleRight(e.value)})).y1((function(e){return t._yScaleRight(0)})).defined((function(t){return!isNaN(parseFloat(t.value))}));s.curve(t._curve);var u=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));u.curve(t._curve);var h=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScaleRight(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));h.curve(t._curve);var d=i.selectAll("g").data(e);return d.exit().remove(),d.enter().append("g").attr("tip",(function(t){return"rainfall"==t.type?"left":"right"})).merge(d).each((function(e,i){var d=d3.select(this).append("path").style("fill",(function(n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})).attr("d",(function(t){return"rainfall"==t.type?n(e.data):a(e.data)})),_=d3.select(this).append("path").style("fill","none").style("stroke",/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color).style("stroke-width",t._lineWidth).style("stroke-opacity",1).style("stroke-dasharray",t._strokeDasharry).attr("d",(function(t){return"rainfall"==t.type?o(e.data):r(e.data)})),f=d3.select(this).selectAll("circle").data(e.data);f.exit().remove();var p=f.enter().append("circle").attr("class","stacked-scatter-circle").merge(f).style("fill",t._radiusFill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke",t._radiusStroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)).style("stroke-width",t._radiusWidth||0).attr("r",t._radius||0).attr("opacity",0).attr("cx",(function(e){return t._xScale(e.name)})).attr("cy",(function(i){return"rainfall"==e.type?t._yScale(i.value):t._yScaleRight(i.value)}));1==t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle)?(d.transition().duration(0).delay(0).attr("d",(function(t){return"rainfall"==t.type?l(e.data):s(e.data)})),_.transition().duration(0).delay(0).attr("d",(function(t){return"rainfall"==t.type?u(e.data):h(e.data)})),p.attr("opacity",1)):(d.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t){return"rainfall"==t.type?l(e.data):s(e.data)})),_.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t){return"rainfall"==t.type?u(e.data):h(e.data)})),p.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).attr("opacity",1))})),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"yScaleRight",value:function(t){return arguments.length?(this._yScaleRight=t,this):this._yScaleRight}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"radiusFill",value:function(t){return arguments.length?(this._radiusFill=t,this):this._radiusFill}},{key:"radiusStroke",value:function(t){return arguments.length?(this._radiusStroke=t,this):this._radiusStroke}},{key:"radiusWidth",value:function(t){return arguments.length?(this._radiusWidth=t,this):this._radiusWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at),So=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-scatter-plot"),i._transHeight=0,i._xScaleBottom="",i._transWidthTop=0,i._transWidthBottom=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data,n=t._xScale,a=t._xScaleBottom,o=t._yScale,r=t._yScaleRight;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-scatter-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var l=e.selectAll("g").data(i,(function(t){return t.name}));l.exit().remove(),l.enter().append("g").merge(l).each((function(e,i){var l=d3.select(this).selectAll("circle").data(e.data);l.exit().remove(),l.enter().append("circle").attr("class","stacked-scatter-circle").merge(l).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth||0).attr("r",t._radius||0).attr("cx",(function(i){return"rainfall"==e.type?n(i.name)+t._transWidthTop||0:(a?a(i.name)+t._transWidthBottom:n(i.name))||0})).attr("cy",(function(i){return("rainfall"==e.type?o(i.value):r(i.value)+t._transHeight)||0}))}));for(var s=e.selectAll(".stacked-scatter-circle").nodes(),u=0;u<s.length;u++)""==s[u].__data__.value||isNaN(s[u].__data__.value)?d3.select(s[u]).style("opacity","0"):d3.select(s[u]).style("opacity","1");return t}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"xScaleBottom",value:function(t){return arguments.length?(this._xScaleBottom=t,this):this._xScaleBottom}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"yScaleRight",value:function(t){return arguments.length?(this._yScaleRight=t,this):this._yScaleRight}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"transHeight",value:function(t){return arguments.length?(this._transHeight=t,this):this._transHeight}},{key:"transWidthTop",value:function(t){return arguments.length?(this._transWidthTop=t,this):this._transWidthTop}},{key:"transWidthBottom",value:function(t){return arguments.length?(this._transWidthBottom=t,this):this._transWidthBottom}}]),e}(at),ko=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-area-text"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a=t._xScale,o=t._yScale,r=t._yScaleRight;n.selectAll("*").remove();var l=n.selectAll("g").data(e);l.exit().remove(),l.enter().append("g").attr("tip",(function(t){return"rainfall"==t.type?"left":"right"})).merge(l).each((function(i,n){var l=d3.select(this).selectAll("text").data(i.data);l.exit().remove();var s=l.enter().append("text").attr("class","rainfall-area-text").merge(l).text((function(e){return isNaN(parseFloat(e.value))||0==parseFloat(e.value)?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(t){return a(t.name)||0})).attr("y",(function(t){return"rainfall"==i.type?o(t.value)||0:r(t.value)||0})).attr("dy",(function(n,a){if(e.length>1){if(null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice))return 0;if(0==t._positionOptions.indexOf(t._positionChoice))return"rainfall"==i.type?n.value<0?-5:.9*t._fontSize+5:n.value>0?-5:.9*t._fontSize+5;if(1==t._positionOptions.indexOf(t._positionChoice))return-5;if(2==t._positionOptions.indexOf(t._positionChoice))return.9*t._fontSize+5}})).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?s.style("opacity",1):s.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+t._duration:0).style("opacity",1)}));for(var s=t.group.selectAll(".rainfall-area-text"),u=[],c=[],h=0;h<s._groups[0].length;h++){c.push(h);for(var d=h+1;d<s._groups[0].length;d++){p(i(d3.select(s._groups[0][h])),i(d3.select(s._groups[0][d])))&&(u.push(h),d3.select(s._groups[0][h]).style("visibility","hidden"))}}for(var _=new Set(u),f=Array.from(_),y=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(f,c),x=0;x<f.length;x++){for(var g=[],v=0;v<y.length;v++){var m=i(d3.select(s._groups[0][f[x]])),b=i(d3.select(s._groups[0][y[v]]));if(g.push(p(m,b)),p(m,b)){if(f[x]==y[v])continue;d3.select(s._groups[0][f[x]]).style("visibility","hidden")}}0==g.filter((function(t){return 1==t})).length&&y.push(f[x])}for(var S=0;S<y.length;S++)d3.select(s._groups[0][y[S]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"yScaleRight",value:function(t){return arguments.length?(this._yScaleRight=t,this):this._yScaleRight}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),wo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-area-chart"),i.grid=new Jt(i.coreGroup),i.areaPlot=new bo(i.coreGroup),i.clipArea=new Ut(i.defs),i.rainfallVolumeAreaText=new ko(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new So(i.coreGroup),i.overlay=new te(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new ea(i.mainGroup),i.yAxisDoubleY=new ea(i.mainGroup),i.xAxis.minTickDistance(5),i.xScale=d3.scalePoint().padding(.2),i.yScale=d3.scaleLinear(),i.yScaleRight=d3.scaleLinear(),i.axisTooltip=new oa(i.mainGroup),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._yOrientRight="right",i._sortValue=0,i._histogramWidth=.7,i._yScaleHeight=1.05,i._curve=d3.curveCardinal,i._lineWidth=2,i._strokeWidth=0,i._strokeColor="#FFFFFF",i._fillColor=null,i._endPointRadius=0,i._fillOpacity=.7,i._labelShow=!1,i._positionOptions=["外部","居上","居下"],i._positionChoice="外部",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["横向展开","起波澜"],i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.yAxisDoubleY,a=t.xScale,o=t.yScale,r=t.yScaleRight,l=t._xType,s=t._yType,u=t._xOrient,c=t._yOrient,h=t._yOrientRight,d=t._fontSize,_=t.widthOfNoMargin,f=t.heightOfMainGroup;a.domain(t._xDomain),o.domain(t._yDomain),r.domain(t._yDomain1),e.scaleFunc(a).allowedMaxTextHeight(.5*f).type(l).orient(u).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(o).allowedMaxTextWidth(.5*_).type(s).orient(c).title(t._yLeftName).tickShow(t._yTickShowLeft).lineStroke(t._axisLineStrokeYL).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange(t._yRange).yAxisLineWidth(t._yAxisLineWidthLeft).axisLineShow(t._yAxisShowLeft).labelDirection(t._yLabelDirectionLeft).labelAngle(t._yLabelAngleLeft).countOfLabel(t._yCountOfLabelLeft).labelSuffix(t._yLabelSuffixLeft).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),n.scaleFunc(r).allowedMaxTextWidth(.5*_).type(s).orient(h).title(t._yRightName).times("second").tickShow(t._yTickShowRight).lineStroke(t._axisLineStrokeYR).fontSize(d).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange(t._yRightRange).yAxisLineWidth(t._yAxisLineWidthRight).axisLineShow(t._yAxisShowRight).labelDirection(t._yLabelDirectionRight).labelAngle(t._yLabelAngleRight).countOfLabel(t._yCountOfLabelRight).labelSuffix(t._yLabelSuffixRight).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var p=(f-e.allowedMaxTextHeight())/(3*d);i.tickCount(p),n.tickCount(p),i.compute(),n.compute();var y=t.activeData,x=i.width,g=n.width;0==y.length&&(x=t.yAxis.width,g=t.yAxisDoubleY.width);var v=0,m=_-x-g;a.range([v,m]),e.compute();var b=e._axisStart,S=e._axisEnd;b<0&&(v=Math.abs(b)>x?Math.abs(b)-x:0),S>m+g&&(m-=S-m-g),t._xAxisEnd=m,a.range([v,m]),o.range([0,f-e.height]),r.range([f-e.height,0]);var k=x,w=f-e.height,C=x+v;e.translate(k,w),i.translate(C,0);var O=m+x;n.translate(O,0),0==y.length&&(e.translate(k,w),i.translate(C,0),n.translate(O,0)),e.update(),i.update(),n.update()}},{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.tooltip,a=(t.axisTooltip,t.areaPlot),o=t.overlay,r=(t.scatterPlot,t.guideScatter),l=t.guideLine,s=t.rainfallVolumeAreaText,u=(t.clipArea,t.xScale),h=t.yScale,d=t.yScaleRight;1.2*Math.min(d3.min(e.filter((function(t){return"volume"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0)<0?t.group.selectAll(".rainfall-volume-area-chart .axis-x-line path").attr("transform","translate(0, "+-(d.range()[0]-d(0))+")"):t.group.selectAll(".rainfall-volume-area-chart .axis-x-line path").attr("transform","translate(0,0)");var _=t.yAxis.width,f=t.yAxisDoubleY.width;0==e.length&&(_=t.yAxis.width,f=t.yAxisDoubleY.width);t.xAxis._axisStart;var p=t.xAxis._axisEnd,g=0;p>t.widthOfNoMargin-_&&(g=p-(t.widthOfNoMargin-_));var v=t.widthOfNoMargin-_-f-g,m=t.heightOfCore,b=t.defs;b.selectAll("filter").remove();var S=b.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_line").attr("filterUnits","objectBoundingBox");if(S.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),S.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),S.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),S.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),S.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),i.width(v).height(m).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),0==e.filter((function(t){return"rainfall"==t.type})).length&&i.width(v).height(m).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxisDoubleY.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var k=x(t._strokeColor),w=[],C=!0,O=!1,F=void 0;try{for(var L,P=k[Symbol.iterator]();!(C=(L=P.next()).done);C=!0){var A=L.value,W=[],z=A.split(":");W.push(q(z[0])),W.push(z[1]),w.push(W)}}catch(t){O=!0,F=t}finally{try{!C&&P.return&&P.return()}finally{if(O)throw F}}var M=w.concat(),D=M.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(D[1]).x1+"%").attr("y1",y(D[1]).y1+"%").attr("x2",y(D[1]).x2+"%").attr("y2",y(D[1]).y2+"%").selectAll("stop").data(M).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var R=x(t._fillColor),N=[],T=!0,B=!1,G=void 0;try{for(var X,j=R[Symbol.iterator]();!(T=(X=j.next()).done);T=!0){var I=X.value,Y=[],H=I.split(":");Y.push(q(H[0])),Y.push(H[1]),N.push(Y)}}catch(t){B=!0,G=t}finally{try{!T&&j.return&&j.return()}finally{if(B)throw G}}var V=N.concat(),$=V.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y($[1]).x1+"%").attr("y1",y($[1]).y1+"%").attr("x2",y($[1]).x2+"%").attr("y2",y($[1]).y2+"%").selectAll("stop").data(V).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}r.data(e).xScale(u).yScale(h).yScaleRight(d).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),l.y1(0).y2(m).stroke("#c6c6c6").strokeDasharray("0 0"),o.data(u.domain()).isScalePoint(!0).bandWidth(u.step()).bandHeight(m).bandX(u.range()[0]).onMouseover((function(i,a){var o=i,s=[{text:o=="&-"+(a+1)?"":o}],c=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));c.push({key:e.key,name:e.name,color:e.color,data:n,type:e.type}),s.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),n.data(s).update(),l.x(u(o)).update().show(),r.data(c).update(),n.move([d3.event.offsetX,d3.event.offsetY]).show(),l.show(),r.show()})).onMousemove((function(){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){n.hide(),l.hide(),r.hide()})),a.data(e).xScale(u).yScale(h).yScaleRight(d).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).curve(t._curve).fillOpacity(t._fillOpacity).lineWidth(t._lineWidth).radius(t._endPointRadius).radiusFill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).radiusStroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).radiusWidth(t._strokeWidth),s.data(e).xScale(u).yScale(h).suffix(t._suffix).yScaleRight(d).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.attr("transform","translate("+_+",0)");var U=t.group.selectAll(".rainfall-volume-area-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));(d3.selectAll(U).remove(),a.update(),o.update(),i.update(),s.update(),1==t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle))?(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("x",-t._endPointRadius+u.range()[0]).attr("y",-t._endPointRadius).attr("height",t._height+2*t._endPointRadius).attr("width",v-u.range()[0]+2*t._endPointRadius),t.coreGroup.select(".rainfall-volume-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("x",-t._endPointRadius+u.range()[0]).attr("y",-t._endPointRadius).attr("width",0).attr("height",t._height+2*t._endPointRadius).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",v-u.range()[0]+2*t._endPointRadius),t.coreGroup.select(".rainfall-volume-area-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"));(t.coreGroup.selectAll(".fake-x-line").remove(),t.coreGroup.append("g").attr("class","fake-x-line").append("line").attr("x1",u.range()[0]).attr("y1",h.range()[0]).attr("x2",u.range()[1]).attr("y2",h.range()[0]).attr("stroke",t._axisLineStrokeX),0!=t._yRange.length)&&(t.mainGroup.selectAll(".range-left-defs").remove(),t.mainGroup.append("defs").attr("class","range-left-defs").append("clipPath").attr("id","range-left-overlay-"+t.id).append("rect").attr("y",0).attr("x",u.range()[0]).attr("height",m).attr("width",v-u.range()[0]),0==isNaN(parseFloat(t._yRange[0]))||0==isNaN(parseFloat(t._yRange[1]))?(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-plot g").nodes().filter((function(t){return"left"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#range-left-overlay-"+t.id)+")"),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-text g").nodes().filter((function(t){return"left"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#range-left-overlay-"+t.id)+")")):(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-plot g").nodes().filter((function(t){return"left"==d3.select(t).attr("tip")}))).attr("clip-path",""),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-text g").nodes().filter((function(t){return"left"==d3.select(t).attr("tip")}))).attr("clip-path","")));0!=t._yRightRange.length&&(t.mainGroup.selectAll(".range-defs").remove(),t.mainGroup.append("defs").attr("class","range-defs").append("clipPath").attr("id","range-overlay-"+t.id).append("rect").attr("y",0).attr("x",u.range()[0]).attr("height",m).attr("width",v-u.range()[0]),0==isNaN(parseFloat(t._yRightRange[0]))||0==isNaN(parseFloat(t._yRightRange[1]))?(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-plot g").nodes().filter((function(t){return"right"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#range-overlay-"+t.id)+")"),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-text g").nodes().filter((function(t){return"right"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#range-overlay-"+t.id)+")")):(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-plot g").nodes().filter((function(t){return"right"==d3.select(t).attr("tip")}))).attr("clip-path",""),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-area-text g").nodes().filter((function(t){return"right"==d3.select(t).attr("tip")}))).attr("clip-path","")))}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=(i.y,i.y1,t.axisCopy),o=a.yl||{},r=a.yr||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeYL(q(o.axisColor)||q(i.color)).axisLineStrokeYR(q(r.axisColor)||q(i.color)).xTitle(n.name).xTickShow(n.labelShow).yTickShowLeft(o.labelShow).yTickShowRight(r.labelShow).xRange(n.range?n.range:[]).yRange(o.range?o.range:[]).yRightRange(r.range?r.range:[]).yLeftName(o.name).yLeftTitle(o.labelSuffix).yRightName(r.name).yRightTitle(r.labelSuffix).xAxisLineWidth(n.axisLineWidth).yAxisLineWidthLeft(o.axisLineWidth).yAxisLineWidthRight(r.axisLineWidth).xAxisShow(n.axisShow).yAxisShowLeft(o.axisShow).yAxisShowRight(r.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirectionLeft(o.labelDirection?o.labelDirection:"自动").yLabelAngleLeft(0==o.labelAngle||o.labelAngle?o.labelAngle:0).yCountOfLabelLeft(0==o.stepOfLabel||o.stepOfLabel?o.stepOfLabel:null).yLabelSuffixLeft(o.labelSuffix?o.labelSuffix:"").yLabelDirectionRight(r.labelDirection?r.labelDirection:"自动").yLabelAngleRight(0==r.labelAngle||r.labelAngle?r.labelAngle:0).yCountOfLabelRight(0==r.stepOfLabel||r.stepOfLabel?r.stepOfLabel:null).yLabelSuffixRight(r.labelSuffix?r.labelSuffix:"")}},{key:"yLabelDirectionLeft",value:function(t){return arguments.length?(this._yLabelDirectionLeft=t,this):this._yLabelDirectionLeft}},{key:"yLabelAngleLeft",value:function(t){return arguments.length?(this._yLabelAngleLeft=parseFloat(t),this):this._yLabelAngleLeft}},{key:"yCountOfLabelLeft",value:function(t){return arguments.length?(this._yCountOfLabelLeft=parseFloat(t),this):this._yCountOfLabelLeft}},{key:"yLabelSuffixLeft",value:function(t){return arguments.length?(this._yLabelSuffixLeft=t,this):this._yLabelSuffixLeft}},{key:"yLabelDirectionRight",value:function(t){return arguments.length?(this._yLabelDirectionRight=t,this):this._yLabelDirectionRight}},{key:"yLabelAngleRight",value:function(t){return arguments.length?(this._yLabelAngleRight=parseFloat(t),this):this._yLabelAngleRight}},{key:"yCountOfLabelRight",value:function(t){return arguments.length?(this._yCountOfLabelRight=parseFloat(t),this):this._yCountOfLabelRight}},{key:"yLabelSuffixRight",value:function(t){return arguments.length?(this._yLabelSuffixRight=t,this):this._yLabelSuffixRight}},{key:"yAxisShowLeft",value:function(t){return arguments.length?(this._yAxisShowLeft=t,this):this._yAxisShowLeft}},{key:"yAxisShowRight",value:function(t){return arguments.length?(this._yAxisShowRight=t,this):this._yAxisShowRight}},{key:"yAxisLineWidthLeft",value:function(t){return arguments.length?(this._yAxisLineWidthLeft=t,this):this._yAxisLineWidthLeft}},{key:"yAxisLineWidthRight",value:function(t){return arguments.length?(this._yAxisLineWidthRight=t,this):this._yAxisLineWidthRight}},{key:"yRightRange",value:function(t){return arguments.length?(this._yRightRange=t,this):this._yRightRange}},{key:"yTickShowRight",value:function(t){return arguments.length?(this._yTickShowRight=t,this):this._yTickShowRight}},{key:"yTickShowLeft",value:function(t){return arguments.length?(this._yTickShowLeft=t,this):this._yTickShowLeft}},{key:"axisLineStrokeYL",value:function(t){return arguments.length?(this._axisLineStrokeYL=t,this):this._axisLineStrokeYL}},{key:"axisLineStrokeYR",value:function(t){return arguments.length?(this._axisLineStrokeYR=t,this):this._axisLineStrokeYR}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=(t.axisCopy,{straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal});0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveCardinal,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=t._yRightRange||[],a=e.length?e[0].data.map((function(t){return t.name})):[0,1],o=e.length&&e.filter((function(t){return"rainfall"==t.type})).length>0?[1.2*Math.min(d3.min(e.filter((function(t){return"rainfall"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*Math.max(d3.max(e.filter((function(t){return"rainfall"==t.type})),(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,0],r=e.length&&e.filter((function(t){return"volume"==t.type})).length>0?[1.2*Math.min(d3.min(e.filter((function(t){return"volume"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*Math.max(d3.max(e.filter((function(t){return"volume"==t.type})),(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,0];t._xDomain=a,t._yDomain=isNaN(o[0])&&isNaN(o[1])?o:[isNaN(parseFloat(i[0]))?o[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?o[1]:o[1]<i[0]?1.5*i[0]:o[1]:parseFloat(i[1])],t._yDomain1=isNaN(r[0])&&isNaN(r[1])?r:[isNaN(parseFloat(n[0]))?r[0]:parseFloat(n[0]),isNaN(parseFloat(n[1]))?isNaN(parseFloat(n[0]))?r[1]:r[1]<n[0]?1.5*n[0]:r[1]:parseFloat(n[1])]}}]),e}(Tt),Co="axis-group",Oo="x-title",Fo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-x-rainfall-line"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=void 0;(s=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(.5).tickPadding(t._tickPadding).tickFormat(t._tickFormat);var u=n.select(".axis-group").empty()?n.append("g").attr("class",Co):n.select(".axis-group"),c=t._labelAngle;"自动"==t._labelDirection&&(c=r),u.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).call(s).on("start",(function(i,n){u.selectAll(".tick text").remove(),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),"竖排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i,n){var a=B(l[n],t._fontSize,t._fontFamily)-t._fontSize,o=I(t._fontSize,c,0,t._labelDirection,e),r=Math.sin(Math.abs(o.angle)*Math.PI/180)*a,s=Math.cos(Math.abs(o.angle)*Math.PI/180)*a;return"top"==e?"translate("+(o.x+(o.angle<0?-r+(-90==o.angle?a/2:0):r-(90==o.angle?a/2:0)))+","+(o.y-s)+")":"translate("+(o.x+(o.angle<0?-(-90==o.angle?a/2:0):90==o.angle?a/2:0))+","+o.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).each((function(i,n){var o=d3.select(this),r=o.text().split("").reverse();"rev"==I(t._fontSize,c,0,t._labelDirection,e).flag&&(r=o.text().split(""));for(var l,s=[],u=0,h=0,d=+o.attr("x"),_=+o.attr("y"),f=o.text(null).append("tspan").attr("x",d).attr("y",_);l=r.pop();)s.push(l),f.text(s.join("")),f.node().getComputedTextLength()>0&&(0==h||++u,s.pop(),f.text(s.join("")),s=[l],f=o.append("tspan").attr("x",d).attr("y",u*parseFloat(.9*a*1.2)+_).text(l)),h++})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity","top"===e?0:1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"横排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,t._labelDirection,e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity","top"===e?0:1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"自动"==t._labelDirection&&u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,"横排",e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).style("text-anchor",(function(i){return I(t._fontSize,c,0,"横排",e).anchor})).attr("opacity","top"===e?0:1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,"横排",e).angle+")"}))}));var h=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)})),d=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove(),d3.selectAll(d).remove();var _=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var f=n.select(".x-title").empty()?n.append("g").attr("class",Oo):n.select(".x-title"),p=f.select("text").empty()?f.append("text"):f.select("text");l.length,d3.max(l,(function(e){return R(e,a,t._fontFamily)}));"top"===e?(f.call(o,_/2+Math.abs(i.range()[0]),-(this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0))),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",-6-.2*a).text(t._title)):(f.call(o,_/2+Math.abs(i.range()[0]),this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",a+6).text(t._title))}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0,o=0,r=0,l=!1,s=t._scaleFunc.range()[0],u=t._scaleFunc.range()[1];function c(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a,t._tickTextWidth=o,t._rotateFlag=l,t._axisStart=s,t._axisEnd=u}var h,d=t._scaleFunc,_=t._type,f=t._fontSize,p=(t._minTickDistance,t._allowedMaxTextHeight);if("自动"==t._labelDirection){var y=Math.abs(d.range()[0]-d.range()[1]),x=void 0,g=void 0;if(e="category"===_?d.domain():d.ticks(t._tickCount),"number"===_&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&e.push(t._xRange[0]),h=!1,x=y/e.length,(g=d3.max(e.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,f,t._fontFamily)}))||0)<.8*x&&(n=0,a=0==g?0:1.125*f,o=R((i=e)[0],f,t._fontFamily)/2||0,t._tickShow||(o=0),c(),h=!0),h)return t;n=0;1*g<p?(a=0==g?0:1.125*f,o=1*R((i=e)[0],f,t._fontFamily)/2||0,r=1*R(i[0],f,t._fontFamily)/2||0,t._tickShow||(o=0),l=!1):(a=0==g?0:1.125*f,o=1*R((i=e)[0],f,t._fontFamily)/2||0,r=1*R(i[0],f,t._fontFamily)/2||0,t._tickShow||(o=0));var v=(y-r)/e.length;if("category"===_&&1.1*g>v){var m=Math.ceil(1.1*g/v);e=e.filter((function(t,e){return e%m==0})),i=i.filter((function(t,e){return e%m==0})),d(e[e.length-1])+g/2>d.range()[1]+15&&e.pop()}return s=t._tickShow&&e.length>0?d(e[0])-o:s,c(),t}if("横排"==t._labelDirection){var b=Math.abs(d.range()[0]-d.range()[1]);e="category"===_?d.domain():d.ticks(t._tickCount),"number"===_&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var S=[];if("number"===_&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var k=d.domain()[0],w=(Math.abs(parseFloat(k))>1?Math.round(parseFloat(k)):k)||0,C=d.domain()[1]||1;if(0!=t._countOfLabel){var O=C-w,F=t._countOfLabel,L=Math.ceil(Math.abs(O/t._countOfLabel)),P=Math.ceil(b/f*2),A=d3.tickStep(w,C,P);t._countOfLabel<A&&(L=Math.ceil(Math.abs(O/A)),F=A),C+=L;for(var W=0;W<L+1;W++)S.push(w+W*F)}else S.push(w);"number"===_&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||S.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||S.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(S[S.length-1]>t._xRange[1]&&S.pop(),S.push(t._xRange[1]))),S=Array.from(new Set(S))),0!=t._countOfLabel&&d.domain([d3.min(S),d3.max(S)]);var z=[];S.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;z.push(i)}})),z=z.filter((function(t){return t<=8})),S=S.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(z)&&(t=parseFloat(t).toFixed(d3.max(z)))}return t}))}if(i=e,"number"===_&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=S),"number"==_){for(var M=[],D=0;D<e.length;D++)M.push(E(e[D],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=M}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var N=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,f,t._fontFamily)}))||0,T=N?f:0,G=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,j=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),Y=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),H=N*Y+T*j,V=T*Y+N*j;if(V<p)a=V,i=i,o=H,r=H,t._tickShow||(o=0),l=!0;else{a=p,i=i.map((function(e){return X(e,a/j,f,t._fontFamily)}));var $=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,q=$*Y+T*j;o=q,r=q,a=T*Y+$*j,t._tickShow||(o=0),l=!0}G%180!=0&&90!=Math.abs(n)||(o/=2,r/=2);var U=(b-r)/e.length;if("category"===_&&r*(G%180==0||90==Math.abs(n)?2:1)>U){var Z=Math.ceil(r*(G%180==0||90==Math.abs(n)?2:1)*1.2/U);e=e.filter((function(t,e){return e%Z==0})),i=i.filter((function(t,e){return e%Z==0}))}if("top"==t._orient){var Q=1;(n>90||n<0&&n>-90)&&(Q=-1);var K=[],J=[];if(e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*Y+T*j,G%180!=0&&90!=Math.abs(n)||(o/=2),K.push(d(e)-o*Q),J.push(d(e)-o*Q)})),s=t._tickShow&&e.length>0?d3.min(K):s,u=t._tickShow&&e.length>0?d3.max(J):u,n%180==0||90==Math.abs(n)){var tt=[],et=[];e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*Y+T*j,G%180!=0&&90!=Math.abs(n)||(o/=2),tt.push(d(e)-o),et.push(d(e)+o)})),s=t._tickShow&&e.length>0?d3.min(tt):s,u=t._tickShow&&e.length>0?d3.max(et):u}}else{var it=-1;(n>90||n<0&&n>-90)&&(it=1);var nt=[],at=[];if(e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*Y+T*j,G%180!=0&&90!=Math.abs(n)||(o/=2),nt.push(d(e)-o*it),at.push(d(e)-o*it)})),s=t._tickShow&&e.length>0?d3.min(nt):s,u=t._tickShow&&e.length>0?d3.max(at):u,n%180==0||90==Math.abs(n)){var ot=[],rt=[];e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*Y+T*j,G%180!=0&&90!=Math.abs(n)||(o/=2),ot.push(d(e)-o),rt.push(d(e)+o)})),s=t._tickShow&&e.length>0?d3.min(ot):s,u=t._tickShow&&e.length>0?d3.max(rt):u}}return c(),t}if("竖排"==t._labelDirection){var lt,st=Math.abs(d.range()[0]-d.range()[1]);e="category"===_?d.domain():d.ticks(t._tickCount),"number"===_&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var ut=[];if("number"===_&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var ct=d.domain()[0],ht=(Math.abs(parseFloat(ct))>1?Math.round(parseFloat(ct)):ct)||0,dt=d.domain()[1]||1;if(0!=t._countOfLabel){var _t=dt-ht,ft=t._countOfLabel,pt=Math.ceil(Math.abs(_t/t._countOfLabel)),yt=Math.ceil(st/f*2),xt=d3.tickStep(ht,dt,yt);t._countOfLabel<xt&&(pt=Math.ceil(Math.abs(_t/xt)),ft=xt),dt+=pt;for(var gt=0;gt<pt+1;gt++)ut.push(ht+gt*ft)}else ut.push(ht);"number"===_&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||ut.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||ut.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(ut[ut.length-1]>t._xRange[1]&&ut.pop(),ut.push(t._xRange[1]))),ut=Array.from(new Set(ut))),0!=t._countOfLabel&&d.domain([d3.min(ut),d3.max(ut)]);var vt=[];ut.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;vt.push(i)}})),vt=vt.filter((function(t){return t<=8})),ut=ut.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(vt)&&(t=parseFloat(t).toFixed(d3.max(vt)))}return t}))}if(i=e,"number"===_&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=ut),"number"==_){for(var mt=[],bt=0;bt<e.length;bt++)mt.push(E(e[bt],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=mt}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var St=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,kt=St?f:0,wt=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,Ct=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),Ot=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),Ft=kt*Ot+St*Ct,Lt=St*Ot+kt*Ct;if(lt=Ft,Lt<p)a=Lt,i=i,o=Ft,r=Ft,t._tickShow||(o=0),l=!0;else{a=p,i=i.map((function(e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}(e,a/Ot,f,t._fontFamily)}));var Pt=d3.max(i,(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,At=kt*Ot+Pt*Ct;o=At,r=At,a=Pt*Ot+kt*Ct,t._tickShow||(o=0),l=!0}0==wt&&(o/=2,r/=2),90==Math.abs(wt)&&(a=0==lt?0:f,o/=2,r/=2);var Wt=(st-r)/e.length;if("category"===_&&r*(0==Math.abs(wt)||90==Math.abs(wt)?2:1)>Wt){var zt=Math.ceil(r*(0==Math.abs(wt)||90==Math.abs(wt)?2:1)*1.2/Wt);e=e.filter((function(t,e){return e%zt==0})),i=i.filter((function(t,e){return e%zt==0}))}if("top"==t._orient){var Mt=1;n>0&&n<90&&(Mt=-1);var Dt=[],Rt=[];if(e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=kt*Ot+o*Ct,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Dt.push(d(e)-o*Mt),Rt.push(d(e)-o*Mt)})),s=t._tickShow&&e.length>0?d3.min(Dt):s,u=t._tickShow&&e.length>0?d3.max(Rt):u,0==Math.abs(n)||90==Math.abs(n)){var Nt=[],Tt=[];e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=kt*Ot+o*Ct,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Nt.push(d(e)-o),Tt.push(d(e)+o)})),s=t._tickShow&&e.length>0?d3.min(Nt):s,u=t._tickShow&&e.length>0?d3.max(Tt):u}}else{var Bt=-1;n>0&&n<90&&(Bt=1);var Gt=[],Xt=[];if(e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=kt*Ot+o*Ct,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Gt.push(d(e)-o*Bt),Xt.push(d(e)-o*Bt)})),s=t._tickShow&&e.length>0?d3.min(Gt):s,u=t._tickShow&&e.length>0?d3.max(Xt):u,0==Math.abs(n)||90==Math.abs(n)){var jt=[],It=[];e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=kt*Ot+o*Ct,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),jt.push(d(e)-o),It.push(d(e)+o)})),s=t._tickShow&&e.length>0?d3.min(jt):s,u=t._tickShow&&e.length>0?d3.max(It):u}}return c(),t}}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"height",get:function(){var t=this,e=this._scaleFunc,i=(Math.abs(e.range()[0]-e.range()[1]),this._tickValueTexts.length,d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),0);return this.isShow&&(i=this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.325*this._fontSize:0)),i}}]),e}(Bt),Lo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-line-plot"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i._transHeight=0,i._transWidthTop=0,i._transWidthBottom=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove(),t._interrupt?i.style("opacity",1):i.style("opacity",0).transition().duration(0).delay(t._transition?t._startDelay:0).style("opacity",1);var n=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)+t._transWidthTop})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));n.curve(t._curve);var a=t._lineFunc||d3.line().x((function(e){return t._xScaleBottom(e.name)+t._transWidthBottom})).y((function(e){return t._yScaleRight(e.value)+t._transHeight})).defined((function(t){return!isNaN(parseFloat(t.value))}));a.curve(t._curve),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-line-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var o=i.selectAll("g").data(e);o.exit().remove(),o.enter().append("g").attr("tip",(function(t){return"rainfall"==t.type?"top":"bottom"})).merge(o).each((function(e,i){var o=d3.select(this).append("path").style("fill","none").style("stroke",/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color).style("stroke-width",t._lineWidth).style("stroke-opacity",1).style("stroke-dasharray","").attr("d",(function(t){return"rainfall"==t.type?n(e.data):a(e.data)}));1==t._interrupt||null==t._moveStyle||0==t._transition?o.attr("stroke-dasharray",""):o.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attrTween("stroke-dasharray",(function(){var t=this.getTotalLength(),e=d3.interpolateString("0,"+t,t+","+t);return function(t){return e(t)}}))}));var r=i.append("g").selectAll("g").data(e,(function(t){return t.name}));r.exit().remove(),r.enter().append("g").attr("tip",(function(t){return"rainfall"==t.type?"top":"bottom"})).merge(r).each((function(e,i){var n=d3.select(this).selectAll("circle").data(e.data);n.exit().remove();var a=n.enter().append("circle").attr("class","rainfall-circle").merge(n).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-line-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth||0).attr("r",0).attr("cx",(function(i){return"rainfall"==e.type?t._xScale(i.name)+t._transWidthTop||0:(t._xScaleBottom?t._xScaleBottom(i.name)+t._transWidthBottom:t._xScale(i.name))||0})).attr("cy",(function(i){return("rainfall"==e.type?t._yScale(i.value):t._yScaleRight(i.value)+t._transHeight)||0}));1==t._interrupt||null==t._moveStyle||0==t._transition?a.attr("r",t._radius||0):a.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("r",t._radius||0)}));for(var l=i.selectAll(".rainfall-circle").nodes(),s=0;s<l.length;s++)""==l[s].__data__.value||isNaN(l[s].__data__.value)?d3.select(l[s]).style("opacity","0"):d3.select(l[s]).style("opacity","1");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"xScaleBottom",value:function(t){return arguments.length?(this._xScaleBottom=t,this):this._xScaleBottom}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"yScaleRight",value:function(t){return arguments.length?(this._yScaleRight=t,this):this._yScaleRight}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transHeight",value:function(t){return arguments.length?(this._transHeight=t,this):this._transHeight}},{key:"transWidthTop",value:function(t){return arguments.length?(this._transWidthTop=t,this):this._transWidthTop}},{key:"transWidthBottom",value:function(t){return arguments.length?(this._transWidthBottom=t,this):this._transWidthBottom}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}}]),e}(at),Po=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-line-text"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._curve=d3.curveLinear,i._fillOpacity=.7,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a=t._xScale,o=t._yScale,r=t._yScaleRight;n.selectAll("*").remove();var l=n.selectAll("g").data(e);l.exit().remove(),l.enter().append("g").attr("tip",(function(t){return"rainfall"==t.type?"top":"bottom"})).merge(l).each((function(i,n){var l=d3.select(this).selectAll("text").data(i.data);l.exit().remove();var s=l.enter().append("text").attr("class","rainfall-line-text").merge(l).text((function(e){return isNaN(parseFloat(e.value))||0==parseFloat(e.value)?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(e){return t._transWidthTop+a(e.name)||0})).attr("y",(function(e){return"rainfall"==i.type?o(e.value)||0:r(e.value)+t._transHeight||0})).attr("dy",(function(n,a){if(e.length>1){if(null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice))return 0;if(0==t._positionOptions.indexOf(t._positionChoice))return"rainfall"==i.type?-5:.9*t._fontSize+5;if(1==t._positionOptions.indexOf(t._positionChoice))return-5;if(2==t._positionOptions.indexOf(t._positionChoice))return.9*t._fontSize+5}})).attr("text-anchor","middle").style("display",t._labelShow?"block":"none");t._interrupt?s.style("opacity",1):s.style("opacity",0).interrupt().transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+t._duration:0).style("opacity",1)}));for(var s=t.group.selectAll(".rainfall-line-text"),u=[],c=[],h=0;h<s._groups[0].length;h++){c.push(h);for(var d=h+1;d<s._groups[0].length;d++){p(i(d3.select(s._groups[0][h])),i(d3.select(s._groups[0][d])))&&(u.push(h),d3.select(s._groups[0][h]).style("visibility","hidden"))}}for(var _=new Set(u),f=Array.from(_),y=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(f,c),x=0;x<f.length;x++){for(var g=[],v=0;v<y.length;v++){var m=i(d3.select(s._groups[0][f[x]])),b=i(d3.select(s._groups[0][y[v]]));if(g.push(p(m,b)),p(m,b)){if(f[x]==y[v])continue;d3.select(s._groups[0][f[x]]).style("visibility","hidden")}}0==g.filter((function(t){return 1==t})).length&&y.push(f[x])}for(var S=0;S<y.length;S++)d3.select(s._groups[0][y[S]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"yScaleRight",value:function(t){return arguments.length?(this._yScaleRight=t,this):this._yScaleRight}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"areaFunc",value:function(t){return arguments.length?(this._areaFunc=t,this):this._areaFunc}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transHeight",value:function(t){return arguments.length?(this._transHeight=t,this):this._transHeight}},{key:"transWidthTop",value:function(t){return arguments.length?(this._transWidthTop=t,this):this._transWidthTop}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ao=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","rainfall-volume-line-chart"),i.gridTop=new Jt(i.coreGroup),i.gridBottom=new Jt(i.coreGroup),i.linePlot=new Lo(i.coreGroup),i.rainfallVolumeLineText=new Po(i.coreGroup),i.guideLineTop=new Et(i.coreGroup),i.guideLineBottom=new Et(i.coreGroup),i.guideScatter=new So(i.coreGroup),i.clipArea=new Ut(i.defs),i.overlayTop=new te(i.coreGroup),i.overlayBottom=new te(i.coreGroup),i.xAxisTop=new Fo(i.mainGroup),i.xAxisBottom=new Fo(i.mainGroup),i.yAxisTop=new ea(i.mainGroup),i.yAxisBottom=new ea(i.mainGroup),i.xAxisTop.minTickDistance(5),i.xScaleTop=d3.scalePoint(),i.xScaleBottom=d3.scalePoint(),i.yScaleTop=d3.scaleLinear(),i.yScaleBottom=d3.scaleLinear(),i.axisTooltip=new oa(i.mainGroup),i._xType="category",i._yType="number",i._xTopOrient="bottom",i._xBottomOrient="top",i._yTopOrient="left",i._yBottomOrient="left",i._sortValue=0,i._histogramWidth=.7,i._yScaleHeight=1.05,i._curve=d3.curveLinear,i._lineWidth=2,i._strokeWidth=0,i._strokeColor="#FFFFFF",i._fillColor=null,i._endPointRadius=0,i._labelShow=!1,i._positionOptions=["外部","居上","居下"],i._positionChoice="外部",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="横向绘制",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxisTop,i=t.xAxisBottom,n=t.yAxisTop,a=t.yAxisBottom,o=t.xScaleTop,r=t.xScaleBottom,l=t.yScaleTop,s=t.yScaleBottom,u=t._xType,c=t._yType,h=t._xTopOrient,d=t._xBottomOrient,_=t._yTopOrient,f=t._yBottomOrient,p=t._fontSize,y=t.widthOfNoMargin,x=t.heightOfMainGroup;o.domain(t._xDomain),r.domain(t._xDomain),l.domain(t._yDomain),s.domain(t._yDomain1),e.scaleFunc(o).allowedMaxTextHeight(.5*x).type(u).orient(h).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(p).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(r).allowedMaxTextHeight(.5*x).type(u).orient(d).title("").tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(p).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),n.scaleFunc(l).allowedMaxTextWidth(.5*y).type(c).orient(_).title(t._yTopName).tickShow(t._yTickShowTop).lineStroke(t._axisLineStrokeYT).fontSize(p).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange(t._yRangeTop).yAxisLineWidth(t._yAxisLineWidthTop).axisLineShow(t._yAxisShowTop).labelDirection(t._yLabelDirectionTop).labelAngle(t._yLabelAngleTop).countOfLabel(t._yCountOfLabelTop).labelSuffix(t._yLabelSuffixTop).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.scaleFunc(s).allowedMaxTextWidth(.5*y).type(c).orient(f).title(t._yBottomName).tickShow(t._yTickShowBottom).lineStroke(t._axisLineStrokeYB).fontSize(p).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange(t._yRangeBottom).yAxisLineWidth(t._yAxisLineWidthBottom).axisLineShow(t._yAxisShowBottom).labelDirection(t._yLabelDirectionBottom).labelAngle(t._yLabelAngleBottom).countOfLabel(t._yCountOfLabelBottom).labelSuffix(t._yLabelSuffixBottom).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var g=(.7*x-e.allowedMaxTextHeight())/p,v=(.7*x-i.allowedMaxTextHeight())/p;n.tickCount(g),a.tickCount(v),n.compute(),a.compute();t.activeData;var m=n.width||0,b=a.width||0,S=d3.max([m,b]),k=S,w=S,C=0,O=y-k;o.range([C,O]),r.range([C,O]),e.compute(),i.compute();var F=e._axisStart,L=e._axisEnd;F<0&&(C=Math.abs(F)>k?Math.abs(F)-k:0),L>O&&(O-=L-O),o.range([C,O]),r.range([C,O]);var P=(x-e.height-16)/2;l.range([P,0]),s.range([0,P]);var A=k,W=P+e.height+10,z=k+C;e.translate(A,P),i.translate(w,W),n.translate(z,0);var M=w+C,D=P+e.height+10;a.translate(M,D),e.update(),i.update(),n.update(),a.update()}},{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.gridTop,n=t.gridBottom,a=t.tooltip,o=(t.axisTooltip,t.linePlot),r=t.overlayTop,l=t.overlayBottom,s=(t.scatterPlot,t.guideScatter),u=t.guideLineTop,h=t.guideLineBottom,d=t.rainfallVolumeLineText,_=t.clipArea,f=t.xScaleTop,p=t.xScaleBottom,g=t.yScaleTop,v=t.yScaleBottom,m=(Math.min(d3.min(e.filter((function(t){return"volume"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),t.yAxisTop.width||0),b=t.yAxisBottom.width||0,S=d3.max([m,b]),k=S,w=S,C=(t.xAxisTop._axisStart,t.xAxisTop._axisEnd),O=0;C>t.widthOfNoMargin-k&&(O=C-(t.widthOfNoMargin-k));var F=t.widthOfNoMargin-k-O,L=t.widthOfNoMargin-w-O,P=t.heightOfMainGroup,A=(P-t.xAxisTop.height-16)/2,W=t.defs;W.selectAll("filter").remove();var z=W.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_line").attr("filterUnits","objectBoundingBox");if(z.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),z.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.5).attr("result","offsetBlurredAlpha"),z.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","1"),z.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),z.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),i.width(F).height(A>0?A:0).planeX(f.range()[0]).xTickLocations(t.xAxisTop.tickLocations).yTickLocations(t.yAxisTop.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.width(L).height(A>0?A:0).planeX(p.range()[0]).type("rainfall").xTickLocations(t.xAxisBottom.tickLocations).yTickLocations(t.yAxisBottom.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.mainGroup.selectAll(".linear-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var M=x(t._strokeColor),D=[],R=!0,N=!1,T=void 0;try{for(var B,G=M[Symbol.iterator]();!(R=(B=G.next()).done);R=!0){var X=B.value,j=[],I=X.split(":");j.push(q(I[0])),j.push(I[1]),D.push(j)}}catch(t){N=!0,T=t}finally{try{!R&&G.return&&G.return()}finally{if(N)throw T}}var Y=D.concat(),H=Y.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(H[1]).x1+"%").attr("y1",y(H[1]).y1+"%").attr("x2",y(H[1]).x2+"%").attr("y2",y(H[1]).y2+"%").selectAll("stop").data(Y).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._fillColor&&/\[/.test(t._fillColor)){var V=x(t._fillColor),$=[],U=!0,Z=!1,Q=void 0;try{for(var K,J=V[Symbol.iterator]();!(U=(K=J.next()).done);U=!0){var tt=K.value,et=[],it=tt.split(":");et.push(q(it[0])),et.push(it[1]),$.push(et)}}catch(t){Z=!0,Q=t}finally{try{!U&&J.return&&J.return()}finally{if(Z)throw Q}}var nt=$.concat(),at=nt.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(at[1]).x1+"%").attr("y1",y(at[1]).y1+"%").attr("x2",y(at[1]).x2+"%").attr("y2",y(at[1]).y2+"%").selectAll("stop").data(nt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}s.data(e).xScale(f).xScaleBottom(p).yScale(g).transHeight(A+t.xAxisTop.height+10).yScaleRight(v).transWidthTop(k).transWidthBottom(w).radius(t._endPointRadius).fill(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).stroke(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).strokeWidth(t._strokeWidth),u.y1(0).y2(A).stroke("#c6c6c6").strokeDasharray("0 0"),h.y1(A+t.xAxisTop.height+10).y2(P).stroke("#c6c6c6").strokeDasharray("0 0"),r.data(f.domain()).isScalePoint(!0).bandWidth(f.step()).bandHeight(A>0?A:0).bandX(f.range()[0]).onMouseover((function(i,n){var o=i,r=[{text:o=="&-"+(n+1)?"":o}],l=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));l.push({key:e.key,name:e.name,color:e.color,data:n,type:e.type}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),a.data(r).update(),u.x(f(o)+k).update().show(),h.x(p(o)+w).update().show(),s.data(l).update(),a.move([d3.event.offsetX,d3.event.offsetY]).show(),u.show(),h.show(),s.show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){a.hide(),u.hide(),h.hide(),s.hide()})),l.data(p.domain()).isScalePoint(!0).type("rainfall").bandWidth(p.step()).bandHeight(A>0?A:0).bandX(p.range()[0]).onMouseover((function(t,i){var n=t,o=[{text:n=="&-"+(i+1)?"":n}],r=[];e.forEach((function(t,e){var i=t.data.filter((function(t){return t.name===n}));r.push({key:t.key,name:t.name,color:t.color,data:i,type:t.type}),o.push({text:(t.name=="$-"+(e+1)?"":t.name)+": "+(isNaN(parseFloat(i[0].value))?"":i[0].value),color:t.color})})),a.data(o).update(),u.x(f(n)+k).update().show(),h.x(p(n)+w).update().show(),s.data(r).update(),a.move([d3.event.offsetX,d3.event.offsetY]).show(),u.show(),h.show(),s.show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){a.hide(),u.hide(),h.hide(),s.hide()})),o.data(e).xScale(f).xScaleBottom(p).yScale(g).yScaleRight(v).transHeight(A+t.xAxisTop.height+10).transWidthTop(k).transWidthBottom(w).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).curve(t._curve).radius(t._endPointRadius).stroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).fill(/\[/.test(t._fillColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._fillColor).lineWidth(t._lineWidth).strokeWidth(t._strokeWidth),d.data(e).xScale(f).yScale(g).yScaleRight(v).transHeight(A+t.xAxisTop.height+10).transWidthTop(k).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var ot=t.group.selectAll(".rainfall-volume-area-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));(d3.selectAll(ot).remove(),o.update(),r.update(),l.update(),i.update(),n.update(),d.update(),t.coreGroup.selectAll(".plane-grid g").attr("transform","translate("+k+", 0)"),t.coreGroup.selectAll(".bands-overlay rect").attr("transform","translate("+k+",0)"),t.coreGroup.selectAll(".rainfall").attr("transform","translate("+w+", "+(A+t.xAxisTop.height+10)+")"),d3.selectAll(t.coreGroup.selectAll(".bands-overlay").nodes().filter((function(t){return"bottom"==d3.select(t).attr("tip")}))).attr("transform","translate(0, "+(A+t.xAxisTop.height+10)+")"),_.width(F).height(A>0?A:0).paddingVertical([0,0]).paddingHorizontal([-f.range()[0]-k,f.range()[0]]).transition(t._transition).duration(t._duration),_.update(),0!=t._yRangeTop.length&&(0==isNaN(parseFloat(t._yRangeTop[0]))||0==isNaN(parseFloat(t._yRangeTop[1]))?(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-plot g").nodes().filter((function(t){return"top"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#"+_.id)+")"),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-text g").nodes().filter((function(t){return"top"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#"+_.id)+")")):(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-plot g").nodes().filter((function(t){return"top"==d3.select(t).attr("tip")}))).attr("clip-path",""),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-text g").nodes().filter((function(t){return"top"==d3.select(t).attr("tip")}))).attr("clip-path",""))),0!=t._yRangeBottom.length)&&(t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",A+t.xAxisTop.height+10).attr("x",f.range()[0]+w).attr("height",A>0?A:0).attr("width",L-f.range()[0]),0==isNaN(parseFloat(t._yRangeBottom[0]))||0==isNaN(parseFloat(t._yRangeBottom[1]))?(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-plot g").nodes().filter((function(t){return"bottom"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-text g").nodes().filter((function(t){return"bottom"==d3.select(t).attr("tip")}))).attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")):(d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-plot g").nodes().filter((function(t){return"bottom"==d3.select(t).attr("tip")}))).attr("clip-path",""),d3.selectAll(t.coreGroup.selectAll(".rainfall-volume-line-text g").nodes().filter((function(t){return"bottom"==d3.select(t).attr("tip")}))).attr("clip-path","")))}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=t.axisCopy,a=i.x||{},o=i.y||{},r=n.yt||{},l=n.yb||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(a.axisColor)||q(i.color)).axisLineStrokeYT(q(r.axisColor)||q(i.color)).axisLineStrokeYB(q(l.axisColor)||q(i.color)).xTitle(a.name).xTickShow(a.labelShow).yTickShowTop(r.labelShow).yTickShowBottom(l.labelShow).xRange(a.range?a.range:[]).yRangeTop(r.range?r.range:[]).yRangeBottom(l.range?l.range:[]).yTopName(o.leftName?o.leftName:r.name).yTopSuffix(o.leftTitle?o.leftTitle:r.labelSuffix).yBottomName(o.rightName?o.rightName:l.name).yBottomSuffix(o.rightTitle?o.rightTitle:l.labelSuffix).xAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).yAxisLineWidthTop(0==r.axisLineWidth||r.axisLineWidth?r.axisLineWidth:1).yAxisLineWidthBottom(0==l.axisLineWidth||l.axisLineWidth?l.axisLineWidth:1).xAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).yAxisShowTop(!(0!=r.axisShow&&!r.axisShow)&&r.axisShow).yAxisShowBottom(!(0!=l.axisShow&&!l.axisShow)&&l.axisShow).xLabelDirection(a.labelDirection?a.labelDirection:"自动").xLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).xCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).xLabelSuffix(a.labelSuffix?a.labelSuffix:"").yLabelDirectionTop(r.labelDirection?r.labelDirection:"自动").yLabelAngleTop(0==r.labelAngle||r.labelAngle?r.labelAngle:0).yCountOfLabelTop(0==r.stepOfLabel||r.stepOfLabel?r.stepOfLabel:null).yLabelSuffixTop(r.labelSuffix?r.labelSuffix:"").yLabelDirectionBottom(l.labelDirection?l.labelDirection:"自动").yLabelAngleBottom(0==l.labelAngle||l.labelAngle?l.labelAngle:0).yCountOfLabelBottom(0==l.stepOfLabel||l.stepOfLabel?l.stepOfLabel:null).yLabelSuffixBottom(l.labelSuffix?l.labelSuffix:"")}},{key:"yLabelDirectionTop",value:function(t){return arguments.length?(this._yLabelDirectionTop=t,this):this._yLabelDirectionTop}},{key:"yLabelAngleTop",value:function(t){return arguments.length?(this._yLabelAngleTop=parseFloat(t),this):this._yLabelAngleTop}},{key:"yCountOfLabelTop",value:function(t){return arguments.length?(this._yCountOfLabelTop=parseFloat(t),this):this._yCountOfLabelTop}},{key:"yLabelSuffixTop",value:function(t){return arguments.length?(this._yLabelSuffixTop=t,this):this._yLabelSuffixTop}},{key:"yLabelDirectionBottom",value:function(t){return arguments.length?(this._yLabelDirectionBottom=t,this):this._yLabelDirectionBottom}},{key:"yLabelAngleBottom",value:function(t){return arguments.length?(this._yLabelAngleBottom=parseFloat(t),this):this._yLabelAngleBottom}},{key:"yCountOfLabelBottom",value:function(t){return arguments.length?(this._yCountOfLabelBottom=parseFloat(t),this):this._yCountOfLabelBottom}},{key:"yLabelSuffixBottom",value:function(t){return arguments.length?(this._yLabelSuffixBottom=t,this):this._yLabelSuffixBottom}},{key:"yAxisLineWidthTop",value:function(t){return arguments.length?(this._yAxisLineWidthTop=t,this):this._yAxisLineWidthTop}},{key:"yAxisLineWidthBottom",value:function(t){return arguments.length?(this._yAxisLineWidthBottom=t,this):this._yAxisLineWidthBottom}},{key:"yTopName",value:function(t){return arguments.length?(this._yTopName=t,this):this._yTopName}},{key:"yTopSuffix",value:function(t){return arguments.length?(this._yTopSuffix=t,this):this._yTopSuffix}},{key:"yBottomName",value:function(t){return arguments.length?(this._yBottomName=t,this):this._yBottomName}},{key:"yBottomSuffix",value:function(t){return arguments.length?(this._yBottomSuffix=t,this):this._yBottomSuffix}},{key:"yAxisShowTop",value:function(t){return arguments.length?(this._yAxisShowTop=t,this):this._yAxisShowTop}},{key:"yAxisShowBottom",value:function(t){return arguments.length?(this._yAxisShowBottom=t,this):this._yAxisShowBottom}},{key:"axisLineStrokeYT",value:function(t){return arguments.length?(this._axisLineStrokeYT=t,this):this._axisLineStrokeYT}},{key:"axisLineStrokeYB",value:function(t){return arguments.length?(this._axisLineStrokeYB=t,this):this._axisLineStrokeYB}},{key:"yTickShowTop",value:function(t){return arguments.length?(this._yTickShowTop=t,this):this._yTickShowTop}},{key:"yTickShowBottom",value:function(t){return arguments.length?(this._yTickShowBottom=t,this):this._yTickShowBottom}},{key:"yRangeTop",value:function(t){return arguments.length?(this._yRangeTop=t,this):this._yRangeTop}},{key:"yRangeBottom",value:function(t){return arguments.length?(this._yRangeBottom=t,this):this._yRangeBottom}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=(t.axisCopy,{straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal});0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?d(e.lineWidth):this._lineWidth,this._curve=e.lineType?r[e.lineType]:d3.curveLinear,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor.constructor===Object?null:e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor.constructor===Object?null:e.endPointFillColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRangeTop||[],n=t._yRangeBottom||[],a=e.length?e[0].data.map((function(t){return t.name})):[0,1],o=e.length&&e.filter((function(t){return"rainfall"==t.type})).length>0?[1.2*Math.min(d3.min(e.filter((function(t){return"rainfall"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*Math.max(d3.max(e.filter((function(t){return"rainfall"==t.type})),(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1],r=e.length&&e.filter((function(t){return"volume"==t.type})).length>0?[1.2*Math.min(d3.min(e.filter((function(t){return"volume"==t.type})),(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*Math.max(d3.max(e.filter((function(t){return"volume"==t.type})),(function(t){return d3.max(t.data,(function(t){return+t.value}))})),0)]:[0,1];t._xDomain=a,t._yDomain=[isNaN(parseFloat(i[0]))?o[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?o[1]:o[1]<i[0]?1.5*i[0]:o[1]:parseFloat(i[1])],t._yDomain1=[isNaN(parseFloat(n[0]))?r[0]:parseFloat(n[0]),isNaN(parseFloat(n[1]))?isNaN(parseFloat(n[0]))?r[1]:r[1]<n[0]?1.5*n[0]:r[1]:parseFloat(n[1])]}}]),e}(Tt),Wo=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t));return e.elem.attr("class","pack-circle"),e._fontColor="#ffffff",e}return w(i,t),S(i,[{key:"update",value:function(){var t=this,i=t._data,n=t._labelLevel;return function(i){d3.transition().duration(2e3),d3.transition().duration(2e3);var a=d3.hierarchy(i).sum((function(t,e){return t.size})),o=d3.pack().size([t._width,t._height]).padding(0),r=o(a).descendants().slice(0,1),l=o(a).descendants().slice(1),s=t.group.selectAll(".node").data(l);s.enter().append("g").attr("class","node circle_enter").attr("opacity",1).attr("transform",(function(t){return"translate("+(isNaN(t.x)?0:t.x)+","+(isNaN(t.y)?0:t.y)+")"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).append("circle").attr("r",1e-6).style("fill",(function(e,i){if(e.data.color&&/\[/.test(e.data.color)){var n=x(e.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f,p=[];return f=(p=a.concat()).pop(),t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}return e.data.color})).transition().duration(t._transition?t._duration:0).attr("r",(function(t,e){return isNaN(t.r)||t.r<0?0:t.r}));s.on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("class","node circle_update").attr("transform",(function(t){return"translate("+(isNaN(t.x)?0:t.x)+","+(isNaN(t.y)?0:t.y)+")"}));s.select("circle").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",(function(t,e){return isNaN(t.r)||t.r<0?0:t.r}));var u=s.exit().transition().duration(t._transition?t._duration:0);if(u.attr("class","node circle_exit").attr("transform",(function(t){return"translate("+(isNaN(t.x)?0:t.x)+","+(isNaN(t.y)?0:t.y)+")"})).attr("opacity",0).remove(),u.select("circle").attr("r",1e-6),"one-level"==t._tip){var h=t._level1Label;1==n.length&&("层级1"==n[0]?h=t._level1Label:"层级2"==n[0]?h=t._level2Label:"层级3"==n[0]&&(h=t._level3Label));var d=h.suffix?h.suffix:"",_=t.group.selectAll(".texts").data(l),f=_.enter().append("g").attr("class","texts text_enter").filter((function(t,e){return 1==t.depth})).attr("opacity",1).attr("transform",(function(t){return"translate("+(isNaN(t.x)?0:t.x)+","+(isNaN(t.y)?0:t.y)+")"})),p=(_.attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("class","texts text_update").attr("transform",(function(t){return"translate("+(isNaN(t.x)?0:t.x)+","+(isNaN(t.y)?0:t.y)+")"})),_.exit().transition().duration(t._transition?t._duration:0));p.attr("class","texts text_exit").attr("transform",(function(t){return"translate("+(isNaN(t.x)?0:t.x)+","+(isNaN(t.y)?0:t.y)+")"})).attr("opacity",0).remove(),null==h.positionOptions||null==h.positionChoice||1==h.positionOptions.indexOf(h.positionChoice)||-1==h.positionOptions.indexOf(h.positionChoice)?(f.append("text").attr("class","label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:h.fontSize})).attr("font-family",(function(t,e){return h.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(h.color)?q(t._colors[h.color]):isNaN(parseFloat(h.color))?q(h.color):q(t._colors[h.color])})).attr("text-anchor","middle").attr("display",h.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),_.select(".label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:h.fontSize})).attr("font-family",(function(t,e){return h.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(h.color)?q(t._colors[h.color]):isNaN(parseFloat(h.color))?q(h.color):q(t._colors[h.color])})).attr("text-anchor","middle").attr("display",h.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),0==h.show||null==h.show||null==h.contentOption||null==h.contentChoice||0==h.contentChoice.length||(1==h.contentChoice.length?0==h.contentOption.indexOf(h.contentChoice[0])?(f.select(".label-1").text((function(t,e){return h.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/h.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),h.fontSize,h.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*h.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"})),_.select(".label-1").text((function(t,e){return h.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/h.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),h.fontSize,h.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*h.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"}))):1==h.contentOption.indexOf(h.contentChoice[0])?(f.select(".label-1").attr("dy","0.4em").text((function(e,i){if(h.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"})),_.select(".label-1").attr("dy","0.4em").text((function(e,i){if(h.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"}))):2==h.contentOption.indexOf(h.contentChoice[0])&&(f.select(".label-1").attr("dy","0.4em").text((function(e,i){return h.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+d})),_.select(".label-1").attr("dy","0.4em").text((function(e,i){return h.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+d}))):2==h.contentChoice.length?0==h.contentOption.indexOf(h.contentChoice[0])&&1==h.contentOption.indexOf(h.contentChoice[1])?(f.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),h.fontSize,h.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"})),_.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),h.fontSize,h.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"}))):0==h.contentOption.indexOf(h.contentChoice[0])&&2==h.contentOption.indexOf(h.contentChoice[1])?(f.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),h.fontSize,h.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+d))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"})),_.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),h.fontSize,h.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+d))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"}))):1==h.contentOption.indexOf(h.contentChoice[0])&&2==h.contentOption.indexOf(h.contentChoice[1])&&(f.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+d))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"})),_.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+d))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"}))):3==h.contentChoice.length&&(f.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),h.fontSize,h.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*h.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+d))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"})),_.select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/h.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(h.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),h.fontSize,h.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*h.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*h.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+d))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+h.fontSize)+")"}))))):0==h.positionOptions.indexOf(h.positionChoice)&&(f.filter((function(t,e){return 1==t.depth})).append("defs").append("path").attr("class","text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-h.fontSize>0?(isNaN(t.r)?0:t.r)-h.fontSize:0,-Math.PI/2,Math.PI/2)})).attr("id",(function(e,i){return"clip-"+t.id+"-"+i})),_.filter((function(t,e){return 1==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-h.fontSize>0?(isNaN(t.r)?0:t.r)-h.fontSize:0,-Math.PI/2,Math.PI/2)})),p.filter((function(t,e){return 1==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-h.fontSize>0?(isNaN(t.r)?0:t.r)-h.fontSize:0,-Math.PI/2,Math.PI/2)})),f.filter((function(t,e){return 1==t.depth})).append("text").attr("class","label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:h.fontSize})).attr("font-family",(function(t,e){return h.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(h.color)?q(t._colors[h.color]):isNaN(parseFloat(h.color))?q(h.color):q(t._colors[h.color])})).attr("text-anchor","middle").attr("display",h.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),f.filter((function(t,e){return 1==t.depth})).select(".label-1").append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",h.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==h.show||null==h.show||null==h.contentOption||null==h.contentChoice||0==h.contentChoice.length?a="":1==h.contentChoice.length?0==h.contentOption.indexOf(h.contentChoice[0])?a=e.data.name:1==h.contentOption.indexOf(h.contentChoice[0])?a=n:2==h.contentOption.indexOf(h.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+d):2==h.contentChoice.length?0==h.contentOption.indexOf(h.contentChoice[0])&&1==h.contentOption.indexOf(h.contentChoice[1])?a=e.data.name+" "+n:0==h.contentOption.indexOf(h.contentChoice[0])&&2==h.contentOption.indexOf(h.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+d:1==h.contentOption.indexOf(h.contentChoice[0])&&2==h.contentOption.indexOf(h.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+d):3==h.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+d),X(a,((isNaN(e.r)?0:e.r)-h.fontSize>0?(isNaN(e.r)?0:e.r)-h.fontSize:0)*Math.PI,h.fontSize,h.fontFamily)})),_.filter((function(t,e){return 1==t.depth})).select(".label-1 textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",h.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==h.show||null==h.show||null==h.contentOption||null==h.contentChoice||0==h.contentChoice.length?a="":1==h.contentChoice.length?0==h.contentOption.indexOf(h.contentChoice[0])?a=e.data.name:1==h.contentOption.indexOf(h.contentChoice[0])?a=n:2==h.contentOption.indexOf(h.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+d):2==h.contentChoice.length?0==h.contentOption.indexOf(h.contentChoice[0])&&1==h.contentOption.indexOf(h.contentChoice[1])?a=e.data.name+" "+n:0==h.contentOption.indexOf(h.contentChoice[0])&&2==h.contentOption.indexOf(h.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+d:1==h.contentOption.indexOf(h.contentChoice[0])&&2==h.contentOption.indexOf(h.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+d):3==h.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+d),X(a,((isNaN(e.r)?0:e.r)-h.fontSize>0?(isNaN(e.r)?0:e.r)-h.fontSize:0)*Math.PI,h.fontSize,h.fontFamily)})),_.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("display",h.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:h.fontSize})).attr("font-family",(function(t,e){return h.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(h.color)?q(t._colors[h.color]):isNaN(parseFloat(h.color))?q(h.color):q(t._colors[h.color])})).attr("text-anchor","middle").attr("opacity",1)),p.select(".label-1").attr("display",h.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1e-6)}else if("two-level"==t._tip){var g=t._level1Label,v=t._level2Label;2==n.length&&("层级1"==n[0]?g=t._level1Label:"层级2"==n[0]?g=t._level2Label:"层级3"==n[0]&&(g=t._level3Label),"层级1"==n[1]?v=t._level1Label:"层级2"==n[1]?v=t._level2Label:"层级3"==n[1]&&(v=t._level3Label));var m=g.suffix?g.suffix:"",b=v.suffix?v.suffix:"",S=t.group.selectAll(".texts").data(l),k=S.enter().append("g").attr("class","texts text_enter").attr("opacity",1).attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})),w=(S.attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("class","texts text_update").attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})),S.exit().transition().duration(t._transition?t._duration:0));w.attr("class","texts text_exit").attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})).attr("opacity",0).remove(),null==g.positionOptions||null==g.positionChoice||0==g.positionOptions.indexOf(g.positionChoice)||-1==g.positionOptions.indexOf(g.positionChoice)?(k.filter((function(t,e){return 1==t.depth})).append("defs").append("path").attr("class","text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-g.fontSize>0?(isNaN(t.r)?0:t.r)-g.fontSize:0,-Math.PI/2,Math.PI/2)})).attr("id",(function(e,i){return"clip-two-level-in-"+t.id+"-"+i})),S.filter((function(t,e){return 1==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-g.fontSize>0?(isNaN(t.r)?0:t.r)-g.fontSize:0,-Math.PI/2,Math.PI/2)})),w.filter((function(t,e){return 1==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-g.fontSize>0?(isNaN(t.r)?0:t.r)-g.fontSize:0,-Math.PI/2,Math.PI/2)})),k.filter((function(t,e){return 1==t.depth})).append("text").attr("class","label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:g.fontSize})).attr("font-family",(function(t,e){return g.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(g.color)?q(t._colors[g.color]):isNaN(parseFloat(g.color))?q(g.color):q(t._colors[g.color])})).attr("text-anchor","middle").attr("display",g.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),k.filter((function(t,e){return 1==t.depth})).select(".label-1").append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-two-level-in-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",g.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==g.show||null==g.show||null==g.contentOption||null==g.contentChoice||0==g.contentChoice.length?a="":1==g.contentChoice.length?0==g.contentOption.indexOf(g.contentChoice[0])?a=e.data.name:1==g.contentOption.indexOf(g.contentChoice[0])?a=n:2==g.contentOption.indexOf(g.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+m):2==g.contentChoice.length?0==g.contentOption.indexOf(g.contentChoice[0])&&1==g.contentOption.indexOf(g.contentChoice[1])?a=e.data.name+" "+n:0==g.contentOption.indexOf(g.contentChoice[0])&&2==g.contentOption.indexOf(g.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+m:1==g.contentOption.indexOf(g.contentChoice[0])&&2==g.contentOption.indexOf(g.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+m):3==g.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+m),X(a,((isNaN(e.r)?0:e.r)-g.fontSize>0?(isNaN(e.r)?0:e.r)-g.fontSize:0)*Math.PI,g.fontSize,g.fontFamily)})),S.filter((function(t,e){return 1==t.depth})).select(".label-1 textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-two-level-in-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",g.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==g.show||null==g.show||null==g.contentOption||null==g.contentChoice||0==g.contentChoice.length?a="":1==g.contentChoice.length?0==g.contentOption.indexOf(g.contentChoice[0])?a=e.data.name:1==g.contentOption.indexOf(g.contentChoice[0])?a=n:2==g.contentOption.indexOf(g.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+m):2==g.contentChoice.length?0==g.contentOption.indexOf(g.contentChoice[0])&&1==g.contentOption.indexOf(g.contentChoice[1])?a=e.data.name+" "+n:0==g.contentOption.indexOf(g.contentChoice[0])&&2==g.contentOption.indexOf(g.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+m:1==g.contentOption.indexOf(g.contentChoice[0])&&2==g.contentOption.indexOf(g.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+m):3==g.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+m),X(a,((isNaN(e.r)?0:e.r)-g.fontSize>0?(isNaN(e.r)?0:e.r)-g.fontSize:0)*Math.PI,g.fontSize,g.fontFamily)})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("display",g.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:g.fontSize})).attr("font-family",(function(t,e){return g.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(g.color)?q(t._colors[g.color]):isNaN(parseFloat(g.color))?q(g.color):q(t._colors[g.color])})).attr("text-anchor","middle").attr("opacity",1)):1==g.positionOptions.indexOf(g.positionChoice)&&(k.filter((function(t,e){return 1==t.depth})).append("text").attr("class","label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:g.fontSize})).attr("font-family",(function(t,e){return g.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(g.color)?q(t._colors[g.color]):isNaN(parseFloat(g.color))?q(g.color):q(t._colors[g.color])})).attr("text-anchor","middle").attr("display",g.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),S.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:g.fontSize})).attr("font-family",(function(t,e){return g.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(g.color)?q(t._colors[g.color]):isNaN(parseFloat(g.color))?q(g.color):q(t._colors[g.color])})).attr("text-anchor","middle").attr("display",g.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),0==g.show||null==g.show||null==g.contentOption||null==g.contentChoice||0==g.contentChoice.length||(1==g.contentChoice.length?0==g.contentOption.indexOf(g.contentChoice[0])?(k.filter((function(t,e){return 1==t.depth})).select(".label-1").text((function(t,e){return g.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/g.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),g.fontSize,g.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*g.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").text((function(t,e){return g.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/g.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),g.fontSize,g.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*g.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"}))):1==g.contentOption.indexOf(g.contentChoice[0])?(k.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){if(g.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){if(g.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"}))):2==g.contentOption.indexOf(g.contentChoice[0])&&(k.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){return g.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+m})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){return g.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+m}))):2==g.contentChoice.length?0==g.contentOption.indexOf(g.contentChoice[0])&&1==g.contentOption.indexOf(g.contentChoice[1])?(k.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),g.fontSize,g.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),g.fontSize,g.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"}))):0==g.contentOption.indexOf(g.contentChoice[0])&&2==g.contentOption.indexOf(g.contentChoice[1])?(k.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),g.fontSize,g.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+m))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),g.fontSize,g.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+m))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"}))):1==g.contentOption.indexOf(g.contentChoice[0])&&2==g.contentOption.indexOf(g.contentChoice[1])&&(k.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+m))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+m))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"}))):3==g.contentChoice.length&&(k.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),g.fontSize,g.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*g.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+m))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"})),S.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/g.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(g.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),g.fontSize,g.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*g.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*g.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+m))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+g.fontSize)+")"}))))),w.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("display",g.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1e-6),null==v.positionOptions||null==v.positionChoice||1==v.positionOptions.indexOf(v.positionChoice)||-1==v.positionOptions.indexOf(v.positionChoice)?(k.filter((function(t,e){return 2==t.depth})).append("text").attr("class","label-2").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:v.fontSize})).attr("font-family",(function(t,e){return v.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(v.color)?q(t._colors[v.color]):isNaN(parseFloat(v.color))?q(v.color):q(t._colors[v.color])})).attr("text-anchor","middle").attr("display",v.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),S.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:v.fontSize})).attr("font-family",(function(t,e){return v.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(v.color)?q(t._colors[v.color]):isNaN(parseFloat(v.color))?q(v.color):q(t._colors[v.color])})).attr("text-anchor","middle").attr("display",v.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),0==v.show||null==v.show||null==v.contentOption||null==v.contentChoice||0==v.contentChoice.length||(1==v.contentChoice.length?0==v.contentOption.indexOf(v.contentChoice[0])?(k.filter((function(t,e){return 2==t.depth})).select(".label-2").text((function(t,e){return v.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/v.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),v.fontSize,v.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*v.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").text((function(t,e){return v.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/v.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),v.fontSize,v.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*v.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"}))):1==v.contentOption.indexOf(v.contentChoice[0])?(k.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){if(v.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){if(v.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"}))):2==v.contentOption.indexOf(v.contentChoice[0])&&(k.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){return v.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+b})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){return v.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+b}))):2==v.contentChoice.length?0==v.contentOption.indexOf(v.contentChoice[0])&&1==v.contentOption.indexOf(v.contentChoice[1])?(k.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),v.fontSize,v.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),v.fontSize,v.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"}))):0==v.contentOption.indexOf(v.contentChoice[0])&&2==v.contentOption.indexOf(v.contentChoice[1])?(k.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),v.fontSize,v.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+b))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),v.fontSize,v.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+b))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"}))):1==v.contentOption.indexOf(v.contentChoice[0])&&2==v.contentOption.indexOf(v.contentChoice[1])&&(k.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+b))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+b))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"}))):3==v.contentChoice.length&&(k.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),v.fontSize,v.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*v.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+b))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/v.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(v.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),v.fontSize,v.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*v.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*v.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+b))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+v.fontSize)+")"}))))):0==v.positionOptions.indexOf(v.positionChoice)&&(k.filter((function(t,e){return 2==t.depth})).append("defs").append("path").attr("class","text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-v.fontSize>0?(isNaN(t.r)?0:t.r)-v.fontSize:0,-Math.PI/2,Math.PI/2)})).attr("id",(function(e,i){return"clip-"+t.id+"-"+i})),S.filter((function(t,e){return 2==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-v.fontSize>0?(isNaN(t.r)?0:t.r)-v.fontSize:0,-Math.PI/2,Math.PI/2)})),w.filter((function(t,e){return 2==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-v.fontSize>0?(isNaN(t.r)?0:t.r)-v.fontSize:0,-Math.PI/2,Math.PI/2)})),k.filter((function(t,e){return 2==t.depth})).append("text").attr("class","label-2").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:v.fontSize})).attr("font-family",(function(t,e){return v.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(v.color)?q(t._colors[v.color]):isNaN(parseFloat(v.color))?q(v.color):q(t._colors[v.color])})).attr("text-anchor","middle").attr("display",v.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),k.filter((function(t,e){return 2==t.depth})).select(".label-2").append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",v.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==v.show||null==v.show||null==v.contentOption||null==v.contentChoice||0==v.contentChoice.length?a="":1==v.contentChoice.length?0==v.contentOption.indexOf(v.contentChoice[0])?a=e.data.name:1==v.contentOption.indexOf(v.contentChoice[0])?a=n:2==v.contentOption.indexOf(v.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+b):2==v.contentChoice.length?0==v.contentOption.indexOf(v.contentChoice[0])&&1==v.contentOption.indexOf(v.contentChoice[1])?a=e.data.name+" "+n:0==v.contentOption.indexOf(v.contentChoice[0])&&2==v.contentOption.indexOf(v.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+b:1==v.contentOption.indexOf(v.contentChoice[0])&&2==v.contentOption.indexOf(v.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+b):3==v.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+b),X(a,((isNaN(e.r)?0:e.r)-v.fontSize>0?(isNaN(e.r)?0:e.r)-v.fontSize:0)*Math.PI,v.fontSize,v.fontFamily)})),S.filter((function(t,e){return 2==t.depth})).select(".label-2 textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",v.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==v.show||null==v.show||null==v.contentOption||null==v.contentChoice||0==v.contentChoice.length?a="":1==v.contentChoice.length?0==v.contentOption.indexOf(v.contentChoice[0])?a=e.data.name:1==v.contentOption.indexOf(v.contentChoice[0])?a=n:2==v.contentOption.indexOf(v.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+b):2==v.contentChoice.length?0==v.contentOption.indexOf(v.contentChoice[0])&&1==v.contentOption.indexOf(v.contentChoice[1])?a=e.data.name+" "+n:0==v.contentOption.indexOf(v.contentChoice[0])&&2==v.contentOption.indexOf(v.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+b:1==v.contentOption.indexOf(v.contentChoice[0])&&2==v.contentOption.indexOf(v.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+b):3==v.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+b),X(a,((isNaN(e.r)?0:e.r)-v.fontSize>0?(isNaN(e.r)?0:e.r)-v.fontSize:0)*Math.PI,v.fontSize,v.fontFamily)})),S.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("display",v.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:v.fontSize})).attr("font-family",(function(t,e){return v.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(v.color)?q(t._colors[v.color]):isNaN(parseFloat(v.color))?q(v.color):q(t._colors[v.color])})).attr("text-anchor","middle").attr("opacity",1)),w.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("display",v.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1e-6)}else if("three-level"==t._tip){var C=t._level1Label,O=t._level2Label,F=t._level3Label,L=C.suffix?C.suffix:"",P=O.suffix?O.suffix:"",A=F.suffix?F.suffix:"",W=t.group.selectAll(".texts").data(l),z=W.enter().append("g").attr("class","texts text_enter").attr("opacity",1).attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})),M=(W.attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("class","texts text_update").attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})),W.exit().transition().duration(t._transition?t._duration:0));M.attr("class","texts text_exit").attr("transform",(function(t){return"translate("+t.x+","+t.y+")"})).attr("opacity",0).remove(),null==C.positionOptions||null==C.positionChoice||0==C.positionOptions.indexOf(C.positionChoice)||-1==C.positionOptions.indexOf(C.positionChoice)?(z.filter((function(t,e){return 1==t.depth})).append("defs").append("path").attr("class","text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-C.fontSize>0?(isNaN(t.r)?0:t.r)-C.fontSize:0,-Math.PI/2,Math.PI/2)})).attr("id",(function(e,i){return"clip-three-level-one-"+t.id+"-"+i})),W.filter((function(t,e){return 1==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-C.fontSize>0?(isNaN(t.r)?0:t.r)-C.fontSize:0,-Math.PI/2,Math.PI/2)})),M.filter((function(t,e){return 1==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-C.fontSize>0?(isNaN(t.r)?0:t.r)-C.fontSize:0,-Math.PI/2,Math.PI/2)})),z.filter((function(t,e){return 1==t.depth})).append("text").attr("class","label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:C.fontSize})).attr("font-family",(function(t,e){return C.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(C.color)?q(t._colors[C.color]):isNaN(parseFloat(C.color))?q(C.color):q(t._colors[C.color])})).attr("text-anchor","middle").attr("display",C.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),z.filter((function(t,e){return 1==t.depth})).select(".label-1").append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-three-level-one-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",C.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==C.show||null==C.show||null==C.contentOption||null==C.contentChoice||0==C.contentChoice.length?a="":1==C.contentChoice.length?0==C.contentOption.indexOf(C.contentChoice[0])?a=e.data.name:1==C.contentOption.indexOf(C.contentChoice[0])?a=n:2==C.contentOption.indexOf(C.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+L):2==C.contentChoice.length?0==C.contentOption.indexOf(C.contentChoice[0])&&1==C.contentOption.indexOf(C.contentChoice[1])?a=e.data.name+" "+n:0==C.contentOption.indexOf(C.contentChoice[0])&&2==C.contentOption.indexOf(C.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+L:1==C.contentOption.indexOf(C.contentChoice[0])&&2==C.contentOption.indexOf(C.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+L):3==C.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+L),X(a,((isNaN(e.r)?0:e.r)-C.fontSize>0?(isNaN(e.r)?0:e.r)-C.fontSize:0)*Math.PI,C.fontSize,C.fontFamily)})),W.filter((function(t,e){return 1==t.depth})).select(".label-1 textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-three-level-one-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",C.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==C.show||null==C.show||null==C.contentOption||null==C.contentChoice||0==C.contentChoice.length?a="":1==C.contentChoice.length?0==C.contentOption.indexOf(C.contentChoice[0])?a=e.data.name:1==C.contentOption.indexOf(C.contentChoice[0])?a=n:2==C.contentOption.indexOf(C.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+L):2==C.contentChoice.length?0==C.contentOption.indexOf(C.contentChoice[0])&&1==C.contentOption.indexOf(C.contentChoice[1])?a=e.data.name+" "+n:0==C.contentOption.indexOf(C.contentChoice[0])&&2==C.contentOption.indexOf(C.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+L:1==C.contentOption.indexOf(C.contentChoice[0])&&2==C.contentOption.indexOf(C.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+L):3==C.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+L),X(a,((isNaN(e.r)?0:e.r)-C.fontSize>0?(isNaN(e.r)?0:e.r)-C.fontSize:0)*Math.PI,C.fontSize,C.fontFamily)})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("display",C.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:C.fontSize})).attr("font-family",(function(t,e){return C.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(C.color)?q(t._colors[C.color]):isNaN(parseFloat(C.color))?q(C.color):q(t._colors[C.color])})).attr("text-anchor","middle").attr("opacity",1)):1==C.positionOptions.indexOf(C.positionChoice)&&(z.filter((function(t,e){return 1==t.depth})).append("text").attr("class","label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:C.fontSize})).attr("font-family",(function(t,e){return C.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(C.color)?q(t._colors[C.color]):isNaN(parseFloat(C.color))?q(C.color):q(t._colors[C.color])})).attr("text-anchor","middle").attr("display",C.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),W.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:C.fontSize})).attr("font-family",(function(t,e){return C.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(C.color)?q(t._colors[C.color]):isNaN(parseFloat(C.color))?q(C.color):q(t._colors[C.color])})).attr("text-anchor","middle").attr("display",C.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),0==C.show||null==C.show||null==C.contentOption||null==C.contentChoice||0==C.contentChoice.length||(1==C.contentChoice.length?0==C.contentOption.indexOf(C.contentChoice[0])?(z.filter((function(t,e){return 1==t.depth})).select(".label-1").text((function(t,e){return C.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/C.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),C.fontSize,C.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*C.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").text((function(t,e){return C.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/C.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),C.fontSize,C.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*C.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"}))):1==C.contentOption.indexOf(C.contentChoice[0])?(z.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){if(C.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){if(C.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"}))):2==C.contentOption.indexOf(C.contentChoice[0])&&(z.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){return C.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+L})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("dy","0.4em").text((function(e,i){return C.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+L}))):2==C.contentChoice.length?0==C.contentOption.indexOf(C.contentChoice[0])&&1==C.contentOption.indexOf(C.contentChoice[1])?(z.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),C.fontSize,C.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),C.fontSize,C.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"}))):0==C.contentOption.indexOf(C.contentChoice[0])&&2==C.contentOption.indexOf(C.contentChoice[1])?(z.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),C.fontSize,C.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+L))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),C.fontSize,C.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+L))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"}))):1==C.contentOption.indexOf(C.contentChoice[0])&&2==C.contentOption.indexOf(C.contentChoice[1])&&(z.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+L))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+L))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"}))):3==C.contentChoice.length&&(z.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),C.fontSize,C.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*C.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+L))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"})),W.filter((function(t,e){return 1==t.depth})).select(".label-1").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/C.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(C.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),C.fontSize,C.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*C.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*C.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+L))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+C.fontSize)+")"}))))),M.filter((function(t,e){return 1==t.depth})).select(".label-1").attr("display",C.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1e-6),null==O.positionOptions||null==O.positionChoice||0==O.positionOptions.indexOf(O.positionChoice)||-1==O.positionOptions.indexOf(O.positionChoice)?(z.filter((function(t,e){return 2==t.depth})).append("defs").append("path").attr("class","text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-O.fontSize>0?(isNaN(t.r)?0:t.r)-O.fontSize:0,-Math.PI/2,Math.PI/2)})).attr("id",(function(e,i){return"clip-three-level-two-"+t.id+"-"+i})),W.filter((function(t,e){return 2==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-O.fontSize>0?(isNaN(t.r)?0:t.r)-O.fontSize:0,-Math.PI/2,Math.PI/2)})),M.filter((function(t,e){return 2==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-O.fontSize>0?(isNaN(t.r)?0:t.r)-O.fontSize:0,-Math.PI/2,Math.PI/2)})),z.filter((function(t,e){return 2==t.depth})).append("text").attr("class","label-2").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:O.fontSize})).attr("font-family",(function(t,e){return O.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(O.color)?q(t._colors[O.color]):isNaN(parseFloat(O.color))?q(O.color):q(t._colors[O.color])})).attr("text-anchor","middle").attr("display",O.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),z.filter((function(t,e){return 2==t.depth})).select(".label-2").append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-three-level-two-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",O.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==O.show||null==O.show||null==O.contentOption||null==O.contentChoice||0==O.contentChoice.length?a="":1==O.contentChoice.length?0==O.contentOption.indexOf(O.contentChoice[0])?a=e.data.name:1==O.contentOption.indexOf(O.contentChoice[0])?a=n:2==O.contentOption.indexOf(O.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+P):2==O.contentChoice.length?0==O.contentOption.indexOf(O.contentChoice[0])&&1==O.contentOption.indexOf(O.contentChoice[1])?a=e.data.name+" "+n:0==O.contentOption.indexOf(O.contentChoice[0])&&2==O.contentOption.indexOf(O.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+P:1==O.contentOption.indexOf(O.contentChoice[0])&&2==O.contentOption.indexOf(O.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+P):3==O.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+P),X(a,((isNaN(e.r)?0:e.r)-O.fontSize>0?(isNaN(e.r)?0:e.r)-O.fontSize:0)*Math.PI,O.fontSize,O.fontFamily)})),W.filter((function(t,e){return 2==t.depth})).select(".label-2 textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-three-level-two-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",O.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==O.show||null==O.show||null==O.contentOption||null==O.contentChoice||0==O.contentChoice.length?a="":1==O.contentChoice.length?0==O.contentOption.indexOf(O.contentChoice[0])?a=e.data.name:1==O.contentOption.indexOf(O.contentChoice[0])?a=n:2==O.contentOption.indexOf(O.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+P):2==O.contentChoice.length?0==O.contentOption.indexOf(O.contentChoice[0])&&1==O.contentOption.indexOf(O.contentChoice[1])?a=e.data.name+" "+n:0==O.contentOption.indexOf(O.contentChoice[0])&&2==O.contentOption.indexOf(O.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+P:1==O.contentOption.indexOf(O.contentChoice[0])&&2==O.contentOption.indexOf(O.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+P):3==O.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+P),X(a,((isNaN(e.r)?0:e.r)-O.fontSize>0?(isNaN(e.r)?0:e.r)-O.fontSize:0)*Math.PI,O.fontSize,O.fontFamily)})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("display",O.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:O.fontSize})).attr("font-family",(function(t,e){return O.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(O.color)?q(t._colors[O.color]):isNaN(parseFloat(O.color))?q(O.color):q(t._colors[O.color])})).attr("text-anchor","middle").attr("opacity",1)):1==O.positionOptions.indexOf(O.positionChoice)&&(z.filter((function(t,e){return 2==t.depth})).append("text").attr("class","label-2").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:O.fontSize})).attr("font-family",(function(t,e){return O.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(O.color)?q(t._colors[O.color]):isNaN(parseFloat(O.color))?q(O.color):q(t._colors[O.color])})).attr("text-anchor","middle").attr("display",O.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),W.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:O.fontSize})).attr("font-family",(function(t,e){return O.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(O.color)?q(t._colors[O.color]):isNaN(parseFloat(O.color))?q(O.color):q(t._colors[O.color])})).attr("text-anchor","middle").attr("display",O.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),0==O.show||null==O.show||null==O.contentOption||null==O.contentChoice||0==O.contentChoice.length||(1==O.contentChoice.length?0==O.contentOption.indexOf(O.contentChoice[0])?(z.filter((function(t,e){return 2==t.depth})).select(".label-2").text((function(t,e){return O.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/O.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),O.fontSize,O.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*O.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").text((function(t,e){return O.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/O.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),O.fontSize,O.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*O.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"}))):1==O.contentOption.indexOf(O.contentChoice[0])?(z.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){if(O.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){if(O.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"}))):2==O.contentOption.indexOf(O.contentChoice[0])&&(z.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){return O.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+P})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("dy","0.4em").text((function(e,i){return O.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+P}))):2==O.contentChoice.length?0==O.contentOption.indexOf(O.contentChoice[0])&&1==O.contentOption.indexOf(O.contentChoice[1])?(z.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),O.fontSize,O.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),O.fontSize,O.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"}))):0==O.contentOption.indexOf(O.contentChoice[0])&&2==O.contentOption.indexOf(O.contentChoice[1])?(z.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),O.fontSize,O.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+P))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),O.fontSize,O.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+P))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"}))):1==O.contentOption.indexOf(O.contentChoice[0])&&2==O.contentOption.indexOf(O.contentChoice[1])&&(z.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+P))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+P))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"}))):3==O.contentChoice.length&&(z.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),O.fontSize,O.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*O.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+P))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"})),W.filter((function(t,e){return 2==t.depth})).select(".label-2").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/O.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(O.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),O.fontSize,O.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*O.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*O.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+P))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+O.fontSize)+")"}))))),M.filter((function(t,e){return 2==t.depth})).select(".label-2").attr("display",O.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1e-6),null==F.positionOptions||null==F.positionChoice||1==F.positionOptions.indexOf(F.positionChoice)||-1==F.positionOptions.indexOf(F.positionChoice)?(z.filter((function(t,e){return 3==t.depth})).append("text").attr("class","label-3").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:F.fontSize})).attr("font-family",(function(t,e){return F.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(F.color)?q(t._colors[F.color]):isNaN(parseFloat(F.color))?q(F.color):q(t._colors[F.color])})).attr("text-anchor","middle").attr("display",F.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),W.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:F.fontSize})).attr("font-family",(function(t,e){return F.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(F.color)?q(t._colors[F.color]):isNaN(parseFloat(F.color))?q(F.color):q(t._colors[F.color])})).attr("text-anchor","middle").attr("display",F.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),0==F.show||null==F.show||null==F.contentOption||null==F.contentChoice||0==F.contentChoice.length||(1==F.contentChoice.length?0==F.contentOption.indexOf(F.contentChoice[0])?(z.filter((function(t,e){return 3==t.depth})).select(".label-3").text((function(t,e){return F.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/F.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),F.fontSize,F.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*F.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").text((function(t,e){return F.fontSize>(isNaN(t.r)?0:1.5*t.r)?"":t.data.name})).each((function(t){for(var e,i=Math.floor(1.5*(isNaN(t.r)?0:t.r)/F.fontSize),n=d3.select(this),a=n.text().split("").reverse(),o=[],r=0,l=(n.node().getBoundingClientRect().height,+n.attr("x")),s=+n.attr("y"),u=n.text(null).append("tspan").attr("x",l).attr("y",s);e=a.pop();){o.push(e);if(r==i-1){var c=X(o.join(""),1.5*(isNaN(t.r)?0:t.r),F.fontSize,F.fontFamily);u.text(c)}else u.text(o.join("")+"");u.node().getComputedTextLength()>1.6*(isNaN(t.r)?0:t.r)&&(r++,o.pop(),u.text(o.join("")),o=[e],u=n.append("tspan").attr("x",l).attr("y",r*F.fontSize*1.1+s).text(e))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"}))):1==F.contentOption.indexOf(F.contentChoice[0])?(z.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("dy","0.4em").text((function(e,i){if(F.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("dy","0.4em").text((function(e,i){if(F.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var n=isNaN(r[0].value)?0:e.value/r[0].value*100;return n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%"}))):2==F.contentOption.indexOf(F.contentChoice[0])&&(z.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("dy","0.4em").text((function(e,i){return F.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+A})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("dy","0.4em").text((function(e,i){return F.fontSize>(isNaN(e.r)?0:1.5*e.r)?"":E(e.value,t._numberStyle,t._decimalPlaces)+A}))):2==F.contentChoice.length?0==F.contentOption.indexOf(F.contentChoice[0])&&1==F.contentOption.indexOf(F.contentChoice[1])?(z.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),F.fontSize,F.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),F.fontSize,F.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+l).text(c)}}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"}))):0==F.contentOption.indexOf(F.contentChoice[0])&&2==F.contentOption.indexOf(F.contentChoice[1])?(z.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),F.fontSize,F.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+A))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),r=+n.attr("y"),l=n.text(null).append("tspan").attr("x",o).attr("y",r);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var s=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),F.fontSize,F.fontFamily);l.text(s),a++,i>1&&(l=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+r).text(E(e.value,t._numberStyle,t._decimalPlaces)+A))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"}))):1==F.contentOption.indexOf(F.contentChoice[0])&&2==F.contentOption.indexOf(F.contentChoice[1])&&(z.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+A))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=isNaN(r[0].value)?0:e.value/r[0].value*100,c=u=null==t._decimalPlaces?parseFloat(u).toFixed(1)+"%":E(u,t._numberStyle,t._decimalPlaces)+"%";s.text(c),a++,i>1&&(s=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+A))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"}))):3==F.contentChoice.length&&(z.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),F.fontSize,F.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*F.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+A))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").text(null).each((function(e){for(var i=Math.floor(1.5*(isNaN(e.r)?0:e.r)/F.fontSize),n=d3.select(this),a=(n.text().split("").reverse(),0),o=(n.node().getBoundingClientRect().height,+n.attr("x")),l=+n.attr("y"),s=n.text(null).append("tspan").attr("x",o).attr("y",l);a<(F.fontSize>(isNaN(e.r)?0:1.5*e.r)?0:1);){var u=X(e.data.name,1.5*(isNaN(e.r)?0:e.r),F.fontSize,F.fontFamily);if(s.text(u),a++,i>1){var c=isNaN(r[0].value)?0:e.value/r[0].value*100;c=null==t._decimalPlaces?parseFloat(c).toFixed(1)+"%":E(c,t._numberStyle,t._decimalPlaces)+"%",s=n.append("tspan").attr("x",o).attr("y",a*F.fontSize*1.1+l).text(c)}i>2&&(s=n.append("tspan").attr("x",o).attr("y",(a+1)*F.fontSize*1.1+l).text(E(e.value,t._numberStyle,t._decimalPlaces)+A))}})).attr("transform",(function(t){return"translate(0,"+(-d3.select(this).node().getBoundingClientRect().height/2+F.fontSize)+")"}))))):0==F.positionOptions.indexOf(F.positionChoice)&&(z.filter((function(t,e){return 3==t.depth})).append("defs").append("path").attr("class","text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-F.fontSize>0?(isNaN(t.r)?0:t.r)-F.fontSize:0,-Math.PI/2,Math.PI/2)})).attr("id",(function(e,i){return"clip-three-level-three-"+t.id+"-"+i})),W.filter((function(t,e){return 3==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-F.fontSize>0?(isNaN(t.r)?0:t.r)-F.fontSize:0,-Math.PI/2,Math.PI/2)})),M.filter((function(t,e){return 3==t.depth})).select(".text-clip").attr("d",(function(t){return e((isNaN(t.r)?0:t.r)-F.fontSize>0?(isNaN(t.r)?0:t.r)-F.fontSize:0,-Math.PI/2,Math.PI/2)})),z.filter((function(t,e){return 3==t.depth})).append("text").attr("class","label-3").attr("opacity",1e-6).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:F.fontSize})).attr("font-family",(function(t,e){return F.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(F.color)?q(t._colors[F.color]):isNaN(parseFloat(F.color))?q(F.color):q(t._colors[F.color])})).attr("text-anchor","middle").attr("display",F.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),z.filter((function(t,e){return 3==t.depth})).select(".label-3").append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-three-level-three-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",F.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==F.show||null==F.show||null==F.contentOption||null==F.contentChoice||0==F.contentChoice.length?a="":1==F.contentChoice.length?0==F.contentOption.indexOf(F.contentChoice[0])?a=e.data.name:1==F.contentOption.indexOf(F.contentChoice[0])?a=n:2==F.contentOption.indexOf(F.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+A):2==F.contentChoice.length?0==F.contentOption.indexOf(F.contentChoice[0])&&1==F.contentOption.indexOf(F.contentChoice[1])?a=e.data.name+" "+n:0==F.contentOption.indexOf(F.contentChoice[0])&&2==F.contentOption.indexOf(F.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+A:1==F.contentOption.indexOf(F.contentChoice[0])&&2==F.contentOption.indexOf(F.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+A):3==F.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+A),X(a,((isNaN(e.r)?0:e.r)-F.fontSize>0?(isNaN(e.r)?0:e.r)-F.fontSize:0)*Math.PI,F.fontSize,F.fontFamily)})),W.filter((function(t,e){return 3==t.depth})).select(".label-3 textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#clip-three-level-three-"+t.id+"-"+i})).text((function(e,i){var n=isNaN(r[0].value)?0:e.value/r[0].value*100;if(n=null==t._decimalPlaces?parseFloat(n).toFixed(1)+"%":E(n,t._numberStyle,t._decimalPlaces)+"%",F.fontSize>(isNaN(e.r)?0:1.5*e.r))return"";var a="";return 0==F.show||null==F.show||null==F.contentOption||null==F.contentChoice||0==F.contentChoice.length?a="":1==F.contentChoice.length?0==F.contentOption.indexOf(F.contentChoice[0])?a=e.data.name:1==F.contentOption.indexOf(F.contentChoice[0])?a=n:2==F.contentOption.indexOf(F.contentChoice[0])&&(a=E(e.value,t._numberStyle,t._decimalPlaces)+A):2==F.contentChoice.length?0==F.contentOption.indexOf(F.contentChoice[0])&&1==F.contentOption.indexOf(F.contentChoice[1])?a=e.data.name+" "+n:0==F.contentOption.indexOf(F.contentChoice[0])&&2==F.contentOption.indexOf(F.contentChoice[1])?a=e.data.name+" "+E(e.value,t._numberStyle,t._decimalPlaces)+A:1==F.contentOption.indexOf(F.contentChoice[0])&&2==F.contentOption.indexOf(F.contentChoice[1])&&(a=n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+A):3==F.contentChoice.length&&(a=e.data.name+" "+n+" "+E(e.value,t._numberStyle,t._decimalPlaces)+A),X(a,((isNaN(e.r)?0:e.r)-F.fontSize>0?(isNaN(e.r)?0:e.r)-F.fontSize:0)*Math.PI,F.fontSize,F.fontFamily)})),W.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("display",F.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("font-size",(function(t,e){return 0==(isNaN(t.r)?0:t.r)?0:F.fontSize})).attr("font-family",(function(t,e){return F.fontFamily})).attr("fill",(function(e,i){return 0==parseFloat(F.color)?q(t._colors[F.color]):isNaN(parseFloat(F.color))?q(F.color):q(t._colors[F.color])})).attr("text-anchor","middle").attr("opacity",1)),M.filter((function(t,e){return 3==t.depth})).select(".label-3").attr("display",F.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1e-6)}}(i),t}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"colors",value:function(t){return arguments.length?(this._colors=t,this):this._colors}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"maxFontSize",value:function(t){return arguments.length?(this._maxFontSize=parseFloat(t),this):this._maxFontSize}},{key:"minFontSize",value:function(t){return arguments.length?(this._minFontSize=parseFloat(t),this):this._minFontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"level1Label",value:function(t){return arguments.length?(this._level1Label=t,this):this._level1Label}},{key:"level2Label",value:function(t){return arguments.length?(this._level2Label=t,this):this._level2Label}},{key:"level3Label",value:function(t){return arguments.length?(this._level3Label=t,this):this._level3Label}},{key:"labelLevel",value:function(t){return arguments.length?(this._labelLevel=t,this):this._labelLevel}},{key:"tip",value:function(t){return arguments.length?(this._tip=t,this):this._tip}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),i}(at),zo=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=this.generateColorList(t.output.length>0?t.output[0].children.length:0),i=t.tip,n=t.output;function a(t,e,i){var n=d3.scaleLinear().clamp(!1).domain([0,1]);if(t&&/\[/.test(t)){var a=x(t),o=[],r=!0,l=!1,s=void 0;try{for(var u,c=a[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var h=u.value.split(":");if("angle"!=h[1]){var d=d3.hsl(q(h[0]));1===e?d.l-=.08:(n.range([d.l-Math.min(.4,.08*e)/2,d.l+Math.min(.4,.08*e)/2]),d.l=n(i));var _="";d&&(_=d+":"+h[1]),o.push(_)}}}catch(t){l=!0,s=t}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}return JSON.stringify(o)}var f=d3.hsl(t);return 1===e?f.l-=.08:(n.range([f.l-Math.min(.4,.08*e)/2,f.l+Math.min(.4,.08*e)/2]),f.l=n(i)),f}return t.output=function(t,e){return"one-level"==i?t.forEach((function(t){t.children.forEach((function(t,i){t.color=e[i]}))})):"two-level"==i?t.forEach((function(t){t.children.forEach((function(t,i){t.color=e[i],Array.isArray(t.children)&&t.children.forEach((function(e){e.color=a(t.color,2,1)}))}))})):"three-level"==i&&t.forEach((function(t){t.children.forEach((function(t,i){t.color=e[i],Array.isArray(t.children)&&t.children.forEach((function(e){e.color=a(t.color,2,1),Array.isArray(e.children)&&e.children.forEach((function(e){e.color=a(t.color,2,2)}))}))}))})),t}(n,e),t}}]),e}(it);function Mo(t,e){var i=0,n=1,a=2,o=3,r=4,l=[],s=[];e.forEach((function(t){"层级1"===t.name?(i=t.index,l.push(t.index),null!=t.index&&s.push(t.name)):"层级2"===t.name?(n=t.index,l.push(t.index),null!=t.index&&s.push(t.name)):"层级3"===t.name?(a=t.index,l.push(t.index),null!=t.index&&s.push(t.name)):"数量"===t.name?o=t.index:"时间"===t.name&&(r=t.index)}));var u=l.filter((function(t){return null!=t}));if(0==u.length)return{output:[],time:[],sumArr:[],tip:"one-level"};1==u.length?(i=u[0],n=null,a=null):2==u.length&&(i=u[0],n=u[1],a=null),Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[i]:("00"+e[i]).substr((""+e[i]).length)));return t};var c=[],h=[],d=[];return null==a&&null!=n?function(){var e=[],a=[];c=[],h=[],d=[],t.slice(1).forEach((function(t,i){var n=new Date(t[r]).getTime();new Date(n).format("yyyy-MM-dd");e.push(String(t[r]))})),d=[].concat(F(new Set(e))),t.slice(1).forEach((function(t,e){a.push({source:t[i],target:t[n]})}));for(var l=function(t){var e=[],i=function(t){if(e.find((function(e){return e.source===t.source&&e.target===t.target})))return"continue";e.push(t)},n=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(n=(r=l.next()).done);n=!0)i(r.value)}catch(t){a=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}return e}(a),s=[],u=function(e){var i=[];t.slice(1).forEach((function(t,n){d[e]==t[r]&&i.push(t)})),s.push(i)},_=0;_<d.length;_++)u(_);for(var f=[],p=0;p<l.length;p++){for(var y=[],x=0;x<t[1].length;x++)y.push(t[1][x]);y[i]=l[p].source,y[n]=l[p].target,y[o]=0,f.push(y)}for(var g=[],v=0;v<s.length;v++){for(var m=[],b=function(t){var e=[];s[v].forEach((function(e,a){f[t][i]==e[i]&&f[t][n]==e[n]&&(f[t][o]=e[o],f[t][r]=e[r])}));for(var a=0;a<f[t].length;a++)e.push(f[t][a]);m.push(e)},S=0;S<f.length;S++)b(S);g.push(m)}for(var k=function(t){var e={};g[t].forEach((function(t,a){var r=t[i],l=t[n],s=t[o];e[r]||(e[r]={name:r,key:r+"-s-"+a,index:a,country:r,province:l,children:[]}),l&&e[r].children.push({name:null==l?"":l||r,key:l+"-t-"+a,index:a,country:r,province:l,size:""==s||isNaN(parseFloat(s))||null==s||null==s?0:parseFloat(s)})}));var a=[];for(var r in e)a.push(e[r]);var l=d3.sum(g[t],(function(t){return t[o]}));h.push(l);var s={name:"root",country:"root",province:"root",children:[]};for(var u in a)s.children.push(a[u]);c.push(s)},w=0;w<g.length;w++)k(w)}():function(){var e=[],l=[];c=[],h=[],d=[],t.slice(1).forEach((function(t,i){var n=new Date(t[r]).getTime();new Date(n).format("yyyy-MM-dd");e.push(String(t[r]))})),d=[].concat(F(new Set(e))),t.slice(1).forEach((function(t,e){l.push({source:t[i],target:t[n],son:t[a]})}));for(var s=function(t){var e=[],i=function(t){if(e.find((function(e){return e.source===t.source&&e.target===t.target&&e.son===t.son})))return"continue";e.push(t)},n=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(n=(r=l.next()).done);n=!0)i(r.value)}catch(t){a=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}return e}(l),u=[],_=function(e){var i=[];t.slice(1).forEach((function(t,n){d[e]==t[r]&&i.push(t)})),u.push(i)},f=0;f<d.length;f++)_(f);for(var p=[],y=0;y<s.length;y++){for(var x=[],g=0;g<t[1].length;g++)x.push(t[1][g]);x[i]=s[y].source,x[n]=s[y].target,x[a]=s[y].son,x[o]=0,p.push(x)}for(var v=[],m=0;m<u.length;m++){for(var b=[],S=function(t){var e=[];u[m].forEach((function(e,l){p[t][i]==e[i]&&p[t][n]==e[n]&&p[t][a]==e[a]&&(p[t][o]=e[o],p[t][r]=e[r])}));for(var l=0;l<p[t].length;l++)e.push(p[t][l]);b.push(e)},k=0;k<p.length;k++)S(k);v.push(b)}for(var w=function(t){var e={};v[t].forEach((function(t,r){var l=t[i],s=t[n];t[o],t[a];e[l]?e[l][s]?e[l][s].push():(e[l][s]=[],s&&(e[l][s]=[],e[l].children.push({name:null==s?"":s||l,key:s+"-t-"+r,index:r,country:l,province:s,children:[]}))):(e[l]={name:l,key:l+"-s-"+r,index:r,country:l,province:s,children:[]},s&&(e[l][s]=[],e[l].children.push({name:null==s?"":s||l,key:s+"-t-"+r,index:r,country:l,province:s,children:[]})))}));var r={};v[t].forEach((function(t,e){var l=t[i],s=t[n],u=t[o],c=t[a];s&&(r[s]?r[s||l].children.push({name:"NA"==c?s||l:c,key:c+"-t-"+e,country:l,province:s,index:e,size:""==u||isNaN(parseFloat(u))||null==u||null==u?0:parseFloat(u)}):r[s||l]={name:s||l,key:s+"-s-"+e,index:e,country:l,province:s,children:[{name:"NA"==c?s||l:c,key:c+"-t-"+e,country:l,province:s,index:e,size:""==u||isNaN(parseFloat(u))||null==u||null==u?0:parseFloat(u)}]})}));var l=[];for(var s in e)l.push(e[s]);var u=[];for(var d in r)u.push(r[d]);l.forEach((function(t,e){t.children.forEach((function(t,e){u.forEach((function(e,i){t.name==e.name&&(t.children=e.children)}))}))}));var _=d3.sum(v[t],(function(t){return t[o]}));h.push(_);var f={name:"root",country:"root",province:"root",children:[]};for(var p in l)f.children.push(l[p]);c.push(f)},C=0;C<v.length;C++)w(C)}(),null==a&&null==n&&function(){var e=[],n=[];c=[],h=[],d=[],t.slice(1).forEach((function(t,i){var n=new Date(t[r]).getTime();new Date(n).format("yyyy-MM-dd");e.push(String(t[r]))})),d=[].concat(F(new Set(e))),t.slice(1).forEach((function(t,e){n.push({source:t[i]})}));for(var a=function(t){var e=[],i=function(t){if(e.find((function(e){return e.source===t.source})))return"continue";e.push(t)},n=!0,a=!1,o=void 0;try{for(var r,l=t[Symbol.iterator]();!(n=(r=l.next()).done);n=!0)i(r.value)}catch(t){a=!0,o=t}finally{try{!n&&l.return&&l.return()}finally{if(a)throw o}}return e}(n),l=[],s=function(e){var i=[];t.slice(1).forEach((function(t,n){d[e]==t[r]&&i.push(t)})),l.push(i)},u=0;u<d.length;u++)s(u);for(var _=[],f=0;f<a.length;f++){for(var p=[],y=0;y<t[1].length;y++)p.push(t[1][y]);p[i]=a[f].source,p[o]=0,_.push(p)}for(var x=[],g=0;g<l.length;g++){for(var v=[],m=function(t){var e=[];l[g].forEach((function(e,n){_[t][i]==e[i]&&(_[t][o]=e[o],_[t][r]=e[r])}));for(var n=0;n<_[t].length;n++)e.push(_[t][n]);v.push(e)},b=0;b<_.length;b++)m(b);x.push(v)}for(var S=function(t){var e={};x[t].forEach((function(t,n){var a=t[i],r=t[o];e[a]||(e[a]={name:a,key:a+"-s-"+n,index:n,country:a,size:""==r||isNaN(parseFloat(r))||null==r||null==r?0:parseFloat(r)})}));var n=[];for(var a in e)n.push(e[a]);var r=d3.sum(x[t],(function(t){return t[o]}));h.push(r);var l={name:"root",country:"root",province:"root",children:[]};for(var s in n)l.children.push(n[s]);c.push(l)},k=0;k<x.length;k++)S(k)}(),{output:c,time:d,sumArr:h,tip:null==a?null==a&&null==n?"one-level":"two-level":"three-level",labelLevel:s,tooltipLabel:t[0][o]||""}}var Do=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","pack-chart"),i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=[],i._moveStyle="",i._endPause=0,i._options=[["packedcircleTransitionDuration","换位动画","0.05"]],i._unitShow=!1,i._unitWord="单位：",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="数据来源：",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._level1Label={titlename:"层次1",show:!0,fontSize:32,color:0,fontFamily:"阿里巴巴普惠体 常规",contentOption:["名称","百分比","数值"],contentChoice:["名称"],positionOptions:["靠边显示","居中显示"],positionChoice:"靠边显示"},i._level2Label={titlename:"层次2",show:!0,fontSize:20,color:0,fontFamily:"阿里巴巴普惠体 常规",contentOption:["名称","百分比","数值"],contentChoice:["名称"],positionOptions:["靠边显示","居中显示"],positionChoice:"靠边显示"},i._level3Label={titlename:"层次3",show:!0,fontSize:18,color:0,fontFamily:"阿里巴巴普惠体 常规",contentOption:["名称","百分比","数值"],contentChoice:["名称"]},i._timeLabel={titlename:"时间标签显示",show:!0,fontSize:"40",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["上居左","上居中","上居右","下居左","下居中","下居右"],positionChoice:"下居右"},i._DynamicInterrupt=!0,i.timer=null,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;clearTimeout(t.timer);var e=0,i=1e3*t._options[0][2]-e;t.mainGroup.selectAll("*").remove(),t.flag=0,t.pack=new Wo(this.mainGroup),t.timeFlag=0;var n=t.pack,a=(t.tooltip,t._data),o=t.widthOfNoMargin,r=t.heightOfMainGroup,l=t.mainGroup.select(".time").empty()?t.mainGroup.append("text").attr("class","time"):t.mainGroup.select(".time");l.attr("display",t._timeLabel.show?"block":"none").attr("font-size",t._timeLabel.fontSize+"px").attr("font-family",t._timeLabel.fontFamily).attr("fill",q(t._timeLabel.color)),null==t._timeLabel.positionOptions||null==t._timeLabel.positionChoice||-1==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.attr("x",0).attr("y",0):0==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.attr("x",0).attr("y",0).attr("text-anchor","start").attr("dy","0.8em"):1==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.attr("x",o/2).attr("y",0).attr("text-anchor","middle").attr("dy","0.8em"):2==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.attr("x",o).attr("y",0).attr("text-anchor","end").attr("dy","0.8em"):3==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.attr("x",0).attr("y",r).attr("text-anchor","start").attr("dy","-0.1em"):4==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.attr("x",o/2).attr("y",r).attr("text-anchor","middle").attr("dy","-0.1em"):5==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)&&l.attr("x",o).attr("y",r).attr("text-anchor","end").attr("dy","-0.1em"),t.pause=function(){},t.clean=function(){clearTimeout(t.timer)},t.timeChange=function(){},setTimeout((function(){function s(){if(clearTimeout(t.timer),t.flag<a.output.length){var n=+new Date;u();var o=+new Date;e=o-n,i=1e3*t._options[0][2]-e>0?1e3*t._options[0][2]-e:0,t.timer=setTimeout(s,t._transition&&1e3*t._duration-e>0?1e3*t._duration-e:0)}else clearTimeout(t.timer)}function u(){0==a.output.length||t.flag>a.output.length||t.flag==a.output.length?clearTimeout(t.timer):(0==t._timeLabel.show||null==t._timeLabel.show||null==t._timeLabel.positionOptions||null==t._timeLabel.positionChoice||-1==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?l.text(null):l.text(a.time[t.flag]),n.data(a.output[t.flag]).labelLevel(a.labelLevel).tip(a.tip).width(o).height(r-(t._timeLabel.show?parseFloat(t._timeLabel.fontSize)+5:0)).colors(t._colorList).transition(t._transition).duration(i).maxFontSize(t._maxFontSize).minFontSize(t._minFontSize).level1Label(t._level1Label).level2Label(t._level2Label).level3Label(t._level3Label).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){d3.select(this).transition().duration(30).style("opacity",.8);var n=[{text:""+e.data.name,color:e.data.color},{text:a.tooltipLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().duration(30).style("opacity",1),t.tooltip.hide()})),n.update(),0==t._timeLabel.show||null==t._timeLabel.show||null==t._timeLabel.positionOptions||null==t._timeLabel.positionChoice||-1==t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)?t.mainGroup.select(".pack-circle").attr("transform","translate(0,0)"):0!=t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)&&1!=t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)&&2!=t._timeLabel.positionOptions.indexOf(t._timeLabel.positionChoice)||t.mainGroup.select(".pack-circle").attr("transform","translate(0,"+(t._timeLabel.show?parseFloat(t._timeLabel.fontSize)+5:0)+")")),t.flag++,t.flag==a.output.length&&clearTimeout(t.timer)}t.flag=0,t._DynamicInterrupt||s(),t.pause=function(e){e?(clearTimeout(t.timer),t.flag--,t._duration=0,i=0,u()):(t._duration=t._copyDuration,i=1e3*t._options[0][2],s())},t.timeChange=function(e){e=String(e),clearTimeout(t.timer),t.flag=a.time.indexOf(e),t.flag==a.output.length||t.flag>a.output.length?(t.flag=a.time.indexOf(e),a.time.indexOf(e)<=0&&(t.flag=0),t._duration=0,i=0,u(),t._duration=t._copyDuration,i=1e3*t._options[0][2],s()):(t.flag=a.time.indexOf(e),a.time.indexOf(e)<=0&&(t.flag=0),t._DynamicInterrupt?(t._duration=0,i=0,u()):(t.flag=a.time.indexOf(e)-1,a.time.indexOf(e)<=0&&(t.flag=0),t._duration=0,i=0,u(),a.time.indexOf(e)<=0&&(t.flag=0),t._duration=t._copyDuration,i=1e3*t._options[0][2],s()))}}),0)}},{key:"onInterruptChange",value:function(t){this._DynamicInterrupt=t,this.pause(t)}},{key:"onTimeChange",value:function(t){this.timeChange(t)}},{key:"onCleanTimer",value:function(){this._DynamicInterrupt=!0,this.clean()}},{key:"configLegend",value:function(){var t=(this._data.output[0]||[]).children.filter((function(t){return t.constructor===Object}))||[];this.legend.data(t).onClick((function(t){var e=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}))}},{key:"sortData",value:function(){}},{key:"setSelfOption",value:function(t){t.display;var e=t.label,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.timerControl;0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._startDelay=i.startDelay?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n.text?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?n.color:this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a.text?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?a.color:this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._level1Label=e?e.pc_level1Label:this._level1Label,this._level2Label=e?e.pc_level2Label:this._level2Label,this._level3Label=e?e.pc_level3Label:this._level3Label,this._timeLabel=e?e.timeLabel:this._timeLabel),0!==Object.getOwnPropertyNames(o).length&&(this._duration=o.frameDuration?o.frameDuration:this._duration,this._copyDuration=o.frameDuration?o.frameDuration:0,this._options=o.options?o.options:this._options)}},{key:"buildOption",value:function(t,e){var i=new zo(t,e);return i.dataSolveFunc(Mo),i}},{key:"activeData",get:function(){return this.sortedDataCopy}}]),e}(nt),Ro="axis-group",No="x-title",To=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-bar-axis-x"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=void 0;(s=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(.5).tickPadding(t._tickPadding).tickFormat(t._tickFormat);var u=n.select(".axis-group").empty()?n.append("g").attr("class",Ro):n.select(".axis-group"),c=t._labelAngle;"自动"==t._labelDirection&&(c=r),u.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).call(s).on("start",(function(i,n){u.selectAll(".tick text").remove(),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),"竖排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i,n){var a=B(l[n],t._fontSize,t._fontFamily)-t._fontSize,o=I(t._fontSize,c,0,t._labelDirection,e),r=Math.sin(Math.abs(o.angle)*Math.PI/180)*a,s=Math.cos(Math.abs(o.angle)*Math.PI/180)*a;return"top"==e?"translate("+(o.x+(o.angle<0?-r+(-90==o.angle?a/2:0):r-(90==o.angle?a/2:0)))+","+(o.y-s)+")":"translate("+(o.x+(o.angle<0?-(-90==o.angle?a/2:0):90==o.angle?a/2:0))+","+o.y+")"})).append("text").text((function(t,e){return l[e]})).each((function(i,n){var o=d3.select(this),r=o.text().split("").reverse();"rev"==I(t._fontSize,c,0,t._labelDirection,e).flag&&(r=o.text().split(""));for(var l,s=[],u=0,h=0,d=+o.attr("x"),_=+o.attr("y"),f=o.text(null).append("tspan").attr("x",d).attr("y",_);l=r.pop();)s.push(l),f.text(s.join("")),f.node().getComputedTextLength()>0&&(0==h||++u,s.pop(),f.text(s.join("")),s=[l],f=o.append("tspan").attr("x",d).attr("y",u*parseFloat(.9*a*1.2)+_).text(l)),h++})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"横排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,t._labelDirection,e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){return l[e]})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"自动"==t._labelDirection&&u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,"横排",e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){return l[e]})).style("text-anchor",(function(i){return I(t._fontSize,c,0,"横排",e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,"横排",e).angle+")"}))}));var h=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)})),d=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove(),d3.selectAll(d).remove();var _=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var f=n.select(".x-title").empty()?n.append("g").attr("class",No):n.select(".x-title"),p=f.select("text").empty()?f.append("text"):f.select("text");l.length,d3.max(l,(function(e){return R(e,a,t._fontFamily)}));"top"===e?(f.call(o,_/2+Math.abs(i.range()[0]),-(this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0))),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",-6-.2*a).text(t._title)):(f.call(o,_/2+Math.abs(i.range()[0]),this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",a+6).text(t._title))}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0,o=0,r=0,l=!1;function s(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a,t._tickTextWidth=o,t._rotateFlag=l}var u=t._scaleFunc,c=t._type,h=t._fontSize,d=(t._minTickDistance,t._allowedMaxTextHeight);if("自动"==t._labelDirection){var _=Math.abs(u.range()[0]-u.range()[1]),f=void 0,p=void 0;if(e="category"===c?u.domain():u.ticks(t._tickCount),"number"===c&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0])),i=e,"number"===c){for(var y=[],x=0;x<e.length;x++)y.push(E(e[x],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=y}if(function(){var l=!1;if(f=_/e.length,"number"===c){for(var u=[],d=0;d<e.length;d++)u.push(E(e[d],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=u}return(p=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,h,t._fontFamily)}))||0)<.8*f&&(n=0,a=0==p?0:1.125*h,o=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,r=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,t._tickShow||(o=0),s(),l=!0),l}())return t;n=0;1*p<d?(a=0==p?0:1.125*h,i=i,o=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,r=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,t._tickShow||(o=0),l=!1):(a=0==p?0:1.125*h,i=i.map((function(e){return X(e,a/1,h,t._fontFamily)})),o=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,r=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,t._tickShow||(o=0));var g=_/e.length;if(p>g){var v=Math.ceil(p/g);e=e.filter((function(t,e){return e%v==0})),i=i.filter((function(t,e){return e%v==0})),u(e[e.length-1])+p/2>u.range()[1]+15&&e.pop()}return s(),t}if("横排"==t._labelDirection){var m=Math.abs(u.range()[0]-u.range()[1]);e="category"===c?u.domain():u.ticks(t._tickCount),"number"===c&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var b=[];if("number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var S=u.domain()[0],k=(Math.abs(parseFloat(S))>1?Math.round(parseFloat(S)):S)||0,w=u.domain()[1]||1;if(0!=t._countOfLabel){var C=w-k,O=t._countOfLabel,F=Math.ceil(Math.abs(C/t._countOfLabel)),L=Math.ceil(m/h*2),P=d3.tickStep(k,w,L);t._countOfLabel<P&&(F=Math.ceil(Math.abs(C/P)),O=P),w+=F;for(var A=0;A<F+1;A++)b.push(k+A*O)}else b.push(k);"number"===c&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||b.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||b.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(b[b.length-1]>t._xRange[1]&&b.pop(),b.push(t._xRange[1]))),b=Array.from(new Set(b))),0!=t._countOfLabel&&u.domain([d3.min(b),d3.max(b)]);var W=[];b.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;W.push(i)}})),W=W.filter((function(t){return t<=8})),b=b.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(W)&&(t=parseFloat(t).toFixed(d3.max(W)))}return t}))}if(i=e,"number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=b),"number"==c){for(var z=[],M=0;M<e.length;M++)z.push(E(e[M],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=z}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var D=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,h,t._fontFamily)}))||0,N=D?h:0,T=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,G=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),j=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),Y=D*j+N*G,H=N*j+D*G;if(H<d)a=H,i=i,o=Y,r=Y,t._tickShow||(o=0),l=!0;else{a=d,i=i.map((function(e){return X(e,a/G,h,t._fontFamily)}));var V=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,$=V*j+N*G;o=$,r=$,a=N*j+V*G,t._tickShow||(o=0),l=!0}T%180!=0&&90!=Math.abs(n)||(o/=2,r/=2);var q=m/e.length;if(("category"===c||null==t._countOfLabel)&&r*(T%180==0||90==Math.abs(n)?2:1)>q){var U=Math.ceil(r*(T%180==0||90==Math.abs(n)?2:1)*1.2/q);e=e.filter((function(t,e){return e%U==0})),i=i.filter((function(t,e){return e%U==0}))}return s(),t}if("竖排"==t._labelDirection){var Z,Q=Math.abs(u.range()[0]-u.range()[1]);e="category"===c?u.domain():u.ticks(t._tickCount),"number"===c&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var K=[];if("number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var J=u.domain()[0],tt=(Math.abs(parseFloat(J))>1?Math.round(parseFloat(J)):J)||0,et=u.domain()[1]||1;if(0!=t._countOfLabel){var it=et-tt,nt=t._countOfLabel,at=Math.ceil(Math.abs(it/t._countOfLabel)),ot=Math.ceil(Q/h*2),rt=d3.tickStep(tt,et,ot);t._countOfLabel<rt&&(at=Math.ceil(Math.abs(it/rt)),nt=rt),et+=at;for(var lt=0;lt<at+1;lt++)K.push(tt+lt*nt)}else K.push(tt);"number"===c&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||K.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||K.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(K[K.length-1]>t._xRange[1]&&K.pop(),K.push(t._xRange[1]))),K=Array.from(new Set(K))),0!=t._countOfLabel&&u.domain([d3.min(K),d3.max(K)]);var st=[];K.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;st.push(i)}})),st=st.filter((function(t){return t<=8})),K=K.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(st)&&(t=parseFloat(t).toFixed(d3.max(st)))}return t}))}if(i=e,"number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=K),"number"==c){for(var ut=[],ct=0;ct<e.length;ct++)ut.push(E(e[ct],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=ut}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var ht=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,dt=ht?h:0,_t=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,ft=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),pt=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),yt=dt*pt+ht*ft,xt=ht*pt+dt*ft;if(Z=yt,xt<d)a=xt,i=i,o=yt,r=yt,t._tickShow||(o=0),l=!0;else{a=d,i=i.map((function(e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}(e,a/pt,h,t._fontFamily)}));var gt=d3.max(i,(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,vt=dt*pt+gt*ft;o=vt,r=vt,a=gt*pt+dt*ft,t._tickShow||(o=0),l=!0}0==_t&&(o/=2,r/=2),90==Math.abs(_t)&&(a=0==Z?0:h,o/=2,r/=2);var mt=Q/e.length;if(("category"===c||null==t._countOfLabel)&&r*(0==Math.abs(_t)||90==Math.abs(_t)?2:1)>mt){var bt=Math.ceil(r*(0==Math.abs(_t)||90==Math.abs(_t)?2:1)*1.2/mt);e=e.filter((function(t,e){return e%bt==0})),i=i.filter((function(t,e){return e%bt==0}))}return s(),t}}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"height",get:function(){var t=this,e=this._scaleFunc,i=(Math.abs(e.range()[0]-e.range()[1]),this._tickValueTexts.length,d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),0);return this.isShow&&(i=this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.125*this._fontSize:0)),i}}]),e}(Bt),Bo="axis-group",Go="y-title",Xo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-bar-axis-y"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=e._orient,n=e._scaleFunc,a=e.group,r=e._fontSize,l=e._tickValueTexts,s=void 0;s=e.axisFunc="right"===i?d3.axisRight(n):d3.axisLeft(n);var u=null;"number"===e._type&&e._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(u=d3.format("d")),s.tickValues(e._tickValues).tickSizeInner(e._tickSize).tickSizeOuter(-.5).tickPadding(e._tickPadding).tickFormat(u);var c=a.select(".axis-group").empty()?a.append("g").attr("class",Bo):a.select(".axis-group");c.transition().duration(e._transition?e._duration:0).ease(d3.easeLinear).call(s).on("start",(function(){c.selectAll(".tick text").style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).style("display","none").text((function(t,e){return l[e]})),c.selectAll(".tick line").style("stroke",e._lineStroke).style("display",e._axisLineShow?"block":"none").style("stroke-width",e._yAxisLineWidth),c.select("path").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none")}));var h=e.group.selectAll(".axis-y-horizontal .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)||"&-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove();var d=Math.abs(n.range()[0]-n.range()[1]);if(e._titleShow&&e._title){var _=a.select(".y-title").empty()?a.append("g").attr("class",Go):a.select(".y-title"),f=_.select("text").empty()?_.append("text"):_.select("text"),p=(R(e._title,r,e._fontFamily),d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(null==e?"":e,t._fontSize,t._fontFamily)})));_.call(o,-(this._tickShow?(p?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0!=parseFloat(e._yAxisLineWidth)&&e._yAxisLineWidth&&e._axisLineShow?5:0),d/2),f.attr("y",-9-e._picPadding).style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(e._title)}else a.select(".y-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);e="category"===o?a.domain():a.ticks(t._tickCount);var s=d3.max(e.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(null==e?"":e,r,t._fontFamily)}))||0;return s<=l?(i=e,n=s):(i=e.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"picPadding",value:function(t){return arguments.length?(this._picPadding=parseFloat(t),this):this._picPadding}},{key:"width",get:function(){var t=this,e=d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(null==e?"":e,t._fontSize,t._fontFamily)})),i=0;return this.isShow&&(i=this._tickShow?(e?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0),i}}]),e}(Bt),jo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-bar"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._fillOpacity=1,i._barCornerRadius=0,i._borderColor="",i._borderWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data;t.group;function i(t){return Math.floor(t)===t?0:String(t).split(".")[1].length||0}var n=t._xScale,a=t._yScale,o=t._numberLabel.suffix?t._numberLabel.suffix:"",r=t.group.selectAll(".bar").data(e,(function(t){return t.name})),l=r.enter().append("g").attr("class","bar bar_enter").attr("opacity",1).style("visibility",(function(t,e){return t.value<0?"hidden":"visible"})).attr("transform",(function(t){return"translate(0,"+a(t.name)+")"}));l.append("rect").attr("x",(function(e,i){var n=e.value;return n>0||0==n?isNaN(t._xScale(0))?0:t._xScale(0):isNaN(t._xScale(n))?0:t._xScale(n)})).attr("width",0).attr("y",(function(e,i){return t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",(function(e){var i=t._yScale.step()*t._barWidthPercent;return isNaN(i)?0:i})).style("fill",(function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}return e.color})).style("stroke-width",(function(e){return t._borderWidth||0})).style("stroke",(function(e){return t._borderColor||e.color})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("width",(function(e){var i=e.value,n=0;return i>0||0==i?n=t._xScale(i)-t._xScale(0)>0?t._xScale(i)-t._xScale(0):0:i<0&&(n=t._xScale(0)-t._xScale(i)>0?t._xScale(0)-t._xScale(i):0),isNaN(n)?0:n}));r.attr("opacity",1).style("visibility",(function(t,e){return t.value<0?"hidden":"visible"})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("class","bar bar_update").attr("transform",(function(t){return"translate(0,"+a(t.name)+")"}));r.select("rect").style("stroke-width",(function(e){return t._borderWidth||0})).style("stroke",(function(e){return t._borderColor||e.color})).attr("x",(function(e,i){var n=e.value;return n>0||0==n?isNaN(t._xScale(0))?0:t._xScale(0):isNaN(t._xScale(n))?0:t._xScale(n)})).attr("y",(function(e,i){return t._yScale.step()*(1-t._barWidthPercent)/2})).attr("height",(function(e){var i=t._yScale.step()*t._barWidthPercent;return isNaN(i)?0:i})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("width",(function(e){var i=e.value,n=0;return i>0||0==i?n=t._xScale(i)-t._xScale(0)>0?t._xScale(i)-t._xScale(0):0:i<0&&(n=t._xScale(0)-t._xScale(i)>0?t._xScale(0)-t._xScale(i):0),isNaN(n)?0:n}));var s=r.exit().transition().duration(t._transition?t._duration:0);"desc"==t._barOrderBy?s.attr("class","bar bar_exit").attr("transform",(function(t){return"translate(0,"+a.range()[0]+")"})).attr("opacity",0).remove():s.attr("class","bar bar_exit").attr("transform",(function(t){return"translate(0,"+a.range()[1]+")"})).attr("opacity",0).remove(),s.select("rect").attr("width",(function(e){var i=e.value,n=0;return i>0||0==i?n=t._xScale(i)-t._xScale(0)>0?t._xScale(i)-t._xScale(0):0:i<0&&(n=t._xScale(0)-t._xScale(i)>0?t._xScale(0)-t._xScale(i):0),isNaN(n)?0:n}));d3.format(",");l.append("text").attr("class","valueLabel").attr("x",(function(t){return 0})).attr("y",(function(e){return t._yScale.step()/2+.4*t._numberLabel.fontSize})).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e,i){if(null==t._numberLabel.color){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-number-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-number-index-"+i)+")"}return e.color}return q(t._numberLabel.color)})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").text((function(e){return E(e.lastValue,t._numberStyle,t._decimalPlaces)+o})).style("text-anchor","start").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(e){var n=this,a=d3.interpolateNumber(e.lastValue,e.value);return function(r){d3.select(n).text(E(parseFloat(a(r)).toFixed(i(e.value)),t._numberStyle,t._decimalPlaces)+o)}})).attr("x",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i;var s=0,u=0;if(0==t._numberLabel.show||null==t._numberLabel.show||null==t._numberLabel.positionChoice)return n(e.value);if(s=0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?0:3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?parseFloat(r)+parseFloat(t._picLabel.picBorderPadding):0,0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))u=0;else if(2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)){u=(R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0)+5}else u=0;return n(e.value)+s+u+5})),r.select(".valueLabel").attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e,i){if(null==t._numberLabel.color){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-number-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-number-index-"+i)+")"}return e.color}return q(t._numberLabel.color)})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i;var s=0,u=0;if(0==t._numberLabel.show||null==t._numberLabel.show||null==t._numberLabel.positionChoice)return n(e.value);if(s=0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?0:3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?parseFloat(r)+parseFloat(t._picLabel.picBorderPadding):0,0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))u=0;else if(2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)){u=(R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0)+5}else u=0;return n(e.value)+s+u+5})).attr("y",(function(e){return t._yScale.step()/2+.4*t._numberLabel.fontSize})).tween("d",(function(e){var n=this,a=d3.interpolateNumber(e.lastValue,e.value);return function(r){d3.select(n).text(E(parseFloat(a(r)).toFixed(i(e.value)),t._numberStyle,t._decimalPlaces)+o)}})),s.select(".valueLabel").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(e){var n=this,a=d3.interpolateNumber(e.lastValue,e.value);return function(r){d3.select(n).text(E(parseFloat(a(r)).toFixed(i(e.value)),t._numberStyle,t._decimalPlaces)+o)}})).attr("x",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i;var s=0,u=0;if(0==t._numberLabel.show||null==t._numberLabel.show||null==t._numberLabel.positionChoice)return n(e.value);if(s=0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?0:3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?parseFloat(r)+parseFloat(t._picLabel.picBorderPadding):0,0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))u=0;else if(2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)){u=(R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0)+5}else u=0;return n(e.value)+s+u+5})),l.append("text").attr("class","axisLabel").style("visibility","visible").attr("x",(function(t){return-10})).attr("y",(function(e){return t._yScale.step()/2+.4*t._axisFontSize})).attr("font-size",t._axisFontSize).attr("fill",t._axisFontColor).attr("font-family",t._axisFontFamily).attr("display",t._axisTickShow?"block":"none").style("text-anchor","end").html((function(e){return X(String(e.name),t._limitWidth,t._axisFontSize,t._axisFontFamily)})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear),r.select(".axisLabel").style("visibility","visible").attr("font-size",t._axisFontSize).attr("fill",t._axisFontColor).attr("font-family",t._axisFontFamily).attr("display",t._axisTickShow?"block":"none").html((function(e){return X(String(e.name),t._limitWidth,t._axisFontSize,t._axisFontFamily)})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return-10})).attr("y",(function(e){return t._yScale.step()/2+.4*t._axisFontSize})),s.select(".axisLabel").style("visibility","visible").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return-10}));var u=l.append("g").attr("class","bar-images").attr("opacity",(function(e,i){var n=1,a=e.value,o=0;a>0||0==a?o=t._xScale(a)-t._xScale(0)>0?t._xScale(a)-t._xScale(0):0:a<0&&(o=t._xScale(0)-t._xScale(a)>0?t._xScale(0)-t._xScale(a):0),o=isNaN(o)?0:o;var r=0,l=0==(r=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/r,s=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,u=0,c=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;u=null==t._picLabel.picMaskOptions||null==c||-1==t._picLabel.picMaskOptions.indexOf(c)?0==r?0:e.imgWidth/r:0==t._picLabel.picMaskOptions.indexOf(c)?d3.min([l,s]):0==r?0:e.imgWidth/r,(0==t._picLabel.show||1!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)&&2!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice))&&(u=0);var h=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return(0==t._textLabel.show||0!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)&&1!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))&&(h=0),u>0?((0==t._textLabel.show&&t._picLabel.show||0==h&&t._picLabel.show)&&u>o&&(n=0),t._textLabel.show&&t._picLabel.show&&u+h+5>o&&(u>o&&h>o||u>o&&h<o?n=0:(u<o&&h>o||u<o&&h<o)&&(n=1))):n=1,n}));u.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("display",t._picLabel.show?"block":"none").attr("transform",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;return r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i,0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate(0,0)":0==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(0)-5-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(0)+parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":2==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(e.value)-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(e.value)+parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":void 0})),r.select(".bar-images").attr("opacity",(function(e,i){var n=1,a=e.value,o=0;a>0||0==a?o=t._xScale(a)-t._xScale(0)>0?t._xScale(a)-t._xScale(0):0:a<0&&(o=t._xScale(0)-t._xScale(a)>0?t._xScale(0)-t._xScale(a):0),o=isNaN(o)?0:o;var r=0,l=0==(r=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/r,s=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,u=0,c=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;u=null==t._picLabel.picMaskOptions||null==c||-1==t._picLabel.picMaskOptions.indexOf(c)?0==r?0:e.imgWidth/r:0==t._picLabel.picMaskOptions.indexOf(c)?d3.min([l,s]):0==r?0:e.imgWidth/r,(0==t._picLabel.show||1!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)&&2!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice))&&(u=0);var h=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return(0==t._textLabel.show||0!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)&&1!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))&&(h=0),u>0?((0==t._textLabel.show&&t._picLabel.show||0==h&&t._picLabel.show)&&u>o&&(n=0),t._textLabel.show&&t._picLabel.show&&u+h+5>o&&(u>o&&h>o||u>o&&h<o?n=0:(u<o&&h>o||u<o&&h<o)&&(n=1))):n=1,n})).attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;return r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i,0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate(0,0)":0==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(0)-5-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(0)+parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":2==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(e.value)-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(e.value)+parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":void 0})),s.select(".bar-images").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;return r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i,0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate(0,0)":0==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(0)-5-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(0)+parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":2==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(e.value)-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?"translate("+(n(e.value)+parseFloat(t._picLabel.picBorderPadding)-(a-r)/2)+",0)":void 0})),u.append("clipPath").attr("class","image-clip").attr("transform",(function(e){return"translate(0,"+t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2+")"})).attr("id",(function(e,i){return"clipBar-"+t.id+"-"+i})).append("circle").attr("r",(function(e){var i=0,n=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,a=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,o=d3.min([n,a])/2;return o<0?0:o})).attr("cx",(function(e){var i=0;return(0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i)/2})).attr("cy",t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage/2),r.select(".image-clip").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){return"translate(0,"+t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2+")"})),s.select(".image-clip").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){return"translate(0,"+t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2+")"})),u.append("image").attr("class","image").attr("clip-path",(function(e,i){var n=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;return null==t._picLabel.picMaskOptions||null==n||-1==t._picLabel.picMaskOptions.indexOf(n)?"":0==t._picLabel.picMaskOptions.indexOf(n)?"url("+c("#clipBar-"+t.id+"-"+i)+")":""})).attr("preserveAspectRatio","xMidYMid meet").attr("x",(function(t){return 0})).attr("y",(function(e){return t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2})).attr("height",(function(e){return t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage})).attr("width",(function(e){var i=0,n=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage;return 0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i})).attr("xlink:href",(function(t){return t.imgUrl})).attr("display",t._picLabel.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",(function(t){return 0})),r.select(".image").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",(function(t){return 0})).attr("y",(function(e){return t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2})),s.select(".image").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 0})).attr("y",(function(e){return t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2}));var h=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;return null==t._picLabel.picMaskOptions||null==h||-1==t._picLabel.picMaskOptions.indexOf(h)||(0==t._picLabel.picMaskOptions.indexOf(h)?(u.append("circle").attr("class","border-circle").attr("transform",(function(e){return"translate(0,"+t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2+")"})).attr("fill","none").attr("stroke",(function(e,i){if(null==t._picLabel.picBorderColor){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-pic-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-pic-index-"+i)+")"}return e.color}return q(t._picLabel.picBorderColor)})).attr("stroke-width",t._picLabel.picBorderWidth).attr("opacity",0).attr("r",(function(e){var i=0,n=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,a=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,o=d3.min([n,a])/2;return o+parseFloat(t._picLabel.picBorderWidth/2)<0?0:o+parseFloat(t._picLabel.picBorderWidth/2)})).attr("cx",(function(e){var i=0;return(0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i)/2})).attr("cy",t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage/2).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),r.select(".border-circle").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("r",(function(e){var i=0,n=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,a=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,o=d3.min([n,a])/2;return o+parseFloat(t._picLabel.picBorderWidth/2)<0?0:o+parseFloat(t._picLabel.picBorderWidth/2)})).attr("cx",(function(e){var i=0;return(0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i)/2})).attr("cy",t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage/2),s.select(".border-circle").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",0)):1==t._picLabel.picMaskOptions.indexOf(h)&&(u.append("rect").attr("class","border-rect").attr("transform",(function(e){return"translate(0,"+t._yScale.step()*(1-t._barWidthPercent*t._picLabel.picSizePercentage)/2+")"})).attr("fill","none").attr("stroke",(function(e,i){if(null==t._picLabel.picBorderColor){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-pic-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-pic-index-"+i)+")"}return e.color}return q(t._picLabel.picBorderColor)})).attr("stroke-width",t._picLabel.picBorderWidth).attr("opacity",0).attr("x",-t._picLabel.picBorderWidth/2).attr("y",-t._picLabel.picBorderWidth/2).attr("width",(function(e){var i=0,n=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i;return isNaN(n+parseFloat(t._picLabel.picBorderWidth))?0:n+parseFloat(t._picLabel.picBorderWidth)})).attr("height",(function(e){var i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage+parseFloat(t._picLabel.picBorderWidth);return isNaN(i)?0:i})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),r.select(".border-rect").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",-t._picLabel.picBorderWidth/2).attr("y",-t._picLabel.picBorderWidth/2).attr("width",(function(e){var i=0,n=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i;return isNaN(n+parseFloat(t._picLabel.picBorderWidth))?0:n+parseFloat(t._picLabel.picBorderWidth)})).attr("height",(function(e){var i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage+parseFloat(t._picLabel.picBorderWidth);return isNaN(i)?0:i})),s.select(".border-rect").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",0))),l.append("text").attr("class","textLabel").attr("opacity",(function(e,i){var n=1,a=e.value,o=0;a>0||0==a?o=t._xScale(a)-t._xScale(0)>0?t._xScale(a)-t._xScale(0):0:a<0&&(o=t._xScale(0)-t._xScale(a)>0?t._xScale(0)-t._xScale(a):0),o=isNaN(o)?0:o;var r=0,l=0==(r=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/r,s=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,u=0,c=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;u=null==t._picLabel.picMaskOptions||null==c||-1==t._picLabel.picMaskOptions.indexOf(c)?0==r?0:e.imgWidth/r:0==t._picLabel.picMaskOptions.indexOf(c)?d3.min([l,s]):0==r?0:e.imgWidth/r,(0==t._picLabel.show||1!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)&&2!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice))&&(u=0);var h=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return(0==t._textLabel.show||0!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)&&1!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))&&(h=0),h>0?((t._textLabel.show&&0==t._picLabel.show||0==u&&t._textLabel.show)&&h>o&&(n=0),t._textLabel.show&&t._picLabel.show&&u+h+5>o&&(u>o&&h>o||u>o&&h<o||u<o&&h>o||u<o&&h<o)&&(n=0)):n=1,n})).attr("x",0).attr("y",(function(e){return t._yScale.step()/2+.4*t._textLabel.fontSize})).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e,i){if(null==t._textLabel.color){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-text-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-text-index-"+i)+")"}return e.color}return q(t._textLabel.color)})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.name})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;if(r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i,0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))return n(0);if(0==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))return 0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(0)+5:1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(0)+parseFloat(r)+parseFloat(t._picLabel.picBorderPadding)+5:n(0)+5;if(1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)){var s=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return 0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)-s-5:2==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-s-5:n(e.value)-s-5}return 2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)?0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)+5:3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)+parseFloat(r)+parseFloat(t._picLabel.picBorderPadding)+5:n(e.value)+5:void 0})),r.select(".textLabel").attr("opacity",(function(e,i){var n=1,a=e.value,o=0;a>0||0==a?o=t._xScale(a)-t._xScale(0)>0?t._xScale(a)-t._xScale(0):0:a<0&&(o=t._xScale(0)-t._xScale(a)>0?t._xScale(0)-t._xScale(a):0),o=isNaN(o)?0:o;var r=0,l=0==(r=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/r,s=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,u=0,c=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;u=null==t._picLabel.picMaskOptions||null==c||-1==t._picLabel.picMaskOptions.indexOf(c)?0==r?0:e.imgWidth/r:0==t._picLabel.picMaskOptions.indexOf(c)?d3.min([l,s]):0==r?0:e.imgWidth/r,(0==t._picLabel.show||1!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)&&2!=t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice))&&(u=0);var h=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return(0==t._textLabel.show||0!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)&&1!=t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))&&(h=0),h>0?((t._textLabel.show&&0==t._picLabel.show||0==u&&t._textLabel.show)&&h>o&&(n=0),t._textLabel.show&&t._picLabel.show&&u+h+5>o&&(u>o&&h>o||u>o&&h<o||u<o&&h>o||u<o&&h<o)&&(n=0)):n=1,n})).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e,i){if(null==t._textLabel.color){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-text-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-text-index-"+i)+")"}return e.color}return q(t._textLabel.color)})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").html((function(t){return t.name})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;if(r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i,0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))return n(0);if(0==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))return 0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(0)+5:1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(0)+parseFloat(r)+parseFloat(t._picLabel.picBorderPadding)+5:n(0)+5;if(1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)){var s=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return 0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)-s-5:2==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-s-5:n(e.value)-s-5}return 2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)?0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)+5:3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)+parseFloat(r)+parseFloat(t._picLabel.picBorderPadding)+5:n(e.value)+5:void 0})).attr("y",(function(e){return t._yScale.step()/2+.4*t._textLabel.fontSize})),s.select(".textLabel").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,a=0==(i=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:e.imgHeight/(t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:e.imgWidth/i,o=t._yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,r=0,l=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;if(r=null==t._picLabel.picMaskOptions||null==l||-1==t._picLabel.picMaskOptions.indexOf(l)?0==i?0:e.imgWidth/i:0==t._picLabel.picMaskOptions.indexOf(l)?d3.min([a,o]):0==i?0:e.imgWidth/i,0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))return n(0);if(0==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice))return 0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(0)+5:1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(0)+parseFloat(r)+parseFloat(t._picLabel.picBorderPadding)+5:n(0)+5;if(1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)){var s=R(String(e.name),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return 0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)-s-5:2==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)-parseFloat(r)-parseFloat(t._picLabel.picBorderPadding)-s-5:n(e.value)-s-5}return 2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)?0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)+5:3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)?n(e.value)+parseFloat(r)+parseFloat(t._picLabel.picBorderPadding)+5:n(e.value)+5:void 0})),t}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=parseFloat(t),this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"y",value:function(t){return arguments.length?(this._y=t,this):this._y}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"picLabel",value:function(t){return arguments.length?(this._picLabel=t,this):this._picLabel}},{key:"axisTickShow",value:function(t){return arguments.length?(this._axisTickShow=t,this):this._axisTickShow}},{key:"axisFontSize",value:function(t){return arguments.length?(this._axisFontSize=t,this):this._axisFontSize}},{key:"axisFontColor",value:function(t){return arguments.length?(this._axisFontColor=t,this):this._axisFontColor}},{key:"axisFontFamily",value:function(t){return arguments.length?(this._axisFontFamily=t,this):this._axisFontFamily}},{key:"barOrderBy",value:function(t){return arguments.length?(this._barOrderBy=t,this):this._barOrderBy}},{key:"limitWidth",value:function(t){return arguments.length?(this._limitWidth=t,this):this._limitWidth}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Io="dynamic-bar-grid-x-line",Yo="dynamic-bar-grid-y-line",Ho=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","dynamic-bar-plane-grid"),i.group=i.elem.append("g"),i._width=400,i._height=400,i._planeX=0,i._transHeight=0,i._transition=!1,i._duration=0,i._type="",i._xTickLocations=[],i._yTickLocations=[],i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._width,i=t._height,n=t.group.attr("class",t._type).style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray).style("pointer-events","none");!function(){if(!t._showX)return void n.selectAll("."+Io).remove();var i=n.selectAll("."+Io).data(t._yTickLocations);i.exit().remove(),i.enter().append("line").attr("class",Io).merge(i).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x1",t._planeX).attr("y1",(function(t){return t+.5})).attr("x2",e).attr("y2",(function(t){return t+.5}))}(),function(){if(!t._showY)return void n.selectAll("."+Yo).remove();var e=n.selectAll("."+Yo).data(t._xTickLocations,(function(t){return t.name}));e.exit().attr("opacity",0).remove(),e.enter().append("line").attr("class",Yo).attr("x1",(function(e){return t._xTickLocations[t._xTickLocations.length-1].value+20})).attr("x2",(function(e){return t._xTickLocations[t._xTickLocations.length-1].value+20})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("y1",0).attr("x1",(function(t){return t.value})).attr("y2",i).attr("x2",(function(t){return t.value})),e.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("y1",0).attr("x1",(function(t){return t.value})).attr("y2",i).attr("x2",(function(t){return t.value}))}()}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"planeX",value:function(t){return arguments.length?(this._planeX=parseFloat(t),this):this._planeX}},{key:"xTickLocations",value:function(t){return arguments.length?(this._xTickLocations=t,this):this._xTickLocations}},{key:"yTickLocations",value:function(t){return arguments.length?(this._yTickLocations=t,this):this._yTickLocations}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}}]),e}(pt),Eo=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return function(t,e){return t.forEach((function(t,i){t.color=e[i],t.color_special=e[i+1],t.data.forEach((function(e){e.color=t.color,e.color_special=t.color_special}))})),t}(t,this.generateColorList(t.length))}}]),e}(it);function Vo(t,e){var i=0,n=[];if(e.forEach((function(t){"timeColUni"===t.function?(i=t.index,t.isLegend):"vCol"===t.function&&0==t.configurable&&n.push(t.index)})),P(t,[i],2))return[];for(var a=t,o={},r=[],l=a.length,s=a[0],u=[],c=[],d=1;d<l;d++)c.push(a[d].length);c.sort((function(t,e){return e-t}));for(var _=0;_<l;_++)for(var f=0;f<c[0];f++)u.push(isNaN(parseFloat(a[_][f])));if(0==u.filter((function(t,e){return 0==t})).length)return[];for(var p=[],y=1;y<c[0];y++)if(y!==i){var x=s[y];""!=s[y]&&null!=s[y]&&null!=s[y]||(x="$-"+y),o[x+"-"+y]={name:x,showLegend:x!="$-"+y,data:[]}}for(var g=1;g<l;g++){var v=a[g],m=v.filter((function(t,e){return e!=i})).sort((function(t,e){return e-t})),b=v[i];if(""!=b&&null!=b&&null!=b||(b="&-"+g),b){p.push(String(b));for(var S=0;S<c[0];S++){var k=s[S];""!=s[S]&&null!=s[S]&&null!=s[S]||(k="$-"+S),S!==i&&k&&o[k+"-"+S].data.push({name:b,rank:m.indexOf(v[S])+1,showAxisText:b!="&-"+g,value:""==v[S]||isNaN(parseFloat(v[S]))||null==v[S]||null==v[S]?0:parseFloat(v[S]),tooltipValueShow:!isNaN(parseFloat(v[S]))})}}}for(var w in o)o[w].time=p,r.push(o[w]);return r.forEach((function(t,e){t.key=h(t.name)+"-"+e})),r}var $o=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-bar-chart"),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._barWidthPercent=.5,i._countOfBars=0,i._borderWidth=0,i._borderColor="",i._barOrderBy="desc",i._textLabel={titlename:"文本标签显示",show:!0,fontFamily:"阿里巴巴普惠体 常规",fontSize:14,positionOptions:["内部居左","内部居右","外部"],positionChoice:"内部居右",color:"#545454"},i._numberLabel={titlename:"数值标签显示",show:!0,fontFamily:"阿里巴巴普惠体 常规",fontSize:14,color:"#545454",positionChoice:"外部居右"},i._picLabel={titlename:"图片标签显示",show:!0,picMaskOptions:["圆形","方形"],picMaskChoice:["方形"],picSizePercentage:"0.9",positionOptions:["轴左","内部居左","内部居右","外部"],positionChoice:"轴左",picBorderPadding:"2",picBorderWidth:"2",picBorderColor:"#fff"},i._timeLabel={titlename:"时间标签显示",show:!0,fontSize:"40",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._pictureList=[],i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=[],i._moveStyle="",i._endPause=0,i._options=[["rankmoveTransitionDuraion","换位动画","0.05"]],i._axisPositonOptions=["上面","下面"],i._axisPositonChoice="上面",i._DynamicInterrupt=!0,i.timer=null,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;clearTimeout(t.timer);var e=0,i=1e3*t._options[0][2]-e;null==t._axisPositonOptions||null==t._axisPositonChoice?(t._xOrient="bottom",t._yOrient="left"):0==t._axisPositonOptions.indexOf(t._axisPositonChoice)?(t._xOrient="top",t._yOrient="left"):1==t._axisPositonOptions.indexOf(t._axisPositonChoice)&&(t._xOrient="bottom",t._yOrient="left"),t.mainGroup.selectAll("*").remove(),t.flag=0,t.mainGroup.selectAll(".animation-defs").remove();var n=t.mainGroup.append("defs").attr("class","animation-defs"),a=n.append("clipPath").attr("id","animation-overlay-"+t.id+"-path").append("rect").attr("y",-t._xAxisLineWidth).attr("height",isNaN(2*t._xAxisLineWidth)?0:2*t._xAxisLineWidth),r=n.append("clipPath").attr("id","animation-overlay-"+t.id+"-axis").append("rect").attr("y",-20-parseFloat(t._fontSize)).attr("height",t._height+parseFloat(t._fontSize));if(t._borderColor&&/\[/.test(t._borderColor)){var l=x(t._borderColor),s=[],u=!0,h=!1,d=void 0;try{for(var _,f=l[Symbol.iterator]();!(u=(_=f.next()).done);u=!0){var p=_.value,g=[],v=p.split(":");g.push(q(v[0])),g.push(v[1]),s.push(g)}}catch(t){h=!0,d=t}finally{try{!u&&f.return&&f.return()}finally{if(h)throw d}}var m=s.concat(),b=m.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(b[1]).x1+"%").attr("y1",y(b[1]).y1+"%").attr("x2",y(b[1]).x2+"%").attr("y2",y(b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var S=t.activeData,k=S.length>0?S[0].time:[];t.xAxis=new To(this.mainGroup),t.yAxis=new Xo(this.mainGroup),t.yAxis.minTickDistance(1),t.coreGroup=this.mainGroup.append("g").attr("class","core-group"),t.grid=new Ho(this.coreGroup),t.rectPlot=new jo(this.coreGroup),t.selectOverlay=new Ni(this.coreGroup),t.overlay=new te(this.coreGroup);(w=navigator.userAgent).indexOf("Trident"),w.indexOf("Presto"),w.indexOf("AppleWebKit"),w.indexOf("Gecko")>-1&&w.indexOf("KHTML"),w.match(/AppleWebKit.*Mobile.*/),w.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),w.indexOf("Android")>-1||w.indexOf("Adr"),w.indexOf("iPhone"),w.indexOf("iPad"),w.indexOf("Safari"),w.indexOf("MicroMessenger"),w.match(/\sQQ/i),(navigator.browserLanguage||navigator.language).toLowerCase();var w,C=[],O=0,F=t._pictureList,L=[],P=F.length;0==P&&z(L);for(var A=function(t){C[t]=new Image,C[t].crossOrigin="Anonymous";var e={};C[t].onload=function(){var i=document.createElement("canvas");i.height=C[t].height,i.width=C[t].width,i.getContext("2d").drawImage(C[t],0,0),e.w=this.width,e.h=this.height,e.url=i.toDataURL(),e.index=t,null!=F[t]&&""!=F[t]&&F[t].constructor!==Object||(e.w=0,e.h=0),L.push(e),++O==P&&z(L)},C[t].src=F[t],null!=F[t]&&""!=F[t]&&F[t].constructor!==Object||(C[t].src="",C[t].onload())},W=0;W<P;W++)A(W);function z(n){setTimeout((function(){function l(){if(clearTimeout(t.timer),t.flag<k.length){var n=+new Date;J();var a=+new Date;e=a-n,i=1e3*t._options[0][2]-e>0?1e3*t._options[0][2]-e:0,t.timer=setTimeout(l,t._transition&&1e3*t._duration-e>0?1e3*t._duration-e:0)}else clearTimeout(t.timer)}if(t.flag=0,t._DynamicInterrupt){t.flag=0;var s=[];S.forEach((function(e,i){var a={};a.name=e.name,a.color=e.color,a.imgUrl=t._pictureList[i]||null,a.imgWidth=0,a.imgHeight=0,n.forEach((function(t,e){t.index==i&&(a.imgWidth=t?0==t.h?0:t.w:0,a.imgHeight=t?0==t.w?0:t.h:0)})),e.data.forEach((function(e,i){0==t.flag?a.lastValue=0:e.name==k[t.flag-1]&&(a.lastValue=e.value),e.name==k[t.flag]&&(a.value=e.value)})),s.push(a)})),s="desc"==t._barOrderBy?s.sort((function(t,e){return t.value-e.value})).slice(t._countOfBars>s.length?0:s.length-t._countOfBars,s.length):"asc"==t._barOrderBy?s.sort((function(t,e){return e.value-t.value})).slice(0,t._countOfBars>s.length?s.length:t._countOfBars):s.slice(0,t._countOfBars>s.length?s.length:t._countOfBars).reverse(),t.computeDomain(s);var u=t.xAxis,h=t.yAxis,d=t.xScale,_=t.yScale,f=t._xType,p=t._yType,y=t._xOrient,x=t._yOrient,g=t._fontSize,v=t._width-t._marginLeft-t._marginRight,m=t.heightOfMainGroup;d.domain(t._xDomain),u.scaleFunc(d).allowedMaxTextHeight(.5*m).type(f).orient(y).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(1e3*t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),_.domain(t._yDomain),h.scaleFunc(_).allowedMaxTextWidth(.5*v).type(p).orient(x).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(i).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);h&&h.titleHeight;var b=t._tickCount?t._tickCount:(v-h.allowedMaxTextWidth())/(3*g);u.tickCount(b).compute(),h.compute(),_.range([m-u.height,0]),h.compute();var w=h.width,C=m-u.height,O=(h.width,0),F=0;if(0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice))O=0,F=0;else if(0==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)){if(n.length>0){var L=d3.max(n,(function(t){return t.w})),P=n.filter((function(t){return t.w==L}))[0],A=0,W=0==(A=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:P.h/(t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:P.w/A,z=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,M=0,D=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;M=null==t._picLabel.picMaskOptions||null==D||-1==t._picLabel.picMaskOptions.indexOf(D)?W:0==t._picLabel.picMaskOptions.indexOf(D)?d3.min([W,z]):W,O=parseFloat(M)+parseFloat(t._picLabel.picBorderPadding)}}else if(3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)&&n.length>0){var R=d3.max(n,(function(t){return t.w})),N=n.filter((function(t){return t.w==R}))[0],T=0,B=0==(T=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:N.h/(t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:N.w/T,X=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,j=0,I=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;j=null==t._picLabel.picMaskOptions||null==I||-1==t._picLabel.picMaskOptions.indexOf(I)?B:0==t._picLabel.picMaskOptions.indexOf(I)?d3.min([B,X]):B,F=parseFloat(j)+parseFloat(t._picLabel.picBorderPadding)}var Y=t._numberLabel.suffix?t._numberLabel.suffix:"",H=s.length?s.map((function(t){return t.name})):[],V=s.length?s.map((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+Y})):[],$=0,U=0;0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)?$=0:2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)&&($=G(H,t._textLabel.fontSize,t._textLabel.fontFamily)||0),0==t._numberLabel.show||null==t._numberLabel.show||null==t._numberLabel.positionChoice?U=0:"外部居右"==t._numberLabel.positionChoice&&(U=G(V,t._numberLabel.fontSize,t._numberLabel.fontFamily)||0);var Z=O,Q=parseFloat(F)+parseFloat($)+parseFloat(U)+10;d.range([Z,v-h.width-Q]),u.compute(),u.translate(w,C).update();var K=parseFloat(h.width)+parseFloat(Z);h.picPadding(Z).translate(K,0).update(),null==t._axisPositonOptions||null==t._axisPositonChoice?(u.translate(w,C).update(),h.picPadding(Z).translate(K,0).update()):0==t._axisPositonOptions.indexOf(t._axisPositonChoice)&&(u.translate(w,u.height).update(),h.picPadding(Z).translate(K,u.height).update()),a.attr("x",Z).attr("width",t.widthOfCore-Z-Q>0?t.widthOfCore-Z-Q:0),r.attr("y",-20-parseFloat(t._fontSize)-u.height).attr("height",t._height+parseFloat(t._fontSize)+u.height).attr("x",-K).attr("width",t.widthOfNoMargin),t.group.selectAll(".dynamic-bar-axis-x .domain").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-path")+")"),t.group.selectAll(".dynamic-bar-axis-x").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-axis")+")")}else t.flag=0,l();function J(){if(0==k.length||t.flag>k.length||t.flag==k.length)clearTimeout(t.timer);else{var e=[];S.forEach((function(i,a){var o={};o.name=i.name,o.color=i.color,o.imgUrl=null,o.imgWidth=0,o.imgHeight=0,n.forEach((function(t,e){t.index==a&&(o.imgWidth=t?0==t.h?0:t.w:0,o.imgHeight=t?0==t.w?0:t.h:0,o.imgUrl=t?t.url:null)})),i.data.forEach((function(e,i){0==t.flag?o.lastValue=0:e.name==k[t.flag-1]&&(o.lastValue=e.value),e.name==k[t.flag]&&(o.value=e.value)})),e.push(o)})),e="desc"==t._barOrderBy?e.sort((function(t,e){return t.value-e.value})).slice(t._countOfBars>e.length?0:e.length-t._countOfBars,e.length):"asc"==t._barOrderBy?e.sort((function(t,e){return e.value-t.value})).slice(0,t._countOfBars>e.length?e.length:t._countOfBars):e.slice(0,t._countOfBars>e.length?e.length:t._countOfBars).reverse(),t.computeDomain(e);var l=t.xAxis,s=t.yAxis,u=t.xScale,h=t.yScale,d=t._xType,_=t._yType,f=t._xOrient,p=t._yOrient,y=t._fontSize,x=t._width-t._marginLeft-t._marginRight,g=t.heightOfMainGroup;u.domain(t._xDomain),l.scaleFunc(u).allowedMaxTextHeight(.5*g).type(d).orient(f).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(1e3*t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),h.domain(t._yDomain),s.scaleFunc(h).allowedMaxTextWidth(.5*x).type(_).orient(p).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(i).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);s&&s.titleHeight;var v=t._tickCount?t._tickCount:(x-s.allowedMaxTextWidth())/(3*y);l.tickCount(v).compute(),s.compute(),h.range([g-l.height,0]),s.compute();var m=s.width,b=g-l.height,w=(s.width,0),C=0;if(0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.positionOptions||null==t._picLabel.positionChoice||-1==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice))w=0,C=0;else if(0==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)){if(n.length>0){var O=d3.max(n,(function(t){return t.w})),F=n.filter((function(t){return t.w==O}))[0],L=0,P=0==(L=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:F.h/(t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:F.w/L,A=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,W=0,z=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;W=null==t._picLabel.picMaskOptions||null==z||-1==t._picLabel.picMaskOptions.indexOf(z)?P:0==t._picLabel.picMaskOptions.indexOf(z)?d3.min([P,A]):P,w=parseFloat(W)+parseFloat(t._picLabel.picBorderPadding)}}else if(3==t._picLabel.positionOptions.indexOf(t._picLabel.positionChoice)&&n.length>0){var M=d3.max(n,(function(t){return t.w})),D=n.filter((function(t){return t.w==M}))[0],R=0,N=0==(R=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage==0?0:D.h/(t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage))?0:D.w/R,T=t.yScale.step()*t._barWidthPercent*t._picLabel.picSizePercentage,B=0,X=Array.isArray(t._picLabel.picMaskChoice)?t._picLabel.picMaskChoice[0]:t._picLabel.picMaskChoice;B=null==t._picLabel.picMaskOptions||null==X||-1==t._picLabel.picMaskOptions.indexOf(X)?N:0==t._picLabel.picMaskOptions.indexOf(X)?d3.min([N,T]):N,C=parseFloat(B)+parseFloat(t._picLabel.picBorderPadding)}var j=t._numberLabel.suffix?t._numberLabel.suffix:"",I=e.length?e.map((function(t){return t.name})):[],Y=e.length?e.map((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+j})):[],H=0,V=0;0==t._textLabel.show||null==t._textLabel.show||null==t._textLabel.positionOptions||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)?H=0:2==t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)&&(H=G(I,t._textLabel.fontSize,t._textLabel.fontFamily)||0),0==t._numberLabel.show||null==t._numberLabel.show||null==t._numberLabel.positionChoice?V=0:"外部居右"==t._numberLabel.positionChoice&&(V=G(Y,t._numberLabel.fontSize,t._numberLabel.fontFamily)||0);var $=w,U=parseFloat(C)+parseFloat(H)+parseFloat(V)+10;u.range([$,x-s.width-U]),l.compute(),l.translate(m,b).update();var Z=parseFloat(s.width)+parseFloat($);s.picPadding($).translate(Z,0).update(),null==t._axisPositonOptions||null==t._axisPositonChoice?(l.translate(m,b).update(),s.picPadding($).translate(Z,0).update()):0==t._axisPositonOptions.indexOf(t._axisPositonChoice)&&(l.translate(m,l.height).update(),s.picPadding($).translate(Z,l.height).update());for(var Q=t.grid,K=t.rectPlot,J=t.tooltip,tt=t.overlay,et=t.selectOverlay,it=(t._barWidthPercent&&t._barWidthPercent,t.widthOfCore),nt=t.heightOfCore,at=h.step(),ot=(Math.min(d3.min(e,(function(t){return+t.value})),0),t.xAxis.tickLocations.slice(1)),rt=[],lt=0;lt<ot.length;lt++){var st={};st.name="刻度"+lt,st.value=ot[lt],rt.push(st)}null==t._axisPositonOptions||null==t._axisPositonChoice||1==t._axisPositonOptions.indexOf(t._axisPositonChoice)?Q.width(it-$-U>0?it-$-U:0).height(nt).xTickLocations(rt).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth).transition(t._transition).duration(1e3*t._duration):0==t._axisPositonOptions.indexOf(t._axisPositonChoice)&&Q.width(it-$-U>0?it-$-U:0).height(nt).xTickLocations(rt).yTickLocations(t.yAxis.tickLocations.map((function(t){return t+at}))).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth).transition(t._transition).duration(1e3*t._duration),tt.data(h.domain()).isScalePoint(!1).isHorizontal(!0).bandWidth(it-$-U>0?it-$-U:0).bandHeight(h.step()).onMouseover((function(i,n){var a=h.domain()[e.length-n-1==-1?1:e.length-n-1==-2?0:e.length-n-1],o=e.filter((function(t){return t.name===a})),r=[];a&&1!=a&&((r=[{text:k[t.flag-1]}]).push({text:o[0].name+": "+E(o[0].value,t._numberStyle,t._decimalPlaces),color:o[0].color}),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+h(a)+")")),J.data(r).update(),J.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){J.move([d3.event.offsetX,d3.event.offsetY]),et.show()})).onMouseout((function(){J.hide(),et.hide()})),et.width(it-$-U>0?it-$-U:0).height(h.step()).shadowColor("#ccc").hide(),K.data(e).xScale(u).yScale(h).barCornerRadius(t._barCornerRadius).barWidthPercent(t._barWidthPercent).borderWidth(t._borderWidth).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).barOrderBy(t._barOrderBy).fillOpacity(t._fillOpacity).textLabel(t._textLabel).numberLabel(t._numberLabel).picLabel(t._picLabel).axisTickShow(t._yTickShow).axisFontSize(t._fontSize).axisFontColor(t._fontColor).axisFontFamily(t._fontFamily).transition(t._transition).duration(i).easeStyle(t._easeStyle).startDelay(0).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).limitWidth(.5*x).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t.coreGroup.call(o,t.yAxis.width+.5,0),null==t._axisPositonOptions||null==t._axisPositonChoice?t.coreGroup.call(o,t.yAxis.width+.5,0):0==t._axisPositonOptions.indexOf(t._axisPositonChoice)&&t.coreGroup.call(o,t.yAxis.width+.5,l.height),Q.translate(0,0).update(),et.update(),K.update(),tt.update(),t.group.selectAll(".dynamic-bar-plane-grid .dynamic-bar-grid-x-line").attr("transform","translate("+$+",0 )"),t.group.selectAll(".bands-overlay").attr("transform","translate("+$+",0 )"),t.group.selectAll(".selectOverlay-rect").attr("x",""+$),a.attr("x",$).attr("width",t.widthOfCore-$-U>0?t.widthOfCore-$-U:0),t.group.selectAll(".dynamic-bar-axis-x .domain").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-path")+")"),r.attr("y",-20-parseFloat(t._fontSize)-l.height).attr("height",t._height+parseFloat(t._fontSize)+l.height).attr("x",-Z).attr("width",t.widthOfNoMargin),t.group.selectAll(".dynamic-bar-axis-x").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-axis")+")");var ut=t.coreGroup.select(".time").empty()?t.coreGroup.append("text").attr("class","time"):t.coreGroup.select(".time");ut.attr("display",t._timeLabel.show?"block":"none").attr("font-size",t._timeLabel.fontSize+"px").attr("font-family",t._timeLabel.fontFamily).attr("fill",q(t._timeLabel.color)),0==t._timeLabel.show||null==t._timeLabel.show?ut.attr("y",h.range()[0]-.4*t._timeLabel.fontSize).attr("x",it).attr("text-anchor","end").text(null):"desc"==t._barOrderBy||"fix"==t._barOrderBy?ut.attr("y",h.range()[0]-.4*t._timeLabel.fontSize).attr("x",it).attr("text-anchor","end").text(k[t.flag]):ut.attr("y",1.4*parseFloat(t._timeLabel.fontSize)).attr("x",it).attr("text-anchor","end").text(k[t.flag]),t.flag++,t.flag==k.length&&clearTimeout(t.timer)}}t.pause=function(e){e?(clearTimeout(t.timer),t.flag--,t._duration=0,i=0,J()):(t._duration=t._copyDuration,i=1e3*t._options[0][2],l())},t.timeChange=function(e){e=String(e),clearTimeout(t.timer),t.flag=k.indexOf(e),t.flag==k.length||t.flag>k.length?(t.flag=k.indexOf(e),k.indexOf(e)<=0&&(t.flag=0),t._duration=0,i=0,J(),t._duration=t._copyDuration,i=1e3*t._options[0][2],l()):(t.flag=k.indexOf(e),k.indexOf(e)<=0&&(t.flag=0),t._DynamicInterrupt?(t._duration=0,i=0,J()):(t.flag=k.indexOf(e)-1,k.indexOf(e)<=0&&(t.flag=0),t._duration=0,i=0,J(),k.indexOf(e)<=0&&(t.flag=0),t._duration=t._copyDuration,i=1e3*t._options[0][2],l()))}}),0)}t.pause=function(){},t.clean=function(){clearTimeout(t.timer)},t.timeChange=function(){}}},{key:"updateAxis",value:function(){}},{key:"onInterruptChange",value:function(t){this._DynamicInterrupt=t,this.pause(t)}},{key:"onTimeChange",value:function(t){this.timeChange(t)}},{key:"onCleanTimer",value:function(){this._DynamicInterrupt=!0,this.clean()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));this.legend.data(t).onClick((function(t){var e=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}))}},{key:"computeDomain",value:function(t){var e=this,i=e._yRange||[],n=t.length?t.map((function(t){return t.name})):[0,1],a=t.length?[0,Math.max(1.05*d3.max(t,(function(t){return t.value})),1)]:[0,1];e._yDomain=n,e._xDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"buildOption",value:function(t,e){var i=new Eo(t,e),n=Vo;return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).axisPositonOptions(n.axisPositonOptions).axisPositonChoice(n.axisPositonChoice).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"axisPositonOptions",value:function(t){return arguments.length?(this._axisPositonOptions=t,this):this._axisPositonOptions}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.timerControl,l=t.pictures;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._borderWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._borderWidth,this._borderColor=e.barborderColor?q(e.barborderColor):"",this._barOrderBy=e.barOrderBy?e.barOrderBy:this._barOrderBy,this._countOfBars=0==e.countOfBars||e.countOfBars?e.countOfBars:this._countOfBars),0!==Object.getOwnPropertyNames(i).length&&(this._textLabel=i&&i.rb_textLabel?i.rb_textLabel:this._textLabel,this._numberLabel=i&&i.rb_numberLabel?i.rb_numberLabel:this._numberLabel,this._picLabel=i&&i.rb_picLabel?i.rb_picLabel:this._picLabel,this._timeLabel=i&&i.timeLabel?i.timeLabel:this._timeLabel),0!==Object.getOwnPropertyNames(r).length&&(this._duration=r?r.frameDuration:this._duration,this._copyDuration=r.frameDuration?r.frameDuration:0,this._options=r.options?r.options:this._options),0!==Object.getOwnPropertyNames(l).length&&(this._pictureList=l?l.urlList:this._pictureList)}}]),e}(Tt),qo="axis-group",Uo="x-title",Zo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-line-axis-x"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=null,i._labelSuffix="",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=void 0;(s=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(.5).tickPadding(t._tickPadding).tickFormat(t._tickFormat);var u=n.select(".axis-group").empty()?n.append("g").attr("class",qo):n.select(".axis-group"),c=t._labelAngle;"自动"==t._labelDirection&&(c=r),u.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).call(s).on("start",(function(i,n){u.selectAll(".tick text").remove(),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),"竖排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i,n){var a=B(l[n],t._fontSize,t._fontFamily)-t._fontSize,o=I(t._fontSize,c,0,t._labelDirection,e),r=Math.sin(Math.abs(o.angle)*Math.PI/180)*a,s=Math.cos(Math.abs(o.angle)*Math.PI/180)*a;return"top"==e?"translate("+(o.x+(o.angle<0?-r+(-90==o.angle?a/2:0):r-(90==o.angle?a/2:0)))+","+(o.y-s)+")":"translate("+(o.x+(o.angle<0?-(-90==o.angle?a/2:0):90==o.angle?a/2:0))+","+o.y+")"})).append("text").text((function(t,e){return l[e]})).each((function(i,n){var o=d3.select(this),r=o.text().split("").reverse();"rev"==I(t._fontSize,c,0,t._labelDirection,e).flag&&(r=o.text().split(""));for(var l,s=[],u=0,h=0,d=+o.attr("x"),_=+o.attr("y"),f=o.text(null).append("tspan").attr("x",d).attr("y",_);l=r.pop();)s.push(l),f.text(s.join("")),f.node().getComputedTextLength()>0&&(0==h||++u,s.pop(),f.text(s.join("")),s=[l],f=o.append("tspan").attr("x",d).attr("y",u*parseFloat(.9*a*1.2)+_).text(l)),h++})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"横排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,t._labelDirection,e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){return l[e]})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"自动"==t._labelDirection&&u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,"横排",e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){return l[e]})).style("text-anchor",(function(i){return I(t._fontSize,c,0,"横排",e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,"横排",e).angle+")"}))}));var h=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)})),d=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove(),d3.selectAll(d).remove();var _=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var f=n.select(".x-title").empty()?n.append("g").attr("class",Uo):n.select(".x-title"),p=f.select("text").empty()?f.append("text"):f.select("text");l.length,d3.max(l,(function(e){return R(e,a,t._fontFamily)}));"top"===e?(f.call(o,_/2+Math.abs(i.range()[0]),-(this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0))),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",-6-.2*a).text(t._title)):(f.call(o,_/2+Math.abs(i.range()[0]),this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)),p.attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",a+6).text(t._title))}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0,o=0,r=0,l=!1;function s(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a,t._tickTextWidth=o,t._rotateFlag=l}var u=t._scaleFunc,c=t._type,h=t._fontSize,d=(t._minTickDistance,t._allowedMaxTextHeight);if("自动"==t._labelDirection){var _=Math.abs(u.range()[0]-u.range()[1]),f=void 0,p=void 0;if(e="category"===c?u.domain():u.ticks(t._tickCount),"number"===c&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0])),i=e,"number"===c){for(var y=[],x=0;x<e.length;x++)y.push(e[x]+t._labelSuffix);i=y}if(function(){var l=!1;if(f=_/e.length,"number"===c){for(var u=[],d=0;d<e.length;d++)u.push(e[d]+t._labelSuffix);i=u}return(p=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,h,t._fontFamily)}))||0)<.8*f&&(n=0,a=0==p?0:1.125*h,o=R(i[0],h,t._fontFamily)/2||0,r=R(i[0],h,t._fontFamily)/2||0,t._tickShow||(o=0),s(),l=!0),l}())return t;n=0;1*p<d?(a=0==p?0:1.125*h,o=1*R((i=e)[0],h,t._fontFamily)/2||0,r=1*R(i[0],h,t._fontFamily)/2||0,t._tickShow||(o=0),l=!1):(a=0==p?0:1.125*h,o=1*R((i=e)[0],h,t._fontFamily)/2||0,r=1*R(i[0],h,t._fontFamily)/2||0,t._tickShow||(o=0));var g=_/e.length;if("category"===c&&1.1*p>g){var v=Math.ceil(1.1*p/g);e=e.filter((function(t,e){return e%v==0})),i=i.filter((function(t,e){return e%v==0})),u(e[e.length-1])+p/2>u.range()[1]+15&&e.pop()}return s(),t}if("横排"==t._labelDirection){var m=Math.abs(u.range()[0]-u.range()[1]);e="category"===c?u.domain():u.ticks(t._tickCount),"number"===c&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));var b=new Array;if("number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var S=u.domain()[0],k=(Math.abs(parseFloat(S))>1?Math.round(parseFloat(S)):S)||0,w=u.domain()[1],C=w||1;if(t._countOfLabel>1){var O=(C-k)/(t._countOfLabel-1);C+=O;for(var F=k;F<C;F+=O)F<Math.ceil(w)+1&&b.push(w<t._countOfLabel?parseFloat(F.toFixed(2)):parseFloat(F.toFixed(0)))}else b.push(S)}if(b.length>t._countOfLabel&&1!=b.length&&b.pop(),i=e,"number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=b),"number"==c){for(var L=[],P=0;P<e.length;P++)L.push(e[P]+t._labelSuffix);i=L}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var A=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,h,t._fontFamily)}))||0,W=A?h:0,z=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,M=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),D=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),N=A*D+W*M,T=W*D+A*M;if(T<d)a=T,i=i,o=N,r=N,t._tickShow||(o=0),l=!0;else{a=d,i=i.map((function(e){return X(e,a/M,h,t._fontFamily)}));var G=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,j=G*D+W*M;o=j,r=j,a=W*D+G*M,t._tickShow||(o=0),l=!0}z%180!=0&&90!=Math.abs(n)||(o/=2,r/=2);var Y=m/e.length;if("category"===c&&r*(z%180==0||90==Math.abs(n)?2:1)>Y){var H=Math.ceil(r*(z%180==0||90==Math.abs(n)?2:1)*1.2/Y);e=e.filter((function(t,e){return e%H==0})),i=i.filter((function(t,e){return e%H==0}))}return s(),t}if("竖排"==t._labelDirection){var E,V=Math.abs(u.range()[0]-u.range()[1]);e="category"===c?u.domain():u.ticks(t._tickCount),"number"===c&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));var $=new Array;if("number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var q=u.domain()[0],U=(Math.abs(parseFloat(q))>1?Math.round(parseFloat(q)):q)||0,Z=u.domain()[1],Q=Z||1;if(t._countOfLabel>1){var K=(Q-U)/(t._countOfLabel-1);Q+=K;for(var J=U;J<Q;J+=K)J<Math.ceil(Z)+1&&$.push(Z<t._countOfLabel?parseFloat(J.toFixed(2)):parseFloat(J.toFixed(0)))}else $.push(q)}if($.length>t._countOfLabel&&1!=$.length&&$.pop(),i=e,"number"===c&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=$),"number"==c){for(var tt=[],et=0;et<e.length;et++)tt.push(e[et]+t._labelSuffix);i=tt}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var it=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,nt=it?h:0,at=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,ot=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),rt=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),lt=nt*rt+it*ot,st=it*rt+nt*ot;if(E=lt,st<d)a=st,i=i,o=lt,r=lt,t._tickShow||(o=0),l=!0;else{a=d,i=i.map((function(e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}(e,a/rt,h,t._fontFamily)}));var ut=d3.max(i,(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,ct=nt*rt+ut*ot;o=ct,r=ct,a=ut*rt+nt*ot,t._tickShow||(o=0),l=!0}0==at&&(o/=2,r/=2),90==Math.abs(at)&&(a=0==E?0:h,o/=2,r/=2);var ht=V/e.length;if("category"===c&&r*(0==Math.abs(at)||90==Math.abs(at)?2:1)>ht){var dt=Math.ceil(r*(0==Math.abs(at)||90==Math.abs(at)?2:1)*1.2/ht);e=e.filter((function(t,e){return e%dt==0})),i=i.filter((function(t,e){return e%dt==0}))}return s(),t}}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"height",get:function(){var t=this,e=this._scaleFunc,i=(Math.abs(e.range()[0]-e.range()[1]),this._tickValueTexts.length,d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),0);return this.isShow&&(i=this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.125*this._fontSize:0)),i}}]),e}(Bt),Qo="axis-group",Ko="y-title",Jo=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-line-axis-y"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i._countOfLabel=null,i._labelSuffix="",i._labelSuffixRank="",i._picPadding=0,i._chartType="line",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=e._orient,n=e._scaleFunc,a=e.group,r=e._fontSize,l=e._tickValueTexts,s=void 0;s=e.axisFunc="right"===i?d3.axisRight(n):d3.axisLeft(n);var u=null;"number"===e._type&&e._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(u=d3.format("d")),s.tickValues(e._tickValues).tickSizeInner(e._tickSize).tickSizeOuter(-.5).tickPadding(e._tickPadding).tickFormat(u);var c=a.select(".axis-group").empty()?a.append("g").attr("class",Qo):a.select(".axis-group");c.transition().duration(e._transition?e._duration:0).ease(d3.easeLinear).call(s).on("start",(function(){c.selectAll(".tick text").remove(),c.selectAll(".tick").filter((function(t,i){return-1!=e._tickValues.indexOf(t)})).append("text").style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).style("display",e._tickShow?"block":"none").attr("dx",(function(t,e){return-8})).attr("dy",.4*r).text((function(t,e){return l[e]})),c.selectAll(".tick line").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none"),c.select("path").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none")}));var h=e.group.selectAll(".axis-y-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)||"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove();var d=Math.abs(n.range()[0]-n.range()[1]);if(e._titleShow&&e._title){var _=a.select(".y-title").empty()?a.append("g").attr("class",Ko):a.select(".y-title"),f=_.select("text").empty()?_.append("text"):_.select("text"),p=(R(e._title,r,e._fontFamily),d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})));_.call(o,-(this._tickShow?(p?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0!=parseFloat(e._yAxisLineWidth)&&e._yAxisLineWidth&&e._axisLineShow?5:0),d/2),f.attr("y",-9-e._picPadding).style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(e._title)}else a.select(".y-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);Math.abs(a.range()[0]-a.range()[1]);e="category"===o?a.domain():a.ticks(t._tickCount),"number"===o&&0!=t._yRange.length&&null!=t._yRange[0]&&t._yRange[0].constructor!==Object&&e.push(-1==String(t._yRange[0]).indexOf(".")?t._yRange[0]:t._yRange[0].toFixed(0));new Array;var s=[];if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[0],c=(Math.abs(parseFloat(u))>1?Math.round(parseFloat(u)):u)||0,h=a.domain()[1]||1;if(0!=t._countOfLabel){var d=h-c,_=t._countOfLabel,f=Math.ceil(Math.abs(d/t._countOfLabel)),p=8*Math.ceil(t._tickCount),y=d3.tickStep(c,h,p);t._countOfLabel<y&&(f=Math.ceil(Math.abs(d/y)),_=y),h+=f;for(var x=0;x<f+1;x++)s.push(c+x*_)}else s.push(c);"number"===o&&0!=t._yRange.length&&(1==t._yRange.length?isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]):(isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]),isNaN(t._yRange[1])||null==t._yRange[1]||(s[s.length-1]>t._yRange[1]&&s.pop(),s.push(t._yRange[1]))),s=Array.from(new Set(s))),0!=t._countOfLabel&&a.domain([d3.min(s),d3.max(s)]);var g=[];s.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;g.push(i)}})),g=g.filter((function(t){return t<=8})),s=s.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(g)&&(t=parseFloat(t).toFixed(d3.max(g)))}return t}))}if(i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o||"rankLine"==t._chartType){for(var v=[],m=0;m<e.length;m++)v.push(E(e[m],t._numberStyle,t._decimalPlaces)+("rankLine"==t._chartType?t._labelSuffixRank:t._labelSuffix));i=v}var b=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,r,t._fontFamily)}))||0;return b<=l?(i=i,n=b):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"picPadding",value:function(t){return arguments.length?(this._picPadding=parseFloat(t),this):this._picPadding}},{key:"chartType",value:function(t){return arguments.length?(this._chartType=t,this):this._chartType}},{key:"labelSuffixRank",value:function(t){return arguments.length?(this._labelSuffixRank=t,this):this._labelSuffixRank}},{key:"width",get:function(){var t=this,e=d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),i=0;return this.isShow&&(i=this._tickShow?(e?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._titleShow&&this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0),i}}]),e}(Bt),tr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-line-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);t.group;var n=t.group.selectAll(".lines").data(e,(function(t){return t.name}));n.enter().append("g").attr("class","lines line_enter").attr("opacity",1).append("path").style("fill","none").style("stroke",(function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}return e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("d",(function(t){return i(t.data)}));n.attr("opacity",1).attr("class","lines line_update");n.select("path").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("d",(function(t){return i(t.data)}));var a=n.exit();return a.attr("class","lines line_exit").attr("opacity",0).remove(),a.select("path").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("d",(function(t){return i(t.data)})),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"picLabel",value:function(t){return arguments.length?(this._picLabel=t,this):this._picLabel}},{key:"labelData",value:function(t){return arguments.length?(this._labelData=t,this):this._labelData}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),er=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-line-label"),i._xScale=null,i._yScale=null,i._lineFunc=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t._data;(t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return t._yScale(e.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}))).curve(t._curve);t.group;function e(t){return Math.floor(t)===t?0:t.toString().split(".")[1].length||0}var i=t._numberLabel.suffix?t._numberLabel.suffix:"",n=t.group.selectAll(".labels-group").data(t._labelData,(function(t){return t.key})),a=n.enter().append("g").attr("class","labels-group label_enter").attr("opacity",1);a.attr("transform",(function(e){return"translate("+t._xScale(e.lastName)+", "+t._yScale(e.lastValue)+")"})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){return"translate("+t._xScale(e.name)+", "+t._yScale(e.value)+")"}));n.attr("opacity",1).attr("class","labels-group label_update").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){return"translate("+t._xScale(e.name)+", "+t._yScale(e.value)+")"}));var o=n.exit();o.attr("class","labels-group label_exit").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("transform",(function(e){return"translate("+t._xScale(e.name)+", "+t._yScale(e.value)+")"})).remove();var r=Array.isArray(t._picLabel.endPointChoice)?t._picLabel.endPointChoice[0]:t._picLabel.endPointChoice;if(0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.endPointStyles||null==r||-1==t._picLabel.endPointStyles.indexOf(r))if(0==t._picLabel.endPointStyles.indexOf(r)){if(null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","end").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return-5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(t){return 5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}else if(1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return t._textLabel.fontSize/2})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return t._textLabel.fontSize/2})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var n=0;return n=0==t._textLabel.show||null==t._textLabel.show?0:R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,0==t._numberLabel.show||null==t._numberLabel.show?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+i,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0,n+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var n=0;return n=0==t._textLabel.show||null==t._textLabel.show?0:R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,0==t._numberLabel.show||null==t._numberLabel.show?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+i,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0,n+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var n=0;return n=0==t._textLabel.show||null==t._textLabel.show?0:R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,0==t._numberLabel.show||null==t._numberLabel.show?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+i,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0,n+5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}}else{d3.format(",");if(null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.1*-t._textLabel.fontSize})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.1*-t._textLabel.fontSize})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.1*-t._textLabel.fontSize}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(t){return 5})).attr("y",(function(e){return 1.1*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return 1.1*t._numberLabel.fontSize})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return 1.1*t._numberLabel.fontSize}))}else if(1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.5*t._textLabel.fontSize})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.5*t._textLabel.fontSize})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.5*t._textLabel.fontSize}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return i+(isNaN(i)||0==i?0:5)+5})).attr("y",(function(e){return.5*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return i+(isNaN(i)||0==i?0:5)+5})).attr("y",(function(e){return.5*t._numberLabel.fontSize})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return i+(isNaN(i)||0==i?0:5)+5})).attr("y",(function(e){return.5*t._numberLabel.fontSize}))}}else if(0==t._picLabel.endPointStyles.indexOf(r)){a.append("circle").attr("display",t._picLabel.show?"block":"none").style("fill",(function(e,i){var n=q(t._picLabel.endPointColor)||e.color;if(n&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var p=o.concat(),g=p.pop();return t.group.append("linearGradient").attr("id",t.id+"-label-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-label-index-"+i)+")"}return n})).attr("r",t._picLabel.endPointHeight/2<0?0:t._picLabel.endPointHeight/2),n.select("circle").attr("display",t._picLabel.show?"block":"none").attr("r",t._picLabel.endPointHeight/2<0?0:t._picLabel.endPointHeight/2),o.select("circle").attr("display",t._picLabel.show?"block":"none").style("fill","none").attr("r",0);var l=a.append("g").attr("class","line-images");if(l.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("display",t._picLabel.show?"block":"none"),n.select(".line-images").attr("display",t._picLabel.show?"block":"none"),o.select(".line-images").attr("display",t._picLabel.show?"block":"none"),l.append("clipPath").attr("class","line-clip").attr("id",(function(e,i){return"clipLine-"+t.id+"-"+i})).append("circle").attr("r",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]);return o/2<0?0:o/2})),n.select(".line-clip").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i;return d3.min([a,n])/2})),o.select(".line-clip").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i;return d3.min([a,n])/2})),l.append("image").attr("class","image").attr("clip-path",(function(e,i){return"url("+c("#clipLine-"+t.id+"-"+i)+")"})).attr("preserveAspectRatio","xMidYMid meet").attr("x",(function(e){var i=0,n=t._picLabel.picHeight;return-(0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i)/2})).attr("y",-t._picLabel.picHeight/2).attr("height",(function(e){return t._picLabel.picHeight})).attr("width",(function(e){var i=0,n=t._picLabel.picHeight;return 0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i})).attr("xlink:href",(function(t){return t.imgUrl})).attr("display",t._picLabel.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),n.select(".image").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",(function(e){var i=0,n=t._picLabel.picHeight;return-(0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i)/2})).attr("y",-t._picLabel.picHeight/2),o.select(".image").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight;return-(0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i)/2})).attr("y",-t._picLabel.picHeight/2),null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","end").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return-(d3.max([o,r])/2)-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return-(d3.max([o,r])/2)-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return-(d3.max([o,r])/2)-5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}else if(1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._textLabel.fontSize/2})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._textLabel.fontSize/2})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5+R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5+R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5+R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}}else{d3.format(",");a.append("rect").attr("display",t._picLabel.show?"block":"none").style("fill",(function(e,i){var n=q(t._picLabel.endPointColor)||e.color;if(n&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var p=o.concat(),g=p.pop();return t.group.append("linearGradient").attr("id",t.id+"-label-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-label-index-"+i)+")"}return n})).attr("x",0).attr("y",-t._picLabel.endPointHeight/2).attr("width",(function(e){var n=0,a=t._picLabel.picHeight;n=0==a?0:e.imgHeight/a;var o=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0,r=t._numberLabel.show&&R(E(e.value,t._numberStyle,t._decimalPlaces)+i,t._numberLabel.fontSize,t._numberLabel.fontFamily)||0,l=0==n?0:e.imgWidth/n,s=0;if(t._picLabel.endPointHeight>t._picLabel.picHeight&&(s=t._picLabel.endPointHeight-t._picLabel.picHeight),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice))return l+(0==l?0==o&&0==r?0:5:s)+(0==o&&0==r?0:2);if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){var u=d3.max([o,r]);return l+(0==l?0==o&&0==r?0:5:s)+u+(isNaN(u)?0:5)+(0==o&&0==r?0:2)}return 1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?l+(0==l?0==o&&0==r?0:5:s)+o+r+(isNaN(r)?0:5)+(isNaN(o)?0:5)+(0==o&&0==r?0:2):void 0})).attr("height",t._picLabel.endPointHeight),n.select("rect").attr("display",t._picLabel.show?"block":"none").attr("x",0).attr("y",-t._picLabel.endPointHeight/2).attr("width",(function(e){var n=0,a=t._picLabel.picHeight;n=0==a?0:e.imgHeight/a;var o=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0,r=t._numberLabel.show&&R(E(e.value,t._numberStyle,t._decimalPlaces)+i,t._numberLabel.fontSize,t._numberLabel.fontFamily)||0,l=0==n?0:e.imgWidth/n,s=0;if(t._picLabel.endPointHeight>t._picLabel.picHeight&&(s=t._picLabel.endPointHeight-t._picLabel.picHeight),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice))return l+(0==l?0==o&&0==r?0:5:s)+(0==o&&0==r?0:2);if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){var u=d3.max([o,r]);return l+(0==l?0==o&&0==r?0:5:s)+u+(isNaN(u)||0==u?0:5)+(0==o&&0==r?0:2)}return 1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?l+(0==l?0==o&&0==r?0:5:s)+o+r+(isNaN(r)||0==r?0:5)+(isNaN(o)||0==o?0:5)+(0==o&&0==r?0:2):void 0})).attr("height",t._picLabel.endPointHeight),o.select("rect").attr("display",t._picLabel.show?"block":"none").style("fill","none").attr("width",0).attr("height",0);var s=a.append("g").attr("class","line-images");if(s.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("display",t._picLabel.show?"block":"none"),n.select(".line-images").attr("display",t._picLabel.show?"block":"none"),o.select(".line-images").attr("display",t._picLabel.show?"block":"none"),s.append("image").attr("class","image").attr("preserveAspectRatio","xMidYMid meet").attr("x",(function(e){var i=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(i=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),i})).attr("y",-t._picLabel.picHeight/2).attr("height",(function(e){return t._picLabel.picHeight})).attr("width",(function(e){var i=0,n=t._picLabel.picHeight;return 0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i})).attr("xlink:href",(function(t){return t.imgUrl})).attr("display",t._picLabel.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),n.select(".image").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",(function(e){var i=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(i=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),i})).attr("y",-t._picLabel.picHeight/2),o.select(".image").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(i=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),i})).attr("y",-t._picLabel.picHeight/2),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.3*-t._textLabel.fontSize})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.3*-t._textLabel.fontSize})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.3*-t._textLabel.fontSize}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.9*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.9*t._numberLabel.fontSize})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.9*t._numberLabel.fontSize}))}else if(1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){a.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.4*t._textLabel.fontSize})),n.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.4*t._textLabel.fontSize})),o.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.4*t._textLabel.fontSize}));d3.format(",");a.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2);var r=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return a+(0==a?0:o)+r+(isNaN(r)||0==r?0:5)+5})).attr("y",(function(e){return.4*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})),n.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2);var r=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return a+(0==a?0:o)+r+(isNaN(r)||0==r?0:5)+5})).attr("y",(function(e){return.4*t._numberLabel.fontSize})),o.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(n){var a=this,o=d3.interpolateNumber(n.lastValue,n.value);return function(r){d3.select(a).text(E(parseFloat(o(r)).toFixed(e(n.value)),t._numberStyle,t._decimalPlaces)+i)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2);var r=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return a+(0==a?0:o)+r+(isNaN(r)||0==r?0:5)+5})).attr("y",(function(e){return.4*t._numberLabel.fontSize}))}}return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"picLabel",value:function(t){return arguments.length?(this._picLabel=t,this):this._picLabel}},{key:"labelData",value:function(t){return arguments.length?(this._labelData=t,this):this._labelData}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),ir=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-line-chart"),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._lineWidth=2,i._curve=d3.curveLinear,i._picLabel={titlename:"节点及图片显示",show:!0,endPointStyles:["圆形","方形"],endPointChoice:["圆形"],endPointColor:null,endPointHeight:10,picHeight:10},i._textLabel={titlename:"文本标签显示",show:!0,fontFamily:"阿里巴巴普惠体 常规",fontSize:14,positionOptions_circle:["左右分布","居右"],positionOptions_rect:["换行","不换行"],positionChoice:"居右",color:"#545454"},i._numberLabel={titlename:"数值标签显示",show:!0,fontFamily:"阿里巴巴普惠体 常规",fontSize:14,color:"#545454",positionChoice:"外部居右"},i._pictureList=[],i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=[],i._moveStyle="",i._endPause=0,i._DynamicInterrupt=!0,i.timer=null,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;clearTimeout(t.timer),t.mainGroup.selectAll("*").remove(),t.flag=0;var e=0,i=1e3*t._duration,n=t.activeData,a=n.length>0?n[0].time:[];t.clipArea=new Ut(this.defs),t.xAxis=new Zo(this.mainGroup),t.yAxis=new Jo(this.mainGroup),this.yAxis.minTickDistance(1),t.coreGroup=this.mainGroup.append("g").attr("class","core-group"),t.grid=new Jt(this.coreGroup),t.linePlot=new tr(this.coreGroup),t.labelPlot=new er(this.coreGroup),t.overlay=new te(this.coreGroup),t.guideLine=new Et(this.coreGroup),t.mainGroup.selectAll(".animation-defs").remove();var r,l=t.mainGroup.append("defs").attr("class","animation-defs"),s=l.append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-10).attr("height",t._height),u=l.append("clipPath").attr("id","animation-overlay-"+t.id+"-axis").append("rect").attr("y",-20).attr("height",t._height),h=l.append("clipPath").attr("id","animation-overlay-"+t.id+"-path").append("rect").attr("y",-20).attr("height",t._height),d=l.append("clipPath").attr("id","animation-overlay-"+t.id+"-band").append("rect").attr("width",0).attr("height",t._height),_=((r=navigator.userAgent).indexOf("Trident"),r.indexOf("Presto"),r.indexOf("AppleWebKit"),r.indexOf("Gecko")>-1&&r.indexOf("KHTML"),r.match(/AppleWebKit.*Mobile.*/),r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),r.indexOf("Android")>-1||r.indexOf("Adr"),r.indexOf("iPhone"),r.indexOf("iPad"),r.indexOf("Safari"),r.indexOf("MicroMessenger"),r.match(/\sQQ/i),(navigator.browserLanguage||navigator.language).toLowerCase(),[]),f=0,p=t._pictureList,y=[],x=p.length;0==x&&m(y);for(var g=function(t){_[t]=new Image,_[t].crossOrigin="Anonymous";var e={};_[t].onload=function(){var i=document.createElement("canvas");i.height=_[t].height,i.width=_[t].width,i.getContext("2d").drawImage(_[t],0,0),e.url=i.toDataURL(),e.w=this.width,e.h=this.height,e.index=t,null!=p[t]&&""!=p[t]&&p[t].constructor!==Object||(e.w=0,e.h=0),y.push(e),++f==x&&m(y)},_[t].src=p[t],null!=p[t]&&""!=p[t]&&p[t].constructor!==Object||(_[t].src="",_[t].onload())},v=0;v<x;v++)g(v);function m(r){setTimeout((function(){t.flag=0;var l=[];n.forEach((function(t,e){var i={};i.name=t.name,i.color=t.color,i.time=a,i.data=t.data,i.imgUrl=null,i.imgWidth=0,i.imgHeight=0,r.forEach((function(t,n){t.index==e&&(i.imgWidth=t?0==t.h?0:t.w:0,i.imgHeight=t?0==t.w?0:t.h:0,i.imgUrl=t?t.url:null)})),l.push(i)})),t.computeDomain(l);var _=t.xAxis,f=t.yAxis,p=t.xScale,y=t.yScale,x=t._xType,g=t._yType,v=t._xOrient,m=t._yOrient,b=t._fontSize,S=t._width-t._marginLeft-t._marginRight,k=0;if(1==t._picLabel.show){var w=isNaN(parseFloat(t._picLabel.endPointHeight))?0:parseFloat(t._picLabel.endPointHeight),C=isNaN(parseFloat(t._picLabel.picHeight))?0:parseFloat(t._picLabel.picHeight);k=d3.max([w,C])}var O=t._xTickShow?parseFloat(t._fontSize)+5:0,F=t._xTitle?parseFloat(t._fontSize)+5:0,L=t.heightOfMainGroup-k/2;k/2>O+F&&(L=t.heightOfMainGroup-k+O+F),p.domain(t._xDomain),_.scaleFunc(p).allowedMaxTextHeight(.5*L).type(x).orient(v).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(b).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(i).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),y.domain(t._yDomain),f.scaleFunc(y).allowedMaxTextWidth(.5*S).type(g).chartType("line").orient(m).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(b).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(i).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);f&&f.titleHeight;var P=(L-_.allowedMaxTextHeight())/(3*b);_.compute(),f.tickCount(P),f.compute(),y.range([L-_.height,0]),f.compute();var A=f.width,W=L-_.height+k/2,z=(f.width,k/2),M=t._numberLabel.suffix?t._numberLabel.suffix:"",D=l.length?l.map((function(t){return t.name})):[],R=[];l.forEach((function(e){return e.data.forEach((function(e){return R.push(E(e.value,t._numberStyle,t._decimalPlaces)+M)}))}));var N=0,T=0;N=0==t._textLabel.show||null==t._textLabel.show?0:G(D,t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,T=0==t._numberLabel.show||null==t._numberLabel.show?0:G(R,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0;var B=0,X=Array.isArray(t._picLabel.endPointChoice)?t._picLabel.endPointChoice[0]:t._picLabel.endPointChoice;if(0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.endPointStyles||null==X||-1==t._picLabel.endPointStyles.indexOf(X)){var j=0;if(0==t._picLabel.endPointStyles.indexOf(X)){parseFloat(t._picLabel.endPointHeight);null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?j=0:0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?j=T:1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)&&(j=T+N)}else null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?j=0:0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?j=d3.max([N,T]):1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)&&(j=T+N);B=parseFloat(j)}else if(r.length>0||0==r.length){var I=d3.max(r,(function(t){return t.w})),Y=r.filter((function(t){return t.w==I}))[0],H=0,V=0==(H=0==t._picLabel.picHeight?0:(Y?Y.h:0)/t._picLabel.picHeight)?0:(Y?Y.w:0)/H,$=t._picLabel.picHeight,U=0;if(0==t._picLabel.endPointStyles.indexOf(X)){var Z=d3.min([V,$]),Q=parseFloat(t._picLabel.endPointHeight);null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?U=d3.max([Z,Q])/2:0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?U=d3.max([Z,Q])/2+T:1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)&&(U=d3.max([Z,Q])/2+T+N)}else{var K=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(K=t._picLabel.endPointHeight-t._picLabel.picHeight),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?U=V+(t._picLabel.show?K:0):0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?U=V+d3.max([N,T])+(t._picLabel.show?K:0):1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)&&(U=V+T+N+(t._picLabel.show?K:0))}B=parseFloat(U)}var J=B;p.range([0,(S-f.width-J)*(a.length-1)/(t._countOfLabel-1)]),_.compute(),_.translate(A,W).update();var tt=parseFloat(f.width);if(f.picPadding(0).translate(tt,z).update(),t._xTitle){var et=t.mainGroup.select(".x-core-title").empty()?t.mainGroup.append("text").attr("class","x-core-title"):t.mainGroup.select(".x-core-title");et.attr("display",t._xTitle?"block":"none").attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("fill",q(t._fontColor)),et.attr("y",W+_.height-t._fontSize/2).attr("x",A+(S-f.width-J)/2).attr("text-anchor","middle").text(t._xTitle)}var it=G(a,t._fontSize,t._fontFamily),nt=t.grid,at=t.linePlot,ot=t.tooltip,rt=t.overlay,lt=t.guideLine,st=t.clipArea,ut=t.widthOfCore,ct=t.heightOfCore-k/2;k/2>O+F&&(ct=t.heightOfCore-k+O+F);p.step(),Math.min(d3.min(l,(function(t){return+t.value})),0);function ht(){if(clearTimeout(t.timer),t.flag<a.length-1){var n=+new Date;ft();var o=+new Date;e=o-n,i=1e3*t._duration-e>0?1e3*t._duration-e:0,t.timer=setTimeout(ht,t._transition?i:0)}else clearTimeout(t.timer)}if(nt.width((S-f.width-J)*(a.length-1)/(t._countOfLabel-1)).height(ct).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth).transition(t._transition).duration(t._transition?i:0),lt.y1(0).y2(ct).stroke("#c6c6c6").strokeDasharray("0 0"),rt.data(p.domain()).isScalePoint(!0).bandX(p.range()[0]).bandWidth(p.step()).bandHeight(ct).onMouseover((function(e,i){var n=e,a=[{text:n=="&-"+(i+1)?"":n}],o=[];l.forEach((function(e,i){var r=e.data.filter((function(t){return t.name===n}));o.push({key:e.key,name:e.name,color:e.color,data:r}),a.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(isNaN(parseFloat(r[0].value))?"":r[0].value,t._numberStyle,t._decimalPlaces),color:e.color})})),ot.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),lt.x(0).update().show(),t.flag<t._countOfLabel-1?t.group.selectAll(".guide-line").transition().duration(200).ease(d3.easeLinear).attr("transform","translate("+p(n)+",0)"):t.group.selectAll(".guide-line").transition().duration(200).ease(d3.easeLinear).attr("transform","translate("+(p(n)+p.step()-p.step()*(t.flag-(t._countOfLabel-2)))+",0)")})).onMousemove((function(){ot.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){ot.hide(),lt.hide()})),t._DynamicInterrupt){var dt=f.width<it/2?f.width:it/2,_t=J<it/2?J:it/2;u.attr("x",-dt-t._marginLeft).attr("width",S-f.width-J+dt+_t+t._marginLeft<0?0:S-f.width-J+dt+_t+t._marginLeft),h.attr("x",0).attr("width",S-f.width-J<0?0:S-f.width-J),t.group.selectAll(".dynamic-line-axis-x").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-axis")+")"),t.group.selectAll(".dynamic-line-axis-x .domain").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-path")+")")}else ht();function ft(){if(0==a.length||t.flag>a.length-1||t.flag==a.length-1)clearTimeout(t.timer);else{t.computeDomain(l);var e=t.yAxis,f=t.yScale,y=t._yType,x=t._yOrient,g=t._fontSize,v=t._width-t._marginLeft-t._marginRight,m=0;if(1==t._picLabel.show){var b=isNaN(parseFloat(t._picLabel.endPointHeight))?0:parseFloat(t._picLabel.endPointHeight),S=isNaN(parseFloat(t._picLabel.picHeight))?0:parseFloat(t._picLabel.picHeight);m=d3.max([b,S])}var k=t._xTickShow?parseFloat(t._fontSize)+5:0,w=t._xTitle?parseFloat(t._fontSize)+5:0,C=t.heightOfMainGroup-m/2;m/2>k+w&&(C=t.heightOfMainGroup-m+k+w),f.domain(t._yDomain),e.scaleFunc(f).allowedMaxTextWidth(.5*v).type(y).chartType("line").orient(x).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(i).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);e&&e.titleHeight;var O=(C-_.allowedMaxTextHeight())/(3*g);e.tickCount(O),e.compute(),f.range([C-_.height,0]),e.compute();var F=e.width,L=C-_.height+m/2,P=(e.width,m/2),A=parseFloat(e.width);e.picPadding(0).translate(A,P).update(),p.range([0,(v-e.width-J)*(a.length-1)/(t._countOfLabel-1)]),_.duration(i).translate(F,L).update(),nt.width((v-e.width-J)*(a.length-1)/(t._countOfLabel-1)).height(ct).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth).transition(t._transition).duration(t._transition?i:0),nt.update(),rt.update(),at.data(l).xScale(p).yScale(f).transition(t._transition).duration(i).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._DynamicInterrupt).curve(t._curve).lineWidth(t._lineWidth).textLabel(t._textLabel).numberLabel(t._numberLabel).picLabel(t._picLabel).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),at.update();var W=[];n.forEach((function(e,i){var n={};n.key=e.name,n.imgUrl=null,n.imgWidth=0,n.imgHeight=0,r.forEach((function(t,e){t.index==i&&(n.imgWidth=t?0==t.h?0:t.w:0,n.imgHeight=t?0==t.w?0:t.h:0,n.imgUrl=t?t.url:null)})),e.data.forEach((function(e,i){0==t.flag||-1==t.flag?(e.name==a[0]&&(n.lastValue=e.value),n.lastName=a[0]):e.name==a[t.flag]&&(n.lastValue=e.value,n.lastName=e.name),e.name==a[t.flag+1]&&(n.name=e.name,n.value=e.value),n.color=e.color})),W.push(n)}));var z=t.labelPlot;if(z.data(l).labelData(W).xScale(p).yScale(f).transition(t._transition).duration(i).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._DynamicInterrupt).curve(t._curve).lineWidth(t._lineWidth).textLabel(t._textLabel).numberLabel(t._numberLabel).picLabel(t._picLabel).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),z.update(),t.flag<t._countOfLabel-1){var M=e.width<it/2?e.width:it/2,D=J<it/2?J:it/2;u.attr("x",-M-t._marginLeft).attr("width",v-e.width-J+M+D+t._marginLeft<0?0:v-e.width-J+M+D+t._marginLeft),h.attr("x",0).attr("width",v-e.width-J<0?0:v-e.width-J),t.group.selectAll(".dynamic-line-axis-x .axis-group").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )")}else h.transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("x",p.step()*(t.flag-(t._countOfLabel-2))),t.group.selectAll(".dynamic-line-axis-x .axis-group").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-p.step()*(t.flag-(t._countOfLabel-2))+",0 )");t.group.selectAll(".dynamic-line-axis-x").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-axis")+")"),t.group.selectAll(".dynamic-line-axis-x .domain").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-path")+")"),t.coreGroup.call(o,t.yAxis.width+.5,.5+m/2),t.flag<t._countOfLabel-1?(s.transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("x",0).attr("width",p.step()*(t.flag+1)),d.transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("x",0).attr("width",p.step()*(t.flag+1)),t.group.selectAll(".dynamic-line-plot").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )"),t.group.selectAll(".dynamic-line-label").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )"),t.group.selectAll(".plane-grid").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0.5 )"),t.group.selectAll(".bands-overlay").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )")):(s.attr("width",v-e.width-J<0?0:v-e.width-J).transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("width",v-e.width-J<0?0:v-e.width-J).attr("x",p.step()*(t.flag-(t._countOfLabel-2))),d.attr("width",v-e.width-J<0?0:v-e.width-J).transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("width",v-e.width-J<0?0:v-e.width-J).attr("x",p.step()*(t.flag-(t._countOfLabel-2)+1)),t.group.selectAll(".dynamic-line-plot").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-p.step()*(t.flag-(t._countOfLabel-2))+",0 )"),t.group.selectAll(".dynamic-line-label").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-p.step()*(t.flag-(t._countOfLabel-2))+",0 )"),t.group.selectAll(".plane-grid").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-p.step()*(t.flag-(t._countOfLabel-2))+",0.5 )"),t.group.selectAll(".bands-overlay").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-p.step()*(t.flag-(t._countOfLabel-2)+1)+",0 )")),t.coreGroup.selectAll(".dynamic-line-plot .lines").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.group.selectAll(".plane-grid").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.group.selectAll(".bands-overlay").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-band")+")"),0!=t._clipShow.length?(st.width(ut).height(ct).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+st.id)+")"),st.update()):(st.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),st.update()),t.flag++}}t.pause=function(e){e?(clearTimeout(t.timer),t.flag--,i=0,ft()):(i=1e3*t._duration,ht())},t.timeChange=function(e){e=String(e),clearTimeout(t.timer),t.flag=a.indexOf(e),t.flag==a.length-1||t.flag>a.length-1?(t.flag=a.indexOf(e)-1,i=0,ft(),i=1e3*t._duration):(0==a.indexOf(e)||a.indexOf(e)<0?t.flag=-1:t.flag=a.indexOf(e)-1,t._DynamicInterrupt?(i=0,ft()):(i=0,ft(),i=1e3*t._duration,ht()))}}),0)}t.pause=function(){},t.clean=function(){clearTimeout(t.timer)},t.timeChange=function(){}}},{key:"updateAxis",value:function(){}},{key:"onInterruptChange",value:function(t){this._DynamicInterrupt=t,this.pause(t)}},{key:"onTimeChange",value:function(t){this.timeChange(t)}},{key:"onCleanTimer",value:function(){this._DynamicInterrupt=!0,this.clean()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));this.legend.data(t).onClick((function(t){var e=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}))}},{key:"computeDomain",value:function(t){var e=this,i=e.activeData,n=i.length>0?i[0].time:[],a=[];t.forEach((function(t){if(e.flag<e._countOfLabel-1)for(var i=0;i<e._countOfLabel;i++)i<n.length&&a.push(t.data[i].value);else for(var o=e.flag-(e._countOfLabel-1);o<e.flag+3;o++)o<n.length&&a.push(t.data[o].value)}));var o=e._yRange||[],r=t.length?t[0].time:[0,1],l=t.length?[1.1*Math.min(d3.min(a),0),1.1*Math.max(d3.max(a),0)]:[0,1];e._xDomain=r.length>0?r:[0,1],e._yDomain=[isNaN(parseFloat(o[0]))?l[0]:parseFloat(o[0]),isNaN(parseFloat(o[1]))?isNaN(parseFloat(o[0]))?l[1]:l[1]<o[0]?1.5*o[0]:l[1]:parseFloat(o[1])]}},{key:"buildOption",value:function(t,e){var i=new Eo(t,e),n=Vo;return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).countOfLabel(parseFloat(n.countOfLabel)<2?2:parseFloat(n.countOfLabel)).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.timerControl,l=t.pictures;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var s={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._curve=e.lineType?s[e.lineType]:d3.curveLinear),0!==Object.getOwnPropertyNames(i).length&&(this._textLabel=i&&i.nl_textLabel?i.nl_textLabel:this._textLabel,this._numberLabel=i&&i.nl_numberLabel?i.nl_numberLabel:this._numberLabel,this._picLabel=i&&i.nl_picLabel?i.nl_picLabel:this._picLabel),0!==Object.getOwnPropertyNames(r).length&&(this._duration=r?r.frameDuration:this._duration,this._copyDuration=r.frameDuration?r.frameDuration:0,this._options=r.options?r.options:this._options),0!==Object.getOwnPropertyNames(l).length&&(this._pictureList=l?l.urlList:this._pictureList)}}]),e}(Tt),nr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-rank-line-plot"),i._xScale=null,i._yScale=null,i._lineFunc=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return e.rank<t._countOfLines+1?t._yScale(e.rank):t._yScale.range()[0]})).defined((function(t){return!isNaN(parseFloat(t.value))}));i.curve(t._curve);t.group;var n=t.group.selectAll(".lines").data(e,(function(t){return t.name}));n.enter().append("g").attr("class","lines line_enter").append("path").style("fill","none").style("stroke",(function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}return e.color})).style("stroke-width",t._lineWidth).style("stroke-dasharray",t._strokeDasharry).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("d",(function(t){return i(t.data)}));n.attr("class","lines line_update");n.select("path").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("d",(function(t){return i(t.data)}));var a=n.exit();return a.attr("class","lines line_exit").remove(),a.select("path").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("d",(function(t){return i(t.data)})),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"picLabel",value:function(t){return arguments.length?(this._picLabel=t,this):this._picLabel}},{key:"labelData",value:function(t){return arguments.length?(this._labelData=t,this):this._labelData}},{key:"countOfLines",value:function(t){return arguments.length?(this._countOfLines=t,this):this._countOfLines}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),or=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-rank-label"),i._xScale=null,i._yScale=null,i._lineFunc=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t._data;(t._lineFunc||d3.line().x((function(e){return t._xScale(e.name)})).y((function(e){return e.rank<t._countOfLines+1?t._yScale(e.rank):t._yScale.range()[0]})).defined((function(t){return!isNaN(parseFloat(t.value))}))).curve(t._curve);t.group;var e=t._numberLabel.suffix?t._numberLabel.suffix:"",i=t.group.selectAll(".labels-group").data(t._labelData,(function(t){return t.key})),n=i.enter().append("g").attr("class","labels-group label_enter");n.attr("transform",(function(e){return"translate("+t._xScale(e.lastName)+", "+(e.lastRank<t._countOfLines+1?t._yScale(e.lastRank):t._yScale.range()[0])+")"})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",(function(e,i){return e.rank<t._countOfLines+1&&0!=t._countOfLines?1:0})).attr("transform",(function(e){return"translate("+t._xScale(e.name)+", "+(e.rank<t._countOfLines+1?t._yScale(e.rank):t._yScale.range()[0])+")"}));i.attr("class","labels-group label_update").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",(function(e,i){return e.rank<t._countOfLines+1&&0!=t._countOfLines?1:0})).attr("transform",(function(e){return"translate("+t._xScale(e.name)+", "+(e.rank<t._countOfLines+1?t._yScale(e.rank):t._yScale.range()[0])+")"}));var a=i.exit();a.attr("class","labels-group label_exit").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",(function(e,i){return e.rank<t._countOfLines+1&&0!=t._countOfLines?1:0})).attr("transform",(function(e){return"translate("+t._xScale(e.name)+", "+(e.rank<t._countOfLines+1?t._yScale(e.rank):t._yScale.range()[0])+")"})).remove();var o=Array.isArray(t._picLabel.endPointChoice)?t._picLabel.endPointChoice[0]:t._picLabel.endPointChoice;if(0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.endPointStyles||null==o||-1==t._picLabel.endPointStyles.indexOf(o))if(0==t._picLabel.endPointStyles.indexOf(o)){if(null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","end").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return-5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(t){return 5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}else if(1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return t._textLabel.fontSize/2})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return t._textLabel.fontSize/2})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(i){var n=0;return n=0==t._textLabel.show||null==t._textLabel.show?0:R(String(i.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,0==t._numberLabel.show||null==t._numberLabel.show?0:R(E(i.rank,t._numberStyle,t._decimalPlaces)+e,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0,n+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(i){var n=0;return n=0==t._textLabel.show||null==t._textLabel.show?0:R(String(i.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,0==t._numberLabel.show||null==t._numberLabel.show?0:R(E(i.rank,t._numberStyle,t._decimalPlaces)+e,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0,n+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(i){var n=0;return n=0==t._textLabel.show||null==t._textLabel.show?0:R(String(i.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,0==t._numberLabel.show||null==t._numberLabel.show?0:R(E(i.rank,t._numberStyle,t._decimalPlaces)+e,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0,n+5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}}else{d3.format(",");if(null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.1*-t._textLabel.fontSize})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.1*-t._textLabel.fontSize})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.1*-t._textLabel.fontSize}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(t){return 5})).attr("y",(function(e){return 1.1*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return 1.1*t._numberLabel.fontSize})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(t){return 5})).attr("y",(function(e){return 1.1*t._numberLabel.fontSize}))}else if(1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.5*t._textLabel.fontSize})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.5*t._textLabel.fontSize})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(t){return 5})).attr("y",(function(e){return.5*t._textLabel.fontSize}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return i+(isNaN(i)||0==i?0:5)+5})).attr("y",(function(e){return.5*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return i+(isNaN(i)||0==i?0:5)+5})).attr("y",(function(e){return.5*t._numberLabel.fontSize})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return i+(isNaN(i)||0==i?0:5)+5})).attr("y",(function(e){return.5*t._numberLabel.fontSize}))}}else if(0==t._picLabel.endPointStyles.indexOf(o)){n.append("circle").attr("display",t._picLabel.show?"block":"none").style("fill",(function(e,i){var n=q(t._picLabel.color)||e.color;if(n&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var p=o.concat(),g=p.pop();return t.group.append("linearGradient").attr("id",t.id+"-label-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-label-index-"+i)+")"}return n})).attr("r",t._picLabel.endPointHeight/2<0?0:t._picLabel.endPointHeight/2),i.select("circle").attr("display",t._picLabel.show?"block":"none").attr("r",t._picLabel.endPointHeight/2<0?0:t._picLabel.endPointHeight/2),a.select("circle").attr("display",t._picLabel.show?"block":"none").style("fill","none").attr("r",0);var r=n.append("g").attr("class","line-images");if(r.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("display",t._picLabel.show?"block":"none"),i.select(".line-images").attr("display",t._picLabel.show?"block":"none"),a.select(".line-images").attr("display",t._picLabel.show?"block":"none"),r.append("clipPath").attr("class","line-clip").attr("id",(function(e,i){return"clipRank-"+t.id+"-"+i})).append("circle").attr("r",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]);return o/2<0?0:o/2})),i.select(".line-clip").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i;return d3.min([a,n])/2})),a.select(".line-clip").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("r",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i;return d3.min([a,n])/2})),r.append("image").attr("class","image").attr("clip-path",(function(e,i){return"url("+c("#clipRank-"+t.id+"-"+i)+")"})).attr("preserveAspectRatio","xMidYMid meet").attr("x",(function(e){var i=0,n=t._picLabel.picHeight;return-(0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i)/2})).attr("y",-t._picLabel.picHeight/2).attr("height",(function(e){return t._picLabel.picHeight})).attr("width",(function(e){var i=0,n=t._picLabel.picHeight;return 0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i})).attr("xlink:href",(function(t){return t.imgUrl})).attr("display",t._picLabel.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),i.select(".image").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",(function(e){var i=0,n=t._picLabel.picHeight;return-(0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i)/2})).attr("y",-t._picLabel.picHeight/2),a.select(".image").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight;return-(0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i)/2})).attr("y",-t._picLabel.picHeight/2),null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","end").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return-(d3.max([o,r])/2)-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return-(d3.max([o,r])/2)-5})).attr("y",(function(e){return t._textLabel.fontSize/2})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return-(d3.max([o,r])/2)-5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}else if(1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._textLabel.fontSize/2})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._textLabel.fontSize/2})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5})).attr("y",(function(e){return t._textLabel.fontSize/2}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5+R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5+R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5})).attr("y",(function(e){return t._numberLabel.fontSize/2})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=d3.min([a,n]),r=parseFloat(t._picLabel.endPointHeight);return d3.max([o,r])/2+5+R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)+5})).attr("y",(function(e){return t._numberLabel.fontSize/2}))}}else{d3.format(",");n.append("rect").attr("display",t._picLabel.show?"block":"none").style("fill",(function(e,i){var n=q(t._picLabel.color)||e.color;if(n&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,h=a[Symbol.iterator]();!(r=(u=h.next()).done);r=!0){var d=u.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),o.push(_)}}catch(t){l=!0,s=t}finally{try{!r&&h.return&&h.return()}finally{if(l)throw s}}var p=o.concat(),g=p.pop();return t.group.append("linearGradient").attr("id",t.id+"-label-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-label-index-"+i)+")"}return n})).attr("x",0).attr("y",-t._picLabel.endPointHeight/2).attr("width",(function(i){var n=0,a=t._picLabel.picHeight;n=0==a?0:i.imgHeight/a;var o=t._textLabel.show&&R(String(i.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0,r=t._numberLabel.show&&R(E(i.rank,t._numberStyle,t._decimalPlaces)+e,t._numberLabel.fontSize,t._numberLabel.fontFamily)||0,l=0==n?0:i.imgWidth/n,s=0;if(t._picLabel.endPointHeight>t._picLabel.picHeight&&(s=t._picLabel.endPointHeight-t._picLabel.picHeight),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice))return l+(0==l?0==o&&0==r?0:5:s)+(0==o&&0==r?0:2);if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){var u=d3.max([o,r]);return l+(0==l?0==o&&0==r?0:5:s)+u+(isNaN(u)?0:5)+(0==o&&0==r?0:2)}return 1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?l+(0==l?0==o&&0==r?0:5:s)+o+r+(isNaN(r)?0:5)+(isNaN(o)?0:5)+(0==o&&0==r?0:2):void 0})).attr("height",t._picLabel.endPointHeight),i.select("rect").attr("display",t._picLabel.show?"block":"none").attr("x",0).attr("y",-t._picLabel.endPointHeight/2).attr("width",(function(i){var n=0,a=t._picLabel.picHeight;n=0==a?0:i.imgHeight/a;var o=t._textLabel.show&&R(String(i.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0,r=t._numberLabel.show&&R(E(i.rank,t._numberStyle,t._decimalPlaces)+e,t._numberLabel.fontSize,t._numberLabel.fontFamily)||0,l=0==n?0:i.imgWidth/n,s=0;if(t._picLabel.endPointHeight>t._picLabel.picHeight&&(s=t._picLabel.endPointHeight-t._picLabel.picHeight),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice))return l+(0==l?0==o&&0==r?0:5:s)+(0==o&&0==r?0:2);if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){var u=d3.max([o,r]);return l+(0==l?0==o&&0==r?0:5:s)+u+(isNaN(u)||0==u?0:5)+(0==o&&0==r?0:2)}return 1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?l+(0==l?0==o&&0==r?0:5:s)+o+r+(isNaN(r)||0==r?0:5)+(isNaN(o)||0==o?0:5)+(0==o&&0==r?0:2):void 0})).attr("height",t._picLabel.endPointHeight),a.select("rect").attr("display",t._picLabel.show?"block":"none").style("fill","none").attr("width",0).attr("height",0);var l=n.append("g").attr("class","line-images");if(l.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("display",t._picLabel.show?"block":"none"),i.select(".line-images").attr("display",t._picLabel.show?"block":"none"),a.select(".line-images").attr("display",t._picLabel.show?"block":"none"),l.append("image").attr("class","image").attr("preserveAspectRatio","xMidYMid meet").attr("x",(function(e){var i=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(i=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),i})).attr("y",-t._picLabel.picHeight/2).attr("height",(function(e){return t._picLabel.picHeight})).attr("width",(function(e){var i=0,n=t._picLabel.picHeight;return 0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i})).attr("xlink:href",(function(t){return t.imgUrl})).attr("display",t._picLabel.show?"block":"none").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1),i.select(".image").attr("display",t._picLabel.show?"block":"none").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("opacity",1).attr("x",(function(e){var i=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(i=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),i})).attr("y",-t._picLabel.picHeight/2),a.select(".image").transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(i=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),i})).attr("y",-t._picLabel.picHeight/2),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice));else if(0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.2*-t._textLabel.fontSize})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.2*-t._textLabel.fontSize})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.2*-t._textLabel.fontSize}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return 1.2*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return 1.2*t._numberLabel.fontSize})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return 1.2*t._numberLabel.fontSize}))}else if(1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)){n.append("text").attr("class","textLabel").attr("opacity",1).attr("font-size",t._textLabel.fontSize).attr("fill",(function(e){return q(t._textLabel.color)||e.color})).attr("font-family",t._textLabel.fontFamily).attr("display",t._textLabel.show?"block":"none").style("text-anchor","start").html((function(t){return t.key})).transition().duration(0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.4*t._textLabel.fontSize})),i.select(".textLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.4*t._textLabel.fontSize})),a.select(".textLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;return t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2),a+(0==a?0:o)+5})).attr("y",(function(e){return.4*t._textLabel.fontSize}));d3.format(",");n.append("text").attr("class","numberLabel").attr("opacity",1).attr("font-size",t._numberLabel.fontSize).attr("fill",(function(e){return q(t._numberLabel.color)||e.color})).attr("font-family",t._numberLabel.fontFamily).attr("display",t._numberLabel.show?"block":"none").style("text-anchor","start").attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2);var r=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return a+(0==a?0:o)+r+(isNaN(r)||0==r?0:5)+5})).attr("y",(function(e){return.4*t._numberLabel.fontSize})).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})),i.select(".numberLabel").attr("opacity",1).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2);var r=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return a+(0==a?0:o)+r+(isNaN(r)||0==r?0:5)+5})).attr("y",(function(e){return.4*t._numberLabel.fontSize})),a.select(".numberLabel").attr("opacity",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).tween("d",(function(i){var n=this,a=d3.interpolateRound(i.lastRank,i.rank);return function(i){d3.select(n).text(E(a(i),t._numberStyle,t._decimalPlaces)+e)}})).attr("x",(function(e){var i=0,n=t._picLabel.picHeight,a=0==(i=0==n?0:e.imgHeight/n)?0:e.imgWidth/i,o=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(o=(t._picLabel.endPointHeight-t._picLabel.picHeight)/2);var r=t._textLabel.show&&R(String(e.key),t._textLabel.fontSize,t._textLabel.fontFamily)||0;return a+(0==a?0:o)+r+(isNaN(r)||0==r?0:5)+5})).attr("y",(function(e){return.4*t._numberLabel.fontSize}))}}return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"mainGroup",value:function(t){return arguments.length?(this._mainGroup=t,this):this._mainGroup}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"picLabel",value:function(t){return arguments.length?(this._picLabel=t,this):this._picLabel}},{key:"labelData",value:function(t){return arguments.length?(this._labelData=t,this):this._labelData}},{key:"countOfLines",value:function(t){return arguments.length?(this._countOfLines=t,this):this._countOfLines}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),rr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","dynamic-rank-line-chart"),i.xScale=d3.scalePoint(),i.yScale=d3.scalePoint(),i._xType="category",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=null,i._lineWidth=2,i._curve=d3.curveLinear,i._countOfLines=0,i._picLabel={titlename:"节点及图片显示",show:!0,endPointStyles:["圆形","方形"],endPointChoice:["圆形"],color:null,endPointHeight:10,picHeight:10},i._textLabel={titlename:"文本标签显示",show:!0,fontFamily:"阿里巴巴普惠体 常规",fontSize:14,positionOptions_circle:["左右分布","居右"],positionOptions_rect:["换行","不换行"],positionChoice:"居右",color:"#545454"},i._numberLabel={titlename:"数值标签显示",show:!0,fontFamily:"阿里巴巴普惠体 常规",fontSize:14,color:"#545454",positionChoice:"外部居右"},i._pictureList=[],i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=[],i._moveStyle="",i._endPause=0,i._options=[["rankmoveTransitionDuraion","换位动画","0.05"]],i._DynamicInterrupt=!0,i.timer=null,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this;clearTimeout(t.timer),t.mainGroup.selectAll("*").remove(),t.flag=0;var e=0,i=1e3*t._duration,n=t.activeData,a=n.length>0?n[0].time:[];t.clipArea=new Ut(this.defs),t.xAxis=new Zo(this.mainGroup),t.yAxis=new Jo(this.mainGroup),t.yAxis.minTickDistance(1),t.coreGroup=this.mainGroup.append("g").attr("class","core-group"),t.grid=new Jt(this.coreGroup),t.linePlot=new nr(this.coreGroup),t.labelPlot=new or(this.coreGroup),t.overlay=new te(this.coreGroup),t.guideLine=new Et(this.coreGroup),t.mainGroup.selectAll(".animation-defs").remove();var r,l=t.mainGroup.append("defs").attr("class","animation-defs"),s=l.append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-10).attr("height",t._height),u=l.append("clipPath").attr("id","animation-overlay-"+t.id+"-axis").append("rect").attr("y",-20).attr("height",t._height),h=l.append("clipPath").attr("id","animation-overlay-"+t.id+"-path").append("rect").attr("y",-20).attr("height",t._height),d=((r=navigator.userAgent).indexOf("Trident"),r.indexOf("Presto"),r.indexOf("AppleWebKit"),r.indexOf("Gecko")>-1&&r.indexOf("KHTML"),r.match(/AppleWebKit.*Mobile.*/),r.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),r.indexOf("Android")>-1||r.indexOf("Adr"),r.indexOf("iPhone"),r.indexOf("iPad"),r.indexOf("Safari"),r.indexOf("MicroMessenger"),r.match(/\sQQ/i),(navigator.browserLanguage||navigator.language).toLowerCase(),[]),_=0,f=t._pictureList,p=[],y=f.length;0==y&&v(p);for(var x=function(t){d[t]=new Image,d[t].crossOrigin="Anonymous";var e={};d[t].onload=function(){var i=document.createElement("canvas");i.height=d[t].height,i.width=d[t].width,i.getContext("2d").drawImage(d[t],0,0),e.url=i.toDataURL(),e.w=this.width,e.h=this.height,e.index=t,null!=f[t]&&""!=f[t]&&f[t].constructor!==Object||(e.w=0,e.h=0),p.push(e),++_==y&&v(p)},d[t].src=f[t],null!=f[t]&&""!=f[t]&&f[t].constructor!==Object||(d[t].src="",d[t].onload())},g=0;g<y;g++)x(g);function v(r){setTimeout((function(){t.flag=0;var l=[];n.forEach((function(t,e){var i={};i.name=t.name,i.color=t.color,i.time=a,i.data=t.data,i.imgUrl=null,i.imgWidth=0,i.imgHeight=0,r.forEach((function(t,n){t.index==e&&(i.imgWidth=t?0==t.h?0:t.w:0,i.imgHeight=t?0==t.w?0:t.h:0,i.imgUrl=t?t.url:null)})),l.push(i)})),t.computeDomain(l);var d=t.xAxis,_=t.yAxis,f=t.xScale,p=t.yScale,y=t._xType,x=t._yType,g=t._xOrient,v=t._yOrient,m=t._fontSize,b=t._width-t._marginLeft-t._marginRight,S=0;if(1==t._picLabel.show){var k=isNaN(parseFloat(t._picLabel.endPointHeight))?0:parseFloat(t._picLabel.endPointHeight),w=isNaN(parseFloat(t._picLabel.picHeight))?0:parseFloat(t._picLabel.picHeight);S=d3.max([k,w])}var C=t._xTickShow?parseFloat(t._fontSize)+5:0,O=t._xTitle?parseFloat(t._fontSize)+5:0,F=t.heightOfMainGroup-S/2;S/2>C+O&&(F=t.heightOfMainGroup-S+C+O),f.domain(t._xDomain),d.scaleFunc(f).allowedMaxTextHeight(.5*F).type(y).orient(g).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(m).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(i).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),p.domain(t._yDomain),_.scaleFunc(p).allowedMaxTextWidth(.5*b).type(x).chartType("rankLine").orient(v).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(m).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(i).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffixRank(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);_&&_.titleHeight,d.allowedMaxTextHeight();d.compute(),_.compute(),p.range([F-d.height,0]),_.compute();var L=_.width,P=F-d.height+S/2,A=(_.width,S/2),W=t._numberLabel.suffix?t._numberLabel.suffix:"",z=l.length?l.map((function(t){return t.name})):[],M=[];l.forEach((function(e){return e.data.forEach((function(e){return M.push(E(e.rank,t._numberStyle,t._decimalPlaces)+W)}))}));var D=0,R=0;D=0==t._textLabel.show||null==t._textLabel.show?0:G(z,t._textLabel.fontSize,t._textLabel.fontFamily)+5||0,R=0==t._numberLabel.show||null==t._numberLabel.show?0:G(M,t._numberLabel.fontSize,t._numberLabel.fontFamily)+5||0;var N=0,T=Array.isArray(t._picLabel.endPointChoice)?t._picLabel.endPointChoice[0]:t._picLabel.endPointChoice;if(0==t._picLabel.show||null==t._picLabel.show||null==t._picLabel.endPointStyles||null==T||-1==t._picLabel.endPointStyles.indexOf(T)){var B=0;if(0==t._picLabel.endPointStyles.indexOf(T)){parseFloat(t._picLabel.endPointHeight);null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?B=0:0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?B=R:1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)&&(B=R+D)}else null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?B=0:0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?B=d3.max([D,R]):1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)&&(B=R+D);N=parseFloat(B)}else if(r.length>0||0==r.length){var X=d3.max(r,(function(t){return t.w})),j=r.filter((function(t){return t.w==X}))[0],I=0,Y=0==(I=0==t._picLabel.picHeight?0:(j?j.h:0)/t._picLabel.picHeight)?0:(j?j.w:0)/I,H=t._picLabel.picHeight,V=0;if(0==t._picLabel.endPointStyles.indexOf(T)){var $=d3.min([Y,H]),U=parseFloat(t._picLabel.endPointHeight);null==t._textLabel.positionOptions_circle||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?V=d3.max([$,U])/2:0==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)?V=d3.max([$,U])/2+R:1==t._textLabel.positionOptions_circle.indexOf(t._textLabel.positionChoice)&&(V=d3.max([$,U])/2+R+D)}else{var Z=0;t._picLabel.endPointHeight>t._picLabel.picHeight&&(Z=t._picLabel.endPointHeight-t._picLabel.picHeight),null==t._textLabel.positionOptions_rect||null==t._textLabel.positionChoice||-1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?V=Y+(t._picLabel.show?Z:0):0==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)?V=Y+d3.max([D,R])+(t._picLabel.show?Z:0):1==t._textLabel.positionOptions_rect.indexOf(t._textLabel.positionChoice)&&(V=Y+R+D+(t._picLabel.show?Z:0))}N=parseFloat(V)}var Q=N;f.range([0,(b-_.width-Q)*(a.length-1)/(t._countOfLabel-1)]),d.compute(),d.translate(L,P).update();var K=parseFloat(_.width);if(_.picPadding(0).translate(K,A).update(),t._xTitle){var J=t.mainGroup.select(".x-core-title").empty()?t.mainGroup.append("text").attr("class","x-core-title"):t.mainGroup.select(".x-core-title");J.attr("display",t._xTitle?"block":"none").attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("fill",q(t._fontColor)),J.attr("y",P+d.height-t._fontSize/2).attr("x",L+(b-_.width-Q)/2).attr("text-anchor","middle").text(t._xTitle)}var tt=G(a,t._fontSize,t._fontFamily),et=t.grid,it=t.linePlot,nt=t.tooltip,at=t.overlay,ot=t.guideLine,rt=t.clipArea,lt=t.widthOfCore,st=t.heightOfCore-S/2;S/2>C+O&&(st=t.heightOfCore-S+C+O);f.step(),Math.min(d3.min(l,(function(t){return+t.value})),0);function ut(){if(clearTimeout(t.timer),t.flag<a.length-1){var n=+new Date;dt();var o=+new Date;e=o-n,i=1e3*t._duration-e>0?1e3*t._duration-e:0,t.timer=setTimeout(ut,t._transition?i:0)}else clearTimeout(t.timer)}if(et.width((b-_.width-Q)*(a.length-1)/(t._countOfLabel-1)).height(st).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth).transition(t._transition).duration(i),ot.y1(0).y2(st).stroke("#c6c6c6").strokeDasharray("0 0"),at.data(f.domain()).isScalePoint(!0).bandX(f.range()[0]).bandWidth(f.step()).bandHeight(st).onMouseover((function(e,i){var n=e,a=[{text:n=="&-"+(i+1)?"":n}],o=[];l.forEach((function(e,i){var r=e.data.filter((function(t){return t.name===n}));o.push({key:e.key,name:e.name,color:e.color,data:r}),a.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(isNaN(parseFloat(r[0].rank))?"":r[0].rank,t._numberStyle,t._decimalPlaces),color:e.color})})),nt.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),ot.x(0).update().show(),t.flag<t._countOfLabel-1?t.group.selectAll(".guide-line").transition().duration(200).ease(d3.easeLinear).attr("transform","translate("+f(n)+",0)"):t.group.selectAll(".guide-line").transition().duration(200).ease(d3.easeLinear).attr("transform","translate("+(f(n)+f.step()-f.step()*(t.flag-(t._countOfLabel-2)))+",0)")})).onMousemove((function(){nt.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){nt.hide(),ot.hide()})),it.data(l).xScale(f).yScale(p).transition(t._transition).duration(i).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._DynamicInterrupt).curve(t._curve).lineWidth(t._lineWidth).textLabel(t._textLabel).numberLabel(t._numberLabel).picLabel(t._picLabel).countOfLines(t._countOfLines).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),t._DynamicInterrupt){var ct=_.width<tt/2?_.width:tt/2,ht=Q<tt/2?Q:tt/2;u.attr("x",-ct-t._marginLeft).attr("width",b-_.width-Q+ct+ht+t._marginLeft<0?0:b-_.width-Q+ct+ht+t._marginLeft),h.attr("x",0).attr("width",b-_.width-Q<0?0:b-_.width-Q),t.group.selectAll(".dynamic-line-axis-x").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-axis")+")"),t.group.selectAll(".dynamic-line-axis-x .domain").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-path")+")")}else ut();function dt(){if(0==a.length||t.flag>a.length-1||t.flag==a.length-1)clearTimeout(t.timer);else{et.duration(i).update(),it.duration(i).update(),at.update();var e=[];n.forEach((function(i,n){var o={};o.key=i.name,o.imgUrl=null,o.imgWidth=0,o.imgHeight=0,r.forEach((function(t,e){t.index==n&&(o.imgWidth=t?0==t.h?0:t.w:0,o.imgHeight=t?0==t.w?0:t.h:0,o.imgUrl=t?t.url:null)})),i.data.forEach((function(e,i){0==t.flag||-1==t.flag?(e.name==a[0]&&(o.lastValue=e.value,o.lastRank=e.rank),o.lastName=a[0]):e.name==a[t.flag]&&(o.lastValue=e.value,o.lastName=e.name,o.lastRank=e.rank),e.name==a[t.flag+1]&&(o.name=e.name,o.value=e.value,o.rank=e.rank),o.color=e.color})),e.push(o)}));var d=t.labelPlot;if(d.data(l).labelData(e).xScale(f).yScale(p).transition(t._transition).duration(i).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._DynamicInterrupt).curve(t._curve).lineWidth(t._lineWidth).textLabel(t._textLabel).numberLabel(t._numberLabel).picLabel(t._picLabel).countOfLines(t._countOfLines).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),d.update(),t.flag<t._countOfLabel-1){var y=_.width<tt/2?_.width:tt/2,x=Q<tt/2?Q:tt/2;u.attr("x",-y-t._marginLeft).attr("width",b-_.width-Q+y+x+t._marginLeft<0?0:b-_.width-Q+y+x+t._marginLeft),h.attr("x",0).attr("width",b-_.width-Q<0?0:b-_.width-Q),t.group.selectAll(".dynamic-line-axis-x .axis-group").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )")}else h.transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("x",f.step()*(t.flag-(t._countOfLabel-2))),t.group.selectAll(".dynamic-line-axis-x .axis-group").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-f.step()*(t.flag-(t._countOfLabel-2))+",0 )");t.group.selectAll(".dynamic-line-axis-x").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-axis")+")"),t.group.selectAll(".dynamic-line-axis-x .domain").attr("clip-path","url("+c("#animation-overlay-"+t.id+"-path")+")"),t.coreGroup.call(o,t.yAxis.width+.5,.5+S/2),t.flag<t._countOfLabel-1?(s.transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("x",0).attr("width",f.step()*(t.flag+1)),t.group.selectAll(".dynamic-rank-line-plot").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )"),t.group.selectAll(".dynamic-rank-label").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )"),t.group.selectAll(".plane-grid").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0.5 )"),t.group.selectAll(".bands-overlay").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate(0,0 )")):(s.attr("width",b-_.width-Q<0?0:b-_.width-Q).transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("width",b-_.width-Q<0?0:b-_.width-Q).attr("x",f.step()*(t.flag-(t._countOfLabel-2))),t.group.selectAll(".dynamic-rank-line-plot").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-f.step()*(t.flag-(t._countOfLabel-2))+",0 )"),t.group.selectAll(".dynamic-rank-label").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-f.step()*(t.flag-(t._countOfLabel-2))+",0 )"),t.group.selectAll(".plane-grid").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-f.step()*(t.flag-(t._countOfLabel-2))+",0.5 )"),t.group.selectAll(".bands-overlay").transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("transform","translate("+-f.step()*(t.flag-(t._countOfLabel-2))+",0 )")),t.coreGroup.selectAll(".dynamic-rank-line-plot .lines").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.group.selectAll(".plane-grid").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.group.selectAll(".bands-overlay").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.group.selectAll(".dynamic-rank-line-plot path").filter((function(i,n){return e[n].rank<t._countOfLines+1})).transition().duration(t._transition?i:0).ease(d3.easeLinear).attr("opacity",1),0==t._countOfLines&&t.group.selectAll(".dynamic-rank-line-plot path").attr("opacity",0),0!=t._clipShow.length?(rt.width(lt).height(st).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+rt.id)+")"),rt.update()):(rt.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),rt.update()),t.flag++}}t.pause=function(e){e?(clearTimeout(t.timer),t.flag--,i=0,dt()):(i=1e3*t._duration,ut())},t.timeChange=function(e){e=String(e),clearTimeout(t.timer),t.flag=a.indexOf(e),t.flag==a.length-1||t.flag>a.length-1?(t.flag=a.indexOf(e)-1,i=0,dt(),i=1e3*t._duration):(0==a.indexOf(e)||a.indexOf(e)<0?t.flag=-1:t.flag=a.indexOf(e)-1,t._DynamicInterrupt?(i=0,dt()):(i=0,dt(),i=1e3*t._duration,ut()))}}),0)}t.pause=function(){},t.clean=function(){clearTimeout(t.timer)},t.timeChange=function(){}}},{key:"updateAxis",value:function(){}},{key:"onInterruptChange",value:function(t){this._DynamicInterrupt=t,this.pause(t)}},{key:"onTimeChange",value:function(t){this.timeChange(t)}},{key:"onCleanTimer",value:function(){this._DynamicInterrupt=!0,this.clean()}},{key:"configLegend",value:function(){var t=this.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));this.legend.data(t).onClick((function(t){var e=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",e).style("opacity",e?.5:1)}))}},{key:"computeDomain",value:function(t){var e=this,i=[],n=[];t.forEach((function(t,e){n.push(e+1);for(var a=0;a<t.data.length-1;a++)i.push(t.data[a].value)}));var a=[].concat(F(new Set(n))),o=e._yRange||[],r=t.length?t[0].time:[0,1];e._xDomain=r.length>0?r:[0,1],e._yDomain=a.sort((function(t,e){return e-t})).slice(e._countOfLines>t.length?0:t.length-e._countOfLines),0==e._countOfLines&&(e._yDomain=a.sort((function(t,e){return e-t})));var l=e._yDomain[0],s=e._yDomain[e._yDomain.length-1],u=[isNaN(parseFloat(o[1]))?isNaN(parseFloat(o[0]))?l:l<o[0]?2*o[0]:l:parseFloat(o[1]),isNaN(parseFloat(o[0]))?s:parseFloat(o[0])];0!=o.length&&(e._yDomain=u[0]>u[1]?d3.range(u[1],u[0]+1,1).sort((function(t,e){return e-t})):d3.range(u[0],u[1]+1,1).sort((function(t,e){return e-t})))}},{key:"buildOption",value:function(t,e){var i=new Eo(t,e),n=Vo;return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).countOfLabel(parseFloat(n.countOfLabel)<2?2:parseFloat(n.countOfLabel)).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.timerControl,l=t.pictures;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY);var s={straight:d3.curveLinear,step:d3.curveStepAfter,curve:d3.curveCardinal};0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._curve=e.lineType?s[e.lineType]:d3.curveLinear,this._countOfLines=e.countOfLines?Number(e.countOfLines):this._countOfLines),0!==Object.getOwnPropertyNames(i).length&&(this._textLabel=i&&i.rl_textLabel?i.rl_textLabel:this._textLabel,this._numberLabel=i&&i.rl_numberLabel?i.rl_numberLabel:this._numberLabel,this._picLabel=i&&i.rl_picLabel?i.rl_picLabel:this._picLabel),0!==Object.getOwnPropertyNames(r).length&&(this._duration=r?r.frameDuration:this._duration,this._copyDuration=r.frameDuration?r.frameDuration:0,this._options=r.options?r.options:this._options),0!==Object.getOwnPropertyNames(l).length&&(this._pictureList=l?l.urlList:this._pictureList)}}]),e}(Tt),lr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","pictograph-bar"),i._xScale=null,i._yScale=null,i._height=null,i._width=null,i._barWidthPercent=.5,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=t._height,a=t._width,o=t._display,r=t._animation,l=t._label,s=t._pictures,u=o.iconScale||.6;u>1.4&&(u=1.4);var h=parseFloat(o.IconsPerRow)||1,d=o.iconBorderWidth||0,_=q(o.iconBorderColor)||null,f=o.fillOpacity,p=o.barWidthPercent,g=l.display,v=l.textLabel.fontFamily,m=l.textLabel.fontSize,b=q(l.textLabel.color)||"#545454",S=l.suffix||"",k=t._transition,w=1e3*parseFloat(t._duration)||"0",C=1e3*parseFloat(r.startDelay)||"0",O=r.moveOptions,F=r.moveStyle,L=s.type||"single",P=s.svglist;switch(L){case"single":P=d3.range(e.length).map((function(){return P[0]}));break;default:if(P.length<e.length){var A=P.length,W=P.length;do{P.push(P[W%A]),W++}while(W<e.length)}}for(var z=t._yScale,M=z.domain()[1],D=z.domain()[0],R=M-D,N=-D*n/R,T=p*(a/e.length),B=T/h,G=B,X=D>0?parseFloat(d3.max(e.map((function(t){return t.value}))))-D:parseFloat(d3.max(e.map((function(t){return t.value})))),j=(e.map((function(t){return t.value})),[]),I=[],Y=[],H=[],V=[],$=i.append("foreignObject"),Z=0;Z<e.length;Z++){$.html(P[Z]).attr("class","svgIcon");var Q=i.select(".svgIcon svg path").attr("d"),K=i.select(".svgIcon").selectAll("svg").select("path").node().getBBox(),J=(t.group.append("path").attr("d",Q).attr("class","icon"),t.group.select(".icon").node().getBBox());j.push(K),I.push(Q),Y.push(J.width),V.push(J.height),H.push(B/(Y[Z]>V[Z]?Y[Z]:V[Z])*1),t.group.selectAll(".icon").remove(),t.group.selectAll(".svgTcon").remove()}var tt=parseInt(n*(X/R)/G),et=X/(h*tt),it=e.map((function(t){return parseInt(Math.round((t.value>D?D>0?t.value-D:t.value:0)/et))||1})),nt=e.map((function(t){return parseInt((t.value>D?D>0?t.value-D:t.value:0)/et)}));if(i.selectAll("*").remove(),t.group.selectAll(".animation-path").remove(),_&&/\[/.test(_)){var at=x(_),ot=[],rt=!0,lt=!1,st=void 0;try{for(var ut,ct=at[Symbol.iterator]();!(rt=(ut=ct.next()).done);rt=!0){var ht=ut.value,dt=[],_t=ht.split(":");dt.push(q(_t[0])),dt.push(_t[1]),ot.push(dt)}}catch(t){lt=!0,st=t}finally{try{!rt&&ct.return&&ct.return()}finally{if(lt)throw st}}var ft=ot.concat(),pt=ft.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(pt[1]).x1+"%").attr("y1",y(pt[1]).y1+"%").attr("x2",y(pt[1]).x2+"%").attr("y2",y(pt[1]).y2+"%").selectAll("stop").data(ft).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}_=/\[/.test(_)?"url("+c("#"+t.id+"-main-border-index-0")+")":_,e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var yt=t.group.append("defs").attr("class","animation-path").selectAll("clipPath").data(e).enter().append("clipPath").attr("id",(function(e,i){return"animation-path-"+t.id+"-"+i})).append("rect"),xt=N<0?0:N;t._interrupt?yt.attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4})):k&&0==O.indexOf(F)?(yt.attr("y",(function(t,e){return G-xt+d/(H[e]*u>0?H[e]*u:1)})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4})),yt.transition().duration(k?.9*w:0).delay(k?C:0).ease(d3.easeLinear).attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4}))):k&&1==O.indexOf(F)?(yt.attr("y",(function(t,e){return G-xt+d/(H[e]*u>0?H[e]*u:1)})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4})),yt.transition().duration(k?.9*w/e.length:0).delay(k?function(t,i){return C+i*w*.9/e.length}:0).ease(d3.easeLinear).attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4}))):k&&2==O.indexOf(F)?(yt.attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",0),yt.transition().duration(k?.9*w:0).delay(k?C:0).ease(d3.easeLinear).attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4}))):k&&3==O.indexOf(F)?(yt.attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)*2})).attr("width",0),yt.transition().duration(k?.9*w/e.length:0).delay(k?function(t,i){return C+i*w*.9/e.length}:0).ease(d3.easeLinear).attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4}))):yt.attr("y",(function(t,e){return-((Math.ceil(it[e]/h)-1)*G+xt+d/(H[e]*u>0?H[e]*u:1))})).attr("x",(function(t,e){return-d/(H[e]*u>0?H[e]*u:1)*2})).attr("height",(function(t,e){return Math.ceil(it[e]/h)*G+5+d/(H[e]*u>0?H[e]*u:1)})).attr("width",(function(t,e){return T+d/(H[e]*u>0?H[e]*u:1)*4}));var gt=i.selectAll("g");gt.exit().remove();var vt=e.map((function(t){return t.color}));gt.data(it).enter().append("g").attr("class","plot").attr("clip-path",(function(e,i){return"url("+c("#animation-path-"+t.id+"-"+i)+")"})).each((function(t,e){d3.select(this).selectAll(".path").data(d3.range(this.__data__)).enter().append("path").attr("class","path").attr("d",I[e]).attr("transform",(function(t,i){var n=B*i,a=0;return i>h-1&&(a-=G*Math.floor(i/h),n=B*(i%h)),"translate("+(n-j[e].x*H[e]*u)+","+(a+(D>0?0:-N)-j[e].y*H[e]*u)+")scale("+H[e]*u+")"}))})).attr("transform",(function(e,i){d3.select(this).select("path").empty()||d3.select(this).select("path").node().getBoundingClientRect().height;var a=(d3.select(this).empty()?0:d3.select(this).node().getBBox().width)/1,o=(i+.5)*t._xScale.bandwidth()-a/2,r=n-G;return"translate("+(o+t._xScale.range()[0])+","+r+")"})).style("visibility",(function(t,i){return e[i].value<=0||nt[i]<1?"hidden":"visible"})).style("stroke",null==_?function(e,i){return/\[/.test(vt[i])?"url("+c("#"+t.id+"-index-"+i)+")":vt[i]}:_).style("stroke-width",(function(t,e){return d/(H[e]*u>0?H[e]*u:1)||0})).style("fill",(function(i,n){return e[n].color&&/\[/.test(e[n].color)?"url("+c("#"+t.id+"-index-"+n)+")":e[n].color&&/#/.test(e[n].color)?e[n].color:"rgb("+U(e[n].color,0)+","+U(e[n].color,1)+","+U(e[n].color,2)+")"})).style("fill-opacity",(function(t,i){if(e[i].color&&/#/.test(e[i].color))return f;var n=U(e[i].color,3)||1;return f*n}));var mt=gt.data(e).enter().append("text").attr("class","gText").attr("text-anchor","middle").attr("x",(function(e,i){return(i+.5)*t._xScale.bandwidth()+t._xScale.range()[0]})).attr("y",(function(t,e){return n-Math.ceil(it[e]/h)*G-5-(D>0?0:N)})).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+S})).style("opacity","0").style("visibility",(function(t,e){return t.value<=0||nt[e]<1?"hidden":"visible"})).style("fill",null==b?function(t){return t.color}:b).style("font-family",v).style("font-size",m+"px");return t._interrupt?mt.style("opacity",g?"1":"0"):mt.transition().duration(k?.1*w:0).delay(k?C+.9*w:0).ease(d3.easeLinear).style("opacity",g?"1":"0"),gt.data(e).enter().append("rect").attr("x",(function(e){return t._xScale(e.name)})).attr("y",0).attr("width",t._xScale.bandwidth()).attr("height",n).style("fill","grey").style("opacity","0").on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"pictures",value:function(t){return arguments.length?(this._pictures=t,this):this._pictures}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),sr=function(t){function e(t,i){b(this,e);var n=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n._display=n._props.display,n._animation=n._props.animation,n._label=n._props.label,n._pictures=n._props.pictures,n}return w(e,t),S(e,[{key:"label",get:function(){return this._label}},{key:"display",get:function(){return this._display}},{key:"animation",get:function(){return this._animation}},{key:"pictures",get:function(){return this._pictures}}]),e}(it),ur=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.pictographBar=new lr(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._interrupt=!1,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.pictographBar,n=t.xScale,a=t.yScale,r=t._label,l=t._display,s=t._animation,u=t._pictures,h=t.grid,d=t.clipArea,_=0;_=l?parseFloat(r.textLabel.fontSize)+5:0;t.xAxis._axisStart;var f=t.xAxis._axisEnd,p=0;f>t.widthOfNoMargin-t.yAxis.width&&(p=f-(t.widthOfNoMargin-t.yAxis.width));var y=t.widthOfCore-p,x=t.heightOfCore;h.width(y).height(x-_).planeX(n.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),i.data(e).height(x-_).width(y).xScale(n).yScale(a).display(l).animation(s).pictures(u).label(r).interrupt(t._interrupt).transition(t._transition).duration(t._duration).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e){var i=[{text:""+e.name,color:e.color},{text:"数量："+E(e.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this).transition().duration(200).style("opacity","0.1")})).onMousemove((function(e){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide(),d3.select(this).transition().duration(200).style("opacity","0")})),t.coreGroup.call(o,t.yAxis.width+.5,_),i.update(),h.update(),d.width(y).height(x).paddingVertical([0,0]).transition(t._transition).duration(t._duration),d.update(),0!=t._yRange.length&&(0==isNaN(parseFloat(t._yRange[0]))||0==isNaN(parseFloat(t._yRange[1]))?t.coreGroup.attr("clip-path","url("+c("#"+d.id)+")"):t.coreGroup.attr("clip-path",""))}},{key:"updateAxis",value:function(){var t=this,e=t._label,i=0;i=t._display?parseFloat(e.textLabel.fontSize)+5:0,t.computeDomain();var n=t.xAxis,a=t.yAxis,o=t.xScale,r=t.yScale,l=t._xType,s=t._yType,u=t._xOrient,c=t._yOrient,h=t._fontSize,d=t.widthOfNoMargin,_=t.heightOfMainGroup;o.domain(t._xDomain).range([0,d-a.width]),r.domain(t._yDomain),n.scaleFunc(o).allowedMaxTextHeight(.5*_).type(l).orient(u).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(h).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.scaleFunc(r).allowedMaxTextWidth(.5*d).type(s).orient(c).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(h).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);a.titleHeight;var f=(_-n.allowedMaxTextHeight())/(3*h);n.compute(),a.tickCount(f),a.compute();var p=0,y=d-a.width;a.compute(),o.range([p,y]),n.compute();var x=n._axisStart,g=n._axisEnd;x<0&&(p=Math.abs(x)>a.width?Math.abs(x)-a.width:0),g>y&&(y-=g-y),o.range([p,y]),r.range([_-n.height-i,0]);var v=a.width,m=_-n.height,b=a.width+p,S=i||0;n.translate(v,m).update(),a.translate(b,S).update()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e.map((function(t){return t.name})):[0,1],a=e.length?[Math.min(d3.min(e,(function(t){return t.value})),0),Math.max(d3.max(e,(function(t){return t.value})),1)]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new sr(t,e),n=W;switch(i.dataType){case"cross-table":n=M;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){this.label(t.label),this.display(t.display),this.animation(t.animation),this.pictures(t.pictures);var e=t.unitDisplay,i=t.sourceDisplay,n=t.animation;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._unitShow=e?e.show:this._unitShow,this._unitWord=e?e.text:this._unitWord,this._unitFontSize=e.fontSize?e.fontSize:this._unitSize,this._unitFontColor=e.color?q(e.color):this._unitColor,this._unitFontFamily=e.fontFamily?e.fontFamily:this._unitFamily,this._unitX=e.xPosition?e.xPosition:this._unitX,this._unitY=e.yPosition?e.yPosition:this._unitY),0!==Object.getOwnPropertyNames(i).length&&(this._sourceShow=i?i.show:this._sourceShow,this._sourceWord=i?i.text:this._sourceWord,this._sourceFontSize=i.fontSize?i.fontSize:this._sourceSize,this._sourceFontColor=i.color?q(i.color):this._sourceColor,this._sourceFontFamily=i.fontFamily?i.fontFamily:this._sourceFamily,this._sourceX=i.xPosition?i.xPosition:this._sourceX,this._sourceY=i.yPosition?i.yPosition:this._sourceY)}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"pictures",value:function(t){return arguments.length?(this._pictures=t,this):this._pictures}}]),e}(Tt),cr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","HundredPercentBar"),i._xScale=null,i._yScale=null,i._height=null,i._width=null,i._barWidth=null,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=t._height,a=t._width,o=t._label,r=t._display,l=t._animation,s=(d3.max(e.map((function(t){return t.value}))),t._transition),u=1e3*t._duration,h=1e3*l.startDelay,d=(l.endPause,l.moveStyle),_=o.textLabel.fontSize,p=o.positionChoice,g=o.display,v=q(o.textLabel.color),m=o.textLabel.fontFamily,b=q(r.barBackgroundColor),S=r.barWidthPercent*(n/e.length),k=r.borderWidth,w=q(r.borderColor),C=r.bar4CornerRadius,O=r.fillOpacity,F=r.bgOpacity;if(i.selectAll("*").remove(),w&&/\[/.test(w)){var L=x(w),P=[],A=!0,W=!1,z=void 0;try{for(var M,D=L[Symbol.iterator]();!(A=(M=D.next()).done);A=!0){var R=M.value,N=[],T=R.split(":");N.push(q(T[0])),N.push(T[1]),P.push(N)}}catch(t){W=!0,z=t}finally{try{!A&&D.return&&D.return()}finally{if(W)throw z}}var B=P.concat(),G=B.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(G[1]).x1+"%").attr("y1",y(G[1]).y1+"%").attr("x2",y(G[1]).x2+"%").attr("y2",y(G[1]).y2+"%").selectAll("stop").data(B).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(b&&/\[/.test(b)){var X=x(b),j=[],I=!0,Y=!1,H=void 0;try{for(var V,$=X[Symbol.iterator]();!(I=(V=$.next()).done);I=!0){var Z=V.value,Q=[],K=Z.split(":");Q.push(q(K[0])),Q.push(K[1]),j.push(Q)}}catch(t){Y=!0,H=t}finally{try{!I&&$.return&&$.return()}finally{if(Y)throw H}}var J=j.concat(),tt=J.pop();t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(tt[1]).x1+"%").attr("y1",y(tt[1]).y1+"%").attr("x2",y(tt[1]).x2+"%").attr("y2",y(tt[1]).y2+"%").selectAll("stop").data(J).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}w=/\[/.test(w)?"url("+c("#"+t.id+"-main-border-index-0")+")":w,b=/\[/.test(b)?"url("+c("#"+t.id+"-main-border-index-1")+")":b,e.forEach((function(e,i){var n=null==b?e.color:b;if(n&&/\[/.test(n)){var a=x(n),o=[],r=!0,l=!1,s=void 0;try{for(var u,c=a[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var h=u.value,d=[],_=h.split(":");d.push(nt(q(_[0]))),d.push(_[1]),o.push(d)}}catch(t){l=!0,s=t}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}var f=o.concat(),p=f.pop();t.group.append("linearGradient").attr("id",t.id+"-light-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-number-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var et=i.selectAll("rect").data(e,(function(t){return t.key}));et.exit().remove();var it=et.enter().append("path").attr("class","hundredPercentBar_right").style("fill",(function(e,i){var n=null==b?e.color:b;if(n&&/\[/.test(n))return"url("+c("#"+t.id+"-light-index-"+i)+")";if(n&&/#/.test(n))return null==b?nt(n):n;var a=U(n,0),o=U(n,1),r=U(n,2);return null==b?nt("rgb("+a+","+o+","+r+")"):n})).style("fill-opacity",(function(t){var e=null==b?t.color:b;if(e&&/#/.test(e))return F;var i=U(e,3)||1;return F*i}));function nt(t){var e=d3.hsl(t);return e.l=1.4*e.l,e}var at=et.enter().append("path").attr("class","hundredPercentBar_left").style("fill",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-number-index-"+i)+")":e.color})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return O;var e=U(t.color,3)||1;return O*e}));function ot(){var i=et.data(e).enter().append("text").attr("class","gText").attr("text-anchor",(function(){return"内部居中"==p?"middle":"内部居右"==p?"end":"start"})).attr("display",(function(){return"外部居右"==p?"none":"block"})).attr("x",(function(e){switch(p){case"外部居右":return a+5;case"外部居左":return t._xScale(e.value)+5;case"内部居左":return 5;case"内部居中":return t._xScale(e.value)/2;case"内部居右":return t._xScale(e.value)-5;default:return 0}})).attr("y",(function(t,i){return(i+.5)*n/e.length+_/3})).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})).style("opacity","0").style("fill",v).style("font-family",m).style("font-size",_);t._interrupt?i.style("opacity",g?"1":"0"):i.transition().duration(s?.1*u:0).delay(s?h+u:0).ease(d3.easeLinear).style("opacity",g?"1":"0")}if(et.enter().append("rect").attr("y",(function(t,i){return(i+.5)*n/e.length-S/2})).attr("width",a).attr("height",S).style("opacity","0").on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),s&&!t._interrupt)switch(ot(),d){case"横向同步拉伸":return at.attr("d",(function(t,i){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(i+.5)*n/e.length-S/2+k/2,width:0,height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(i+.5)*n/e.length-S/2,width:0,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),it.attr("d",(function(t,i){return f({x:k/2,y:(i+.5)*n/e.length-S/2,width:a,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),at.transition().delay(h).duration(.9*u).ease(d3.easeLinear).attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),void it.attr("stroke",(function(e,i){var n=null==b?e.color:b;return n&&/\[/.test(n)?null==w?"url("+c("#"+t.id+"-light-index-"+i)+")":w:(n&&/#/.test(n)||(U(n,0),U(n,1),U(n,2),U(n,3)),null==w?null==b?nt(n):n:w)})).attr("stroke-width",k).transition().duration(s?.1*u:0).delay(s?h:0).ease(d3.easeLinear);case"纵向依次展开":return at.attr("d",(function(t,i){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(i+.5)*n/e.length-S/2+k/2,width:0,height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(i+.5)*n/e.length-S/2,width:0,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),it.attr("d",(function(t,i){return f({x:k/2,y:(i+.5)*n/e.length-S/2,width:a,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),at.transition().delay((function(t,i){return h+.9*u/e.length*(e.length-i)})).duration(.9*u/e.length).ease(d3.easeLinear).attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),void it.attr("stroke",(function(e,i){var n=null==b?e.color:b;return n&&/\[/.test(n)?null==w?"url("+c("#"+t.id+"-light-index-"+i)+")":w:(n&&/#/.test(n)||(U(n,0),U(n,1),U(n,2),U(n,3)),null==w?null==b?nt(n):n:w)})).attr("stroke-width",k).transition().duration(s?.1*u:0).delay(s?h:0).ease(d3.easeLinear);case"百叶窗":return at.attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:0,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:0,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),it.attr("d",(function(t,i){return f({x:k/2,y:(i+.5)*n/e.length-S/2,width:a,height:0,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),at.transition().delay(h).duration(.9*u).ease(d3.easeLinear).attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),void it.attr("d",(function(t,i){return f({x:parseFloat(k)/2,y:(i+.5)*n/e.length-S/2,width:a,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})).attr("stroke",(function(e,i){var n=null==b?e.color:b;return n&&/\[/.test(n)?null==w?"url("+c("#"+t.id+"-light-index-"+i)+")":w:(n&&/#/.test(n)||(U(n,0),U(n,1),U(n,2),U(n,3)),null==w?null==b?nt(n):n:w)})).attr("stroke-width",k);case"机场翻牌":return at.attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:0,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:0,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),it.attr("d",(function(t,i){return f({x:k/2,y:(i+.5)*n/e.length-S/2,width:a,height:0,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),at.transition().duration(.9*u/e.length).delay((function(t,i){return h+.9*u/e.length*(e.length-i)})).ease(d3.easeLinear).attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),void it.attr("d",(function(t,i){return f({x:parseFloat(k)/2,y:(i+.5)*n/e.length-S/2,width:a,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})).attr("stroke",(function(e,i){var n=null==b?e.color:b;return n&&/\[/.test(n)?null==w?"url("+c("#"+t.id+"-light-index-"+i)+")":w:(n&&/#/.test(n)||(U(n,0),U(n,1),U(n,2),U(n,3)),null==w?null==b?nt(n):n:w)})).attr("stroke-width",k);default:return rt()}else rt(),ot();function rt(){at.attr("d",(function(i,a){return f(null!==k||"0"!==k?{x:parseFloat(k),y:(a+.5)*n/e.length-S/2+k/2,width:t._xScale(i.value)-parseFloat(k),height:S-parseFloat(k),cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"}:{x:0,y:(a+.5)*n/e.length-S/2,width:t._xScale(i.value),height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),it.attr("d",(function(t,i){return f({x:parseFloat(k)/2,y:(i+.5)*n/e.length-S/2,width:a,height:S,cornerRadius:C,roundCorners:[0,1,2,3],type:"horizontal"})})),it.attr("stroke",(function(e,i){var n=null==b?e.color:b;if(n&&/\[/.test(n))return null==w?"url("+c("#"+t.id+"-light-index-"+i)+")":w;if(n&&/#/.test(n))return null==w?null==b?nt(n):n:w;U(n,0),U(n,1),U(n,2),U(n,3);return null==w?null==b?nt(n):n:w})).attr("stroke-width",k).transition().duration(s?.1*u:0).delay(s?h+u:0).ease(d3.easeLinear)}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),hr=function(t){function e(t,i){b(this,e);var n=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n._label=n._props.label,n._display=n._props.display,n._animation=n._props.animation,n}return w(e,t),S(e,[{key:"label",get:function(){var t=this._label;return{display:t.display,positionOptions:t.positionOptions||["外部居右","外部居左","内部居左","内部居中","内部居右"],positionChoice:t.positionChoice||"外部居右",textLabel:{fontSize:t.textLabel.fontSize||"14",color:t.textLabel.color||"#545454",fontFamily:t.textLabel.fontFamily||"阿里巴巴普惠体 常规"}}}},{key:"display",get:function(){var t=this._display;return{barBackgroundColor:t.barBackgroundColor||null,barWidthPercent:t.barWidthPercent,borderWidth:t.borderWidth||"0",borderColor:t.borderColor||null,bar4CornerRadius:t.bar4CornerRadius||[0,0,0,0],bgOpacity:0==t.bgOpacity?0:t.bgOpacity,fillOpacity:0==t.fillOpacity?0:t.fillOpacity}}},{key:"animation",get:function(){var t=this._animation;return{transition:t.transition,duration:t.duration||"0",startDelay:t.startDelay||"0",endPause:t.endPause||"0",moveOptions:t.moveOptions||["横向同步拉伸","纵向依次展开","百叶窗","机场翻牌"],moveStyle:t.moveStyle||"横向同步拉伸",easeStyle:t.easeStyle||""}}}]),e}(it),dr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.bar=new cr(i.coreGroup),i.clipArea=new Ut(i.defs),i.yAxis=new jt(i.mainGroup),i.xAxis=new Ht(i.mainGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._xOrient="bottom",i._yOrient="left",i._interrupt=!1,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.bar,n=t.xScale,a=t.yScale,r=t.grid,l=t.clipArea,s=t.heightOfCore,u=t.gridEnd-t.gridStart,h=t._label,d=t._display,_=t._animation,f=h.positionChoice,p=e.length?e.map((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})):[""],y=e.length?e.map((function(t){return t.name})):[""],x=(G(p,h.textLabel.fontSize,h.textLabel.fontFamily),G(y,t._fontSize,t._fontFamily));if(0!=h.display&&"外部居右"==f||0,1==h.display&&"外部居左"==f){var g=t.widthOfNoMargin-x-5-(t._xTitle?t._fontSize:0),v=d3.max(e.map((function(t){return t.value}))),m=g*(1-v/(v<=100?100:d3.max(e.map((function(t){return t.value})))))-h.textLabel.fontSize;G(E(v,t._numberStyle,t._decimalPlaces)+"%",h.textLabel.fontSize,h.textLabel.fontFamily)>m?G(p,h.textLabel.fontSize,h.textLabel.fontFamily):0}for(var b=[],S=0;S<e.length;S++)b.unshift(e[S]);if(r.width(u+a.range()[0]).height(s).planeX(a.range()[0]).xTickLocations(t.yAxis.tickLocations).yTickLocations(t.xAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),i.data(b).xScale(a).yScale(n).height(s).width(u).label(h).display(d).animation(_).interrupt(t._interrupt).transition(t._transition).duration(t._duration).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e){var i=[{text:""+e.valueLabel},{text:e.name+"  :  "+E(e.value,t._numberStyle,t._decimalPlaces)+"%",color:e.color}];t.tooltip.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(e){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide()})),"下面"==t._axisPositonChoiceX?t.coreGroup.call(o,t.xAxis.width+.5,0):t.coreGroup.call(o,t.xAxis.width+.5,t.yAxis.height),0!=t._clipShowX.length?(l.width(u).height(s).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+l.id)+")"),l.update()):(l.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),l.update()),(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&(l.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),l.update(),t.coreGroup.attr("clip-path","")),r.update(),i.update(),t.mainGroup.selectAll(".label-text").remove(),1==h.display&&"外部居右"==f){t.mainGroup.selectAll(".label-text").remove();var k=0;k=(t._axisPositonChoiceX,0);var w=t.mainGroup.selectAll(".label-text").data(b);w.exit().remove();w.enter().append("text").attr("transform","translate("+(t.xAxis.width+.5)+", "+k+")").attr("class","label-text").attr("text-anchor","start").attr("x",u+10).attr("y",(function(i,n){return"上面"==t._axisPositonChoiceX?(n+.5)*s/e.length+h.textLabel.fontSize/3+t.yAxis.height:(n+.5)*s/e.length+h.textLabel.fontSize/3})).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})).style("fill",q(h.textLabel.color)).style("font-family",h.textLabel.fontFamily).style("font-size",h.textLabel.fontSize)}else t.mainGroup.selectAll(".label-text").remove()}},{key:"updateAxis",value:function(){var t=this,e=t.activeData,i=t._label,n=i.positionChoice,a=e.length?e.map((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})):[""],o=e.length?e.map((function(t){return t.name})):[""],r=G(a,i.textLabel.fontSize,i.textLabel.fontFamily),l=G(o,t._fontSize,t._fontFamily);if(0!=i.display&&"外部居右"==n||(r=0),1==i.display&&"外部居左"==n){var s=t.widthOfNoMargin-l-5-(t._xTitle?t._fontSize:0),u=d3.max(e.map((function(t){return t.value}))),c=s*(1-u/(u<=100?100:d3.max(e.map((function(t){return t.value})))))-i.textLabel.fontSize;r=G(E(u,t._numberStyle,t._decimalPlaces)+"%",i.textLabel.fontSize,i.textLabel.fontFamily)>c?G(a,i.textLabel.fontSize,i.textLabel.fontFamily):0}t.computeDomain();var h=t.xAxis,d=t.yAxis,_=t.xScale,f=t.yScale,p=t._xType,y=t._yType,x=t._xOrient,g=t._yOrient;g="上面"==t._axisPositonChoiceX?"top":"bottom";var v=t._fontSize,m=t.widthOfNoMargin,b=t.heightOfMainGroup;f.domain(t._xDomain),d.scaleFunc(f).allowedMaxTextHeight(.5*b).type(y).orient(g).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(v).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).tickFormat((function(t){return t+"%"})).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix("%").numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),_.domain(t._yDomain),h.scaleFunc(_).allowedMaxTextWidth(.5*m).type(p).orient(x).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(v).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);h.titleHeight;d.tickCount(5),h.compute();var S=m-h.width-r;h.compute(),f.range([0,S]),d.compute();d._axisStart;var k=d._axisEnd;k>S&&(S-=k-S),t.gridStart=0,t.gridEnd=S,f.range([0,S]),_.range([b-d.height,0]);var w=d.height,C=h.width,O=b-d.height,F=h.width+0,L=0;"上面"==t._axisPositonChoiceX?(O=w,L=w):O=(t._axisPositonChoiceX,b-w),d.translate(C,O).update(),h.translate(F,L).update()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._xRange||[],n=d3.max(e.map((function(t){return t.value})));n=n<=100?100:d3.max(e.map((function(t){return t.value})));var a=e.length?[0,n]:[0,1],o=e.length?e.map((function(t){return t.name})):[0,1];t._xDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])],t._yDomain=o}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new hr(t,e),n=W;switch(i.dataType){case"cross-table":n=solveCrossTableData;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range).yRange(a.range).clipShow(a.range).clipShowX(n.range).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){this.label(t.label),this.display(t.display),this.animation(t.animation);var e=t.unitDisplay,i=t.sourceDisplay,n=t.animation;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._unitShow=e?e.show:this._unitShow,this._unitWord=e?e.text:this._unitWord,this._unitFontSize=e.fontSize?e.fontSize:this._unitSize,this._unitFontColor=e.color?q(e.color):this._unitColor,this._unitFontFamily=e.fontFamily?e.fontFamily:this._unitFamily,this._unitX=e.xPosition?e.xPosition:this._unitX,this._unitY=e.yPosition?e.yPosition:this._unitY),0!==Object.getOwnPropertyNames(i).length&&(this._sourceShow=i?i.show:this._sourceShow,this._sourceWord=i?i.text:this._sourceWord,this._sourceFontSize=i.fontSize?i.fontSize:this._sourceSize,this._sourceFontColor=i.color?q(i.color):this._sourceColor,this._sourceFontFamily=i.fontFamily?i.fontFamily:this._sourceFamily,this._sourceX=i.xPosition?i.xPosition:this._sourceX,this._sourceY=i.yPosition?i.yPosition:this._sourceY)}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.xAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.yAxis.height:0,e=this.heightOfMainGroup-t;return e>0?e:0}}]),e}(Tt),_r=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","line-plot"),i._curve=d3.curveLinear,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._label,n=(i.display,i.positionOptions,i.positionChoice,i.textLabel.fontSize,q(i.textLabel.color),i.textLabel.fontFamily,t._animation),a=t._transition,o=1e3*t._duration,r=1e3*n.startDelay,l=n.moveStyle,s=t._display,u=s.lineWidth,h=s.lineType||"straight",d=(s.endPointRadius,d3.line().x((function(e){return t._xScale(e.value)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})));"curve"==h&&d.curve(t._curve);var _=t.group;_.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var f=_.selectAll("path").data(e,(function(t){return t.key})),p=f.enter().append("path").merge(f).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",u).attr("d",(function(t){return d(t.data)})).attr("stroke-dasharray",(function(){return this.getTotalLength()})).attr("stroke-dashoffset",(function(){return this.getTotalLength()}));function g(){p.attr("stroke-dashoffset",0)}return a&&!t._interrupt?"依次绘制"==l?p.transition().duration(.9*o/e.length).delay((function(t,i){return r+i*(.9*o/e.length)})).ease(d3.easeLinear).attr("stroke-dashoffset",0):"同时绘制"==l?p.transition().duration(.9*o).delay(r).ease(d3.easeLinear).attr("stroke-dashoffset",0):"穿针引线"==l?setTimeout((function(){p.attr("stroke-dashoffset",0).style("opacity","0"),p.transition().duration(.9*o/e.length).delay((function(t,i){return r+i*(.9*o/e.length)})).ease(d3.easeLinear).style("opacity","1")}),o/6):g():g(),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(at),fr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-line-labels"),i._curve=d3.curveLinear,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t._label,a=n.display,o=n.positionOptions,r=n.positionChoice,l=n.textLabel.fontSize,s=q(n.textLabel.color),u=n.textLabel.fontFamily,c=n.suffix||"",h=t._animation,d=t._transition,_=1e3*t._duration,f=1e3*h.startDelay,y=(h.moveStyle,t._display),x=(y.lineWidth,y.lineType,y.endPointRadius),g=t.group;return g.selectAll("*").remove(),g.selectAll("g").data(e,(function(t){return t.key})).data(e).enter().append("g").attr("class","g").each((function(e){var i=e.data,n=d3.select(this).selectAll("text").data(i).enter().append("text").attr("class","lineReverseChart-label-text").attr("text-anchor",(function(){return a&&0==o.indexOf(r)?"start":a&&1==o.indexOf(r)?"end":"middle"})).attr("dy","0.35em").attr("x",(function(e){return a&&0==o.indexOf(r)?x>0?t._xScale(e.value)+parseFloat(x)+5:t._xScale(e.value)+8:a&&1==o.indexOf(r)?x>0?t._xScale(e.value)-parseFloat(x)-5:t._xScale(e.value)-8:t._xScale(e.value)})).attr("y",(function(e,i){return a&&2==o.indexOf(r)?x>0?t._yScale(e.name)-.35*parseFloat(l)-parseFloat(x)-5:t._yScale(e.name)-.35*parseFloat(l)-8:a&&3==o.indexOf(r)?x>0?t._yScale(e.name)+.35*parseFloat(l)+parseFloat(x)+5:t._yScale(e.name)+.35*parseFloat(l)+8:t._yScale(e.name)})).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+c})).style("opacity",0).style("fill",s).style("font-family",u).style("font-size",l);t._interrupt?n.style("opacity",a?"1":"0"):n.transition().duration(d?.1*_:0).delay(d?f+_:0).ease(d3.easeLinear).style("opacity",a?"1":"0")})),function(){for(var t=g.selectAll(".lineReverseChart-label-text"),e=[],n=[],a=0;a<t._groups[0].length;a++){n.push(a);for(var o=a+1;o<t._groups[0].length;o++){var r=i(d3.select(t._groups[0][a])),l=i(d3.select(t._groups[0][o]));p(r,l)&&(e.push(a),d3.select(t._groups[0][a]).style("visibility","hidden"))}}for(var s=new Set(e),u=Array.from(s),c=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(u,n),h=0;h<u.length;h++){for(var d=[],_=0;_<c.length;_++){var f=i(d3.select(t._groups[0][u[h]])),y=i(d3.select(t._groups[0][c[_]]));if(d.push(p(f,y)),p(f,y)){if(u[h]==c[_])continue;d3.select(t._groups[0][u[h]]).style("visibility","hidden")}}0==d.filter((function(t){return 1==t})).length&&c.push(u[h])}for(var x=0;x<c.length;x++)d3.select(t._groups[0][c[x]]).style("visibility","visible")}(),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),pr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverseLine-scatter-plot"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=1,i._transition=!1,i._animation={transition:!0,duration:"1.8",startDelay:"0",endPause:"1",moveOptions:["依次绘制","同时绘制","穿针引线"],moveStyle:"依次绘制",easeStyle:""},i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data;e.selectAll("*").remove();var n=t._xScale,a=t._yScale,o=t._animation,r=t._transition,l=1e3*t._duration,s=1e3*o.startDelay,u=o.moveStyle;i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-an-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var h=e.selectAll("g").data(i,(function(t){return t.name}));return h.exit().remove(),h.enter().append("g").merge(h).each((function(e,o){var h=d3.select(this).selectAll("circle").data(e.data);h.exit().remove();var d=h.enter().append("circle").merge(h).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-an-index-"+o)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-an-index-"+o)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",0).attr("cy",0).attr("r",0).attr("cx",(function(t){return n(t.value)||0})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",0);if(r&&!t._interrupt)switch(u){case"依次绘制":return void d.transition().duration(.9*l/e.data.length).delay((function(t,n){return s+o*(.9*l/i.length)+.9*l/e.data.length/i.length*n})).ease(d3.easeLinear).attr("r",t._radius);case"同时绘制":return void d.transition().duration(.9*l/e.data.length).delay((function(t,i){return s+i*(.9*l/e.data.length)})).ease(d3.easeLinear).attr("r",t._radius);case"穿针引线":return setTimeout((function(){d.attr("r",t._radius)}),s),void d.attr("cx",0).transition().duration(.9*l/6).delay(s).ease(d3.easeLinear).attr("cx",(function(t){return n(t.value)||0}));default:return _()}else _();function _(){d.attr("r",t._radius)}})),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(at),yr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","scatter-plot-noA"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=1,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data;i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-no-an-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=t._xScale,a=t._yScale,o=e.selectAll("g").data(i,(function(t){return t.name}));return o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-no-an-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-no-an-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.value)||0})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius)})),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}}]),e}(at),xr=function(t){function e(t,i){b(this,e);var n=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n._label=n._props.label,n._display=n._props.display,n._animation=n._props.animation,n}return w(e,t),S(e,[{key:"label",get:function(){var t=this._label;return{display:t.display,positionOptions:t.positionOptions||["右侧","左侧","上面","下面"],positionChoice:t.positionChoice||"右侧",textLabel:{fontSize:t.textLabel.fontSize||"14",color:t.textLabel.color||"#545454",fontFamily:t.textLabel.fontFamily||"阿里巴巴普惠体 常规"},suffix:t.suffix||""}}},{key:"display",get:function(){var t=this._display;return{lineType:t.lineType||"straight",lineWidth:t.lineWidth,endPointRadius:t.endPointRadius,endPointBorderWidth:t.endPointBorderWidth,endPointBorderColor:t.endPointBorderColor||null,endPointFillColor:t.endPointFillColor||null}}},{key:"animation",get:function(){var t=this._animation;return{transition:t.transition,duration:t.duration||"0",startDelay:t.startDelay||"0",endPause:t.endPause||"0",moveOptions:t.moveOptions||["依次绘制","同时绘制","穿针引线"],moveStyle:t.moveStyle||"依次绘制",easeStyle:t.easeStyle||""}}}]),e}(it),gr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.clipArea=new Ut(i.defs),i.yAxis=new jt(i.mainGroup),i.xAxis=new Ht(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.LinePlotReverse=new _r(i.coreGroup),i.scatterPlot=new pr(i.coreGroup),i.labels=new fr(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new yr(i.coreGroup),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._duration=0,i._interrupt=!1,i._showPoints=!0,i._curve=d3.curveCardinal,i.labelTextClass="lineReverseChart-label-text",i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.LinePlotReverse,a=t.scatterPlot,r=t.labels,l=t.clipArea,s=t.tooltip,u=t.overlay,h=t.guideLine,d=t.guideScatter,_=t.xScale,f=t.yScale,p=(t.yAxis._axisStart,t.yAxis._axisEnd),g=0;p>t.widthOfNoMargin-t.xAxis.width&&(g=p-(t.widthOfNoMargin-t.xAxis.width));var v=t.widthOfCore-g,m=t.heightOfCore,b=(_.bandwidth(),t._label),S=t._display,k=t._animation,w=t._axis,C=S.endPointRadius||"0",O=S.endPointBorderWidth||"0",F=q(S.endPointBorderColor)||null,L=q(S.endPointFillColor)||null,P=w.axisPositonChoice||"下面",A=b.display,W=b.positionOptions,z=b.positionChoice,M=b.textLabel.fontSize,D=t._display.endPointRadius,R=0;if(R=A?0==W.indexOf(z)||1==W.indexOf(z)?.5*parseFloat(M)+parseFloat(D):"上面"==P?3==W.indexOf(z)?parseFloat(M)+parseFloat(D):parseFloat(D):2==W.indexOf(z)?parseFloat(M)+parseFloat(D):parseFloat(D):parseFloat(D),t.mainGroup.selectAll(".linear-gradient").remove(),F&&/\[/.test(F)){var N=x(F),T=[],B=!0,G=!1,X=void 0;try{for(var j,I=N[Symbol.iterator]();!(B=(j=I.next()).done);B=!0){var Y=j.value,H=[],V=Y.split(":");H.push(q(V[0])),H.push(V[1]),T.push(H)}}catch(t){G=!0,X=t}finally{try{!B&&I.return&&I.return()}finally{if(G)throw X}}var $=T.concat(),U=$.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(U[1]).x1+"%").attr("y1",y(U[1]).y1+"%").attr("x2",y(U[1]).x2+"%").attr("y2",y(U[1]).y2+"%").selectAll("stop").data($).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(L&&/\[/.test(L)){var Z=x(L),Q=[],K=!0,J=!1,tt=void 0;try{for(var et,it=Z[Symbol.iterator]();!(K=(et=it.next()).done);K=!0){var nt=et.value,at=[],ot=nt.split(":");at.push(q(ot[0])),at.push(ot[1]),Q.push(at)}}catch(t){J=!0,tt=t}finally{try{!K&&it.return&&it.return()}finally{if(J)throw tt}}var rt=Q.concat(),lt=rt.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(lt[1]).x1+"%").attr("y1",y(lt[1]).y1+"%").attr("x2",y(lt[1]).x2+"%").attr("y2",y(lt[1]).y2+"%").selectAll("stop").data(rt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}F=/\[/.test(F)?"url("+c("#"+t.id+"-main-border-index-0")+")":F,L=/\[/.test(L)?"url("+c("#"+t.id+"-main-border-index-1")+")":L,i.width(v).height(m-R).planeX(f.range()[0]).xTickLocations(t.yAxis.tickLocations.slice(1)).yTickLocations(t.xAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).xScale(f).yScale(_).label(b).display(S).animation(k).interrupt(t._interrupt).axis(w).curve(t._curve).transition(t._transition).duration(t._duration),a.data(e).xScale(f).yScale(_).stroke(F).fill(L).radius(C).strokeWidth(O).animation(k).interrupt(t._interrupt).transition(t._transition).duration(t._duration),r.data(e).xScale(f).yScale(_).label(b).display(S).animation(k).interrupt(t._interrupt).axis(w).curve(t._curve).transition(t._transition).duration(t._duration).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),h.x1(f.range()[0]).x2(v).y1(0).y2(0).stroke("#c6c6c6").strokeDasharray("0 0"),d.xScale(f).yScale(_).stroke(L).fill(F).radius(C).strokeWidth(O),u.data(_.domain()).isScalePoint(!1).isHorizontal(!0).bandX(f.range()[0]).bandWidth(v-f.range()[0]).bandHeight(_.step()).onMouseover((function(){s.move([d3.event.offsetX,d3.event.offsetY]).show(),h.show(),d.show()})).onMousemove((function(i,n){var a=[],o=_.domain()[_.domain().length-n-1==-1?1:_.domain().length-n-1==-2?0:_.domain().length-n-1],r=[{text:o=="&-"+(_.domain().length-n)?"":o}];o&&1!=o&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));a.push({key:e.key,name:e.name,color:e.color,data:n}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(n[0].value,t._numberStyle,t._decimalPlaces),color:e.color})})),h.update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate(0,"+_(o)+")")),s.data(r).update(),d.data(a).update(),s.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMouseout((function(){s.hide(),h.hide(),d.hide()})),"下面"==P?(t.coreGroup.call(o,t.xAxis.width+.5,R),i.translate(t.xAxis.width+.5,R)):(t.coreGroup.call(o,t.xAxis.width+.5,t.yAxis.height),i.translate(t.xAxis.width+.5,t.yAxis.height)),0!=t._clipShowX.length?(l.width(v).height(m).paddingVertical([parseFloat(b.textLabel.fontSize)+parseFloat(2*C)+5,parseFloat(b.textLabel.fontSize)+parseFloat(2*C)+5]).paddingHorizontal([-f.range()[0],0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+l.id)+")"),l.update()):(l.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),l.update()),(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&(l.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),l.update(),t.coreGroup.attr("clip-path","")),d.elem.style("pointer-events","none"),u.translate(0,-_.step()/2).update(),i.update(),n.update(),t._showPoints?a.update().show():a.hide(),r.update()}},{key:"updateAxis",value:function(){var t=this,e=t._axis.axisPositonChoice;t.computeDomain();var i=t.xAxis,n=t.yAxis,a=t.xScale,o=t.yScale,r=t._xType,l=t._yType,s=void 0;s="上面"==e?"top":"bottom";var u=t._label,c=u.display,h=u.positionOptions,d=u.positionChoice,_=u.textLabel.fontSize,f=t._display.endPointRadius,p=0;p=c?0==h.indexOf(d)||1==h.indexOf(d)?.5*parseFloat(_)+parseFloat(f):"上面"==e?3==h.indexOf(d)?parseFloat(_)+parseFloat(f):parseFloat(f):2==h.indexOf(d)?parseFloat(_)+parseFloat(f):parseFloat(f):parseFloat(f);var y=t._fontSize,x=t.widthOfNoMargin,g=t.heightOfMainGroup;o.domain(t._xDomain),n.scaleFunc(o).allowedMaxTextHeight(.5*g).type(l).orient(s).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*x).type(r).orient("left").title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var v=t._tickCount?t._tickCount:(x-i.allowedMaxTextWidth())/(3*y);i.tickCount(v),i.compute();var m=0,b=x-i.width;i.compute(),o.range([m,b]),n.compute();var S=n._axisStart,k=n._axisEnd;S<0&&(m=Math.abs(S)>i.width?Math.abs(S)-i.width:0),k>b&&(b-=k-b),o.range([m,b]),a.range([g-n.height-p,0]);var w=g-n.height,C=p||0;"上面"==e?(w=n.height,C=n.height):w=g-n.height;var O=i.width,F=i.width+m;n.translate(O,w).update(),i.translate(F,C).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._axis,n=t._xRange||[],a=i.axisPositonChoice,o=e.length?e[0].data.map((function(t){return t.name})):[0,1],r=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];"下面"==a||o.reverse(),t._xDomain=[isNaN(parseFloat(n[0]))?r[0]:parseFloat(n[0]),isNaN(parseFloat(n[1]))?isNaN(parseFloat(n[0]))?r[1]:r[1]<n[0]?1.5*n[0]:r[1]:parseFloat(n[1])],t._yDomain=o}},{key:"buildOption",value:function(t,e){var i=new xr(t,e),n=W;switch(i.dataType){case"cross-table":n=ee;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){this.label(t.label),this.display(t.display),this.animation(t.animation),this.axis(t.axis.x);var e=t.unitDisplay,i=t.sourceDisplay,n=t.animation;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._unitShow=e?e.show:this._unitShow,this._unitWord=e?e.text:this._unitWord,this._unitFontSize=e.fontSize?e.fontSize:this._unitSize,this._unitFontColor=e.color?q(e.color):this._unitColor,this._unitFontFamily=e.fontFamily?e.fontFamily:this._unitFamily,this._unitX=e.xPosition?e.xPosition:this._unitX,this._unitY=e.yPosition?e.yPosition:this._unitY),0!==Object.getOwnPropertyNames(i).length&&(this._sourceShow=i?i.show:this._sourceShow,this._sourceWord=i?i.text:this._sourceWord,this._sourceFontSize=i.fontSize?i.fontSize:this._sourceSize,this._sourceFontColor=i.color?q(i.color):this._sourceColor,this._sourceFontFamily=i.fontFamily?i.fontFamily:this._sourceFamily,this._sourceX=i.xPosition?i.xPosition:this._sourceX,this._sourceY=i.yPosition?i.yPosition:this._sourceY)}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.xAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.yAxis.height:0,e=this.heightOfMainGroup-t;return e>0?e:0}}]),e}(Tt),vr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-overlap-area"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._stroke=null,i._strokeWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i._lineWidth="1",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._yScale,n=t._xScale,a=t._label,o=(a.display,a.positionChoice,a.positionOptions,a.textLabel.fontSize,q(a.textLabel.color),a.textLabel.fontFamily,t._animation),r=t._transition,l=1e3*t._duration,s=1e3*o.startDelay,u=o.moveStyle,h=o.moveOptions,d=t._display,_=d.lineWidth,f=d.lineType,p=d.fillOpacity;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),r&&0==h.indexOf(u)){var g=d3.line().x((function(e){return t._xScale(e.value)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),v=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1((function(t){return n(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(g.curve(t._curve),v.curve(t._curve));var m=t.group;m.selectAll("path").remove();var b=m.selectAll("path").data(e,(function(t){return t.key})),S=m.selectAll("path").data(e,(function(t){return t.key}));S.exit().remove(),b.exit().remove();var k=b.enter().append("path").merge(b).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),w=S.enter().append("path").merge(S).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));k.attr("d",(function(t){return g(t.data)})),w.attr("d",(function(t){return v(t.data)}))}else if(r&&1==h.indexOf(u)){for(var C=[],O=0;O<e.length;O++){C[O]={},C[O].name=e[O].name,C[O].color=e[O].color,C[O].data=[];for(var F=0;F<e[O].data.length;F++)C[O].data[F]={},C[O].data[F].value=e[O].data[0].value,C[O].data[F].name=e[O].data[F].name}var L=d3.line().x((function(e){return t._xScale(e.value)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),P=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1((function(t){return n(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(L.curve(t._curve),P.curve(t._curve));var A=t.group;A.selectAll("path").remove();var W=A.selectAll("path").data(e,(function(t){return t.key})),z=A.selectAll("path").data(e,(function(t){return t.key}));z.exit().remove(),W.exit().remove();var M=W.enter().append("path").merge(W).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),D=z.enter().append("path").merge(z).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(M.attr("d",(function(t){return L(t.data)})),D.attr("d",(function(t){return P(t.data)}))):(M.attr("d",(function(t,e){return L(C[e].data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return L(t.data)})),D.attr("d",(function(t,e){return P(C[e].data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return P(t.data)})))}else if(r&&2==h.indexOf(u)){var R=d3.line().x(n(0)).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),N=d3.line().x((function(e){return t._xScale(e.value)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),T=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1(n(0)).defined((function(t){return!isNaN(parseFloat(t.value))})),B=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1((function(t){return n(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(R.curve(t._curve),N.curve(t._curve),T.curve(t._curve),B.curve(t._curve));var G=t.group;G.selectAll("path").remove();var X=G.selectAll("path").data(e,(function(t){return t.key})),j=G.selectAll("path").data(e,(function(t){return t.key}));j.exit().remove(),X.exit().remove();var I=X.enter().append("path").merge(X).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),Y=j.enter().append("path").merge(j).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(I.attr("d",(function(t){return N(t.data)})),Y.attr("d",(function(t){return B(t.data)}))):(I.attr("d",(function(t){return R(t.data)})).transition().delay((function(t,i){return r?s+i*l/e.length:0})).duration(r?.9*l/e.length:0).attr("d",(function(t){return N(t.data)})),Y.attr("d",(function(t){return T(t.data)})).transition().delay((function(t,i){return r?s+i*l/e.length:0})).duration(r?.9*l/e.length:0).attr("d",(function(t){return B(t.data)})))}else if(r&&3==h.indexOf(u)){var H=d3.line().x(n(0)).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),E=d3.line().x((function(e){return t._xScale(e.value)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),V=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1(n(0)).defined((function(t){return!isNaN(parseFloat(t.value))})),$=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1((function(t){return n(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(H.curve(t._curve),E.curve(t._curve),V.curve(t._curve),$.curve(t._curve));var Z=t.group;Z.selectAll("path").remove();var Q=Z.selectAll("path").data(e,(function(t){return t.key})),K=Z.selectAll("path").data(e,(function(t){return t.key}));K.exit().remove(),Q.exit().remove();var J=Q.enter().append("path").merge(Q).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),tt=K.enter().append("path").merge(K).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(J.attr("d",(function(t){return E(t.data)})),tt.attr("d",(function(t){return $(t.data)}))):(J.attr("d",(function(t){return H(t.data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return E(t.data)})),tt.attr("d",(function(t){return V(t.data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return $(t.data)})))}else{var et=d3.line().x((function(e){return t._xScale(e.value)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),it=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1((function(t){return n(t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(et.curve(t._curve),it.curve(t._curve));var nt=t.group;nt.selectAll("path").remove();var at=nt.selectAll("path").data(e,(function(t){return t.key})),ot=nt.selectAll("path").data(e,(function(t){return t.key}));ot.exit().remove(),at.exit().remove();var rt=at.enter().append("path").merge(at).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),lt=ot.enter().append("path").merge(ot).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));rt.attr("d",(function(t){return et(t.data)})),lt.attr("d",(function(t){return it(t.data)}))}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(at),mr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-overlap-area-scatter-plot"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=1,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-scatter-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=t._xScale,a=t._yScale,o=e.selectAll("g").data(i,(function(t){return t.name}));o.exit().remove();var r=t._animation,l=t._transition,s=1e3*t._duration,u=1e3*r.startDelay,h=r.moveStyle,d=r.moveOptions;if(l&&0==d.indexOf(h))o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.value)||n(0)})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius)}));else if(l&&1==d.indexOf(h)){for(var _=[],f=0;f<i.length;f++){_[f]={},_[f].name=i[f].name,_[f].color=i[f].color,_[f].data=[];for(var p=0;p<i[f].data.length;p++)_[f].data[p]={},_[f].data[p].value=i[f].data[0].value,_[f].data[p].name=i[f].data[p].name}o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t,e){return n(_[i].data[e].value)})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0}));t._interrupt?r.attr("cx",(function(t){return n(t.value)})):r.transition().delay((function(t,e){return l?u:0})).duration(l?.9*s:0).attr("cx",(function(t){return n(t.value)}))}))}else l&&2==d.indexOf(h)?o.enter().append("g").merge(o).each((function(e,o){var r=d3.select(this).selectAll("circle").data(e.data);r.exit().remove();var h=r.enter().append("circle").merge(r).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+o)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+o)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",n(0)).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?h.attr("cx",(function(t){return n(t.value)})):h.transition().delay((function(t,e){return l?u+o*s/i.length:0})).duration(l?.9*s/i.length:0).attr("cx",(function(t){return n(t.value)}))})):l&&3==d.indexOf(h)?o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",n(0)).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?r.attr("cx",(function(t){return n(t.value)})):r.transition().delay(l?u:0).duration(l?.9*s:0).attr("cx",(function(t){return n(t.value)}))})):o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.value)||n(0)})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius)}));return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(at),br=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-overlap-area-labels"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._stroke=null,i._strokeWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i._lineWidth="1",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=(t._yScale,t._xScale,t._label),a=n.display,o=n.positionChoice,r=n.positionOptions,l=n.textLabel.fontSize,s=q(n.textLabel.color),u=n.textLabel.fontFamily,c=n.suffix||"",h=t._animation,d=t._transition,_=1e3*t._duration,f=1e3*h.startDelay,y=(h.moveStyle,h.moveOptions,t._display),x=(y.lineWidth,y.lineType,y.fillOpacity,y.endPointRadius||"0"),g=t.group;g.selectAll("g").remove();var v=g.selectAll("g").data(e,(function(t){return t.key}));v.exit().remove(),v.enter().append("g").attr("class","text-overlap-g").each((function(e){var i=e.data,n=d3.select(this).selectAll("text").data(i).enter().append("text").attr("class","overlapAreaReverseChartLabel").attr("text-anchor",(function(){return a&&0==r.indexOf(o)?"start":a&&1==r.indexOf(o)?"end":"middle"})).attr("x",(function(e){return a&&0==r.indexOf(o)?x>0?t._xScale(e.value)+parseFloat(x)+5:t._xScale(e.value)+8:a&&1==r.indexOf(o)?x>0?t._xScale(e.value)-parseFloat(x)-5:t._xScale(e.value)-8:t._xScale(e.value)})).attr("y",(function(e,i){return a&&2==r.indexOf(o)?x>0?t._yScale(e.name)-parseFloat(x)-5-.35*parseFloat(l):t._yScale(e.name)-8-.35*parseFloat(l):a&&3==r.indexOf(o)?x>0?t._yScale(e.name)+parseFloat(x)+5+.35*parseFloat(l):t._yScale(e.name)+8+.35*parseFloat(l):t._yScale(e.name)})).attr("dy","0.35em").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+c})).style("opacity",0).style("fill",s).style("font-family",u).style("font-size",l);t._interrupt?n.style("opacity",a?"1":"0"):n.transition().duration(d?.1*_:0).delay(d?f+.9*_:0).ease(d3.easeLinear).style("opacity",a?"1":"0")}));for(var m=g.selectAll(".overlapAreaReverseChartLabel"),b=[],S=[],k=0;k<m._groups[0].length;k++){S.push(k);for(var w=k+1;w<m._groups[0].length;w++){p(i(d3.select(m._groups[0][k])),i(d3.select(m._groups[0][w])))&&(b.push(k),d3.select(m._groups[0][k]).style("visibility","hidden"))}}for(var C=new Set(b),O=Array.from(C),F=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(O,S),L=0;L<O.length;L++){for(var P=[],A=0;A<F.length;A++){var W=i(d3.select(m._groups[0][O[L]])),z=i(d3.select(m._groups[0][F[A]]));if(P.push(p(W,z)),p(W,z)){if(O[L]==F[A])continue;d3.select(m._groups[0][O[L]]).style("visibility","hidden")}}0==P.filter((function(t){return 1==t})).length&&F.push(O[L])}for(var M=0;M<F.length;M++)d3.select(m._groups[0][F[M]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Sr=function(t){function e(t,i){b(this,e);var n=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n._label=n._props.label,n._display=n._props.display,n._animation=n._props.animation,n}return w(e,t),S(e,[{key:"label",get:function(){var t=this._label;return{display:t.display,positionOptions:t.positionOptions||["右侧","左侧","上面","下面"],positionChoice:t.positionChoice||"右侧",textLabel:{fontSize:t.textLabel.fontSize||"14",color:t.textLabel.color||"#545454",fontFamily:t.textLabel.fontFamily||"阿里巴巴普惠体 常规"},suffix:t.suffix||""}}},{key:"display",get:function(){var t=this._display;return{fillOpacity:t.fillOpacity,lineType:t.lineType,lineWidth:t.lineWidth,endPointRadius:t.endPointRadius,endPointBorderWidth:t.endPointBorderWidth,endPointBorderColor:t.endPointBorderColor,endPointFillColor:t.endPointFillColor}}},{key:"animation",get:function(){var t=this._animation;return{transition:t.transition,duration:t.duration||"0",startDelay:t.startDelay||"0",endPause:t.endPause||"0",moveOptions:t.moveOptions||["纵向展开","起波澜","横向依次拉伸","横向同步拉伸"],moveStyle:t.moveStyle||"纵向展开",easeStyle:t.easeStyle||""}}}]),e}(it),kr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.yAxis=new jt(i.mainGroup),i.xAxis=new Ht(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.reverseOverlapArea=new vr(i.coreGroup),i.scatterPlot=new mr(i.coreGroup),i.reverseOverlapAreaLabels=new br(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new yr(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._curve=d3.curveCardinal,i._showPoints=!0,i._interrupt=!1,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.reverseOverlapAreaLabels,a=t.reverseOverlapArea,r=t.scatterPlot,l=t.clipArea,s=t.tooltip,u=t.overlay,h=t.guideLine,d=t.guideScatter,_=t.xScale,f=t.yScale,p=(t.yAxis._axisStart,t.yAxis._axisEnd),g=0;p>t.widthOfNoMargin-t.xAxis.width&&(g=p-(t.widthOfNoMargin-t.xAxis.width));var v=t.widthOfCore-g,m=t.heightOfCore,b=(_.bandwidth(),t._label),S=t._display,k=t._animation,w=t._transition,C=1e3*t._duration,O=1e3*k.startDelay,F=k.moveStyle,L=k.moveOptions,P=S.endPointRadius||"0",A=S.endPointBorderWidth||"0",W=q(S.endPointBorderColor)||null,z=q(S.endPointFillColor)||null,M=t._axis,D=M.axisPositonChoice,R=M.axisPositonOptions,N=b.display,T=b.positionOptions,B=b.positionChoice,G=b.textLabel.fontSize,X=t._display.endPointRadius,j=0;if(j=N?0==T.indexOf(B)||1==T.indexOf(B)?.5*parseFloat(G)+parseFloat(X):"上面"==D?3==T.indexOf(B)?parseFloat(G)+parseFloat(X):parseFloat(X):2==T.indexOf(B)?parseFloat(G)+parseFloat(X):parseFloat(X):parseFloat(X),t.mainGroup.selectAll(".linear-gradient").remove(),W&&/\[/.test(W)){var I=x(W),Y=[],H=!0,V=!1,$=void 0;try{for(var U,Z=I[Symbol.iterator]();!(H=(U=Z.next()).done);H=!0){var Q=U.value,K=[],J=Q.split(":");K.push(q(J[0])),K.push(J[1]),Y.push(K)}}catch(t){V=!0,$=t}finally{try{!H&&Z.return&&Z.return()}finally{if(V)throw $}}var tt=Y.concat(),et=tt.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(et[1]).x1+"%").attr("y1",y(et[1]).y1+"%").attr("x2",y(et[1]).x2+"%").attr("y2",y(et[1]).y2+"%").selectAll("stop").data(tt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(z&&/\[/.test(z)){var it=x(z),nt=[],at=!0,ot=!1,rt=void 0;try{for(var lt,st=it[Symbol.iterator]();!(at=(lt=st.next()).done);at=!0){var ut=lt.value,ct=[],ht=ut.split(":");ct.push(q(ht[0])),ct.push(ht[1]),nt.push(ct)}}catch(t){ot=!0,rt=t}finally{try{!at&&st.return&&st.return()}finally{if(ot)throw rt}}var dt=nt.concat(),_t=dt.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(_t[1]).x1+"%").attr("y1",y(_t[1]).y1+"%").attr("x2",y(_t[1]).x2+"%").attr("y2",y(_t[1]).y2+"%").selectAll("stop").data(dt).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(W=/\[/.test(W)?"url("+c("#"+t.id+"-main-border-index-0")+")":W,z=/\[/.test(z)?"url("+c("#"+t.id+"-main-border-index-1")+")":z,i.width(v).height(m-j).planeX(f.range()[0]).xTickLocations(t.yAxis.tickLocations.slice(1)).yTickLocations(t.xAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).xScale(f).yScale(_).label(b).display(S).animation(k).axis(M).interrupt(t._interrupt).transition(t._transition).duration(t._duration).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.data(e).xScale(f).yScale(_).label(b).display(S).animation(k).axis(M).curve(t._curve).interrupt(t._interrupt).transition(t._transition).duration(t._duration),r.data(e).xScale(f).yScale(_).stroke(W).fill(z).radius(P).strokeWidth(A).animation(k).height(m).interrupt(t._interrupt).transition(t._transition).duration(t._duration),h.x1(f.range()[0]).x2(v).y1(0).y2(0).stroke("#c6c6c6").strokeDasharray("0 0"),d.xScale(f).yScale(_).stroke(z).fill(W).radius(P).strokeWidth(A),u.data(_.domain()).isScalePoint(!1).isHorizontal(!0).bandX(f.range()[0]).bandWidth(v-f.range()[0]).bandHeight(_.step()).onMouseover((function(){s.move([d3.event.offsetX,d3.event.offsetY]).show(),h.show(),d.show()})).onMousemove((function(i,n){var a=[],o=_.domain()[_.domain().length-n-1==-1?1:_.domain().length-n-1==-2?0:_.domain().length-n-1],r=[{text:o=="&-"+(_.domain().length-n)?"":o}];o&&1!=o&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));a.push({key:e.key,name:e.name,color:e.color,data:n}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(n[0].value,t._numberStyle,t._decimalPlaces),color:e.color})})),h.update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate(0,"+_(o)+")")),s.data(r).update(),d.data(a).update(),s.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMouseout((function(){s.hide(),h.hide(),d.hide()})),w&&0==L.indexOf(F))if(t._interrupt){t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",2*-parseFloat(P)).attr("x",2*-parseFloat(P)).attr("height",m+4*parseFloat(P)).attr("width",v+4*parseFloat(P)),t.coreGroup.select(".reverse-overlap-area").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-overlap-area-scatter-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-overlap-area-labels").attr("opacity",1)}else{if(1==R.indexOf(D))t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",v+4*parseFloat(P)).attr("height",m+4*parseFloat(P)).attr("y",m+2*parseFloat(P)).attr("x",2*-parseFloat(P)).transition().duration(w?.9*C:0).delay(w?O:0).attr("y",2*-parseFloat(P));else if(0==R.indexOf(D)){t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",v+4*parseFloat(P)).attr("height",0).attr("y",2*-parseFloat(P)).attr("x",2*-parseFloat(P)).transition().duration(w?.9*C:0).delay(w?O:0).attr("height",m+4*parseFloat(P))}else t.mainGroup.selectAll(".animation-defs").remove();t.coreGroup.select(".reverse-overlap-area").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-overlap-area-scatter-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-overlap-area-labels").attr("opacity",0).transition().duration(w?.1*C:0).delay(w?O+.9*C:0).attr("opacity",1)}else t.coreGroup.select(".reverse-overlap-area").attr("clip-path",""),t.coreGroup.select(".reverse-overlap-area-scatter-plot").attr("clip-path",""),t.coreGroup.select(".reverse-overlap-area-labels").attr("opacity",1);1==R.indexOf(D)?(t.coreGroup.call(o,t.xAxis.width+.5,j),i.translate(t.xAxis.width+.5,j)):(t.coreGroup.call(o,t.xAxis.width+.5,t.yAxis.height),i.translate(t.xAxis.width+.5,t.yAxis.height)),0!=t._clipShowX.length?(l.width(v).height(m).paddingVertical([parseFloat(b.textLabel.fontSize)+parseFloat(2*P)+5,parseFloat(b.textLabel.fontSize)+parseFloat(2*P)+5]).paddingHorizontal([-f.range()[0],0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+l.id)+")"),l.update()):(l.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),l.update()),(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&(l.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),l.update(),t.coreGroup.attr("clip-path","")),d.elem.style("pointer-events","none"),u.translate(0,-_.step()/2).update(),l.update(),i.update(),a.update(),t._showPoints?r.update().show():r.hide(),n.update()}},{key:"updateAxis",value:function(){var t=this,e=t._axis,i=e.axisPositonChoice,n=e.axisPositonOptions;t.computeDomain();var a=t.xAxis,o=t.yAxis,r=t.xScale,l=t.yScale,s=t._xType,u=t._yType,c=void 0;c=0==n.indexOf(i)?"top":"bottom";var h=t._label,d=h.display,_=h.positionOptions,f=h.positionChoice,p=h.textLabel.fontSize,y=t._display.endPointRadius,x=0;x=d?0==_.indexOf(f)||1==_.indexOf(f)?.5*parseFloat(p)+parseFloat(y):"上面"==i?3==_.indexOf(f)?parseFloat(p)+parseFloat(y):parseFloat(y):2==_.indexOf(f)?parseFloat(p)+parseFloat(y):parseFloat(y):parseFloat(y);var g=t._fontSize,v=t.widthOfNoMargin,m=t.heightOfMainGroup;l.domain(t._xDomain),r.domain(t._yDomain),o.scaleFunc(l).allowedMaxTextHeight(.5*m).type(u).orient(c).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),r.domain(t._yDomain),a.scaleFunc(r).allowedMaxTextWidth(.5*v).type(s).orient("left").title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);a.titleHeight;var b=t._tickCount?t._tickCount:(v-a.allowedMaxTextWidth())/(3*g);o.tickCount(b),a.compute();var S=0,k=v-a.width;a.compute(),l.range([S,k]),o.compute();var w=o._axisStart,C=o._axisEnd;w<0&&(S=Math.abs(w)>a.width?Math.abs(w)-a.width:0),C>k&&(k-=C-k),l.range([S,k]),r.range([m-o.height-x,0]);var O=m-o.height,F=x||0;0==n.indexOf(i)?(O=o.height,F=o.height):O=(n.indexOf(i),m-o.height);var L=a.width,P=a.width+S;o.translate(L,O).update(),a.translate(P,F).update()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._axis,n=i.axisPositonChoice,a=i.axisPositonOptions,o=t._xRange||[],r=e.length?e[0].data.map((function(t){return t.name})):[0,1],l=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.2*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];0==a.indexOf(n)?r.reverse():a.indexOf(n),t._xDomain=[isNaN(parseFloat(o[0]))?l[0]:parseFloat(o[0]),isNaN(parseFloat(o[1]))?isNaN(parseFloat(o[0]))?l[1]:l[1]<o[0]?1.5*o[0]:l[1]:parseFloat(o[1])],t._yDomain=r}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new Sr(t,e),n=W;switch(i.dataType){case"cross-table":n=ee;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){this.label(t.label),this.display(t.display),this.animation(t.animation),this.axis(t.axis.x);var e=t.unitDisplay,i=t.sourceDisplay,n=t.animation;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._unitShow=e?e.show:this._unitShow,this._unitWord=e?e.text:this._unitWord,this._unitFontSize=e.fontSize?e.fontSize:this._unitSize,this._unitFontColor=e.color?q(e.color):this._unitColor,this._unitFontFamily=e.fontFamily?e.fontFamily:this._unitFamily,this._unitX=e.xPosition?e.xPosition:this._unitX,this._unitY=e.yPosition?e.yPosition:this._unitY),0!==Object.getOwnPropertyNames(i).length&&(this._sourceShow=i?i.show:this._sourceShow,this._sourceWord=i?i.text:this._sourceWord,this._sourceFontSize=i.fontSize?i.fontSize:this._sourceSize,this._sourceFontColor=i.color?q(i.color):this._sourceColor,this._sourceFontFamily=i.fontFamily?i.fontFamily:this._sourceFamily,this._sourceX=i.xPosition?i.xPosition:this._sourceX,this._sourceY=i.yPosition?i.yPosition:this._sourceY)}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.xAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.yAxis.height:0,e=this.heightOfMainGroup-t;return e>0?e:0}}]),e}(Tt),wr=function(t){function e(t,i){b(this,e);var n=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n._label=n._props.label,n._display=n._props.display,n._animation=n._props.animation,n}return w(e,t),S(e,[{key:"label",get:function(){var t=this._label;return{display:t.display,positionOptions:t.positionOptions||["右侧","左侧","上面","下面"],positionChoice:t.positionChoice||"右侧",textLabel:{fontSize:t.textLabel.fontSize||"14",color:t.textLabel.color||"#545454",fontFamily:t.textLabel.fontFamily||"阿里巴巴普惠体 常规"},suffix:t.suffix}}},{key:"display",get:function(){var t=this._display;return{fillOpacity:t.fillOpacity,lineType:t.lineType,lineWidth:t.lineWidth,endPointRadius:t.endPointRadius,endPointBorderWidth:t.endPointBorderWidth,endPointBorderColor:t.endPointBorderColor,endPointFillColor:t.endPointFillColor}}},{key:"animation",get:function(){var t=this._animation;return{transition:t.transition,duration:t.duration||"0",startDelay:t.startDelay||"0",endPause:t.endPause||"0",moveOptions:t.moveOptions||["纵向展开","起波澜","横向依次拉伸","横向同步拉伸","分步展示面"],moveStyle:t.moveStyle||"纵向展开",easeStyle:t.easeStyle||""}}}]),e}(it);function Cr(t,e){var i=0,n=!1;if(e.forEach((function(t){"objCol"===t.function&&(i=t.index,n=t.isLegend)})),P(t,[i],2))return[];var a=z(t,e),o={},r=[],l=a.length,s=a[0];if(n)for(var u=1;u<l;u++){var c=a[u],d=c[i];if(d){""!=d&&null!=d&&null!=d||(d="$-"+u);for(var _={name:d,dataScreen:!0,showLegend:d!="$-"+u,data:[]},f=0;f<c.length;f++){var p=s[f];f!==i&&p&&_.data.push({name:p,value:c[f]})}r.push(_)}}else{s.forEach((function(t,e){e!==i&&(o[t]={name:t,dataScreen:!0,showLegend:!!t,data:[]})}));for(var y=1;y<l;y++){var x=a[y],g=x[i];if(g)for(var v=0;v<x.length;v++){var m=s[v];v!==i&&m&&o[m].data.push({name:g,value:x[v]})}}for(var b in o)r.push(o[b])}r.forEach((function(t,e){t.key=h(t.name)+"-"+e}));var S={};return r.forEach((function(t){t.data.forEach((function(t){null==S[t.name]?(S[t.name]=t.value,t.total=S[t.name]):(S[t.name]+=t.value,t.total=S[t.name])}))})),r}var Or=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-stacked-area"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._stroke=null,i._strokeWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i._lineWidth="1",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._yScale,n=t._xScale,a=t._label,o=(a.display,a.positionChoice,a.positionOptions,a.textLabel.fontSize,q(a.textLabel.color),a.textLabel.fontFamily,t._animation),r=t._transition,l=1e3*t._duration,s=1e3*o.startDelay,u=o.moveStyle,h=o.moveOptions,d=t._display,_=d.lineWidth,f=d.lineType,p=d.fillOpacity;if(t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),r&&0==h.indexOf(u)){var g=d3.line().x((function(e){return t._xScale(e.total)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),v=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(g.curve(t._curve),v.curve(t._curve));var m=t.group;m.selectAll("path").remove();var b=m.selectAll("path").data(e,(function(t){return t.key})),S=m.selectAll("path").data(e,(function(t){return t.key}));S.exit().remove(),b.exit().remove();var k=b.enter().append("path").merge(b).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),w=S.enter().append("path").merge(S).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));k.attr("d",(function(t){return g(t.data)})),w.attr("d",(function(t){return v(t.data)}))}else if(r&&1==h.indexOf(u)){for(var C=[],O=0;O<e.length;O++){C[O]={},C[O].name=e[O].name,C[O].color=e[O].color,C[O].data=[];for(var F=0;F<e[O].data.length;F++)C[O].data[F]={},C[O].data[F].total=e[O].data[0].total,C[O].data[F].value=e[O].data[0].value,C[O].data[F].name=e[O].data[F].name}var L=d3.line().x((function(e){return t._xScale(e.total)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),P=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(L.curve(t._curve),P.curve(t._curve));var A=t.group;A.selectAll("path").remove();var W=A.selectAll("path").data(e,(function(t){return t.key})),z=A.selectAll("path").data(e,(function(t){return t.key}));z.exit().remove(),W.exit().remove();var M=W.enter().append("path").merge(W).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),D=z.enter().append("path").merge(z).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(M.attr("d",(function(t){return L(t.data)})),D.attr("d",(function(t){return P(t.data)}))):(M.attr("d",(function(t,e){return L(C[e].data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return L(t.data)})),D.attr("d",(function(t,e){return P(C[e].data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return P(t.data)})))}else if(r&&2==h.indexOf(u)){var R=d3.line().x((function(e){return t._xScale(e.total)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),N=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total-t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))})),T=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(R.curve(t._curve),N.curve(t._curve),T.curve(t._curve));var B=t.group;B.selectAll("path").remove();var G=B.selectAll("path").data(e,(function(t){return t.key})),X=B.selectAll("path").data(e,(function(t){return t.key}));X.exit().remove(),G.exit().remove();var j=G.enter().append("path").merge(G).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})).style("opacity","0"),I=X.enter().append("path").merge(X).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(j.attr("d",(function(t){return R(t.data)})).style("opacity","1"),I.attr("d",(function(t){return T(t.data)}))):(j.transition().delay(r?s+.8*l:0).duration(r?.1*l:0).attr("d",(function(t){return R(t.data)})).style("opacity","1"),I.attr("d",(function(t){return N(t.data)})).transition().delay(r?s:0).duration(r?.9*l:0).attr("d",(function(t){return T(t.data)})))}else if(r&&3==h.indexOf(u)){var Y=d3.line().x(n(0)).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),H=d3.line().x((function(e){return t._xScale(e.total)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),E=t._areaFunc||d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0(n(0)).x1(n(0)).defined((function(t){return!isNaN(parseFloat(t.value))})),V=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(Y.curve(t._curve),H.curve(t._curve),E.curve(t._curve),V.curve(t._curve));var $=t.group;$.selectAll("path").remove();var Z=$.selectAll("path").data(e,(function(t){return t.key})),Q=$.selectAll("path").data(e,(function(t){return t.key}));Q.exit().remove(),Z.exit().remove();var K=Z.enter().append("path").merge(Z).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),J=Q.enter().append("path").merge(Q).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(K.attr("d",(function(t){return H(t.data)})),J.attr("d",(function(t){return V(t.data)}))):(K.attr("d",(function(t){return Y(t.data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return H(t.data)})),J.attr("d",(function(t){return E(t.data)})).transition().delay((function(t,e){return r?s:0})).duration(r?.9*l:0).attr("d",(function(t){return V(t.data)})))}else if(r&&4==h.indexOf(u)){var tt=d3.line().x((function(e){return t._xScale(e.total)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),et=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total-t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))})),it=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(tt.curve(t._curve),et.curve(t._curve),it.curve(t._curve));var nt=t.group;nt.selectAll("path").remove();var at=nt.selectAll("path").data(e,(function(t){return t.key})),ot=nt.selectAll("path").data(e,(function(t){return t.key}));ot.exit().remove(),at.exit().remove();var rt=at.enter().append("path").merge(at).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})).style("opacity","0"),lt=ot.enter().append("path").merge(ot).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));t._interrupt?(rt.attr("d",(function(t){return tt(t.data)})).style("opacity","1"),lt.attr("d",(function(t){return it(t.data)}))):(rt.transition().delay((function(t,i){return r?s+(i+1)*l/e.length:0})).duration(r?.9*l/e.length:0).attr("d",(function(t){return tt(t.data)})).style("opacity","1"),lt.attr("d",(function(t){return et(t.data)})).transition().delay((function(t,i){return r?s+i*l/e.length:0})).duration(r?.9*l/e.length:0).attr("d",(function(t){return it(t.data)})))}else{var st=d3.line().x((function(e){return t._xScale(e.total)})).y((function(e){return t._yScale(e.name)+t._yScale.bandwidth()/2})).defined((function(t){return!isNaN(parseFloat(t.value))})),ut=d3.area().y((function(t){return i(t.name)+i.bandwidth()/2})).x0((function(t){return n(t.total-t.value)})).x1((function(t){return n(t.total)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==f&&(st.curve(t._curve),ut.curve(t._curve));var ct=t.group;ct.selectAll("path").remove();var ht=ct.selectAll("path").data(e,(function(t){return t.key})),dt=ct.selectAll("path").data(e,(function(t){return t.key}));dt.exit().remove(),ht.exit().remove();var _t=ht.enter().append("path").merge(ht).style("fill","none").style("stroke",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",(function(){return parseFloat(_)<=0?"0":parseFloat(_)>100?"100":parseFloat(_)})),ft=dt.enter().append("path").merge(dt).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return p;var e=U(t.color,3)||1;return p*e}));_t.attr("d",(function(t){return st(t.data)})),ft.attr("d",(function(t){return ut(t.data)}))}return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(at),Fr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-stacked-area-scatter-plot"),i._xScale=null,i._yScale=null,i._radius=function(){return 3},i._fill=null,i._stroke=null,i._strokeWidth=1,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-scatter-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=t._xScale,a=t._yScale,o=e.selectAll("g").data(i,(function(t){return t.name}));o.exit().remove();var r=t._animation,l=t._transition,s=1e3*t._duration,u=1e3*r.startDelay,h=r.moveStyle,d=r.moveOptions;if(l&&0==d.indexOf(h))o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.total)||0})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius)}));else if(l&&1==d.indexOf(h)){for(var _=[],f=0;f<i.length;f++){_[f]={},_[f].name=i[f].name,_[f].color=i[f].color,_[f].data=[];for(var p=0;p<i[f].data.length;p++)_[f].data[p]={},_[f].data[p].total=i[f].data[0].total,_[f].data[p].value=i[f].data[0].value,_[f].data[p].name=i[f].data[p].name}o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("r",t._radius).attr("cx",(function(t,e){return n(_[i].data[e].total)})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0}));t._interrupt?r.attr("cx",(function(t){return n(t.total)})):r.transition().delay((function(t,e){return l?u:0})).duration(l?.9*s:0).attr("cx",(function(t){return n(t.total)}))}))}else l&&2==d.indexOf(h)?o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.total-t.value)})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius).style("opacity","0");t._interrupt?r.attr("cx",(function(t){return n(t.total)})).style("opacity","1"):r.transition().delay(l?u:0).duration(l?.9*s:0).attr("cx",(function(t){return n(t.total)})).style("opacity","1")})):l&&3==d.indexOf(h)?o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove();var r=o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",n(0)).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius);t._interrupt?r.attr("cx",(function(t){return n(t.total)})):r.transition().delay(l?u:0).duration(l?.9*s:0).attr("cx",(function(t){return n(t.total)}))})):l&&4==d.indexOf(h)?o.enter().append("g").merge(o).each((function(e,o){var r=d3.select(this).selectAll("circle").data(e.data);r.exit().remove();var h=r.enter().append("circle").merge(r).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+o)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+o)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.total-t.value)})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius).style("opacity","0");t._interrupt?h.attr("cx",(function(t){return n(t.total)})).style("opacity","1"):h.transition().delay((function(t,e){return l?u+o*s/i.length:0})).duration(l?.9*s/i.length:0).attr("cx",(function(t){return n(t.total)})).style("opacity","1")})):o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-scatter-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.total)||0})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius)}));return t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}}]),e}(at),Lr=function(t){function e(t){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t.group,i=t._data;e.selectAll("*").remove(),i.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-an-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var n=t._xScale,a=t._yScale,o=e.selectAll("g").data(i,(function(t){return t.name}));return o.exit().remove(),o.enter().append("g").merge(o).each((function(e,i){var o=d3.select(this).selectAll("circle").data(e.data);o.exit().remove(),o.enter().append("circle").merge(o).style("fill",t._fill||(/\[/.test(e.color)?"url("+c("#"+t.id+"-an-index-"+i)+")":e.color)).style("stroke",t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-an-index-"+i)+")":e.color)).style("stroke-width",t._strokeWidth).attr("cx",(function(t){return n(t.total)||0})).attr("cy",(function(e){return a(e.name)+t._yScale.bandwidth()/2||0})).attr("r",t._radius)})),t}}]),e}(yr),Pr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","reverse-stacked-area-labels"),i._xScale=null,i._yScale=null,i._areaFunc=null,i._stroke=null,i._strokeWidth=2,i._strokeDasharry="",i._curve=d3.curveLinear,i._transition=!1,i._lineWidth="1",i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=(t._yScale,t._xScale,t._label),a=n.display,o=n.positionChoice,r=n.positionOptions,l=n.textLabel.fontSize,s=q(n.textLabel.color),u=n.textLabel.fontFamily,c=n.suffix||"",h=t._animation,d=t._transition,_=1e3*t._duration,f=1e3*h.startDelay,y=t._display.endPointRadius||"0",x=t.group;x.selectAll("g").remove();var g=x.selectAll("g").data(e,(function(t){return t.key}));g.exit().remove(),g.enter().append("g").attr("class","text-stacked-g").each((function(e){var i=e.data,n=d3.select(this).selectAll("text").data(i).enter().append("text").attr("class","overlapAreaReverseChartLabel").attr("text-anchor",(function(){return a&&0==r.indexOf(o)?"start":a&&1==r.indexOf(o)?"end":"middle"})).attr("x",(function(e){return a&&0==r.indexOf(o)?y>0?t._xScale(e.total)+parseFloat(y)+5:t._xScale(e.total)+8:a&&1==r.indexOf(o)?y>0?t._xScale(e.total)-parseFloat(y)-5:t._xScale(e.total)-8:t._xScale(e.total)})).attr("y",(function(e,i){return a&&2==r.indexOf(o)?y>0?t._yScale(e.name)-parseFloat(y)-5-.35*parseFloat(l):t._yScale(e.name)-8-.35*parseFloat(l):a&&3==r.indexOf(o)?y>0?t._yScale(e.name)+parseFloat(y)+5+.35*parseFloat(l):t._yScale(e.name)+8+.35*parseFloat(l):t._yScale(e.name)})).attr("dy","0.35em").text((function(e){return E(e.total,t._numberStyle,t._decimalPlaces)+c})).style("opacity",0).style("fill",s).style("font-family",u).style("font-size",l);t._interrupt?n.style("opacity",a?"1":"0"):n.transition().duration(d?.1*_:0).delay(d?f+.9*_:0).ease(d3.easeLinear).style("opacity",a?"1":"0")}));for(var v=x.selectAll(".overlapAreaReverseChartLabel"),m=[],b=[],S=0;S<v._groups[0].length;S++){b.push(S);for(var k=S+1;k<v._groups[0].length;k++){p(i(d3.select(v._groups[0][S])),i(d3.select(v._groups[0][k])))&&(m.push(S),d3.select(v._groups[0][S]).style("visibility","hidden"))}}for(var w=new Set(m),C=Array.from(w),O=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(C,b),F=0;F<C.length;F++){for(var L=[],P=0;P<O.length;P++){var A=i(d3.select(v._groups[0][C[F]])),W=i(d3.select(v._groups[0][O[P]]));if(L.push(p(A,W)),p(A,W)){if(C[F]==O[P])continue;d3.select(v._groups[0][C[F]]).style("visibility","hidden")}}0==L.filter((function(t){return 1==t})).length&&O.push(C[F])}for(var z=0;z<O.length;z++)d3.select(v._groups[0][O[z]]).style("visibility","visible");return t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"lineFunc",value:function(t){return arguments.length?(this._lineFunc=t,this):this._lineFunc}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeDasharry",value:function(t){return arguments.length?(this._strokeDasharry=t,this):this._strokeDasharry}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveLinear,this):this._curve}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ar=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.clipArea=new Ut(i.defs),i.yAxis=new jt(i.mainGroup),i.xAxis=new Ht(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.areaReverse=new Or(i.coreGroup),i.scatterPlot=new Fr(i.coreGroup),i.overlay=new te(i.coreGroup),i.guideLine=new Et(i.coreGroup),i.guideScatter=new Lr(i.coreGroup),i.stackedAreaLabels=new Pr(i.coreGroup),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._curve=d3.curveCardinal,i._showPoints=!0,i._interrupt=!1,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)e[i].data[n].value=parseFloat(e[i].data[n].value),e[i].data[n].total=0==i?parseFloat(e[i].data[n].value):e[i-1].data[n].total+parseFloat(e[i].data[n].value);var a=t.grid,r=t.stackedAreaLabels,l=t.areaReverse,s=t.scatterPlot,u=t.clipArea,h=t.tooltip,d=t.overlay,_=t.guideLine,f=t.guideScatter,p=t.xScale,g=t.yScale,v=(t.yAxis._axisStart,t.yAxis._axisEnd),m=0;v>t.widthOfNoMargin-t.xAxis.width&&(m=v-(t.widthOfNoMargin-t.xAxis.width));var b=t.widthOfCore-m,S=t.heightOfCore,k=(p.bandwidth(),t._label),w=t._display,C=t._animation,O=t._transition,F=1e3*t._duration,L=1e3*C.startDelay,P=C.moveStyle,A=C.moveOptions,W=w.endPointRadius||"0",z=w.endPointBorderWidth||"0",M=q(w.endPointBorderColor)||null,D=q(w.endPointFillColor)||null,R=t._axis,N=R.axisPositonChoice,T=R.axisPositonOptions,B=k.display,G=k.positionOptions,X=k.positionChoice,j=k.textLabel.fontSize,I=t._display.endPointRadius,Y=0;if(Y=B?0==G.indexOf(X)||1==G.indexOf(X)?.5*parseFloat(j)+parseFloat(I):"上面"==N?3==G.indexOf(X)?parseFloat(j)+parseFloat(I):parseFloat(I):2==G.indexOf(X)?parseFloat(j)+parseFloat(I):parseFloat(I):parseFloat(I),t.mainGroup.selectAll(".linear-gradient").remove(),M&&/\[/.test(M)){var H=x(M),V=[],$=!0,U=!1,Z=void 0;try{for(var Q,K=H[Symbol.iterator]();!($=(Q=K.next()).done);$=!0){var J=Q.value,tt=[],et=J.split(":");tt.push(q(et[0])),tt.push(et[1]),V.push(tt)}}catch(t){U=!0,Z=t}finally{try{!$&&K.return&&K.return()}finally{if(U)throw Z}}var it=V.concat(),nt=it.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(nt[1]).x1+"%").attr("y1",y(nt[1]).y1+"%").attr("x2",y(nt[1]).x2+"%").attr("y2",y(nt[1]).y2+"%").selectAll("stop").data(it).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(D&&/\[/.test(D)){var at=x(D),ot=[],rt=!0,lt=!1,st=void 0;try{for(var ut,ct=at[Symbol.iterator]();!(rt=(ut=ct.next()).done);rt=!0){var ht=ut.value,dt=[],_t=ht.split(":");dt.push(q(_t[0])),dt.push(_t[1]),ot.push(dt)}}catch(t){lt=!0,st=t}finally{try{!rt&&ct.return&&ct.return()}finally{if(lt)throw st}}var ft=ot.concat(),pt=ft.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(pt[1]).x1+"%").attr("y1",y(pt[1]).y1+"%").attr("x2",y(pt[1]).x2+"%").attr("y2",y(pt[1]).y2+"%").selectAll("stop").data(ft).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(M=/\[/.test(M)?"url("+c("#"+t.id+"-main-border-index-0")+")":M,D=/\[/.test(D)?"url("+c("#"+t.id+"-main-border-index-1")+")":D,a.width(b).height(S-Y).planeX(g.range()[0]).xTickLocations(t.yAxis.tickLocations.slice(1)).yTickLocations(t.xAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),r.data(e).xScale(g).yScale(p).label(k).display(w).animation(C).interrupt(t._interrupt).transition(t._transition).duration(t._duration).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),l.data(e).xScale(g).yScale(p).label(k).display(w).animation(C).axis(R).curve(t._curve).width(b).height(S).interrupt(t._interrupt).transition(t._transition).duration(t._duration),s.data(e).xScale(g).yScale(p).stroke(M).fill(D).radius(W).strokeWidth(z).animation(C).height(S).interrupt(t._interrupt).transition(t._transition).duration(t._duration),_.x1(g.range()[0]).x2(b).y1(0).y2(0).stroke("#c6c6c6").strokeDasharray("0 0"),f.xScale(g).yScale(p).stroke(D).fill(M).radius(W).strokeWidth(z),d.data(p.domain()).isScalePoint(!1).isHorizontal(!0).bandX(g.range()[0]).bandWidth(b-g.range()[0]).bandHeight(p.step()).onMouseover((function(){h.move([d3.event.offsetX,d3.event.offsetY]).show(),_.show(),f.show()})).onMousemove((function(i,n){var a=[],o=p.domain()[p.domain().length-n-1==-1?1:p.domain().length-n-1==-2?0:p.domain().length-n-1],r=[{text:o=="&-"+(p.domain().length-n)?"":o}];o&&1!=o&&(e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));a.push({key:e.key,name:e.name,color:e.color,data:n}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+E(n[0].value,t._numberStyle,t._decimalPlaces),color:e.color})})),_.update().show(),t.group.selectAll(".guide-line").transition().duration(200).attr("transform","translate(0,"+p(o)+")")),h.data(r).update(),f.data(a).update(),h.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMouseout((function(){h.hide(),_.hide(),f.hide()})),O&&0==A.indexOf(P))if(t._interrupt){t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("y",2*-parseFloat(W)).attr("x",2*-parseFloat(W)).attr("height",S+4*parseFloat(W)).attr("width",b+4*parseFloat(W)),t.coreGroup.select(".reverse-stacked-area").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-stacked-area-scatter-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-stacked-area-labels").attr("opacity",1)}else{if(1==T.indexOf(N))t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",b+4*parseFloat(W)).attr("height",S+4*parseFloat(W)).attr("y",S+2*parseFloat(W)).attr("x",2*-parseFloat(W)).transition().duration(O?.9*F:0).delay(O?L:0).attr("y",2*-parseFloat(W));else if(0==T.indexOf(N)){t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",b+4*parseFloat(W)).attr("height",0).attr("y",2*-parseFloat(W)).attr("x",2*-parseFloat(W)).transition().duration(O?.9*F:0).delay(O?L:0).attr("height",S+4*parseFloat(W))}else t.mainGroup.selectAll(".animation-defs").remove();t.coreGroup.select(".reverse-stacked-area").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-stacked-area-scatter-plot").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")"),t.coreGroup.select(".reverse-stacked-area-labels").attr("opacity",0).transition().duration(O?.1*F:0).delay(O?L+.9*F:0).attr("opacity",1)}else t.coreGroup.select(".reverse-stacked-area-labels").attr("opacity",1);1==T.indexOf(N)?(t.coreGroup.call(o,t.xAxis.width+.5,Y),a.translate(t.xAxis.width+.5,Y)):(t.coreGroup.call(o,t.xAxis.width+.5,t.yAxis.height),a.translate(t.xAxis.width+.5,t.yAxis.height)),0!=t._clipShowX.length?(u.width(b).height(S).paddingVertical([parseFloat(k.textLabel.fontSize)+parseFloat(2*W)+5,parseFloat(k.textLabel.fontSize)+parseFloat(2*W)+5]).paddingHorizontal([-g.range()[0],0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+u.id)+")"),u.update()):(u.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),u.update()),(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&(u.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),u.update(),t.coreGroup.attr("clip-path","")),f.elem.style("pointer-events","none"),d.translate(0,-p.step()/2).update(),u.update(),a.update(),l.update(),t._showPoints?s.update().show():s.hide(),r.update()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t._axis,i=e.axisPositonChoice,n=e.axisPositonOptions,a=t.xAxis,o=t.yAxis,r=t.xScale,l=t.yScale,s=t._xType,u=t._yType,c=void 0;c=0==n.indexOf(i)?"top":"bottom";var h=t._label,d=h.display,_=h.positionOptions,f=h.positionChoice,p=h.textLabel.fontSize,y=t._display.endPointRadius,x=0;x=d?0==_.indexOf(f)||1==_.indexOf(f)?.5*parseFloat(p)+parseFloat(y):"上面"==i?3==_.indexOf(f)?parseFloat(p)+parseFloat(y):parseFloat(y):2==_.indexOf(f)?parseFloat(p)+parseFloat(y):parseFloat(y):parseFloat(y);var g=t._fontSize,v=t.widthOfNoMargin,m=t.heightOfMainGroup;l.domain(t._xDomain),r.domain(t._yDomain),o.scaleFunc(l).allowedMaxTextHeight(.5*m).type(u).orient(c).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),r.domain(t._yDomain),a.scaleFunc(r).allowedMaxTextWidth(.5*v).type(s).orient("left").title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(g).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);a.titleHeight;var b=t._tickCount?t._tickCount:(v-a.allowedMaxTextWidth())/(3*g);o.tickCount(b),a.compute();var S=0,k=v-a.width;a.compute(),l.range([S,k]),o.compute();var w=o._axisStart,C=o._axisEnd;w<0&&(S=Math.abs(w)>a.width?Math.abs(w)-a.width:0),C>k&&(k-=C-k),l.range([S,k]),r.range([m-o.height-x,0]);var O=m-o.height,F=x||0;0==n.indexOf(i)?(O=o.height,F=o.height):O=(n.indexOf(i),m-o.height);var L=a.width,P=a.width+S;o.translate(L,O).update(),a.translate(P,F).update()}},{key:"computeDomain",value:function(){for(var t=this,e=t.activeData,i=0;i<e.length;i++)for(var n=0;n<e[i].data.length;n++)e[i].data[n].value=parseFloat(e[i].data[n].value),e[i].data[n].total=0==i?parseFloat(e[i].data[n].value):e[i-1].data[n].total+parseFloat(e[i].data[n].value);var a=t._axis,o=a.axisPositonChoice,r=a.axisPositonOptions,l=t._xRange||[],s=e.length?e[0].data.map((function(t){return t.name})):[0,1],u=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.total}))})),0),1.15*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))}))]:[0,1];0==r.indexOf(o)?s.reverse():r.indexOf(o),t._xDomain=[isNaN(parseFloat(l[0]))?u[0]:parseFloat(l[0]),isNaN(parseFloat(l[1]))?isNaN(parseFloat(l[0]))?u[1]:u[1]<l[0]?1.5*l[0]:u[1]:parseFloat(l[1])],t._yDomain=s}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new wr(t,e),n=W;switch(i.dataType){case"cross-table":n=Cr;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){this.label(t.label),this.display(t.display),this.animation(t.animation),this.axis(t.axis.x);var e=t.unitDisplay,i=t.sourceDisplay,n=t.animation;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._unitShow=e?e.show:this._unitShow,this._unitWord=e?e.text:this._unitWord,this._unitFontSize=e.fontSize?e.fontSize:this._unitSize,this._unitFontColor=e.color?q(e.color):this._unitColor,this._unitFontFamily=e.fontFamily?e.fontFamily:this._unitFamily,this._unitX=e.xPosition?e.xPosition:this._unitX,this._unitY=e.yPosition?e.yPosition:this._unitY),0!==Object.getOwnPropertyNames(i).length&&(this._sourceShow=i?i.show:this._sourceShow,this._sourceWord=i?i.text:this._sourceWord,this._sourceFontSize=i.fontSize?i.fontSize:this._sourceSize,this._sourceFontColor=i.color?q(i.color):this._sourceColor,this._sourceFontFamily=i.fontFamily?i.fontFamily:this._sourceFamily,this._sourceX=i.xPosition?i.xPosition:this._sourceX,this._sourceY=i.yPosition?i.yPosition:this._sourceY)}},{key:"axis",value:function(t){return arguments.length?(this._axis=t,this):this._axis}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.xAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.yAxis.height:0,e=this.heightOfMainGroup-t;return e>0?e:0}}]),e}(Tt),Wr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","histogram-plot"),i._xScale=null,i._yScale=null,i._height=null,i._width=null,i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=t._height,a=(t._width,t._label),o=t._animation,r=t._display,l=a.display,s=a.positionOptions||["上面","内部居上","内部居中","内部居下"],u=a.positionChoice||"上面",h=a.textLabel.fontFamily||"阿里巴巴普惠体 常规",d=a.textLabel.fontSize||"14",_=q(a.textLabel.color)||"#545454",p=a.suffix||"",g=t._transition,v=1e3*t._duration||"2",m=1e3*o.startDelay||"0",b=o.moveOptions,S=o.moveStyle,k=r.fillOpacity,w=r.borderWidth||"0",C=q(r.borderColor),O=r.bar4CornerRadius;if(i.selectAll("*").remove(),C&&/\[/.test(C)){var F=x(C),L=[],P=!0,A=!1,W=void 0;try{for(var z,M=F[Symbol.iterator]();!(P=(z=M.next()).done);P=!0){var D=z.value,R=[],N=D.split(":");R.push(q(N[0])),R.push(N[1]),L.push(R)}}catch(t){A=!0,W=t}finally{try{!P&&M.return&&M.return()}finally{if(A)throw W}}var T=L.concat(),B=T.pop();t.group.selectAll(".linear-gradient").remove(),t.group.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(B[1]).x1+"%").attr("y1",y(B[1]).y1+"%").attr("x2",y(B[1]).x2+"%").attr("y2",y(B[1]).y2+"%").selectAll("stop").data(T).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}C=/\[/.test(C)?"url("+c("#"+t.id+"-main-border-index-0")+")":C,e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var G=i.selectAll("rect").data(e,(function(t){return t.key}));G.exit().remove();var X=G.enter().append("path").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return k;var e=U(t.color,3)||1;return k*e})).style("stroke-opacity",(function(t){return t.value>0?"1":"0"})).style("stroke-width",(function(t){return w||0})).style("display",(function(t){return 0==t.value?"none":"block"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?X.attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:t._xScale.step(),height:n-t._yScale(e.value),cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})).style("stroke",null==C?function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color}:C):g&&0==b.indexOf(S)?(X.attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:n,width:t._xScale.step(),height:0,cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})),X.transition().duration(g?.9*v:0).delay(g?m:0).ease(d3.easeLinear).attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:t._xScale.step(),height:n-t._yScale(e.value),cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})).style("stroke",null==C?function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color}:C)):g&&1==b.indexOf(S)?(X.attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:n,width:t._xScale.step(),height:0,cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})),X.transition().duration(g?.9*v/e.length:0).delay(g?function(t,i){return m+i*(.9*v/e.length)}:0).ease(d3.easeLinear).attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:t._xScale.step(),height:n-t._yScale(e.value),cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})).style("stroke",null==C?function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color}:C)):g&&2==b.indexOf(S)?(X.attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:0,height:n-t._yScale(e.value),type:"horizontal"})})),X.transition().duration(g?.9*v:0).delay(g?m:0).ease(d3.easeLinear).attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:t._xScale.step(),height:n-t._yScale(e.value),cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})).style("stroke",null==C?function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color}:C)):g&&3==b.indexOf(S)?(X.attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:0,height:n-t._yScale(e.value),type:"horizontal"})})),X.transition().duration(g?.9*v/e.length:0).delay(g?function(t,i){return m+i*(.9*v/e.length)}:0).ease(d3.easeLinear).attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:t._xScale.step(),height:n-t._yScale(e.value),cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})).style("stroke",null==C?function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color}:C)):X.attr("d",(function(e,i){return f({x:i*t._xScale.step()+t._xScale.range()[0],y:t._yScale(e.value),width:t._xScale.step(),height:n-t._yScale(e.value),cornerRadius:O,roundCorners:[0,1,2,3],type:"horizontal"})})).style("stroke",null==C?function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color}:C);var j=G.data(e).enter().append("text").attr("class","gText").attr("text-anchor","middle").attr("x",(function(e,i){return(i+.5)*t._xScale.step()+t._xScale.range()[0]})).attr("y",(function(e){return 1==s.indexOf(u)?n-t._yScale(e.value)<parseFloat(d)+10?t._yScale(e.value)-5:t._yScale(e.value)+.8*parseFloat(d)+5:2==s.indexOf(u)?n-t._yScale(e.value)<parseFloat(d)+10?t._yScale(e.value)-5:t._yScale(e.value)+.5*(n-t._yScale(e.value)+parseFloat(d)):3==s.indexOf(u)?n-t._yScale(e.value)<parseFloat(d)+10?t._yScale(e.value)-5:n-5:(s.indexOf(u),t._yScale(e.value)-5)}));return t._interrupt?j.text((function(t){if(0!=t.value)return t.value+p})).style("display",l?"block":"none").style("opacity",1).style("fill",_).style("font-family",h).style("font-size",d+"px"):j.style("display",l?"block":"none").style("opacity",0).transition().duration(g?.1*v:0).delay(g?m+.9*v:0).ease(d3.easeLinear).text((function(t){if(0!=t.value)return t.value+p})).style("opacity",1).style("fill",_).style("font-family",h).style("font-size",d+"px"),t}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),zr=function(t){function e(t,i){b(this,e);var n=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n._label=n._props.label,n._display=n._props.display,n._animation=n._props.animation,n}return w(e,t),S(e,[{key:"histogramData",get:function(){var t=this._display,e=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),i=["groupNum","groupDistance"],n=t.histogramSection.key,a=t.histogramSection.sectionValue;if(parseFloat(a)>=1){var o=d3.min(e.map((function(t){return t.value}))),r=-1==String(o).indexOf(".")?o-1:o;0==o&&(r=0);var l=Math.floor(r)||0,s=d3.max(e.map((function(t){return t.value}))),u=-1==String(s).indexOf(".")?s+1:s,c=Math.ceil(u)||1,h=null,d=new Array;if(0==i.indexOf(n)){var _=parseFloat((c-l)/a);c+=_;for(var f=l;f<c;f+=_)d.push(parseFloat(f.toFixed(1)));var p=d3.histogram().domain([l,c]).thresholds(d)(e.map((function(t){return t.value})));h=p}else if(1==i.indexOf(n)){c+=parseFloat(a);for(var y=l;y<c;y+=parseFloat(a))d.push(parseFloat(y.toFixed(1)));var x=d3.histogram().domain([l,c]).thresholds(d)(e.map((function(t){return t.value})));h=x}else{var g=parseFloat((c-l)/a);c+=g;for(var v=l;v<c;v+=g)d.push(parseFloat(v.toFixed(1)));var m=d3.histogram().domain([l,c]).thresholds(d)(e.map((function(t){return t.value})));h=m}var b=d.map((function(t,e){return[t.toString(),h.map((function(t){return t.length}))[e]]}));b.unshift(["分组","值"]);var S=W(b,this._columnMap);return $(S,this.generateColorList(S.length))}return[]}},{key:"label",get:function(){return this._label}},{key:"display",get:function(){return this._display}},{key:"animation",get:function(){return this._animation}}]),e}(it),Mr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.histogram=new Wr(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._interrupt=!1,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=[];if("linear"==t._colors.type){var i=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],n=d3.scaleLinear().domain([t.activeData.length-1,0]).range(i);t.activeData.sort((function(t,e){return e.value-t.value})).map((function(t,e){return t.color=n(e),t}));e=t.activeData.sort((function(t,e){return t.index-e.index}))}else e=t.activeData;var a=t.histogram,r=t.xScale,l=t.yScale,s=t.grid,u=t.clipArea,h=(t.xAxis._axisStart,t.xAxis._axisEnd),d=0;h>t.widthOfNoMargin-t.yAxis.width&&(d=h-(t.widthOfNoMargin-t.yAxis.width));var _=t.widthOfCore-d,f=t.heightOfCore,p=t._label,y=t._animation,x=t._display,g=["groupNum","groupDistance"],v=x.histogramSection.key,m=x.histogramSection.sectionValue,b=parseFloat(m)<1?0:parseFloat(e[e.length-1].name)-parseFloat(e[0].name);s.width(_).height(f).planeX(r.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),a.data(e).xScale(r).yScale(l).height(f).width(_).label(p).display(x).animation(y).interrupt(t._interrupt).transition(t._transition).duration(t._duration).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(i,n){var a=[];1==g.indexOf(v)?(parseFloat(i.name),parseFloat(m)):parseFloat((parseFloat(i.name)+parseFloat(b/(e.length-1))).toFixed(1)),a=parseFloat(m)>1?[{text:"["+E(i.name,t._numberStyle,t._decimalPlaces)+","+E(e[n+1].name,t._numberStyle,t._decimalPlaces)+"]",color:i.color},{text:"数量:   "+i.value}]:[{text:"["+E(i.name,t._numberStyle,t._decimalPlaces)+","+E(i.name,t._numberStyle,t._decimalPlaces)+"]",color:i.color},{text:"数量:   "+i.value}],t.tooltip.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show(),d3.select(this.parentNode).selectAll("path").style("opacity","0.6"),d3.select(this).style("opacity","1")})).onMousemove((function(e){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){t.tooltip.hide(),d3.select(this.parentNode).selectAll("path").style("opacity","1")})),t.coreGroup.call(o,t.yAxis.width+.5,0),s.translate(t.yAxis.width,0).update(),a.update(),u.width(_).height(f).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),u.update(),0!=t._yRange.length&&(0==isNaN(parseFloat(t._yRange[0]))||0==isNaN(parseFloat(t._yRange[1]))?t.coreGroup.attr("clip-path","url("+c("#"+u.id)+")"):t.coreGroup.attr("clip-path",""))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).chartType("histogram"),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(2*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]),a.range([h-e.height,0]);var x=i.width,g=h-e.height,v=i.width+_;e.translate(x,g).update(),i.translate(v,0).update()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=e.length?e.map((function(t){return t.name})):[0,1],n=this._yRange||[],a=d3.max(e.map((function(t){return t.value}))),o=e.length?[Math.min(d3.min(e.map((function(t){return t.value}))),0),Math.max(1.3*a,1)]:[0,1];t._xDomain=i,t._yDomain=[isNaN(parseFloat(n[0]))?o[0]:parseFloat(n[0]),isNaN(parseFloat(n[1]))?isNaN(parseFloat(n[0]))?o[1]:o[1]<n[0]?1.5*n[0]:o[1]:parseFloat(n[1])]}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new zr(t,e),n=W;switch(i.dataType){case"cross-table":n=M;break;default:n=W}return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){this.label(t.label),this.display(t.display),this.animation(t.animation),this.data(t.histogramData);var e=t.unitDisplay,i=t.sourceDisplay,n=t.animation;0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._unitShow=e?e.show:this._unitShow,this._unitWord=e?e.text:this._unitWord,this._unitFontSize=e.fontSize?e.fontSize:this._unitSize,this._unitFontColor=e.color?q(e.color):this._unitColor,this._unitFontFamily=e.fontFamily?e.fontFamily:this._unitFamily,this._unitX=e.xPosition?e.xPosition:this._unitX,this._unitY=e.yPosition?e.yPosition:this._unitY),0!==Object.getOwnPropertyNames(i).length&&(this._sourceShow=i?i.show:this._sourceShow,this._sourceWord=i?i.text:this._sourceWord,this._sourceFontSize=i.fontSize?i.fontSize:this._sourceSize,this._sourceFontColor=i.color?q(i.color):this._sourceColor,this._sourceFontFamily=i.fontFamily?i.fontFamily:this._sourceFamily,this._sourceX=i.xPosition?i.xPosition:this._sourceX,this._sourceY=i.yPosition?i.yPosition:this._sourceY)}},{key:"configLegend",value:function(){var t=this,e=[];if("linear"==t._colors.type){var i=[q(isNaN(parseFloat(t._colors.list[0]))?t._colors.list[0]:t._colorList[t._colors.list[0]]),q(isNaN(parseFloat(t._colors.list[1]))?t._colors.list[1]:t._colorList[t._colors.list[1]])],n=d3.scaleLinear().domain([t.activeData.length-1,0]).range(i);t.activeData.sort((function(t,e){return e.value-t.value})).map((function(t,e){return t.color=n(e),t}));e=t.activeData.sort((function(t,e){return t.index-e.index}))}else e=t.activeData;var a=t._display,o=a.histogramSection.key,r=a.histogramSection.sectionValue,l=parseFloat(r)<1?0:parseFloat(e[e.length-1].name)-parseFloat(e[0].name);1==["groupNum","groupDistance"].indexOf(o)?parseFloat(r):parseFloat(l/(e.length-1));for(var s=[],u=0;u<e.length-1;u++){var c={};c.name=E(e[u].name,t._numberStyle,t._decimalPlaces)+"~"+E(e[u+1].name,t._numberStyle,t._decimalPlaces),c.color=e[u].color,c.key=e[u].key,s.push(c)}t.legend.data(s).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"label",value:function(t){return arguments.length?(this._label=t,this):this._label}},{key:"histogramData",value:function(t){return arguments.length?(this._histogramData=t,this):this._histogramData}},{key:"display",value:function(t){return arguments.length?(this._display=t,this):this._display}},{key:"animation",value:function(t){return arguments.length?(this._animation=t,this):this._animation}}]),e}(Tt),Dr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","basic-scatter"),i._radius=function(){},i._cx=function(){},i._cy=function(){},i._fill=null,i._stroke=null,i._strokeWidth=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));t._transition&&t._duration;var n=i.selectAll("circle").data(e,(function(t){return t.key}));n.exit().remove();var a=n.enter().append("circle").merge(n).attr("cx",t._cx).attr("cy",t._cy).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).attr("r",0).style("stroke",(function(e,i){return t._stroke||(/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color)})).style("stroke-width",t._strokeWidth||0).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);return null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?a.attr("r",t._radius):0==t._moveOptions.indexOf(t._moveStyle)?t._interrupt?a.attr("r",t._radius):a.transition().duration(t._transition?t._duration/(e.length>0?e.length:0):0).delay((function(i,n){return t._transition?t._startDelay+t._duration/(e.length>0?e.length:0)*n:0})).attr("r",t._radius):1==t._moveOptions.indexOf(t._moveStyle)&&(t._interrupt?a.attr("r",t._radius):a.transition().duration(t._transition?t._duration:0).delay((function(e,i){return t._transition?t._startDelay:0})).attr("r",t._radius)),t}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"cx",value:function(t){return arguments.length?(this._cx=t,this):this._cx}},{key:"cy",value:function(t){return arguments.length?(this._cy=t,this):this._cy}},{key:"fill",value:function(t){return arguments.length?(this._fill=t,this):this._fill}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}}]),e}(at);function Rr(t,e){var i=0,n=1,a=2;e.forEach((function(t){"typeCol"===t.function?i=t.index:"X轴"===t.name?n=t.index:"Y轴"===t.name&&(a=t.index)}));var o=[],r=[],l={};t.slice(1).forEach((function(t,e){var s=t[i]||"",u=t[n],c=t[a],h=s+"-"+name+"-"+e;l[s]||""==s||(l[s]=s,o.push(s)),r.push({category:s,x:u,y:c,key:h})}));var s=t[0],u={category:s[i]||"",x:s[n],y:s[a]};return{categories:o,nodes:r,labels:u}}var Nr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","basic-scatter-chart"),i.clipArea=new Ut(i.defs),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup).tickFormat((function(t){return t})),i.yAxis=new Fi(i.mainGroup),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleLinear(),i._xType="number",i._yType="number",i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.core=new Dr(i.coreGroup),i._sortValue=-1,i._maxRadius=5,i._endPointRadius=5,i._strokeWidth=1,i._strokeColor=null,i._fillOpacity=.8,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="依次出现",i._moveOptions=["依次出现","同步出现"],i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.core,i=t.tooltip,n=t.grid,a=t.clipArea,r=t.activeData,l=r.nodes,s=r.labels,u=(t.xAxis._axisStart,t.xAxis._axisEnd),h=0;u>t.widthOfNoMargin-t.yAxis.width&&(h=u-(t.widthOfNoMargin-t.yAxis.width));var d=t.widthOfCore-h,_=t.heightOfCore,f=t.xScale,p=t.yScale,g=t._endPointRadius;d3.max(l,(function(t){return Math.abs(t.radius)}));if(t._strokeColor&&/\[/.test(t._strokeColor)){var v=x(t._strokeColor),m=[],b=!0,S=!1,k=void 0;try{for(var w,C=v[Symbol.iterator]();!(b=(w=C.next()).done);b=!0){var O=w.value,F=[],L=O.split(":");F.push(q(L[0])),F.push(L[1]),m.push(F)}}catch(t){S=!0,k=t}finally{try{!b&&C.return&&C.return()}finally{if(S)throw k}}var P=m.concat(),A=P.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(A[1]).x1+"%").attr("y1",y(A[1]).y1+"%").attr("x2",y(A[1]).x2+"%").attr("y2",y(A[1]).y2+"%").selectAll("stop").data(P).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(l).cx((function(t){return f(isNaN(t.x)?0:t.x)})).cy((function(t){return p(isNaN(t.y)?0:t.y)})).radius((function(t){return g})).stroke(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._strokeColor).strokeWidth(t._strokeWidth).fillOpacity(t._fillOpacity).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).moveOptions(t._moveOptions).endPause(t._endPause).interrupt(t._interrupt).onMouseover((function(e){var n=[{color:e.color,text:e.category},{text:s.x+"："+E(e.x,t._numberStyle,t._decimalPlaces)},{text:s.y+"："+E(e.y,t._numberStyle,t._decimalPlaces)}];i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){i.hide()})),n.width(d).height(_).planeX(f.range()[0]).xTickLocations(t.xAxis.tickLocations).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),t.coreGroup.call(o,t.yAxis.width+.5,0),0!=t._clipShow.length||0!=t._clipShowX.length?(a.width(d).height(_).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+a.id)+")"),a.update()):(a.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),a.update()),(null==t._clipShow[0]&&null==t._clipShow[1]||""==t._clipShow[0]&&""==t._clipShow[1]||null==t._clipShow[0]&&null==t._clipShow[1])&&(null==t._clipShowX[0]&&null==t._clipShowX[1]||""==t._clipShowX[0]&&""==t._clipShowX[1]||null==t._clipShowX[0]&&null==t._clipShowX[1])&&(a.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),a.update(),t.coreGroup.attr("clip-path","")),e.update(),n.translate(t.yAxis.width+.5,0).update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy,i=e.legendData;t.legend.data(i).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),i.forEach((function(t){t.name===n.name&&(t.active=!a)})),e.nodes.forEach((function(t){t.category===n.name&&(t.active=!a)})),t.onDataChange()}))}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(3*u),_=(c-i.allowedMaxTextWidth())/(3*u);e.tickCount(_),i.tickCount(d),e.compute(),i.compute();var f=0,p=c-i.width;i.compute(),n.range([f,p]),e.compute();var y=e._axisStart,x=e._axisEnd;y<0&&(f=Math.abs(y)>i.width?Math.abs(y)-i.width:0),x>p&&(p-=x-p),n.range([f,p]),a.range([h-e.height,0]);var g=i.width,v=h-e.height,m=i.width+f;e.translate(g,v).update(),i.translate(m,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"computeDomain",value:function(){var t=this.activeData.nodes,e=this._xRange||[],i=this._yRange||[],n=d3.extent(t,(function(t){return parseFloat(t.x)})),a=d3.extent(t,(function(t){return parseFloat(t.y)})),o=[Math.min(0,n[0]||0),Math.max(1,1.1*n[1]||0)],r=[Math.min(0,a[0]||0),Math.max(1,1.1*a[1]||0)];this._xDomain=[isNaN(parseFloat(e[0]))?o[0]:parseFloat(e[0]),isNaN(parseFloat(e[1]))?isNaN(parseFloat(e[0]))?o[1]:o[1]<e[0]?1.5*e[0]:o[1]:parseFloat(e[1])],this._yDomain=[isNaN(parseFloat(i[0]))?r[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?r[1]:r[1]<i[0]?1.5*i[0]:r[1]:parseFloat(i[1])]}},{key:"sortData",value:function(){var t=this._data;-1===this._sortValue?t.nodes.sort((function(t,e){return e.radius-t.radius||t.index-e.index})):1===this._sortValue&&t.nodes.sort((function(t,e){return t.radius-e.radius||t.index-e.index})),this._sortedDataCopy=t}},{key:"buildOption",value:function(t,e){var i=new ki(t,e);return i.dataSolveFunc(Rr),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay,a=t.display;0!==Object.getOwnPropertyNames(a).length&&(this._endPointRadius=0==a.bubbleDiameter||a.bubbleDiameter?a.bubbleDiameter/2:this._endPointRadius,this._strokeColor=a.bubbleBorderColor?q(a.bubbleBorderColor):"",this._strokeWidth=0==a.bubbleBorderWidth||a.bubbleBorderWidth?a.bubbleBorderWidth:this._strokeWidth,this._fillOpacity=0==a.fillOpacity||a.fillOpacity?a.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._easeStyle=e.easeStyle?e.easeStyle:this._easeStyle,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=t,this):this._maxRadius}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{nodes:t.nodes.filter((function(t){return!1!==t.active})),labels:t.labels}}}]),e}(Tt),Tr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","table-plot"),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data.horizontal,i=t._data.vercital,n=t.group;n.selectAll("*").remove();var a=5,o=5,r=5,l=5,s=parseFloat(t._fontSize);if(s<=16?(a=4,o=4,r=4,l=4):s>=17&&s<=20?(a=5,o=5,r=5,l=5):s>=21&&s<=36?(a=7,o=7,r=7,l=7):s>36?(a=9,o=9,r=9,l=9):(a=5,o=5,r=5,l=5),"equalwidth"==t._equalWidth){for(var u=t._basic.bold?"bold":"normal",h=[],d=[],_=0;_<e.length;_++){d=[];for(var f=0;f<e[_].data.length;f++)d.push(N(String(e[_].data[f].value),t._columnWidth-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing));h.push(d)}for(var p,y=[],x=0;x<i.length;x++)y.push(t._columnWidth);p=d3.sum(y);for(var g=[],v=0;v<h.length;v++)g.push(d3.max(h[v])+a+o);var m=d3.sum(g),b=t._Width+(i.length+1)*t._strokeWidth+5,S=t._Height+5,k=p+(i.length+1)*t._strokeWidth,w=m+(e.length+1)*t._strokeWidth+1,C=n.append("foreignObject").attr("x",t._marginLeft).attr("y",parseFloat(t._tableTrans)+parseFloat(t._marginTop)).attr("width",t._Width+(i.length+1)*t._strokeWidth+5).attr("height",t._Height+5).append("xhtml:div").attr("xmlns","http://www.w3.org/1999/xhtml").style("-webkit-overflow-scrolling","touch").style("width",t._Width+(i.length+1)*t._strokeWidth+5+"px").style("height",t._Height+5+"px").attr("id","svg-container-div").style("overflow-x",(function(){return k>b?"auto":"hidden"})).style("overflow-y",(function(){return w>S?"auto":"hidden"})).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("version","1.1").attr("width",p+(i.length+1)*t._strokeWidth).attr("height",m+(e.length+1)*t._strokeWidth+1),O=C.selectAll(".bar").data(e,(function(t){return t.name}));O.enter().append("g").attr("class","bar bar_enter").attr("opacity",1).attr("transform",(function(e,i){for(var n,r=[],l=0;l<i;l++)r.push(d3.max(h[l])+a+o+t._strokeWidth);return n=d3.sum(r)+t._strokeWidth,"translate("+t._strokeWidth+","+n+")"})).each((function(i,n){var s=d3.select(this).selectAll("rect").data(i.data);s.exit().remove();s.enter().append("rect").attr("x",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(y[a]+t._strokeWidth);return d3.sum(n)})).attr("width",(function(t,e){return y[e]})).attr("y",0).attr("height",(function(t,e){return d3.max(h[n])+a+o})).style("fill",(function(e,i){var a="none";return"single"==t._colorType?a=(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":t._headRow.show?n>0&&(a=n%2==0?(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none":(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none"):a=n%2==0?(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none",t._firstCol.show&&0==i&&(a=(isNaN(t._firstCol.bgColor)?t._firstCol.bgColor:t._colorList[t._firstCol.bgColor])||"none"),t._headRow.show&&0==n&&(a=(isNaN(t._headRow.bgColor)?t._headRow.bgColor:t._colorList[t._headRow.bgColor])||"none"),q(a)})).style("stroke-width",.5).style("stroke",(function(e,i){var a="none";return"single"==t._colorType?a=(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":t._headRow.show?n>0&&(a=n%2==0?(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none":(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none"):a=n%2==0?(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none",t._firstCol.show&&0==i&&(a=(isNaN(t._firstCol.bgColor)?t._firstCol.bgColor:t._colorList[t._firstCol.bgColor])||"none"),t._headRow.show&&0==n&&(a=(isNaN(t._headRow.bgColor)?t._headRow.bgColor:t._colorList[t._headRow.bgColor])||"none"),q(a)}));var d=d3.select(this).selectAll("clipPath").data(i.data);d.exit().remove();d.enter().append("clipPath").attr("id",(function(e,i){return"hidden-clip-"+i+"-"+n+"-"+t.id})).append("rect").attr("x",(function(e,i){for(var o,s=[],c=0;c<i;c++)s.push(y[c]+t._strokeWidth);o=d3.sum(s);d3.max(h[n]),N(e.value,y[i]-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing);var d=y[i]-r-l,_=T(e.value,y[i]-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing);return o-("left"==t._basic.align||"justify"==t._basic.align?0:"right"==t._basic.align?d-_:(d-_)/2)})).attr("width",(function(t,e){return y[e]})).attr("y",0).attr("height",(function(t,e){return d3.max(h[n])+a+o}));var _=d3.select(this).selectAll("text").data(i.data);_.exit().remove();var f=_.enter().append("text").attr("clip-path",(function(e,i){return"url("+c("#hidden-clip-"+i+"-"+n+"-"+t.id)+")"})).text((function(t){return t.value})).attr("x",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(y[a]+t._strokeWidth);return d3.sum(n)+r})).attr("y",.9*t._fontSize).attr("transform",(function(e,i){var s=d3.max(h[n])+a+o,c=N(e.value,y[i]-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing),d=y[i]-r-l,_=T(e.value,y[i]-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing);return"translate("+("left"==t._basic.align||"justify"==t._basic.align?0:"right"==t._basic.align?d-_:(d-_)/2)+","+((s-c)/2+(t._lineHeight-1)*t._fontSize/2)+")"})).attr("fill",(function(e,i){var a=isNaN(t._fontColor)?t._fontColor:t._colorList[t._fontColor];return t._firstCol.show&&0==i&&(a=(isNaN(t._firstCol.fontColor)?t._firstCol.fontColor:t._colorList[t._firstCol.fontColor])||"none"),t._headRow.show&&0==n&&(a=(isNaN(t._headRow.fontColor)?t._headRow.fontColor:t._colorList[t._headRow.fontColor])||"none"),q(a)})).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).style("letter-spacing",t._letterSpacing).style("font-weight",t._basic.bold?"bold":"normal").style("text-decoration",(function(e){return t._basic.underline?"underline":t._basic.deleteline?"line-through":"none"})).style("font-style",t._basic.italic?"italic":"normal").each((function(e,i){for(var n=[],o=[],s=[],c=[],h=[],d=[],_=[],f=[],p=[],x=[],g=[],v=[],m=[],b=[],S=[],k=[],w=[],C=[],O=[],F=[],L=[],P=[],A=[],W=String(e.value),z=/[a-z0-9]+[a-z0-9]+/gi,M=/[a-z0-9]+[\.|,][a-z0-9]+/gi,D=/[\u4e00-\u9fa5a-zA-Z0-9]+[`~!@#$%^&*()_+<>?:"{},.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+/gi,R=/[0-9]+/gi,N=/[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]+[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]/gi,B=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi,G=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+)[%。\，\-；\; ]+/gi,X=/([\u4e00-\u9fa5]|[a-zA-Z]+)[-][0-9]+/gi,j=/^(%|。|\，|\-|\;| )+/gi,I=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]+([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9])/gi,Y=/[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi;n=z.exec(W);)o.push(n.index+1),m.push(z.lastIndex);for(;n=M.exec(W);)s.push(n.index+1),b.push(M.lastIndex);for(;n=D.exec(W);)c.push(n.index+1),S.push(D.lastIndex);for(;n=R.exec(W);)h.push(n.index+1),k.push(R.lastIndex);for(;n=N.exec(W);)d.push(n.index+1),w.push(N.lastIndex);for(;n=B.exec(W);)_.push(n.index+1),C.push(B.lastIndex);for(;n=G.exec(W);)if(isNaN(n[0].indexOf("-")))f.push(n.index+1),O.push(G.lastIndex);else{for(var H=!0;X.exec(W);)H=!1;H&&(f.push(n.index+1),O.push(G.lastIndex))}for(;n=X.exec(W);)isNaN(n[0].indexOf("-"))||p.push(n.index+n[0].indexOf("-")+1),F.push(X.lastIndex);for(;n=j.exec(W);)x.push(n.index+1),L.push(W.length);for(;n=I.exec(W);)g.push(n.index+1),P.push(W.length);for(;n=Y.exec(W);)v.push(n.index+1),A.push(W.length);var E,V=d3.select(this),$=V.text().split("").reverse(),q=[],U=0,Z=0,Q=+V.attr("x"),K=+V.attr("y"),J=V.text(null).append("tspan").attr("x",Q).attr("y",K);if("justify"==t._basic.align){var tt=y[i]-r-l,et=T(e.value,y[i]-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing);tt<et?J.attr("textLength",et).attr("lengthAdjust","spacing"):J.attr("textLength",y[i]-r-l).attr("lengthAdjust","spacing")}for(;E=$.pop();){q.push(E),J.text(q.join(""));var it=!0;if(o.length>0)for(var nt=0;nt<o.length;nt++)Z>=o[nt]&&Z<m[nt]&&(it=!1);if(s.length>0)for(var at=0;at<s.length;at++)Z>=s[at]&&Z<b[at]&&(it=!1);if(c.length>0)for(var ot=0;ot<c.length;ot++)Z>=c[ot]&&Z<S[ot]&&(it=!1);if(h.length>0)for(var rt=0;rt<h.length;rt++)Z>=h[rt]&&Z<k[rt]&&(it=!1);if(d.length>0)for(var lt=0;lt<d.length;lt++)Z>=d[lt]&&Z<w[lt]&&(it=!1);if(_.length>0)for(var st=0;st<_.length;st++)Z>=_[st]&&Z<C[st]&&(it=!1);if(f.length>0)for(var ut=0;ut<f.length;ut++)Z>=f[ut]&&Z<O[ut]&&(it=!1);if(p.length>0)for(var ct=0;ct<p.length;ct++)Z>=p[ct]&&Z<F[ct]&&(it=!1);if(x.length>0)for(var ht=0;ht<x.length;ht++)Z>=x[ht]&&Z<L[ht]&&(it=!1);if(g.length>0)for(var dt=0;dt<g.length;dt++)Z>=g[dt]&&Z<P[dt]&&(it=!1);if(v.length>0)for(var _t=0;_t<v.length;_t++)Z>=v[_t]&&Z<A[_t]&&(it=!1);if(it&&J.node().getComputedTextLength()>y[i]-r-l&&(0==Z||++U,q.pop(),J.text(q.join("")),q=[E],J=V.append("tspan").attr("x",Q).attr("y",U*parseFloat(.9*t._fontSize*t._lineHeight)+K).text(E),"justify"==t._basic.align)){var ft=y[i]-r-l,pt=T(e.value,y[i]-r-l,a,t._fontSize,t._fontFamily,u,t._lineHeight,t._letterSpacing);ft<pt?J.attr("textLength",pt).attr("lengthAdjust","spacing"):J.attr("textLength",y[i]-r-l).attr("lengthAdjust","spacing")}Z++}}));t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?f.style("opacity",1):0==t._moveOptions.indexOf(t._moveStyle)?f.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?t._duration:0).style("opacity",1):2==t._moveOptions.indexOf(t._moveStyle)?f.style("opacity",0).transition().delay(t._transition?t._startDelay+t._duration/(e.length>0?e.length:1)*n:0).duration(t._transition?t._duration/(e.length>0?e.length:1):0).style("opacity",1):1==t._moveOptions.indexOf(t._moveStyle)&&f.style("opacity",0).transition().delay((function(e,n){return t._transition?t._startDelay+t._duration/(i.data.length>0?i.data.length:1)*n:0})).duration((function(e,n){return t._transition?t._duration/(i.data.length>0?i.data.length:1):0})).style("opacity",1)}));O.exit().attr("class","bar bar_exit").attr("opacity",0).remove();var F=C.selectAll(".y-lines").data(d3.range(0,i.length+1));F.exit().remove();F.enter().append("line").attr("class","y-lines").attr("fill","none").attr("stroke",isNaN(t._strokeColor)?t._strokeColor:t._colorList[t._strokeColor]).attr("stroke-width",t._strokeWidth).attr("x1",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(y[a]+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2})).attr("x2",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(y[a]+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2})).attr("y1",t._strokeWidth-1||0).attr("y2",m+(e.length+1)*t._strokeWidth);var L=C.selectAll(".x-lines").data(d3.range(0,e.length+1));L.exit().remove();L.enter().append("line").attr("class","x-lines").attr("fill","none").attr("stroke",isNaN(t._strokeColor)?t._strokeColor:t._colorList[t._strokeColor]).attr("stroke-width",t._strokeWidth).attr("x1",(function(t,e){return 0})).attr("x2",(function(e,n){return p+(i.length+1)*t._strokeWidth})).attr("y1",(function(e,i){for(var n=[],r=0;r<i;r++)n.push(d3.max(h[r])+a+o+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2})).attr("y2",(function(e,i){for(var n=[],r=0;r<i;r++)n.push(d3.max(h[r])+a+o+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2}))}else{for(var P=[],A=[],W=0;W<i.length;W++){A=[];for(var z=0;z<i[W].data.length;z++)A.push(R(String(i[W].data[z].value),t._fontSize,t._fontFamily));P.push(A)}for(var M=[],D=0;D<P.length;D++)M.push(d3.max(P[D]));for(var B=d3.sum(M),G=t._basic.bold?"bold":"normal",X=[],j=[],I=0;I<i.length;I++){j=[];for(var Y=0;Y<i[I].data.length;Y++)j.push(T(String(i[I].data[Y].value),t._Width*(M[I]/B)-r-l,a,t._fontSize,t._fontFamily,G,t._lineHeight,t._letterSpacing));X.push(j)}for(var H=[],E=0,V=0;V<X.length;V++)H.push(d3.max(X[V])+r+l);for(var $=[],U=[],Z=0;Z<e.length;Z++){U=[];for(var Q=0;Q<e[Z].data.length;Q++)U.push(N(String(e[Z].data[Q].value),H[Q]-r-l,a,t._fontSize,t._fontFamily,G,t._lineHeight,t._letterSpacing));$.push(U)}if((E=d3.sum(H))<t._Width){for(var K=t._Width-E,J=0;J<H.length;J++)H[J]+=K*(M[J]/B);E=d3.sum(H)}for(var tt=[],et=0;et<$.length;et++)tt.push(d3.max($[et])+a+o);var it=d3.sum(tt),nt=t._Width+(i.length+1)*t._strokeWidth+5,at=t._Height+5,ot=E+(i.length+1)*t._strokeWidth,rt=it+(e.length+1)*t._strokeWidth+1,lt=n.append("foreignObject").attr("x",t._marginLeft).attr("y",parseFloat(t._tableTrans)+parseFloat(t._marginTop)).attr("width",t._Width+(i.length+1)*t._strokeWidth+5).attr("height",t._Height+5).append("xhtml:div").attr("xmlns","http://www.w3.org/1999/xhtml").style("-webkit-overflow-scrolling","touch").style("width",t._Width+(i.length+1)*t._strokeWidth+5+"px").style("height",t._Height+5+"px").attr("id","svg-container-div").style("overflow-x",(function(){return ot>nt?"auto":"hidden"})).style("overflow-y",(function(){return rt>at?"auto":"hidden"})).append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("version","1.1").attr("width",E+(i.length+1)*t._strokeWidth).attr("height",it+(e.length+1)*t._strokeWidth+1),st=lt.selectAll(".bar").data(e,(function(t){return t.name}));st.enter().append("g").attr("class","bar bar_enter").attr("opacity",1).attr("transform",(function(e,i){for(var n,r=[],l=0;l<i;l++)r.push(d3.max($[l])+a+o+t._strokeWidth);return n=d3.sum(r)+t._strokeWidth,"translate("+t._strokeWidth+","+n+")"})).each((function(i,n){var s=d3.select(this).selectAll("rect").data(i.data);s.exit().remove();s.enter().append("rect").attr("x",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(H[a]+t._strokeWidth);return d3.sum(n)})).attr("width",(function(t,e){return H[e]})).attr("y",0).attr("height",(function(t,e){return d3.max($[n])+a+o})).style("fill",(function(e,i){var a="none";return"single"==t._colorType?a=(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":t._headRow.show?n>0&&(a=n%2==0?(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none":(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none"):a=n%2==0?(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none",t._firstCol.show&&0==i&&(a=(isNaN(t._firstCol.bgColor)?t._firstCol.bgColor:t._colorList[t._firstCol.bgColor])||"none"),t._headRow.show&&0==n&&(a=(isNaN(t._headRow.bgColor)?t._headRow.bgColor:t._colorList[t._headRow.bgColor])||"none"),q(a)})).style("stroke-width",.5).style("stroke",(function(e,i){var a="none";return"single"==t._colorType?a=(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":t._headRow.show?n>0&&(a=n%2==0?(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none":(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none"):a=n%2==0?(isNaN(t._dataColor[0])?t._dataColor[0]:t._colorList[t._dataColor[0]])||"none":(isNaN(t._dataColor[1])?t._dataColor[1]:t._colorList[t._dataColor[1]])||"none",t._firstCol.show&&0==i&&(a=(isNaN(t._firstCol.bgColor)?t._firstCol.bgColor:t._colorList[t._firstCol.bgColor])||"none"),t._headRow.show&&0==n&&(a=(isNaN(t._headRow.bgColor)?t._headRow.bgColor:t._colorList[t._headRow.bgColor])||"none"),q(a)}));var u=d3.select(this).selectAll("text").data(i.data);u.exit().remove();var c=u.enter().append("text").text((function(t){return t.value})).attr("x",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(H[a]+t._strokeWidth);return d3.sum(n)+r})).attr("y",.9*t._fontSize).attr("transform",(function(e,i){var s=d3.max($[n])+a+o,u=N(e.value,H[i]-r-l,a,t._fontSize,t._fontFamily,G,t._lineHeight,t._letterSpacing),c=H[i]-r-l,h=T(e.value,H[i]-r-l,a,t._fontSize,t._fontFamily,G,t._lineHeight,t._letterSpacing);return"translate("+("left"==t._basic.align||"justify"==t._basic.align?0:"right"==t._basic.align?c-h:(c-h)/2)+","+((s-u)/2+(t._lineHeight-1)*t._fontSize/2)+")"})).attr("fill",(function(e,i){var a=isNaN(t._fontColor)?t._fontColor:t._colorList[t._fontColor];return t._firstCol.show&&0==i&&(a=(isNaN(t._firstCol.fontColor)?t._firstCol.fontColor:t._colorList[t._firstCol.fontColor])||"none"),t._headRow.show&&0==n&&(a=(isNaN(t._headRow.fontColor)?t._headRow.fontColor:t._colorList[t._headRow.fontColor])||"none"),q(a)})).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).style("letter-spacing",t._letterSpacing).style("font-weight",t._basic.bold?"bold":"normal").style("text-decoration",(function(e){return t._basic.underline?"underline":t._basic.deleteline?"line-through":"none"})).style("font-style",t._basic.italic?"italic":"normal").each((function(e,i){for(var n=[],a=[],o=[],s=[],u=[],c=[],h=[],d=[],_=[],f=[],p=[],y=[],x=[],g=[],v=[],m=[],b=[],S=[],k=[],w=[],C=[],O=[],F=[],L=String(e.value),P=/[a-z0-9]+[a-z0-9]+/gi,A=/[a-z0-9]+[\.|,][a-z0-9]+/gi,W=/[\u4e00-\u9fa5a-zA-Z0-9]+[`~!@#$%^&*()_+<>?:"{},.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+/gi,z=/[0-9]+/gi,M=/[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]+[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]]/gi,D=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi,R=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘、，|《。》？、【】[\]]+)[%。\，\-；\; ]+/gi,N=/([\u4e00-\u9fa5]|[a-zA-Z]+)[-][0-9]+/gi,T=/^(%|。|\，|\-|\;| )+/gi,B=/([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]+([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9])/gi,G=/[`~!@#$^&*()_+<>?:"{},\.\/'[\]·！#￥（——）：“”‘、|《》？、【】[\]]([\u4e00-\u9fa5]|[a-zA-Z]+|[0-9]+|[`~!@#$%。，\-\; ^&*()_+=<>?:"{},\.\/;'[\]·！#￥（——）：；“”‘，|《》？、【】[\]])+/gi;n=P.exec(L);)a.push(n.index+1),x.push(P.lastIndex);for(;n=A.exec(L);)o.push(n.index+1),g.push(A.lastIndex);for(;n=W.exec(L);)s.push(n.index+1),v.push(W.lastIndex);for(;n=z.exec(L);)u.push(n.index+1),m.push(z.lastIndex);for(;n=M.exec(L);)c.push(n.index+1),b.push(M.lastIndex);for(;n=D.exec(L);)h.push(n.index+1),S.push(D.lastIndex);for(;n=R.exec(L);)if(isNaN(n[0].indexOf("-")))d.push(n.index+1),k.push(R.lastIndex);else{for(var X=!0;N.exec(L);)X=!1;X&&(d.push(n.index+1),k.push(R.lastIndex))}for(;n=N.exec(L);)isNaN(n[0].indexOf("-"))||_.push(n.index+n[0].indexOf("-")+1),w.push(N.lastIndex);for(;n=T.exec(L);)f.push(n.index+1),C.push(L.length);for(;n=B.exec(L);)p.push(n.index+1),O.push(L.length);for(;n=G.exec(L);)y.push(n.index+1),F.push(L.length);var j,I=d3.select(this),Y=I.text().split("").reverse(),E=[],V=0,$=0,q=+I.attr("x"),U=+I.attr("y"),Z=I.text(null).append("tspan").attr("x",q).attr("y",U);for("justify"==t._basic.align&&Z.attr("textLength",H[i]-r-l).attr("lengthAdjust","spacing");j=Y.pop();){E.push(j),Z.text(E.join(""));var Q=!0;if(a.length>0)for(var K=0;K<a.length;K++)$>=a[K]&&$<x[K]&&(Q=!1);if(o.length>0)for(var J=0;J<o.length;J++)$>=o[J]&&$<g[J]&&(Q=!1);if(s.length>0)for(var tt=0;tt<s.length;tt++)$>=s[tt]&&$<v[tt]&&(Q=!1);if(u.length>0)for(var et=0;et<u.length;et++)$>=u[et]&&$<m[et]&&(Q=!1);if(c.length>0)for(var it=0;it<c.length;it++)$>=c[it]&&$<b[it]&&(Q=!1);if(h.length>0)for(var nt=0;nt<h.length;nt++)$>=h[nt]&&$<S[nt]&&(Q=!1);if(d.length>0)for(var at=0;at<d.length;at++)$>=d[at]&&$<k[at]&&(Q=!1);if(_.length>0)for(var ot=0;ot<_.length;ot++)$>=_[ot]&&$<w[ot]&&(Q=!1);if(f.length>0)for(var rt=0;rt<f.length;rt++)$>=f[rt]&&$<C[rt]&&(Q=!1);if(p.length>0)for(var lt=0;lt<p.length;lt++)$>=p[lt]&&$<O[lt]&&(Q=!1);if(y.length>0)for(var st=0;st<y.length;st++)$>=y[st]&&$<F[st]&&(Q=!1);Q&&Z.node().getComputedTextLength()>H[i]-r-l&&(0==$||++V,E.pop(),Z.text(E.join("")),E=[j],Z=I.append("tspan").attr("x",q).attr("y",V*parseFloat(.9*t._fontSize*t._lineHeight)+U).text(j),"justify"==t._basic.align&&Z.attr("textLength",H[i]-r-l).attr("lengthAdjust","spacing")),$++}}));t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)?c.style("opacity",1):0==t._moveOptions.indexOf(t._moveStyle)?c.style("opacity",0).transition().delay((function(e,i){return t._transition?t._startDelay:0})).duration(t._transition?t._duration:0).style("opacity",1):2==t._moveOptions.indexOf(t._moveStyle)?c.style("opacity",0).transition().delay(t._transition?t._startDelay+t._duration/(e.length>0?e.length:1)*n:0).duration(t._transition?t._duration/(e.length>0?e.length:1):0).style("opacity",1):1==t._moveOptions.indexOf(t._moveStyle)&&c.style("opacity",0).transition().delay((function(e,n){return t._transition?t._startDelay+t._duration/(i.data.length>0?i.data.length:1)*n:0})).duration((function(e,n){return t._transition?t._duration/(i.data.length>0?i.data.length:1):0})).style("opacity",1)}));st.exit().attr("class","bar bar_exit").attr("opacity",0).remove();var ut=lt.selectAll(".y-lines").data(d3.range(0,i.length+1));ut.exit().remove();ut.enter().append("line").attr("class","y-lines").attr("fill","none").attr("stroke",isNaN(t._strokeColor)?t._strokeColor:t._colorList[t._strokeColor]).attr("stroke-width",t._strokeWidth).attr("x1",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(H[a]+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2})).attr("x2",(function(e,i){for(var n=[],a=0;a<i;a++)n.push(H[a]+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2})).attr("y1",t._strokeWidth-1||0).attr("y2",it+(e.length+1)*t._strokeWidth);var ct=lt.selectAll(".x-lines").data(d3.range(0,e.length+1));ct.exit().remove();ct.enter().append("line").attr("class","x-lines").attr("fill","none").attr("stroke",isNaN(t._strokeColor)?t._strokeColor:t._colorList[t._strokeColor]).attr("stroke-width",t._strokeWidth).attr("x1",(function(t,e){return 0})).attr("x2",(function(e,n){return E+(i.length+1)*t._strokeWidth})).attr("y1",(function(e,i){for(var n=[],r=0;r<i;r++)n.push(d3.max($[r])+a+o+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2})).attr("y2",(function(e,i){for(var n=[],r=0;r<i;r++)n.push(d3.max($[r])+a+o+t._strokeWidth);return d3.sum(n)+t._strokeWidth/2}))}return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"Width",value:function(t){return arguments.length?(this._Width=t,this):this._Width}},{key:"Height",value:function(t){return arguments.length?(this._Height=t,this):this._Height}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"columnWidth",value:function(t){return arguments.length?(this._columnWidth=parseFloat(t),this):this._columnWidth}},{key:"equalWidth",value:function(t){return arguments.length?(this._equalWidth=t,this):this._equalWidth}},{key:"colorType",value:function(t){return arguments.length?(this._colorType=t,this):this._colorType}},{key:"dataColor",value:function(t){return arguments.length?(this._dataColor=t,this):this._dataColor}},{key:"firstCol",value:function(t){return arguments.length?(this._firstCol=t,this):this._firstCol}},{key:"headRow",value:function(t){return arguments.length?(this._headRow=t,this):this._headRow}},{key:"lineHeight",value:function(t){return arguments.length?(this._lineHeight=t,this):this._lineHeight}},{key:"letterSpacing",value:function(t){return arguments.length?(this._letterSpacing=t,this):this._letterSpacing}},{key:"basic",value:function(t){return arguments.length?(this._basic=t,this):this._basic}},{key:"colorList",value:function(t){return arguments.length?(this._colorList=t,this):this._colorList}},{key:"tableTrans",value:function(t){return arguments.length?(this._tableTrans=t,this):this._tableTrans}},{key:"marginTop",value:function(t){return arguments.length?(this._marginTop=t,this):this._marginTop}},{key:"marginLeft",value:function(t){return arguments.length?(this._marginLeft=t,this):this._marginLeft}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Br=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap,this.numberFormat);return{horizontal:t.horizontal,vercital:t.vercital}}},{key:"tableFont",get:function(){return Object.assign({},this._props.font)}}]),e}(it);function Gr(t,e,i){for(var n=t,a=[],o={},r=[],l=n.length,s=n[0],u=[],c=0;c<l;c++)u.push(n[c].length);u.sort((function(t,e){return e-t}));for(var d=0;d<u[0];d++){var _=s[d];""!=s[d]&&null!=s[d]&&null!=s[d]||(_="$-"+d),o[_+"-"+d]={name:_,showLegend:_!="$-"+d,data:[]}}for(var f=0;f<l;f++){var p=n[f],y=p[0];if(""!=y&&null!=y&&null!=y||(y="&-"+f),y)for(var x=0;x<u[0];x++){var g=s[x];""!=s[x]&&null!=s[x]&&null!=s[x]||(g="$-"+x),g&&o[g+"-"+x].data.push({showAxisText:y!="&-"+f,value:null==p[x]||null==p[x]||p[x].constructor===Object?null:E(p[x],i.style,i.decimalPlaces),tooltipValueShow:!isNaN(parseFloat(p[x]))})}}for(var v=0;v<l;v++){var m=n[v],b=m[0];if(""!=b&&null!=b&&null!=b||(b="$-"+v),b){for(var S={name:b,showLegend:b!="$-"+v,data:[]},k=0;k<u[0];k++){var w=s[k];""!=w&&null!=w&&null!=w||(w="&-"+k),S.data.push({name:w,showAxisText:w!="&-"+k,value:null==m[k]||null==m[k]||m[k].constructor===Object?null:E(m[k],i.style,i.decimalPlaces),tooltipValueShow:!isNaN(parseFloat(m[k]))})}a.push(S)}}for(var C in o)r.push(o[C]);return a.forEach((function(t,e){t.key=h(t.name)+"-"+e})),r.forEach((function(t,e){t.key=h(t.name)+"-"+e})),{horizontal:a,vercital:r}}var Xr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","table-chart"),i.rectPlot=new Tr(i.elem),i._sortValue=null,i._labelShow=!1,i._positionOptions=[],i._positionChoice="",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._strokeWidth=1,i._strokeColor="#bfbfbf",i._equalWidth="auto",i._colorType="single",i._dataColor=[""],i._columnWidth=70,i._headRow={show:!0,bgColor:"#5AAEF3",fontColor:"#ffffff"},i._firstCol={show:!0,bgColor:"#5AAEF3",fontColor:"#ffffff"},i._tableFontSize=14,i._tableFontColor="#545454",i._tableFontFamily="阿里巴巴普惠体 常规",i._lineHeight=1.4,i._letterSpacing=0,i._basic={bold:!1,underline:!1,italic:!1,deleteline:!1,align:"left"},i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同步出现","横向出现","纵向出现"],i._moveStyle="同步出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t._data,i=t._data.vercital,n=e,a=(t.tooltip,t.rectPlot),o=t.heightOfMainGroup,r=t.widthOfNoMargin;a.data(n).Width(r-(i.length+1)*t._strokeWidth).Height(o).strokeWidth(t._strokeWidth).strokeColor(t._strokeColor).equalWidth(t._equalWidth).columnWidth(t._columnWidth).colorType(t._colorType).dataColor(t._dataColor).firstCol(t._firstCol).headRow(t._headRow).fontSize(t._tableFontSize).fontColor(t._tableFontColor).fontFamily(t._tableFontFamily).lineHeight(t._lineHeight).letterSpacing(t._letterSpacing).basic(t._basic).colorList(t._colorList).tableTrans(t.tableTrans).marginTop(t._marginTop).marginLeft(t._marginLeft).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(this._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){}},{key:"sortData",value:function(){}},{key:"setPublicOption",value:function(t){this.data(t.data).backgroundColor(t.backgroundColor).width(t.width).height(t.height).colorList(t._blockTheme.colors).colors(t.colors),this.fontFamily(t.font.fontFamily).fontSize(t.font.fontSize).fontColor(t.font.color),this.titleShow(t.title.show).titleText(t.title.text).titleColor(t.title.color).titleFontFamily(t.title.fontFamily).titleFontSize(t.title.fontSize).titleX(t.title.xPosition).titleY(t.title.yPosition).titlePadding(parseFloat(t.title.lineHeight||10)).totalHeight(parseFloat(t.title.totalHeight||39)),this.tooltipShow(t.tooltipShow),this.dataType(t.dataType),this.unitPadding(parseFloat(t.unitDisplay.bottomLineHeight||15)).sourcePadding(parseFloat(t.sourceDisplay.topLineHeight||15)).marginTop(t.paddings?parseFloat(t.paddings.top||20):20).marginBottom(t.paddings?parseFloat(t.paddings.bottom||23):23).marginLeft(t.paddings?parseFloat(t.paddings.left||24):24).marginRight(t.paddings?parseFloat(t.paddings.right||24):24),this.timeDuration(t._animation&&t._animation.duration||0),this.numberStyle(t.numberFormat.style).decimalPlaces(t.numberFormat.decimalPlaces)}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.table,l=t.tableFont;0!==Object.getOwnPropertyNames(l).length&&(this._tableFontSize=l.fontSize?l.fontSize:this._tableFontSize,this._tableFontColor=l.color?q(l.color):this._tableFontColor,this._tableFontFamily=l.fontFamily?l.fontFamily:this._tableFontFamily,this._lineHeight=l.lineHeight?l.lineHeight:this._lineHeight,this._letterSpacing=l.letterSpacing&&"justify"!=l.basic.align?l.letterSpacing:0,this._basic=l.basic?l.basic:this._basic),0!==Object.getOwnPropertyNames(r).length&&(this._strokeWidth=0==r.strokeWidth||r.strokeWidth?r.strokeWidth:this._strokeWidth,this._strokeColor=r.strokeColor?q(r.strokeColor):"",this._equalWidth=r?r.columnStyle:this._equalWidth,this._columnWidth=0==r.columnWidth||r.columnWidth?r.columnWidth:this._columnWidth,this._colorType=r.rowColorType?r.rowColorType:this._colorType,this._dataColor=r.rowColor?r.rowColor:this._dataColor,this._headRow=r.headRow?r.headRow:this._headRow,this._firstCol=r.firstCol?r.firstCol:this._firstCol),0!==Object.getOwnPropertyNames(e).length&&(this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=e.bar4CornerRadius?e.bar4CornerRadius:this._barCornerRadius,this._borderWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._borderWidth,this._borderColor=e.barborderColor?q(e.barborderColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel)}},{key:"buildOption",value:function(t,e){var i=new Br(t,e),n=Gr;return i.dataSolveFunc(n),i}},{key:"activeData",get:function(){return this.sortedDataCopy}}]),e}(nt),jr=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polarArea"),e._startAngle=0,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t.group;a.selectAll("*").remove();var o=t._innerRadius,r=(t._donutCount,t._startAngle),l=t._endAngle,s=t._radius,u=t._transition,h=t._duration,d=t._startDelay,_=t._moveOptions,f=t._moveStyle,g=t._lineWidth,m=(t._fillOpacity,t._endPointRadius),b=t._endPointBorderColor,S=t._endPointBorderWidth,k=t._endPointFillColor,w=t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice),C=t._numberLabel.fontSize,O=t._numberLabel.fontFamily,F=q(t._numberLabel.color),L=t._sectorCount,P=2*Math.PI-Math.abs(l-r),A=d3.max(n,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))}))||1,W=[0,1.1*A];if(t._isPolar)if(null==t._count)W=v(0,A,Math.ceil(s/t._themeFontSize/3));else if(W=[],0!=t._count){var z=A-0,M=Math.ceil(Math.abs(z/t._count));A+=M;for(var N=0;N<M+1;N++)W.push(0+N*t._count)}else W.push(0);var T=d3.scaleLinear().domain([d3.min(W),d3.max(W)]).range([o,s]),B=d3.scaleLinear().domain([0,L]).range([r,l]),G=d3.areaRadial().angle((function(t,e){return B(e)})).innerRadius(o).outerRadius(o),I=d3.areaRadial().angle((function(t,e){return B(e)})).innerRadius(T(0)).outerRadius((function(t){return T(t.value)}));P<=0&&"curve"==t._lineType?(I.curve(d3.curveCardinalClosed),G.curve(d3.curveCardinalClosed)):P>0&&"curve"==t._lineType?(I.curve(d3.curveCardinal),G.curve(d3.curveCardinal)):P<=0&&"straight"==t._lineType?(I.curve(d3.curveLinearClosed),G.curve(d3.curveLinearClosed)):P>0&&"straight"==t._lineType&&(I.curve(d3.curveLinear),G.curve(d3.curveLinear));var Y=n.length>0?n[0].data.map((function(t){return t.name})):[],H=a.append("g").attr("class","polar-area-axis");H.append("path").attr("class","polar-area-xAxis").attr("d",(function(i,n){var a=void 0,r=void 0;return"clockwise"==t._rotateDirection?(a=t._startAngle,r=t._startAngle+t._totalAngle):(a=t._startAngle-t._totalAngle,r=t._startAngle),"内部"==t._axisPositonChoice?e(o-.5*t._xAxisLineWidth,a,r):e(s-.5*t._xAxisLineWidth,a,r)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?H.style("opacity",1):H.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);var V=d3.arc().innerRadius(o).outerRadius(1.5*s),$=d3.pie().value((function(t){return Math.abs(t.value)})).startAngle(r).endAngle(l)([{value:1}]),Z=a.append("g").selectAll("g").attr("class","polar-area-clips").data(n);Z.exit().remove(),Z.enter().append("clipPath").attr("id",(function(e,i){return t.id+"-polar-area-"+i})).merge(Z).each((function(e,i){var a=d3.select(this).selectAll("path").data($);a.exit().remove();var o=a.enter().append("path");t._interrupt?o.attr("d",(function(t){return V(t)})):u&&0==_.indexOf(f)?o.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attrTween("d",(function(t){var e=d3.interpolate(r,l);return function(i){return t.endAngle=e(i),V(t)}})):u&&1==_.indexOf(f)?o.transition().duration((function(e,i){return t._transition?.9*t._duration/(n.length>0?n.length:1):0})).delay((function(e,a){return t._transition?t._startDelay+i*(.9*t._duration/(n.length>0?n.length:1)):0})).attrTween("d",(function(t){var e=d3.interpolate(r,l);return function(i){return t.endAngle=e(i),V(t)}})):o.attr("d",(function(t){return V(t)}))}));var Q=d3.arc().innerRadius(o).outerRadius(s).startAngle(r).endAngle(l);t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("path").attr("d",Q()),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var K=a.append("g").attr("class","polar-area-elems").selectAll("g").data(n);K.exit().remove(),K.enter().append("g").merge(K).style("pointer-events","none").each((function(e,i){var n=d3.select(this).append("path").attr("class","polar-area").style("fill",(function(e,n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":(e.color&&/#/.test(e.color),e.color)})).style("stroke-width",g||1).attr("clip-path",(function(e,n){return"url("+c("#"+t.id+"-polar-area-"+i)+")"})),a=d3.select(this).selectAll("circle").data(e.data);a.exit().remove();var o=a.enter().append("circle").attr("class","polar-area-points").merge(a).style("fill",(function(n,a){var o=""==k?e.color:k;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"})).style("fill-opacity",(function(i){var n=""==k?e.color:k;if(n&&/#/.test(n))return t._fillOpacity;var a=U(n,3)||1;return t._fillOpacity*a})).style("stroke",(function(n,a){var o=""==b?e.color:b;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)})).style("stroke-width",S).attr("r",m).attr("cx",(function(t,e){return T(0)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(0)*Math.sin(B(e)-Math.PI/2)}));if(t._interrupt)n.attr("d",(function(t){return I(t.data)})),o.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)}));else if(u&&0==_.indexOf(f))n.attr("d",(function(t){return I(t.data)})),o.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})).attr("opacity","0").transition().duration(u?.1*h:0).delay(u?d+.9*h:0).style("opacity","1");else if(u&&1==_.indexOf(f))n.attr("d",(function(t){return I(t.data)})),o.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})).attr("opacity","0").transition().duration(u?.1*h:0).delay(u?d+.9*h:0).style("opacity","1");else if(u&&2==_.indexOf(f))n.attr("d",(function(t){return G(t.data)})).transition().duration(u?.9*h:0).delay(u?d:0).attr("d",(function(t){return I(t.data)})),o.transition().duration(u?.9*h:0).delay(u?d:0).attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)}));else if(u&&3==_.indexOf(f)){for(var r=[],l={},s=0;s<e.data.length;s++)l.name=e.data[s].name,l.value=e.data[0].value,r.push(l);n.attr("d",(function(t){return I(r)})).transition().duration(u?.9*h:0).delay(u?d:0).attr("d",(function(t){return I(t.data)})),o.attr("cx",(function(t,e){return T(r[e].value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(r[e].value)*Math.sin(B(e)-Math.PI/2)})).transition().duration(u?.9*h:0).delay(u?d:0).attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)}))}else n.attr("d",(function(t){return I(t.data)})),o.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)}))})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);var J=a.append("g").selectAll("g").attr("class","polar-area-labels-groups").data(n);J.exit().remove(),J.enter().append("g").merge(J).style("pointer-events","none").each((function(e,i){var n=d3.select(this).selectAll("text").data(e.data);n.exit().remove();var a=n.enter().append("text").attr("class","polar-area-number-labels").merge(n).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("y",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})).style("text-anchor",(function(i,n){var a=(t._endAngle-t._startAngle)/(e.data.length-1>0?e.data.length-1:1),o=t._startAngle+a*n;return o<0?o+=2*Math.PI:o>2*Math.PI&&(o-=2*Math.PI),o>=0&&o<=Math.PI/4||o>7*Math.PI/4&&o<=2*Math.PI?"middle":o>Math.PI/4&&o<=3*Math.PI/4?0==w?"end":"start":o>3*Math.PI/4&&o<=5*Math.PI/4?"middle":o>3*Math.PI/4&&o<=7*Math.PI/4?0==w?"start":"end":"middle"})).attr("dx",(function(i,n){var a=(t._endAngle-t._startAngle)/(e.data.length-1>0?e.data.length-1:1),o=t._startAngle+a*n;return o<0?o+=2*Math.PI:o>2*Math.PI&&(o-=2*Math.PI),o>1*Math.PI/4&&o<=3*Math.PI/4?0==w?-parseFloat(m)-5:parseFloat(m)+5:o>5*Math.PI/4&&o<=7*Math.PI/4?0==w?parseFloat(m)+5:-parseFloat(m)-5:0})).attr("dy",(function(i,n){var a=(t._endAngle-t._startAngle)/(e.data.length-1>0?e.data.length-1:1),o=t._startAngle+a*n;return o<0?o+=2*Math.PI:o>2*Math.PI&&(o-=2*Math.PI),o>=0&&o<=1*Math.PI/4||o>7*Math.PI/4&&o<=2*Math.PI?0==w?parseFloat(m)+5+.7*C:-parseFloat(m)-5:o>3*Math.PI/4&&o<=5*Math.PI/4?0==w?-parseFloat(m)-5:parseFloat(m)+5+.7*C:"0.35em"})).style("font-size",C).style("fill",F).style("font-family",O).style("display",t._labelShow?"block":"none");t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}));var tt=(l-r)/(L||1),et=[],it=void 0;if(it="外部"==t._axisPositonChoice?s+5:o-5,n.length>0)for(var nt=0;nt<L+1;nt++){var at=it*Math.sin(r+nt*tt),ot=-it*Math.cos(r+nt*tt);et.push({x:at,y:ot})}else et=[{x:it*Math.sin(r),y:-it*Math.cos(r)},{x:it*Math.sin(l),y:-it*Math.cos(l)}];var rt=(l-r)/(L>0?L:1),lt=a.selectAll(".area-lines").data(d3.range(n.length>0?L+1:0));lt.exit().remove();var st=lt.enter().append("line").attr("class","area-lines").merge(lt).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=r+rt*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?s:o)})).attr("y1",(function(e,i){var n=r+rt*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?s:o)})).attr("x2",(function(e,i){var n=r+rt*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?s+5:o-5)})).attr("y2",(function(e,i){var n=r+rt*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?s+5:o-5)}));a.selectAll(".tick-text").remove();var ut=a.append("g").selectAll("text").data(et);ut.exit().remove();var ct=ut.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice){if("水平"==t._xLabelDirection){var a=Math.cos(r+rt*i-Math.PI/2)*(s+10),l=t._mainWidth/2-Math.abs(a);return X(Y[i],l,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var u=Math.sin(r+rt*i-Math.PI/2)*(s+10),c=t._mainHeight/2-Math.abs(u);return null==Y[i]?"":j(Y[i],c,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection)return X(Y[i],(o-10)/2,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(Y[i],(o-10)/2,t._themeFontSize,t._themeFontFamily)}})).attr("x",(function(e,i){var n=r+rt*i;return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(s+10):Math.cos(n-Math.PI/2)*(o-10)})).attr("y",(function(e,i){var n=r+rt*i;return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(s+10):Math.sin(n-Math.PI/2)*(o-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)ct.attr("transform",(function(e,i){var n=r+rt*i;return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:.35*t._themeFontSize)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var ht=t.group.append("g").selectAll("text").data(et);ht.exit().remove();var dt=ht.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(r+rt*e)/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?dt.text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(Y[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",s+10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(r+rt*e)/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(r+rt*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(s+10)+",0)":null})):dt.text((function(e,i){var n=o-10-parseFloat(t._themeFontSize)>0?o-10-parseFloat(t._themeFontSize):0;return X(Y[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",o-10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(r+rt*e)/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(r+rt*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(o-10)+",0)":null}))}else{a.selectAll(".tick-text").remove();var _t=t.group.selectAll("g.text-group").data(et);_t.exit().remove();_t.enter().append("g").attr("class","text-group").merge(_t).each((function(i,a){d3.select(this);var l=s+10;"内部"==t._axisPositonChoice&&(l=o-10-t._themeFontSize);var u=r+rt*a,c=d3.select(this.parentNode),h="arc-path-"+a+"-"+t.id,d=e(l+.5*t._themeFontSize,u+rt/2+.015,u-rt/2-.015);"clockwise"==t._rotateDirection&&(d=e(l+.6*t._themeFontSize,u-rt/2+.015,u+rt/2-.015));var _=t._defs.select("#"+h).empty()?t._defs.append("path").attr("d",d).attr("id",h):t._defs.select("#"+h).attr("d",d);n.length>0&&D(c,_,Y[a],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none");d3.select(this).select("path"),_.node().getTotalLength(),R(Y[a],t._themeFontSize,t._themeFontFamily)}))}1==t._interrupt?(st.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),ct.style("opacity",1).style("display",t._showX?"block":"none")):(st.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),ct.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var ft=0;ft<L+1;ft++){var pt=ft*rt+r;"外部"==t._axisPositonChoice?0==pt||pt==Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ft]).attr("text-anchor","middle"):pt>Math.PI||pt<0&&pt>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ft]).attr("text-anchor","end"):d3.select(a.selectAll(".tick-text").nodes()[ft]).attr("text-anchor","start"):pt>0&&pt<Math.PI||pt>2*-Math.PI&&pt<-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ft]).attr("text-anchor","end"):pt>Math.PI&&pt<2*Math.PI||pt<0&&pt>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ft]).attr("text-anchor","start"):d3.select(a.selectAll(".tick-text").nodes()[ft]).attr("text-anchor","middle")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var yt=t.group.selectAll(".tick-text"),xt=[],gt=[],vt=0;vt<yt._groups[0].length;vt++){gt.push(vt);for(var mt=vt+1;mt<yt._groups[0].length;mt++){p(i(d3.select(yt._groups[0][vt])),i(d3.select(yt._groups[0][mt])))&&(xt.push(vt),d3.select(yt._groups[0][vt]).style("opacity","0"))}}for(var bt=new Set(xt),St=Array.from(bt),kt=Ht(St,gt),wt=0;wt<St.length;wt++){for(var Ct=[],Ot=0;Ot<kt.length;Ot++){var Ft=i(d3.select(yt._groups[0][St[wt]])),Lt=i(d3.select(yt._groups[0][kt[Ot]]));if(Ct.push(p(Ft,Lt)),p(Ft,Lt)){if(St[wt]==kt[Ot])continue;d3.select(yt._groups[0][St[wt]]).remove()}}0==Ct.filter((function(t){return 1==t})).length&&kt.push(St[wt])}for(var Pt=0;Pt<kt.length;Pt++)d3.select(yt._groups[0][kt[Pt]]).style("opacity","1")}for(var At=a.selectAll(".polar-area-number-labels"),Wt=[],zt=[],Mt=0;Mt<At._groups[0].length;Mt++){zt.push(Mt);for(var Dt=Mt+1;Dt<At._groups[0].length;Dt++){p(i(d3.select(At._groups[0][Mt])),i(d3.select(At._groups[0][Dt])))&&(Wt.push(Mt),d3.select(At._groups[0][Mt]).style("visibility","hidden"))}}for(var Rt=new Set(Wt),Nt=Array.from(Rt),Tt=Ht(Nt,zt),Bt=0;Bt<Nt.length;Bt++){for(var Gt=[],Xt=0;Xt<Tt.length;Xt++){var jt=i(d3.select(At._groups[0][Nt[Bt]])),It=i(d3.select(At._groups[0][Tt[Xt]]));if(Gt.push(p(jt,It)),p(jt,It)){if(Nt[Bt]==Tt[Xt])continue;d3.select(At._groups[0][Nt[Bt]]).style("visibility","hidden")}}0==Gt.filter((function(t){return 1==t})).length&&Tt.push(Nt[Bt])}for(var Yt=0;Yt<Tt.length;Yt++)d3.select(At._groups[0][Tt[Yt]]).style("visibility","visible");function Ht(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"lineType",value:function(t){return arguments.length?(this._lineType=t,this):this._lineType}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=t,this):this._sectorCount}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),Ir=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","polar-overlay"),i._innerRadius=0,i._outerRadius=0,i._startAngle=0,i._endAngle=0,i._sectorCount=1,i._totalAngle=180,i._onMouseover=function(){},i._onMousemove=function(){},i._onMouseout=function(){},i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;if(t._data){var e=t._totalAngle,i=t._data;t.elem.selectAll("*").remove();var n=(t._endAngle-t._startAngle)/(e==2*Math.PI?i.length:i.length-1||1),a=d3.arc().innerRadius(t._innerRadius).outerRadius(t._outerRadius),o=d3.pie().value(1).startAngle(t._startAngle-n/2).endAngle(t._endAngle-n/2)(e==2*Math.PI?d3.range(i.length):d3.range(i.length-1));e!=2*Math.PI&&o.push({data:i.length-1,endAngle:t._endAngle,index:i.length-1,padAngle:0,startAngle:t._endAngle-n/2,value:1});var r=t.elem.selectAll(".polar-overlay-arc").data(o);r.exit().remove();var l=r.enter().append("g").attr("class",".polar-overlay-arc");return l.append("path"),r.merge(l).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout).select("path").style("opacity","0").attr("d",(function(i,n){return e==2*Math.PI&&0==n&&(i.endAngle=i.endAngle+2*Math.PI,i.startAngle=i.startAngle+2*Math.PI),i.startAngle<t._startAngle?(i.startAngle=t._startAngle,a(i)):a(i)})),this}}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"outerRadius",value:function(t){return arguments.length?(this._outerRadius=t,this):this._outerRadius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}}]),e}(L),Yr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","polar-area-chart"),i.grid=new gt(i.mainGroup),i.overlay=new Ir(i.mainGroup),i.polarArea=new jr(i.mainGroup),i.radialAxis=new mt(i.mainGroup),i.guideLine=new Et(i.mainGroup),i._transition=!0,i._easeStyle="",i._duration=2,i._startDelay=0,i._moveOptions=["同步顺时针","依次顺时针","径向展开","径向起波澜"],i._moveStyle="同步顺时针",i._endPause=0,i._lineType="curve",i._lineWidth="2",i._endPointRadius="3.5",i._strokeWidth="1",i._strokeColor="#FFFFFF",i._fillColor=null,i._fillOpacity="1",i._axisOpeningAngle="0",i._rotateDirection,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData;t._interrupt?t.group.selectAll(".donut-polar-grid").interrupt().style("opacity",1):t.group.selectAll(".donut-polar-grid").interrupt().style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var i=t.polarArea,n=t.grid,a=t.tooltip,o=t.overlay,r=t.guideLine,l=t.radialAxis,s=1e3*t._transition,u=1e3*t._duration,h=1e3*t._startDelay,d=t._strokeColor,_=t._fillColor,f=t._fontSize,p=t.widthOfNoMargin,g=t.heightOfMainGroup,v=0,m=void 0,b=void 0,S=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"";"水平"==t._xLabelDirection&&1==t._xTickShow?(m=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),b=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(m=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),b=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(m=t._fontSize,b=t._fontSize):(m=0,b=0),m=m<.4*p*.88?m:.4*p*.88,b=b<.4*g*.88?b:.4*g*.88,v="外部"==t._axisPositonChoice?Math.min(.88*p/2-m,.88*g/2-b):.88*Math.min(p,g)/2,"clockwise"==t._rotateDirection?(t._startAngle=t._startAngle,t._endAngle=t._startAngle+t._totalAngle):(t._startAngle=t._startAngle,t._endAngle=t._startAngle-t._totalAngle);var k=Math.round(d3.max(e,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))}))),w=(d3.scaleLinear().domain([0,k]).range([.38*-v,-v]),Math.floor(.62*v/(1.1*f)));if("竖排"==t._yLabelDirection&&(w=Math.floor(.62*v/(k.toString().length*f*1.1))),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t.mainGroup.selectAll(".linear-gradient").remove(),d&&/\[/.test(d)){var C=x(d),O=[],F=!0,L=!1,P=void 0;try{for(var A,W=C[Symbol.iterator]();!(F=(A=W.next()).done);F=!0){var z=A.value,M=[],D=z.split(":");M.push(q(D[0])),M.push(D[1]),O.push(M)}}catch(t){L=!0,P=t}finally{try{!F&&W.return&&W.return()}finally{if(L)throw P}}var N=O.concat(),T=N.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(T[1]).x1+"%").attr("y1",y(T[1]).y1+"%").attr("x2",y(T[1]).x2+"%").attr("y2",y(T[1]).y2+"%").selectAll("stop").data(N).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(_&&/\[/.test(_)){var B=x(_),G=[],X=!0,j=!1,I=void 0;try{for(var Y,H=B[Symbol.iterator]();!(X=(Y=H.next()).done);X=!0){var V=Y.value,$=[],Z=V.split(":");$.push(q(Z[0])),$.push(Z[1]),G.push($)}}catch(t){j=!0,I=t}finally{try{!X&&H.return&&H.return()}finally{if(j)throw I}}var Q=G.concat(),K=Q.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(K[1]).x1+"%").attr("y1",y(K[1]).y1+"%").attr("x2",y(K[1]).x2+"%").attr("y2",y(K[1]).y2+"%").selectAll("stop").data(Q).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}d=/\[/.test(d)?"url("+c("#"+t.id+"-main-border-index-0")+")":d,_=/\[/.test(_)?"url("+c("#"+t.id+"-main-border-index-1")+")":_,i.data(e).transition(s).duration(u).startDelay(h).moveOptions(t._moveOptions).moveStyle(t._moveStyle).lineWidth(t._lineWidth).radius(v).totalAngle(t._totalAngle).axisPositonChoice(t._axisPositonChoice).numberLabel(t._numberLabel).labelShow(t._labelShow).fillOpacity(t._fillOpacity).lineType(t._lineType).donutCount(w).defs(t.defs).sectorCount(e.length>0?Math.abs(t._endAngle-t._startAngle)==2*Math.PI?e[0].data.length:e[0].data.length-1:0).innerRadius(.38*v).translate(p/2,g/2).endPointRadius(t._endPointRadius).endPointBorderColor(d).endPointBorderWidth(t._strokeWidth).endPointFillColor(_).startAngle(t._startAngle).endAngle(t._endAngle).showX(t._xTickShow).showY(t._yTickShow).stroke(t._axisLineStroke).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).rotateDirection(t._rotateDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(p).mainHeight(g).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),"clockwise"==t._rotateDirection?(t._startAngleGrid=t._startAngle,t._endAngleGrid=t._startAngle+t._totalAngle):(t._startAngleGrid=t._startAngle-t._totalAngle,t._endAngleGrid=t._startAngle),o.totalAngle(t._totalAngle).innerRadius(.38*v).outerRadius(v).startAngle(t._startAngleGrid).endAngle(t._endAngleGrid).data(t.activeData.length>0?t.activeData[0].data:[]).translate(p/2,g/2).onMouseover((function(i,n){if(!(t.activeData.length<=0)){var o=.38*v,l=n;"counterclockwise"==t._rotateDirection&&t._totalAngle!=2*Math.PI?l=t.activeData.length>0?t.activeData[0].data.length-n-1:0:"counterclockwise"==t._rotateDirection&&t._totalAngle==2*Math.PI&&(l=t.activeData[0].data.length-n);t._endAngleGrid,t._startAngleGrid,t.activeData[0].data;var s=(i.startAngle+i.endAngle)/2;i.startAngle==t._startAngleGrid?s=t._startAngleGrid:i.endAngle==t._endAngleGrid&&(s=t._endAngleGrid),r.x1(Math.cos(s-Math.PI/2)*o).y1(Math.sin(s-Math.PI/2)*o).x2(Math.cos(s-Math.PI/2)*v).y2(Math.sin(s-Math.PI/2)*v).stroke("#C6C6C6").strokeDasharray("0");for(var u=t.mainGroup.select(".polarArea .polar-area-elems").selectAll("g"),h=function(i){var n=u.nodes()[i];d3.select(n).selectAll("circle").style("stroke",(function(n,a){var o=""==d?e[i].color:d;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)})).style("fill",(function(n,a){var o=""==_?e[i].color:_;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"}))},f=0;f<u.nodes().length;f++)h(f);for(var p=function(i){var n=u.nodes()[i],a=d3.select(n).selectAll("circle").nodes()[l>t.activeData[0].data.length-1?0:l];d3.select(a).style("fill",(function(n,a){var o=""==d?e[i].color:d;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"})).style("stroke",(function(n,a){var o=""==_?e[i].color:_;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)}))},y=0;y<u.nodes().length;y++)p(y);var x=[];x.push({text:t.activeData[0].data[l>t.activeData[0].data.length-1?0:l].name+": "}),e.forEach((function(e,i){x.push({text:e.name+": "+E(e.data[l>t.activeData[0].data.length-1?0:l].value,t._numberStyle,t._decimalPlaces),color:e.color})})),a.data(x).update().move([d3.event.offsetX,d3.event.offsetY]).show(),r.show().update()}})).onMousemove((function(t,e){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(i,n){a.hide(),r.hide();for(var o=t.mainGroup.select(".polarArea .polar-area-elems").selectAll("g"),l=function(i){var n=o.nodes()[i];d3.select(n).selectAll("circle").style("stroke",(function(n,a){var o=""==d?e[i].color:d;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)})).style("fill",(function(n,a){var o=""==_?e[i].color:_;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"}))},s=0;s<o.nodes().length;s++)l(s)})),r.translate(p/2,g/2),o.update(),i.update(),l.data(t.activeData).radius(v).innerRadius(.38*v).startAngle(t._startAngle).endAngle(t._endAngle).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(p).mainHeight(g).suffix(t._yLabelSuffix).maxValue(k).count(t._yCountOfLabel).isPolar(!0).range(t._yRange).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).translate(p/2,g/2),l.update(),t._totalAngle>=2*Math.PI&&0==t._yAxisShow&&l.elem.selectAll("text").style("text-anchor","middle").attr("dx","clockwise"==t._rotateDirection?8:-8),n.sectorCount(e.length>0?Math.abs(t._endAngle-t._startAngle)==2*Math.PI?e[0].data.length:e[0].data.length-1:1).donutCount(t._isPolar?l._polarCount:6).startAngle(t._startAngleGrid).endAngle(t._endAngleGrid).radius(v).innerRadius(.38*v).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth).translate(p/2,g/2),n.update();var J=t.mainGroup.selectAll(".donut-grid-line").nodes();J.length>0&&(t._totalAngle>=2*Math.PI?t._yAxisShow?(d3.select(J[0]).remove(),d3.select(J[J.length-1]).remove()):"clockwise"==t._rotateDirection?d3.select(J[0]).remove():d3.select(J[J.length-1]).remove():t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(J[0]).remove():d3.select(J[J.length-1]).remove()));var tt=t.mainGroup.selectAll(".donut-grid-arc-path").nodes();tt.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(tt[0]).remove():t._xAxisShow&&(t._isPolar&&Math.abs(l._polarCount[l._polarCount.length-1])==v?d3.select(tt[tt.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o?o.numberLabel.show:this._labelShow,this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel,this._suffix=o.numberLabel&&o.numberLabel.suffix?o.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i.transition||0==i.transition?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._lineType=e.lineType?e.lineType:this._lineType,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(0!=a.labelShow&&!a.labelShow||a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}}]),e}(vt),Hr=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polarLine"),e._startAngle=0,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t.group;a.selectAll("*").remove();var o=t._innerRadius,r=(t._donutCount,t._endAngle),l=t._startAngle,s=t._radius,u=t._transition,h=t._duration,d=t._startDelay,_=t._moveOptions,f=t._moveStyle,g=t._endPointRadius,m=t._endPointBorderColor,b=t._endPointBorderWidth,S=t._endPointFillColor,k=t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice),w=t._numberLabel.fontSize,C=t._numberLabel.fontFamily,O=q(t._numberLabel.color),F=t._sectorCount,L=2*Math.PI-Math.abs(r-l),P=d3.max(n,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))}))||1,A=[0,1.1*P];if(t._isPolar)if(null==t._count)A=v(0,P,Math.ceil(s/t._themeFontSize/3));else if(A=[],0!=t._count){var W=P-0,z=Math.ceil(Math.abs(W/t._count));P+=z;for(var M=0;M<z+1;M++)A.push(0+M*t._count)}else A.push(0);var T=d3.scaleLinear().domain([d3.min(A),d3.max(A)]).range([o,s]),B=d3.scaleLinear().domain([0,F]).range([l,r]),G=d3.lineRadial().angle((function(t,e){return B(e)})).radius((function(t){return T(t.value)}));L<=0&&"curve"==t._lineType?G.curve(d3.curveCardinalClosed):L>0&&"curve"==t._lineType?G.curve(d3.curveCardinal):L<=0&&"straight"==t._lineType?G.curve(d3.curveLinearClosed):L>0&&"straight"==t._lineType&&G.curve(d3.curveLinear);var I=n.length?n[0].data.map((function(t){return t.name})):[],Y=a.append("g").attr("class","polar-line-axis");Y.append("path").attr("class","polar-line-xAxis").attr("d",(function(i,n){var a=void 0,r=void 0;return"clockwise"==t._rotateDirection?(a=t._startAngle,r=t._startAngle+t._totalAngle):(a=t._startAngle-t._totalAngle,r=t._startAngle),"内部"==t._axisPositonChoice?e(o-.5*t._xAxisLineWidth,a,r):e(s-.5*t._xAxisLineWidth,a,r)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?Y.style("opacity",1):Y.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);var H=d3.arc().innerRadius(o).outerRadius(1.5*s),V=d3.pie().value((function(t){return Math.abs(t.value)})).startAngle(l).endAngle(r)([{value:1}]),$=a.append("g").selectAll("g").attr("class","polar-line-clips").data(n);$.exit().remove(),$.enter().append("clipPath").attr("id",(function(e,i){return t.id+"-polar-line-"+i})).merge($).each((function(e,i){var a=d3.select(this).selectAll("path").data(V);a.exit().remove();var o=a.enter().append("path");t._interrupt?o.attr("d",(function(t){return H(t)})):u&&0==_.indexOf(f)?o.transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attrTween("d",(function(t){var e=d3.interpolate(l,r);return function(i){return t.endAngle=e(i),H(t)}})):u&&1==_.indexOf(f)?o.transition().duration((function(e,i){return t._transition?.9*t._duration/(n.length>0?n.length:1):0})).delay((function(e,a){return t._transition?t._startDelay+i*(.9*t._duration/(n.length>0?n.length:1)):0})).attrTween("d",(function(t){var e=d3.interpolate(l,r);return function(i){return t.endAngle=e(i),H(t)}})):o.attr("d",(function(t){return H(t)}))}));var Z=d3.arc().innerRadius(o).outerRadius(s).startAngle(l).endAngle(r);t.elem.selectAll("defs").remove(),t.elem.append("defs").append("clipPath").attr("id","overlay-"+t.id).append("path").attr("d",Z()),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var Q=a.append("g").attr("class","polar-line-elems").selectAll("g").data(n);Q.exit().remove(),Q.enter().append("g").merge(Q).each((function(e,i){for(var a=[],o=e.data.length,r=0;r<o;r++)a.push(e.data[r]);a.push(e.data[0]);var l=d3.select(this).append("path").attr("class","polar-lines").style("fill","none").style("stroke",(function(e,n){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":(e.color&&/#/.test(e.color),e.color)})).style("stroke-width",t._lineWidth).attr("clip-path",(function(e,n){return"url("+c("#"+t.id+"-polar-line-"+i)+")"})),s=d3.select(this).selectAll("circle").data(e.data);s.exit().remove();var p=s.enter().append("circle").attr("class","polar-line-points").merge(s).style("fill",(function(n,a){var o=""==S?e.color:S;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"})).style("fill-opacity",(function(i){var n=""==S?e.color:S;return n&&/#/.test(n)?t._fillOpacity:U(n,3)||1})).style("stroke",(function(n,a){var o=""==m?e.color:m;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)})).style("stroke-width",b).attr("r",g).attr("cx",(function(t,e){return T(0)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(0)*Math.sin(B(e)-Math.PI/2)}));t._interrupt?(l.attr("d",(function(e){return t._openAngle<=0&&"curve"==t._lineType?G(a):G(e.data)})),p.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)}))):u&&0==_.indexOf(f)||u&&1==_.indexOf(f)?(l.attr("d",(function(e){return t._openAngle<=0&&"curve"==t._lineType?G(a):G(e.data)})),p.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})).attr("opacity","0").transition().duration(u?.1*h:0).delay(u?d+.9*h:0).style("opacity","1")):u&&2==_.indexOf(f)?(p.transition().duration(u?.3*h:0).delay(u?d:0).attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})),l.attr("d",(function(e){return t._openAngle<=0&&"curve"==t._lineType?G(a):G(e.data)})).style("stroke-opacity","0").transition().duration((function(t,e){return u?.6*h/(n.length>0?n.length:1):0})).delay((function(t,e){return u?d+.3*h+i*h*.6/(n.length>0?n.length:1):0})).style("stroke-opacity","1")):(l.attr("d",(function(e){return t._openAngle<=0&&"curve"==t._lineType?G(a):G(e.data)})),p.attr("cx",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("cy",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})))})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);var K=a.append("g").selectAll("g").attr("class","polar-line-labels-groups").data(n);K.exit().remove(),K.enter().append("g").merge(K).style("pointer-events","none").each((function(e,i){var n=d3.select(this).selectAll("text").data(e.data);n.exit().remove();var a=n.enter().append("text").attr("class","polar-line-number-labels").merge(n).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t,e){return T(t.value)*Math.cos(B(e)-Math.PI/2)})).attr("y",(function(t,e){return T(t.value)*Math.sin(B(e)-Math.PI/2)})).style("text-anchor",(function(i,n){var a=(t._endAngle-t._startAngle)/(e.data.length-1>0?e.data.length-1:1),o=t._startAngle+a*n;return o<0&&(o+=2*Math.PI),o>=0&&o<=Math.PI/4||o>7*Math.PI/4&&o<=2*Math.PI?"middle":o>Math.PI/4&&o<=3*Math.PI/4?0==k?"end":"start":o>3*Math.PI/4&&o<=5*Math.PI/4?"middle":o>3*Math.PI/4&&o<=7*Math.PI/4?0==k?"start":"end":"middle"})).attr("dx",(function(i,n){var a=(t._endAngle-t._startAngle)/(e.data.length-1>0?e.data.length-1:1),o=t._startAngle+a*n;return o<0&&(o+=2*Math.PI),o>1*Math.PI/4&&o<=3*Math.PI/4?0==k?-parseFloat(g)-5:parseFloat(g)+5:o>5*Math.PI/4&&o<=7*Math.PI/4?0==k?parseFloat(g)+5:-parseFloat(g)-5:0})).attr("dy",(function(i,n){var a=(t._endAngle-t._startAngle)/(e.data.length-1>0?e.data.length-1:1),o=t._startAngle+a*n;return o<0&&(o+=2*Math.PI),o>=0&&o<=1*Math.PI/4||o>7*Math.PI/4&&o<=2*Math.PI?0==k?parseFloat(g)+5+.7*w:-parseFloat(g)-5:o>3*Math.PI/4&&o<=5*Math.PI/4?0==k?-parseFloat(g)-5:parseFloat(g)+5+.7*w:"0.35em"})).style("font-size",w).style("fill",O).style("font-family",C).style("display",t._labelShow?"block":"none");t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}));var J=(r-l)/(F||1),tt=[],et=void 0;if(et="外部"==t._axisPositonChoice?s+5:o-5,n.length>0)for(var it=0;it<F+1;it++){var nt=et*Math.sin(l+it*J),at=-et*Math.cos(l+it*J);tt.push({x:nt,y:at})}else tt=[{x:et*Math.sin(l),y:-et*Math.cos(l)},{x:et*Math.sin(r),y:-et*Math.cos(r)}];var ot=(r-l)/(F>0?F:1),rt=a.selectAll(".area-lines").data(d3.range(n.length>0?F+1:0));rt.exit().remove();var lt=rt.enter().append("line").attr("class","area-lines").merge(rt).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=l+ot*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?s:o)})).attr("y1",(function(e,i){var n=l+ot*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?s:o)})).attr("x2",(function(e,i){var n=l+ot*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?s+5:o-5)})).attr("y2",(function(e,i){var n=l+ot*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?s+5:o-5)}));a.selectAll(".tick-text").remove();var st=a.append("g").selectAll("text").data(tt);st.exit().remove();var ut=st.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice){if("水平"==t._xLabelDirection){var a=Math.cos(l+ot*i-Math.PI/2)*(s+10),r=t._mainWidth/2-Math.abs(a);return X(I[i],r,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var u=Math.sin(l+ot*i-Math.PI/2)*(s+10),c=t._mainHeight/2-Math.abs(u);return j(I[i],c,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection){var h=Math.cos(l+ot*i-Math.PI/2)*(o-10),d=X(I[i],(o-10)/2,t._themeFontSize,t._themeFontFamily);return R(d)>Math.abs(h)?"":d}if("径向"==t._xLabelDirection){var _=Math.sin(l+ot*i-Math.PI/2)*(o-10),f=j(I[i],(o-10)/2,t._themeFontSize,t._themeFontFamily);return N(f)>Math.abs(_)?"":f}}})).attr("x",(function(e,i){var n=l+ot*i;return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(s+10):Math.cos(n-Math.PI/2)*(o-10)})).attr("y",(function(e,i){var n=l+ot*i;return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(s+10):Math.sin(n-Math.PI/2)*(o-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)ut.attr("transform",(function(e,i){var n=l+ot*i;return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:0)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var ct=t.group.append("g").selectAll("text").data(tt);ct.exit().remove();var ht=ct.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(l+ot*e)/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?ht.text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(I[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",s+10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(l+ot*e)/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(l+ot*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(s+10)+",0)":null})):ht.text((function(e,i){var n=o-10-parseFloat(t._themeFontSize)>0?o-10-parseFloat(t._themeFontSize):0;return X(I[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",o-10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(l+ot*e)/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(l+ot*e)/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(o-10)+",0)":null}))}else{a.selectAll(".tick-text").remove();var dt=t.group.selectAll("g.text-group").data(tt);dt.exit().remove();dt.enter().append("g").attr("class","text-group").merge(dt).each((function(i,a){d3.select(this);var r=s+10;"内部"==t._axisPositonChoice&&(r=o-10-t._themeFontSize);var u=l+ot*a,c=d3.select(this.parentNode),h="arc-path-"+a+"-"+t.id,d=e(r+.5*t._themeFontSize,u+ot/2+.015,u-ot/2-.015);"clockwise"==t._rotateDirection&&(d=e(r+.6*t._themeFontSize,u-ot/2+.015,u+ot/2-.015));var _=t._defs.select("#"+h).empty()?t._defs.append("path").attr("d",d).attr("id",h):t._defs.select("#"+h).attr("d",d);n.length>0&&D(c,_,I[a],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none");d3.select(this).select("path"),_.node().getTotalLength(),R(I[a],t._themeFontSize,t._themeFontFamily)}))}1==t._interrupt?(lt.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),ut.style("opacity",1).style("display",t._showX?"block":"none")):(lt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),ut.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var _t=0;_t<F+1;_t++){var ft=_t*ot+l;"外部"==t._axisPositonChoice?0==ft||ft==Math.PI?d3.select(a.selectAll(".tick-text").nodes()[_t]).attr("text-anchor","middle"):ft>Math.PI||ft<0&&ft>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[_t]).attr("text-anchor","end"):d3.select(a.selectAll(".tick-text").nodes()[_t]).attr("text-anchor","start"):ft>0&&ft<Math.PI||ft>2*-Math.PI&&ft<-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[_t]).attr("text-anchor","end"):ft>Math.PI&&ft<2*Math.PI||ft<0&&ft>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[_t]).attr("text-anchor","start"):d3.select(a.selectAll(".tick-text").nodes()[_t]).attr("text-anchor","middle")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var pt=t.group.selectAll(".tick-text"),yt=[],xt=[],gt=0;gt<pt._groups[0].length;gt++){xt.push(gt);for(var vt=gt+1;vt<pt._groups[0].length;vt++){p(i(d3.select(pt._groups[0][gt])),i(d3.select(pt._groups[0][vt])))&&(yt.push(gt),d3.select(pt._groups[0][gt]).style("opacity","0"))}}for(var mt=new Set(yt),bt=Array.from(mt),St=Yt(bt,xt),kt=0;kt<bt.length;kt++){for(var wt=[],Ct=0;Ct<St.length;Ct++){var Ot=i(d3.select(pt._groups[0][bt[kt]])),Ft=i(d3.select(pt._groups[0][St[Ct]]));if(wt.push(p(Ot,Ft)),p(Ot,Ft)){if(bt[kt]==St[Ct])continue;d3.select(pt._groups[0][bt[kt]]).remove()}}0==wt.filter((function(t){return 1==t})).length&&St.push(bt[kt])}for(var Lt=0;Lt<St.length;Lt++)d3.select(pt._groups[0][St[Lt]]).style("opacity","1")}for(var Pt=a.selectAll(".polar-line-number-labels"),At=[],Wt=[],zt=0;zt<Pt._groups[0].length;zt++){Wt.push(zt);for(var Mt=zt+1;Mt<Pt._groups[0].length;Mt++){p(i(d3.select(Pt._groups[0][zt])),i(d3.select(Pt._groups[0][Mt])))&&(At.push(zt),d3.select(Pt._groups[0][zt]).style("visibility","hidden"))}}for(var Dt=new Set(At),Rt=Array.from(Dt),Nt=Yt(Rt,Wt),Tt=0;Tt<Rt.length;Tt++){for(var Bt=[],Gt=0;Gt<Nt.length;Gt++){var Xt=i(d3.select(Pt._groups[0][Rt[Tt]])),jt=i(d3.select(Pt._groups[0][Nt[Gt]]));if(Bt.push(p(Xt,jt)),p(Xt,jt)){if(Rt[Tt]==Nt[Gt])continue;d3.select(Pt._groups[0][Rt[Tt]]).style("visibility","hidden")}}0==Bt.filter((function(t){return 1==t})).length&&Nt.push(Rt[Tt])}for(var It=0;It<Nt.length;It++)d3.select(Pt._groups[0][Nt[It]]).style("visibility","visible");function Yt(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}return t}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"curve",value:function(t){return arguments.length?(this._curve=t,this):this._curve}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"lineType",value:function(t){return arguments.length?(this._lineType=t,this):this._lineType}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=t,this):this._sectorCount}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),n}(at),Er=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","polar-line-chart"),i.grid=new gt(i.mainGroup),i.overlay=new Ir(i.mainGroup),i.polarLine=new Hr(i.mainGroup),i.radialAxis=new mt(i.mainGroup),i.guideLine=new Et(i.mainGroup),i._transition=!0,i._easeStyle="",i._duration="2",i._startDelay=0,i._moveOptions=["同步顺时针","依次顺时针","穿针引线"],i._moveStyle="同步顺时针",i._endPause=0,i._lineType="curve",i._lineWidth="1.5",i._endPointRadius="3.5",i._strokeWidth="1",i._strokeColor="#FFFFFF",i._fillColor="",i._axisOpeningAngle="0",i._ticksFontSize="12",i._fontColor="#313131",i._fontFamily="阿里巴巴普惠体 常规",i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.tooltip,n=t.polarLine,a=t.grid,o=t.guideLine,r=t.overlay,l=t.radialAxis;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var s=t._strokeColor,u=t._fillColor,h=t._transition,d=1e3*t._duration,_=1e3*t._startDelay,f=t.widthOfNoMargin,p=t.heightOfMainGroup,g=t._fontSize,v=(t._endPointRadius,0),m=void 0,b=void 0,S=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):"";"水平"==t._xLabelDirection&&1==t._xTickShow?(m=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),b=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(m=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),b=d3.max(S.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(m=t._fontSize,b=t._fontSize):(m=0,b=0),m=m<.4*f*.88?m:.4*f*.88,b=b<.4*p*.88?b:.4*p*.88,v="外部"==t._axisPositonChoice?Math.min(.88*f/2-m,.88*p/2-b):.88*Math.min(f,p)/2,"clockwise"==t._rotateDirection?(t._startAngle=t._startAngle,t._endAngle=t._startAngle+t._totalAngle):(t._startAngle=t._startAngle,t._endAngle=t._startAngle-t._totalAngle);var k=Math.round(d3.max(e,(function(t){return d3.max(t.data,(function(t){return parseFloat(t.value)}))}))),w=(d3.scaleLinear().domain([0,k]).range([.38*-v,-v]),Math.floor(.62*v/(1.1*g)));if("竖排"==t._yLabelDirection&&(w=Math.floor(.62*v/(k.toString().length*g*1.1))),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t.mainGroup.selectAll(".linear-gradient").remove(),s&&/\[/.test(s)){var C=x(s),O=[],F=!0,L=!1,P=void 0;try{for(var A,W=C[Symbol.iterator]();!(F=(A=W.next()).done);F=!0){var z=A.value,M=[],D=z.split(":");M.push(q(D[0])),M.push(D[1]),O.push(M)}}catch(t){L=!0,P=t}finally{try{!F&&W.return&&W.return()}finally{if(L)throw P}}var N=O.concat(),T=N.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(T[1]).x1+"%").attr("y1",y(T[1]).y1+"%").attr("x2",y(T[1]).x2+"%").attr("y2",y(T[1]).y2+"%").selectAll("stop").data(N).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(u&&/\[/.test(u)){var B=x(u),G=[],X=!0,j=!1,I=void 0;try{for(var Y,H=B[Symbol.iterator]();!(X=(Y=H.next()).done);X=!0){var V=Y.value,$=[],Z=V.split(":");$.push(q(Z[0])),$.push(Z[1]),G.push($)}}catch(t){j=!0,I=t}finally{try{!X&&H.return&&H.return()}finally{if(j)throw I}}var Q=G.concat(),K=Q.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(K[1]).x1+"%").attr("y1",y(K[1]).y1+"%").attr("x2",y(K[1]).x2+"%").attr("y2",y(K[1]).y2+"%").selectAll("stop").data(Q).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}s=/\[/.test(s)?"url("+c("#"+t.id+"-main-border-index-0")+")":s,u=/\[/.test(u)?"url("+c("#"+t.id+"-main-border-index-1")+")":u,n.data(e).transition(h).duration(d).startDelay(_).moveStyle(t._moveStyle).moveOptions(t._moveOptions).totalAngle(t._totalAngle).lineWidth(t._lineWidth).lineType(t._lineType).endPointRadius(t._endPointRadius).endPointBorderColor(s).endPointBorderWidth(t._strokeWidth).endPointFillColor(u).numberLabel(t._numberLabel).labelShow(t._labelShow).radius(v).axisPositonChoice(t._axisPositonChoice).donutCount(w).defs(t.defs).sectorCount(e.length>0?Math.abs(t._endAngle-t._startAngle)==2*Math.PI?e[0].data.length:e[0].data.length-1:0).innerRadius(.38*v).startAngle(t._startAngle).endAngle(t._endAngle).showX(t._xTickShow).showY(t._yTickShow).stroke(t._axisLineStroke).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(f).mainHeight(p).translate(f/2,p/2).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),o.translate(f/2,p/2),"clockwise"==t._rotateDirection?(t._startAngleGrid=t._startAngle,t._endAngleGrid=t._startAngle+t._totalAngle):(t._startAngleGrid=t._startAngle-t._totalAngle,t._endAngleGrid=t._startAngle),r.totalAngle(t._totalAngle).innerRadius(.38*v).outerRadius(v).startAngle(t._startAngleGrid).endAngle(t._endAngleGrid).data(t.activeData.length>0?t.activeData[0].data:[]).translate(f/2,p/2).onMouseover((function(n,a){if(!(t.activeData.length<=0)){var r=.38*v,l=a;"counterclockwise"==t._rotateDirection&&t._totalAngle!=2*Math.PI?l=t.activeData.length>0?t.activeData[0].data.length-a-1:0:"counterclockwise"==t._rotateDirection&&t._totalAngle==2*Math.PI&&(l=t.activeData[0].data.length-a);t._endAngleGrid,t._startAngleGrid,t.activeData[0].data;var h=(n.startAngle+n.endAngle)/2;n.startAngle==t._startAngleGrid?h=t._startAngleGrid:n.endAngle==t._endAngleGrid&&(h=t._endAngleGrid),o.x1(Math.cos(h-Math.PI/2)*r).y1(Math.sin(h-Math.PI/2)*r).x2(Math.cos(h-Math.PI/2)*v).y2(Math.sin(h-Math.PI/2)*v).stroke("#C6C6C6").strokeDasharray("0");for(var d=t.mainGroup.select(".polarLine .polar-line-elems").selectAll("g"),_=function(i){var n=d.nodes()[i];d3.select(n).selectAll("circle").style("stroke",(function(n,a){var o=""==s?e[i].color:s;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)})).style("fill",(function(n,a){var o=""==u?e[i].color:u;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"}))},f=0;f<d.nodes().length;f++)_(f);for(var p=function(i){var n=d.nodes()[i],a=d3.select(n).selectAll("circle").nodes()[l>t.activeData[0].data.length-1?0:l];d3.select(a).style("fill",(function(n,a){var o=""==s?e[i].color:s;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"})).style("stroke",(function(n,a){var o=""==u?e[i].color:u;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)}))},y=0;y<d.nodes().length;y++)p(y);var x=[];x.push({text:t.activeData[0].data[l>t.activeData[0].data.length-1?0:l].name+": "}),e.forEach((function(e,i){x.push({text:e.name+": "+E(e.data[l>t.activeData[0].data.length-1?0:l].value,t._numberStyle,t._decimalPlaces),color:e.color})})),i.data(x).update().move([d3.event.offsetX,d3.event.offsetY]).show(),o.show().update()}})).onMousemove((function(t,e){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(n,a){i.hide(),o.hide();for(var r=t.mainGroup.select(".polarLine .polar-line-elems").selectAll("g"),l=function(i){var n=r.nodes()[i];d3.select(n).selectAll("circle").style("stroke",(function(n,a){var o=""==s?e[i].color:s;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":(o&&/#/.test(o),o)})).style("fill",(function(n,a){var o=""==u?e[i].color:u;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+i)+")":o&&/#/.test(o)?o:"rgb("+U(o,0)+","+U(o,1)+","+U(o,2)+")"}))},h=0;h<r.nodes().length;h++)l(h)})),o.translate(f/2,p/2),r.update(),n.update(),l.data(t.activeData).radius(v).innerRadius(.38*v).startAngle(t._startAngle).endAngle(t._endAngle).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(f).mainHeight(p).suffix(t._yLabelSuffix).count(t._yCountOfLabel).isPolar(!0).maxValue(k||1).translate(f/2,p/2).range(t._yRange).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),l.update(),t._totalAngle>=2*Math.PI&&0==t._yAxisShow&&l.elem.select("g .polar-axis").selectAll("text").style("text-anchor","middle").attr("dx","clockwise"==t._rotateDirection?8:-8),a.sectorCount(e.length>0?Math.abs(t._endAngle-t._startAngle)==2*Math.PI?e[0].data.length:e[0].data.length-1:1).donutCount(t._isPolar?l._polarCount:6).startAngle(t._startAngleGrid).endAngle(t._endAngleGrid).radius(v).innerRadius(.38*v).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth).translate(f/2,p/2),a.update(),n.elem.style("pointer-events","none");var J=t.mainGroup.selectAll(".donut-grid-line").nodes();J.length>0&&(t._totalAngle>=2*Math.PI?t._yAxisShow?(d3.select(J[0]).remove(),d3.select(J[J.length-1]).remove()):"clockwise"==t._rotateDirection?d3.select(J[0]).remove():d3.select(J[J.length-1]).remove():t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(J[0]).remove():d3.select(J[J.length-1]).remove()));var tt=t.mainGroup.selectAll(".donut-grid-arc-path").nodes();tt.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(tt[0]).remove():t._xAxisShow&&(t._isPolar&&Math.abs(l._polarCount[l._polarCount.length-1])==v?d3.select(tt[tt.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o?o.numberLabel.show:this._labelShow,this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel,this._suffix=o.numberLabel&&o.numberLabel.suffix?o.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i.transition||0==i.transition?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._lineType=e.lineType?e.lineType:this._lineType,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._strokeWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._strokeWidth,this._strokeColor=e.endPointBorderColor?q(e.endPointBorderColor):"",this._fillColor=e.endPointFillColor?q(e.endPointFillColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(0!=a.labelShow&&!a.labelShow||a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}}]),e}(vt),Vr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.xAxis=null,i.yAxis=null,i.yAxisDoubleY=null,i.xScale=null,i.yScale=null,i._marginLeft=24,i._marginRight=24,i._marginTop=20,i._gapPadding=15,i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._xDomain=null,i._yDomain=null,i._clipShow=null,i._xTitle="",i._yTitle="",i._axisLineStroke=null,i._xTickShow=!0,i._yTickShow=!0,i}return w(e,t),S(e,[{key:"update",value:function(){return this.sortData(),this.styleSvg(),this.removeLabelText(),this.updateLegend(),this.updateTitle(),this.updateUnit(),this.updateSource(),this.updateAxis(),this.updateCore(),this.updateScale(),this.layout(),this.tooltip&&this.tooltip.fontSize(this._fontSize).fontFamily(this._fontFamily).hide().lock(!this._tooltipShow),this}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.3*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStroke).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration);var d=i.titleHeight,_=(h-e.allowedMaxTextHeight())/(3*u);i.tickCount(_),i.compute(),n.range([0,c-i.width]),e.compute(),a.range([h-d-e.height,0]);var f=i.width,p=h-e.height,y=i.width,x=d;e.translate(f,p).update(),i.translate(y,x).update()}},{key:"onDataChange",value:function(){this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"updateScale",value:function(){}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yDomain||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=void 0;if(e.length){var o=d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),r=1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}));a=o<0?r<=0?[o,0]:[o,r]:[0,r]}else a=[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}},{key:"xType",value:function(t){return arguments.length?(this._xType=t,this):this._xType}},{key:"yType",value:function(t){return arguments.length?(this._yType=t,this):this._yType}},{key:"xOrient",value:function(t){return arguments.length?(this._xOrient=t,this):this._xOrient}},{key:"yOrient",value:function(t){return arguments.length?(this._yOrient=t,this):this._yOrient}},{key:"xDomain",value:function(t){return arguments.length?(this._xDomain=t,this):this._xDomain}},{key:"yDomain",value:function(t){return arguments.length?(this._yDomain=t,this):this._yDomain}},{key:"clipShow",value:function(t){return arguments.length?(this._clipShow=t,this):this._clipShow}},{key:"clipShowX",value:function(t){return arguments.length?(this._clipShowX=t,this):this._clipShowX}},{key:"xTitle",value:function(t){return arguments.length?(this._xTitle=t,this):this._xTitle}},{key:"yTitle",value:function(t){return arguments.length?(this._yTitle=t,this):this._yTitle}},{key:"axisLineStroke",value:function(t){return arguments.length?(this._axisLineStroke=t,this):this._axisLineStroke}},{key:"xTickShow",value:function(t){return arguments.length?(this._xTickShow=t,this):this._xTickShow}},{key:"yTickShow",value:function(t){return arguments.length?(this._yTickShow=t,this):this._yTickShow}},{key:"yLeftName",value:function(t){return arguments.length?(this._yLeftName=t,this):this._yLeftName}},{key:"yLeftTitle",value:function(t){return arguments.length?(this._yLeftTitle=t,this):this._yLeftTitle}},{key:"yRightName",value:function(t){return arguments.length?(this._yRightName=t,this):this._yRightName}},{key:"yRightTitle",value:function(t){return arguments.length?(this._yRightTitle=t,this):this._yRightTitle}},{key:"unit",value:function(t){return arguments.length?(this._unit=t,this):this._unit}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisLineStroke(i.color).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xDomain(n.range).yDomain(a.range).clipShow(a.range).clipShowX(n.range)}},{key:"widthOfCore",get:function(){var t=this.yAxis?this.yAxis.width:0,e=this.widthOfNoMargin-t;return e>0?e:0}},{key:"heightOfCore",get:function(){var t=this.xAxis?this.xAxis.height:0,e=this.yAxis?this.yAxis.titleHeight:0,i=this.heightOfMainGroup-t-e;return i>0?i:0}}]),e}(vt),$r="axis-group",qr="y-title",Ur=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,o=t._tickValueTexts,r=void 0;r=t.axisFunc="right"===e?d3.axisRight(i):d3.axisLeft(i);var l=null;"number"===t._type&&t._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(l=d3.format("d")),r.tickValues(t._tickShow?t._tickValues:[]).tickSizeInner(t._tickShow?t._tickSize:0).tickSizeOuter(0).tickPadding(t._tickPadding).tickFormat(l);var s=n.select(".axis-group").empty()?n.append("g").attr("class",$r):n.select(".axis-group");if(s.transition().duration(t._transition?t._duration:0).call(r).on("start",(function(){s.selectAll(".tick text").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).text((function(t,e){return o[e]})),s.selectAll(".tick line").style("stroke",t._lineStroke),s.select("path").style("stroke",t._lineStroke).style("display",t._axisLineShow?"block":"none")})),t._titleShow&&t._title){var u=n.select(".y-title").empty()?n.append("g").attr("class",qr):n.select(".y-title"),c=u.select("text").empty()?u.append("text"):u.select("text"),h=R(t._title,a,t._fontFamily);c.attr("x",h>=2*t.width?2-t.width:0).attr("y",-this._fontSize).style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).style("text-anchor",h>=2*t.width?"start":"middle").text(t._title)}else n.select(".y-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);e="category"===o?a.domain():a.ticks(t._tickCount),"number"===o&&0!=a.domain()[0]&&e.push(-1==String(a.domain()[0]).indexOf(".")?a.domain()[0]:a.domain()[0].toFixed(0));var s=d3.max(e,(function(e){return R(e,r,t._fontFamily)}));return s<=l?(i=e,n=s):(i=e.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"width",get:function(){var t=0;return this.isShow&&(t=this._tickShow?this._tickSize+this._tickPadding+this._tickTextWidth:0),t}}]),e}(Bt),Zr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._clipId="clip-overlay-"+i.id,i.overlayRect=i.elem.append("defs").append("clipPath").attr("id",i._clipId).append("rect"),i.elem.attr("class","ForceDiagram"),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a=t._height,o=t._width,r=t._borderWidth,l=(t._linkColor,t._rScale),s=t._textLabel.fontSize,u=t._textLabel.fontFamily,h=q(t._textLabel.color),d=t._contentChoice,_=t._contentOption,f=t._positionChoice;0==d.length&&(t._labelShow=!1),n.selectAll("*").remove();for(var g=t._links.filter((function(t){return!1!==t.active})),v=(e.map((function(t){return parseFloat(t.value)})),e),m=g,b=d3.forceSimulation(v).alphaDecay(.01).force("center",d3.forceCenter(o/2,a/2)).force("charge",d3.forceManyBody().strength(-80)).force("link",d3.forceLink(m).id((function(t){return t.id})).distance(20)).force("x",d3.forceX()).force("y",d3.forceY()).stop(),S=[],k=[],w=0,C=Math.ceil(Math.log(b.alphaMin())/Math.log(1-b.alphaDecay()));w<C;++w)b.tick();n.append("g").attr("stroke","grey").attr("stroke-width",r).selectAll("line").data(m).enter().append("line").attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),n.append("g").attr("stroke","#fff").attr("stroke-width",t._endPointBorderWidth).selectAll("circle").data(v).enter().append("circle").attr("cx",(function(t){return S.push(t.x-o/2),t.x})).attr("cy",(function(t){return k.push(t.y-a/2),t.y})).attr("r",(function(t){return l(t.value)}));var O=d3.max(S.map((function(t){return Math.abs(t)}))),F=d3.max(k.map((function(t){return Math.abs(t)}))),L=2*(d3.max([F,O])+parseFloat(s)),P=d3.min([o,a])/L>=1?d3.min([o,a])/L:1;n.selectAll("*").remove(),t.group.attr("clip-path","url("+c("#"+t._clipId)+")"),t.overlayRect.attr("x",0).attr("y",0).attr("width",o).attr("height",a),e.forEach((function(e,i){var a=e.color;if(a&&/\[/.test(a)){var o=x(a),r=[],l=!0,s=!1,u=void 0;try{for(var c,h=o[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),r.push(_)}}catch(t){s=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(s)throw u}}var p=r.concat(),g=p.pop();n.append("linearGradient").attr("id",t.id+"-force-diagram-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var A=d3.forceSimulation(e).alphaDecay(.01).force("collision",d3.forceCollide((function(t){return l(t.value)}))).force("charge",d3.forceManyBody().strength(-4*P*P));Array.from(new Set(e.map((function(t){return t.type}))));function W(t,e,i){return R(t,s,u)}function z(e,i){var n=e,o=parseFloat(t._endPointBorderWidth),r=l(i),u=0;return n<(u=3==f||4==f?1==d.length?r+o+5+1*s:r+o+5+2*s:1==d.length?Math.max(r+o,.5*s):Math.max(r+o,1*s))?4==f?r+o:u:n>a-u?3==f?a-r-o:a-u:n}function M(e,i,n){var a=E(i,t._numberStyle,t._decimalPlaces)+t._suffix,r=l(i),s=parseFloat(t._endPointBorderWidth),u=e,c=0;return u<(c=t._labelShow?1==f||2==f?1==d.length&&0==_.indexOf(d[0])?r+s+W(n)+5:1==d.length&&0==_.indexOf(d[0])?r+s+W(a)+5:r+s+Math.max(W(a),W(n))+5:0==f?Math.max(W(a),W(n))<2*r?.5*(r+s+5+Math.max(W(a),W(n))):r+s+5+Math.max(W(a),W(n)):.5*Math.max(W(a),W(n)):r+s)?2==f?r+s:c:u>o-c?2==f?o-r-s:o-c:u}for(w=0,C=Math.ceil(Math.log(A.alphaMin())/Math.log(1-A.alphaDecay()));w<C;++w)A.tick();var D=n.append("g").selectAll("line").data(g).enter().append("line").style("class","force-diagram-links").style("opacity",t._fillOpacity||"1").style("stroke-width",r).style("stroke",""==t._linkColor?"#dedede":t._linkColor).attr("x1",(function(t){return M(t.source.x,t.source.value,t.source.id)})).attr("y1",(function(t){return z(t.source.y,t.source.value)})).attr("x2",(function(t){return M(t.target.x,t.target.value,t.target.id)})).attr("y2",(function(t){return z(t.target.y,t.target.value)})).on("mouseover",t._onMouseover2).on("mousemove",t._onMousemove2).on("mouseout",t._onMouseout2),N=n.append("g").selectAll("circle").data(e).enter().append("circle").style("class","force-diagram-nodes").attr("cx",(function(t){return M(t.x,t.value,t.id)})).attr("cy",(function(t){return z(t.y,t.value)})).attr("r",(function(t){return l(t.value)})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){var n=""==t._endPointBorderColor?e.color:t._endPointBorderColor;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-force-diagram-"+i)+")":(n&&/#/.test(n),n)})).style("stroke-width",t._endPointBorderWidth).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-force-diagram-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),T=n.append("g").selectAll("g").data(e).enter().append("g").attr("class","force-diagram-labels").style("pointer-events","none").style("display",t._labelShow?"block":"none"),B=T.append("text").style("fill",h).style("font-family",u).style("font-size",s).attr("x",(function(t){return M(t.x,t.value,t.id)})).attr("y",(function(t){return z(t.y,t.value)})).attr("class","force-diagram-text-labels").attr("dy",(function(e,i){return 3==f?1==d.length?-l(e.value)-parseFloat(t._endPointBorderWidth)-5:-l(e.value)-parseFloat(t._endPointBorderWidth)-5-1.1*parseFloat(s):4==f?l(e.value)+5+parseFloat(t._endPointBorderWidth)+.7*parseFloat(s):1==d.length?"0.35em":"-0.2em"})).attr("dx",(function(e,i){var n=E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,a=-l(e.value)-parseFloat(t._endPointBorderWidth)-5,r=l(e.value)+parseFloat(t._endPointBorderWidth)+5;return 0!=f?1==f?a:2==f?r:0:2==d.length?W(e.id)>=2*l(e.value)||W(n)>=2*l(e.value)?e.x<o/2?a:r:0:1==d.length&&0==_.indexOf(d[0])?W(e.id)>=2*l(e.value)?e.x<o/2?a:r:0:void 0})).attr("text-anchor",(function(e){var i=E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix;return 0!=f?1==f?"end":2==f?"start":"middle":2==d.length?W(e.id)>=2*l(e.value)||W(i)>=2*l(e.value)?e.x<o/2?"end":"start":"middle":1==d.length&&0==_.indexOf(d[0])?W(e.id)>=2*l(e.value)?e.x<o/2?"end":"start":"middle":void 0})).text((function(t){return t.id})),G=T.append("text").style("fill",h).style("font-family",u).style("font-size",s).attr("x",(function(t){return M(t.x,t.value,t.id)})).attr("y",(function(t){return z(t.y,t.value)})).attr("class","force-diagram-number-labels").attr("dy",(function(e,i){return 3==f?-l(e.value)-parseFloat(t._endPointBorderWidth)-5:4==f?1==d.length?l(e.value)+parseFloat(t._endPointBorderWidth)+5+.7*parseFloat(s):l(e.value)+parseFloat(t._endPointBorderWidth)+5+1.7*parseFloat(s):1==d.length?"0.35em":"0.9em"})).attr("dx",(function(e,i){var n=E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,a=-l(e.value)-parseFloat(t._endPointBorderWidth)-5,r=l(e.value)+parseFloat(t._endPointBorderWidth)+5;return 0!=f?1==f?a:2==f?r:0:2==d.length?W(e.id)>=2*l(e.value)||W(n)>=2*l(e.value)?e.x<o/2?a:r:0:1==d.length&&1==_.indexOf(d[0])?W(n)>=2*l(e.value)?e.x<o/2?a:r:0:void 0})).attr("text-anchor",(function(e){var i=E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix;return 0!=f?1==f?"end":2==f?"start":"middle":2==d.length?W(e.id)>=2*l(e.value)||W(i)>=2*l(e.value)?e.x<o/2?"end":"start":"middle":1==d.length&&1==_.indexOf(d[0])?W(i)>=2*l(e.value)?e.x<o/2?"end":"start":"middle":void 0})).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix}));1==d.length&&0==_.indexOf(d[0])?G.style("display","none"):1==d.length&&1==_.indexOf(d[0])?B.style("display","none"):0==d.length&&(G.style("display","none"),B.style("display","none")),t._interrupt||(t._transition&&0==t._moveStyle?(D.attr("x1",(function(t){return o/2})).attr("y1",(function(t){return a/2})).attr("x2",(function(t){return o/2})).attr("y2",(function(t){return a/2})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("x1",(function(t){return M(t.source.x,t.source.value,t.source.id)})).attr("y1",(function(t){return z(t.source.y,t.source.value)})).attr("x2",(function(t){return M(t.target.x,t.target.value,t.target.id)})).attr("y2",(function(t){return z(t.target.y,t.target.value)})),N.attr("cx",o/2).attr("cy",a/2).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("cx",(function(t){return M(t.x,t.value,t.id)})).attr("cy",(function(t){return z(t.y,t.value)}))):t._transition&&1==t._moveStyle&&(D.style("opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",t._fillOpacity||0),N.style("fill-opacity","0").transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i}))),B.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),G.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1));for(var X=t.group.selectAll(".force-diagram-labels"),j=[],I=[],Y=0;Y<X._groups[0].length;Y++){I.push(Y);for(var H=Y+1;H<X._groups[0].length;H++){p(i(d3.select(X._groups[0][Y])),i(d3.select(X._groups[0][H])))&&(j.push(Y),d3.select(X._groups[0][Y]).style("visibility","hidden"))}}for(var V=new Set(j),$=Array.from(V),Z=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}($,I),Q=0;Q<$.length;Q++){for(var K=[],J=0;J<Z.length;J++){var tt=i(d3.select(X._groups[0][$[Q]])),et=i(d3.select(X._groups[0][Z[J]]));if(K.push(p(tt,et)),p(tt,et)){if($[Q]==Z[J])continue;d3.select(X._groups[0][$[Q]]).style("visibility","hidden")}}0==K.filter((function(t){return 1==t})).length&&Z.push($[Q])}for(var it=0;it<Z.length;it++)d3.select(X._groups[0][Z[it]]).style("visibility","visible");return t}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"links",value:function(t){return arguments.length?(this._links=t,this):this._links}},{key:"rScale",value:function(t){return arguments.length?(this._rScale=t,this):this._rScale}},{key:"linkColor",value:function(t){return arguments.length?(this._linkColor=t,this):this._linkColor}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"onMouseover2",value:function(t){return arguments.length?(this._onMouseover2=t,this):this._onMouseover2}},{key:"onMousemove2",value:function(t){return arguments.length?(this._onMousemove2=t,this):this._onMousemove2}},{key:"onMouseout2",value:function(t){return arguments.length?(this._onMouseout2=t,this):this._onMouseout2}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Qr=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data,this._columnMap),e=Array.from(new Set(t.nodes.map((function(t){return t.type})))),i=this.generateColorList(e.length||1);return function(t,i){return t.forEach((function(t,n){e.forEach((function(e,n){t.type==e&&(t.color=i[n])}))})),t}(t.nodes,i)}},{key:"links",get:function(){return this._dataSolveFunc(this._dataSrc.data,this._columnMap).links}}]),e}(it);function Kr(t,e){var i=t[1],n=e[1],a=0,o=0,r=0;if(n.forEach((function(t){"objCol"===t.function?a=t.index:"typeCol"===t.function?(o=t.index,t.isLegend):"vCol"===t.function&&(r=t.index)})),P(i,[a,o,r])||!A(i,r))return[];var l=[],s=i[0][2],u=i.slice(1),c=[];u.forEach((function(t){""==t[a]||""==t[o]||""==t[r]||(c.push(t[a]),l.push({id:t[a],type:t[o],value:parseFloat(t[r]),valueLabel:s}))})),l.forEach((function(t,e){t.key=h(t.id)+"-"+e}));var d=0,_=0,f=t[0];e[0].forEach((function(t){"sourceCol"===t.function?d=t.index:"targetCol"===t.function&&(_=t.index)}));var p=[];return f.slice(1).forEach((function(t,e){""==t[d]||""==t[_]||-1==c.indexOf(t[d])||-1==c.indexOf(t[_])||p.push({source:t[d],target:t[_]})})),p.forEach((function(t,e){t.key=h(t.source)+"-"+h(t.target)+"-"+e,t.index=e})),{nodes:l,links:p}}var Jr=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.forceDiagram=new Zr(i.coreGroup),i.xAxis=new mi(i.mainGroup),i.yAxis=new Ur(i.mainGroup),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._labelShow=!0,i._positionOptions=["自动","外部居左","外部居右","外部居上","外部居下","内部居中"],i._positionChoice="自动",i._contentOption=["名称","数值"],i._contentChoice=["名称","数值"],i._suffix="",i._textLabel={fontFamily:"阿里巴巴普惠体 Regular",fontSize:"14px",color:"545454"},i._bubbleSizeType="area",i._borderWidth="1",i._linkColor="#DEDEDE",i._endPointRadiusMax="32",i._endPointRadiusMin="0",i._endPointBorderColor="#FFFFFF",i._endPointBorderWidth="1",i._fillOpacity="1",i._transition=!1,i._easeStyle="",i._duration="1.5",i._startDelay=0,i._moveOptions=["中心弹出","淡入"],i._moveStyle="中心弹出",i._endPause=0,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._suffix="",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t._links,n=t.forceDiagram,a=(t.xScale,t.yScale,t.grid),r=t.heightOfCore,l=t.widthOfNoMargin,s=t.tooltip;t.xAxis._axisLineShow=!1,t.yAxis._axisLineShow=!1;var u=void 0;if(u="diameter"==t._bubbleSizeType?d3.scaleLinear().domain([parseFloat(d3.min(e.map((function(t){return t.value})))),parseFloat(d3.max(e.map((function(t){return t.value}))))]).range([parseFloat(t._endPointRadiusMin),parseFloat(t._endPointRadiusMax)]):d3.scaleSqrt().domain([parseFloat(d3.min(e.map((function(t){return t.value})))),parseFloat(d3.max(e.map((function(t){return t.value}))))]).range([parseFloat(t._endPointRadiusMin),parseFloat(t._endPointRadiusMax)]),t.mainGroup.selectAll(".linear-gradient").remove(),t._linkColor&&/\[/.test(t._linkColor)){var h=x(t._linkColor),d=[],_=!0,f=!1,p=void 0;try{for(var g,v=h[Symbol.iterator]();!(_=(g=v.next()).done);_=!0){var m=g.value,b=[],S=m.split(":");b.push(q(S[0])),b.push(S[1]),d.push(b)}}catch(t){f=!0,p=t}finally{try{!_&&v.return&&v.return()}finally{if(f)throw p}}var k=d.concat(),w=k.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(w[1]).x1+"%").attr("y1",y(w[1]).y1+"%").attr("x2",y(w[1]).x2+"%").attr("y2",y(w[1]).y2+"%").selectAll("stop").data(k).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._endPointBorderColor&&/\[/.test(t._endPointBorderColor)){var C=x(t._endPointBorderColor),O=[],F=!0,L=!1,P=void 0;try{for(var A,W=C[Symbol.iterator]();!(F=(A=W.next()).done);F=!0){var z=A.value,M=[],D=z.split(":");M.push(q(D[0])),M.push(D[1]),O.push(M)}}catch(t){L=!0,P=t}finally{try{!F&&W.return&&W.return()}finally{if(L)throw P}}var R=O.concat(),N=R.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(N[1]).x1+"%").attr("y1",y(N[1]).y1+"%").attr("x2",y(N[1]).x2+"%").attr("y2",y(N[1]).y2+"%").selectAll("stop").data(R).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).links(i).width(l).height(r).positionChoice(t._positionOptions.indexOf(t._positionChoice)).contentChoice(t._contentChoice).contentOption(t._contentOption).textLabel(t._textLabel).borderWidth(t._borderWidth).linkColor(/\[/.test(t._linkColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._linkColor).fillOpacity(t._fillOpacity).endPointBorderColor(/\[/.test(t._endPointBorderColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._endPointBorderColor).endPointBorderWidth(t._endPointBorderWidth).rScale(u).interrupt(t._interrupt).labelShow(t._labelShow).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*t._startDelay).moveStyle(t._moveOptions.indexOf(t._moveStyle)).endPause(t._endPause).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){var n=[{text:""+e.id,color:e.color},{text:e.valueLabel+":   "+E(e.value,t._numberStyle,t._decimalPlaces)}];s.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){s.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t,e){s.hide()})).onMouseover2((function(t,e){var i=[{text:t.source.id+"→"+t.target.id}];s.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove2((function(t,e){s.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout2((function(t,e){s.hide()})),t.coreGroup.call(o,t.yAxis.width+.5,t.yAxis.titleHeight),a.update(),n.update()}},{key:"sortData",value:function(){var t=this._data.slice(0),e=this._sortValue,i=this._dataType,n=t.map((function(t){return t.color})),a=void 0;"cross-table"===i?(t.forEach((function(t){t.sum=d3.sum(t.data,(function(t){return t.value}))})),a=1===e?function(t,e){return t.sum-e.sum}:-1===e?function(t,e){return e.sum-t.sum}:null):a=1===e?function(t,e){return t.value-e.value}:-1===e?function(t,e){return e.value-t.value}:null,this._sortedDataCopy=a?t.sort(a).map((function(t,e){return t.color=n[e],t})):t}},{key:"configLegend",value:function(){for(var t=this,e=t.activeData,i=t._links.filter((function(t){return!1!==t.active})),n=e.map((function(t){return[t.type,t.color]})),a={},o=[],r=0;r<n.length;r++)a[n[r]]||(o.push(n[r]),a[n[r]]=!0);for(var l=[],s=0;s<o.length;s++){var u={};u.name=o[s][0],u.color=o[s][1],u.key=o[s][0],l.push(u)}t.activeData.forEach((function(t){t.active=!0})),t.legend.data(l).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),e.forEach((function(t){t.type===n.key&&(t.active=!a)}));var o=t.activeData.map((function(t){return t.key}));i.forEach((function(t){o.includes(t.source.key)&&o.includes(t.source.key)&&1==t.source.active&&1==t.target.active?t.active=!0:t.active=!1})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this;t.activeData;t._xDomain=[],t._yDomain=[]}},{key:"buildOption",value:function(t,e){var i=new Qr(t,e);return i.dataSolveFunc(Kr),i}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){this.links(t.links);var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o?o.display:this._labelShow,this._positionChoice=o.positionChoice?o.positionChoice:this._positionChoice,this._contentChoice=o.contentChoice?o.contentChoice:this._contentChoice,this._textLabel=o.textLabel?o.textLabel:this._textLabel,this._suffix=o.suffix?o.suffix:""),0!==Object.getOwnPropertyNames(e).length&&(this._bubbleSizeType=e.bubbleSizeType?e.bubbleSizeType:this._bubbleSizeType,this._borderWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._borderWidth,this._linkColor=e.lineColor_static?q(e.lineColor_static):"",this._endPointRadiusMin=0==e.minRadius||e.minRadius?e.minRadius:this._endPointRadiusMin,this._endPointRadiusMax=0==e.maxRadius||e.maxRadius?e.maxRadius:this._endPointRadiusMax,this._endPointBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._endPointBorderWidth,this._endPointBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"links",value:function(t){return arguments.length?(this._links=t,this):this._links}}]),e}(Vr),tl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._clipId="clip-overlay-"+i.id,i.overlayRect=i.elem.append("defs").append("clipPath").attr("id",i._clipId).append("rect"),i.elem.attr("class","ForceDiagramArrow"),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a=t._height,o=t._width,r=t._borderWidth,l=t._textLabel.fontSize,s=t._textLabel.fontFamily,u=q(t._textLabel.color),h=t._endPointRadius,d=t._positionChoice;t._arrowAspectRatio;n.selectAll("*").remove();var _=t._links;if(!((_=_.filter((function(t){return!1!==t.active}))).length<1)){for(var f=e,g=_,v=d3.forceSimulation(f).alphaDecay(.01).force("center",d3.forceCenter(o/2,a/2)).force("charge",d3.forceManyBody().strength(-80)).force("link",d3.forceLink(g).id((function(t){return t.id})).distance(20)).force("x",d3.forceX().strength(.1)).force("y",d3.forceY().strength(o/a*.1)).stop(),m=[],b=[],S=0,k=Math.ceil(Math.log(v.alphaMin())/Math.log(1-v.alphaDecay()));S<k;++S)v.tick();n.append("g").attr("stroke","grey").attr("stroke-width",r).selectAll("line").data(g).enter().append("line").attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),n.append("g").attr("stroke","#fff").attr("stroke-width",t._endPointBorderWidth).selectAll("circle").data(f).enter().append("circle").attr("cx",(function(t){return m.push(t.x-o/2),t.x})).attr("cy",(function(t){return b.push(t.y-a/2),t.y})).attr("r",h);var w=d3.max(m.map((function(t){return Math.abs(t)}))),C=d3.max(b.map((function(t){return Math.abs(t)}))),O=2*(d3.max([C,w])+parseFloat(l)),F=d3.min([o,a])/O>=1?d3.min([o,a])/O:1;n.selectAll("*").remove(),d3.select(".force-diagram-arrow defs").selectAll("*").remove(),t.group.attr("clip-path","url("+c("#"+t._clipId)+")"),t.overlayRect.attr("x",0).attr("y",0).attr("width",o).attr("height",a);var L=Math.floor(1e9*Math.random());_.forEach((function(e,i){var a=e.color;if(a&&/\[/.test(a)){var o=x(a),r=[],l=!0,s=!1,u=void 0;try{for(var c,h=o[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),r.push(_)}}catch(t){s=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(s)throw u}}var p=r.concat(),g=p.pop();n.append("linearGradient").attr("id","force-diagram-arrow-"+t.id+"-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),n.append("linearGradient").attr("id","force-diagram-arrow-"+L+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var P=d3.forceSimulation(e).alphaDecay(.01).force("collision",d3.forceCollide(h)).force("charge",d3.forceManyBody().strength(-6*F*F)).force("link",d3.forceLink(_).id((function(t){return t.id})).distance());for(S=0,k=Math.ceil(Math.log(P.alphaMin())/Math.log(1-P.alphaDecay()));S<k;++S)P.tick();var A=t.group.append("defs").selectAll("marker").data(_).enter().append("marker").attr("id",(function(e,i){return"arrow-"+t.id+"-"+i})).attr("refX",t._triangleHeight).attr("refY",t._triangleBtWidth/2).attr("markerWidth",t._triangleHeight).attr("markerHeight",t._triangleBtWidth).attr("orient","auto").attr("markerUnits","userSpaceOnUse").append("path").attr("d","M 0 0 L "+t._triangleHeight+" "+t._triangleBtWidth/2+" L 0 "+t._triangleBtWidth+" z").style("fill",(function(t,e){return t.color&&/\[/.test(t.color)?"url("+c("#force-diagram-arrow-"+L+e)+")":t.color&&/#/.test(t.color)?t.color:"rgb("+U(t.color,0)+","+U(t.color,1)+","+U(t.color,2)+")"})).style("fill-opacity",(function(e,i){if(e.color&&/#/.test(e.color))return t._fillOpacity;var n=U(e.color,3)||1;return t._fillOpacity*n})),W=n.append("g").selectAll("line").data(_).enter().append("path").style("class","force-diagram-arrow-links").style("fill","none").style("stroke-width",r).style("stroke",(function(e,i){var n=e.color;return n&&/\[/.test(n)?"url("+c("#force-diagram-arrow-"+t.id+"-"+i)+")":n&&/#/.test(n)?n:"rgb("+U(n,0)+","+U(n,1)+","+U(n,2)+")"})).style("stroke-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).attr("marker-end",(function(e,i){return"url("+c("#arrow-"+t.id+"-"+i)+")"})).attr("d",(function(e){var i=d3.select(this).attr("d","M"+J(e.source.x,e.source.id)+","+K(e.source.y)+" "+J(e.target.x,e.target.id)+","+K(e.target.y)),n=i.node().getPointAtLength(parseFloat(h)+parseFloat(t._endPointBorderWidth)+2),a=i.node().getPointAtLength(i.node().getTotalLength()-parseFloat(h)-2-parseFloat(t._endPointBorderWidth)),o=Math.hypot(a.x-n.x,a.y-n.y);return"M"+n.x+","+n.y+" A"+o+","+o+" 0 0,1 "+a.x+","+a.y})).style("stroke-dasharray",(function(e,i){return this.getTotalLength()+" "+t._triangleHeight})).style("stroke-dashoffset",""+t._triangleHeight).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),z=n.append("g").selectAll("circle").data(e).enter().append("circle").style("class","force-diagram-arrow-nodes").attr("cx",(function(t){return J(t.x,t.id)})).attr("cy",(function(t){return K(t.y)})).attr("r",(function(t){return h})).style("stroke",(function(e,i){var n=""==t._endPointBorderColor?"#000000":t._endPointBorderColor;return n&&/\[/.test(n)?"url("+c("#force-diagram-arrow-"+t.id+"-"+i)+")":(n&&/#/.test(n),n)})).style("stroke-width",t._endPointBorderWidth).style("fill",(function(e,i){var n=""==t._endPointFillColor?"#000000":t._endPointFillColor;return n&&/\[/.test(n)?"url("+c("#force-diagram-arrow"+t.id+"-"+i)+")":n&&/#/.test(n)?n:"rgb("+U(n,0)+","+U(n,1)+","+U(n,2)+")"})).style("fill-opacity",(function(e,i){var n=t._endPointFillColor;if(n&&/#/.test(n))return t._fillOpacity;var a=U(n,3)||1;return t._fillOpacity*a})),M=n.append("g").selectAll("g").data(e).enter().append("g").attr("class","force-diagram-arrow-labels").style("pointer-events","none").style("display",t._labelShow?"block":"none").append("text").style("fill",u).style("font-family",s).style("font-size",l).attr("x",(function(t){return J(t.x,t.id)})).attr("y",(function(t){return K(t.y)})).attr("class","force-diagram-arrow-text-labels").attr("dy",(function(e,i){return 0==d?-parseFloat(t._endPointBorderWidth)-parseFloat(t._endPointRadius)-4:1==d?.7*parseFloat(l)+parseFloat(t._endPointBorderWidth)+parseFloat(t._endPointRadius)+4:"0.35em"})).attr("dx",(function(e,i){return 2==d?-parseFloat(t._endPointBorderWidth)-parseFloat(t._endPointRadius)-4:3==d?parseFloat(t._endPointBorderWidth)+parseFloat(t._endPointRadius)+4:0})).attr("text-anchor",(function(t){return 2==d?"end":3==d?"start":"middle"})).text((function(t){return t.id}));t._interrupt||(t._transition&&0==t._moveStyle?(W.style("stroke-opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("stroke-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})),A.style("fill-opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})),z.attr("cx",o/2).attr("cy",a/2).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("cx",(function(t){return J(t.x,t.id)})).attr("cy",(function(t){return K(t.y)}))):t._transition&&1==t._moveStyle&&(W.style("stroke-opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("stroke-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})),A.style("fill-opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})),z.style("fill-opacity","0").transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).style("fill-opacity",(function(e,i){var n=t._endPointFillColor;if(n&&/#/.test(n))return t._fillOpacity;var a=U(n,3)||1;return t._fillOpacity*a}))),M.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1));for(var D=t.group.selectAll(".force-diagram-arrow-labels"),N=[],T=[],B=0;B<D._groups[0].length;B++){T.push(B);for(var G=B+1;G<D._groups[0].length;G++){p(i(d3.select(D._groups[0][B])),i(d3.select(D._groups[0][G])))&&(N.push(B),d3.select(D._groups[0][B]).style("visibility","hidden"))}}for(var X=new Set(N),j=Array.from(X),I=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(j,T),Y=0;Y<j.length;Y++){for(var H=[],E=0;E<I.length;E++){var V=i(d3.select(D._groups[0][j[Y]])),$=i(d3.select(D._groups[0][I[E]]));if(H.push(p(V,$)),p(V,$)){if(j[Y]==I[E])continue;d3.select(D._groups[0][j[Y]]).style("visibility","hidden")}}0==H.filter((function(t){return 1==t})).length&&I.push(j[Y])}for(var Z=0;Z<I.length;Z++)d3.select(D._groups[0][I[Z]]).style("visibility","visible");return t}function Q(t,e,i){return R(t,l,s)+2}function K(e){var i=e,n=parseFloat(h)+parseFloat(t._endPointBorderWidth)+.1*a,o=0;return i<n+(o=0==d||1==d?parseFloat(l)+4:0)?n+o:i>a-n-o?a-n-o:i}function J(e,i){var n=parseFloat(h)+parseFloat(t._endPointBorderWidth)+.1*o,a=e,r=0;return a<n+(r=2==d||3==d?Q(i):.5*Q(i))?n+r:a>o-n-r?o-n-r:a}}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"links",value:function(t){return arguments.length?(this._links=t,this):this._links}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"triangleBtWidth",value:function(t){return arguments.length?(this._triangleBtWidth=t,this):this._triangleBtWidth}},{key:"triangleHeight",value:function(t){return arguments.length?(this._triangleHeight=t,this):this._triangleHeight}}]),e}(at),el=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){return this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]).nodes}},{key:"links",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=Array.from(new Set(t.links.map((function(t){return t.type})))),i=this.generateColorList(e.length||1);return function(t,i){return t.forEach((function(t,n){e.forEach((function(e,n){t.type==e&&(t.color=i[n])}))})),t}(t.links,i)}}]),e}(it);function il(t,e){var i=t.slice(1),n=0,a=0,o=0;e.forEach((function(t){"sourceCol"===t.function?n=t.index:"targetCol"===t.function?a=t.index:"typeCol"===t.function&&(o=t.index,t.isLegend)}));var r=[];i.forEach((function(t,e){r.push(t[n]),r.push(t[a])})),r=Array.from(new Set(r));var l=[],s=[];return r.forEach((function(t,e){l.push({id:t})})),l.forEach((function(t,e){t.key=h(t.id)+"-"+e})),i.forEach((function(t,e){t[n]!=t[a]&&s.push({source:t[n],target:t[a],type:t[o],key:t[n]+"-"+t[a]+"-"+e})})),{nodes:l,links:s}}var nl="force-diagram-arrow",al=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class",nl),i.elem.attr("id",nl),i.grid=new Jt(i.coreGroup),i.forceDiagram=new tl(i.coreGroup),i.xAxis=new mi(i.mainGroup),i.yAxis=new Ur(i.mainGroup),i.xScale=d3.scalePoint(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._labelShow=!1,i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["上侧","下侧","左侧","右侧","居中"],positionChoice:"右侧"},i._borderWidth="1",i._endPointFillColor="",i._fillOpacity="1",i._endPointRadius="5",i._endPointBorderColor="",i._endPointBorderWidth="0",i._triangleBtWidth=12,i._triangleHeight=12,i._transition=!0,i._easeStyle="",i._duration="1.5",i._startDelay=0,i._moveOptions=["中心弹出","淡入"],i._moveStyle="中心弹出",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t._links,n=t.tooltip,a=t.forceDiagram,r=t.grid,l=t.heightOfCore,s=t.widthOfCore;if(t.xAxis._axisLineShow=!1,t.yAxis._axisLineShow=!1,t.mainGroup.selectAll(".linear-gradient").remove(),t._endPointFillColor&&/\[/.test(t._endPointFillColor)){var u=x(t._endPointFillColor),h=[],d=!0,_=!1,f=void 0;try{for(var p,g=u[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var v=p.value,m=[],b=v.split(":");m.push(q(b[0])),m.push(b[1]),h.push(m)}}catch(t){_=!0,f=t}finally{try{!d&&g.return&&g.return()}finally{if(_)throw f}}var S=h.concat(),k=S.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(k[1]).x1+"%").attr("y1",y(k[1]).y1+"%").attr("x2",y(k[1]).x2+"%").attr("y2",y(k[1]).y2+"%").selectAll("stop").data(S).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._endPointBorderColor&&/\[/.test(t._endPointBorderColor)){var w=x(t._endPointBorderColor),C=[],O=!0,F=!1,L=void 0;try{for(var P,A=w[Symbol.iterator]();!(O=(P=A.next()).done);O=!0){var W=P.value,z=[],M=W.split(":");z.push(q(M[0])),z.push(M[1]),C.push(z)}}catch(t){F=!0,L=t}finally{try{!O&&A.return&&A.return()}finally{if(F)throw L}}var D=C.concat(),R=D.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(R[1]).x1+"%").attr("y1",y(R[1]).y1+"%").attr("x2",y(R[1]).x2+"%").attr("y2",y(R[1]).y2+"%").selectAll("stop").data(D).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}a.data(e).links(i).width(s).height(l).positionChoice(t._textLabel.positionOptions.indexOf(t._textLabel.positionChoice)).textLabel(t._textLabel).borderWidth(t._borderWidth).fillOpacity(t._fillOpacity).endPointRadius(t._endPointRadius).endPointBorderColor(/\[/.test(t._endPointBorderColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._endPointBorderColor).endPointBorderWidth(t._endPointBorderWidth).triangleBtWidth(t._triangleBtWidth).triangleHeight(t._triangleHeight).endPointFillColor(/\[/.test(t._endPointFillColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._endPointFillColor).labelShow(t._labelShow).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveOptions.indexOf(t._moveStyle)).endPause(t._endPause).onMouseover((function(t,e){var i=[{text:t.source.id+"→"+t.target.id}];n.data(i).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t,e){n.hide()})),t.coreGroup.call(o,t.yAxis.width+.5,t.yAxis.titleHeight),r.update(),a.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){for(var t=this,e=(t.sortedDataCopy,Array.from(new Set(t._links.map((function(t){return t.type}))))),i=(t._nodes,t._links.filter((function(t){return!1!==t.active}))),n=[],a=0;a<e.length;a++){var o={};o.name=e[a],o.color=t._colors[a],n.push(o)}t.legend.data(n).onClick((function(e){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),i.forEach((function(t){e.name==t.type&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this;t.activeData;t._xDomain=[],t._yDomain=[]}},{key:"sortData",value:function(){var t=this._data.slice(0),e=this._sortValue,i=void 0;i="cross-table"===this._dataType?1===e?function(t,e){return t.sum-e.sum}:-1===e?function(t,e){return e.sum-t.sum}:null:1===e?function(t,e){return t.value-e.value}:-1===e?function(t,e){return e.value-t.value}:null,this._sortedDataCopy=i?t.sort(i):t}},{key:"buildOption",value:function(t,e){var i=new el(t,e);return i.dataSolveFunc(il),i}},{key:"setSelfOption",value:function(t){this.links(t.links),this.colors(t.generateColorList(Array.from(new Set(t.links.map((function(t){return t.type})))).length||1));var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o.textLabel?o.textLabel.show:this._labelShow,this._textLabel=o.textLabel?o.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(e).length&&(this._triangleBtWidth=0==e.triangleBtWidth||e.triangleBtWidth?e.triangleBtWidth:this._triangleBtWidth,this._triangleHeight=0==e.triangleHeight||e.triangleHeight?e.triangleHeight:this._triangleHeight,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._borderWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._borderWidth,this._endPointFillColor=e.endPointFillColor_static?q(e.endPointFillColor_static):"",this._endPointBorderWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._endPointBorderWidth,this._endPointBorderColor=e.endPointBorderColor_static?q(e.endPointBorderColor_static):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"links",value:function(t){return arguments.length?(this._links=t,this):this._links}},{key:"colors",value:function(t){return arguments.length?(this._colors=t,this):this._colors}}]),e}(Vr),ol="hundredPercent-icon-bar-group",rl="hundredPercent-icon-bar-clip-path",ll="hundredPercent-icon-bar-back-rect",sl="hundredPercent-icon-bar-back-group",ul="hundredPercent-icon-bar-front-group",cl="hundredPercent-icon-bar-label-group",hl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","hundredPercent-icon-bar"),i.defs=i.elem.append("defs"),i._width=400,i._height=400,i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._countOfOneRow=10,i._padding=2,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t._width,n=t._height,a=t._backgroundIconColor,r=t._backFillOpacity,l=t._borderColor;!function(){var t=0,e=window.screen;~navigator.userAgent.toLowerCase().indexOf("msie")?e.deviceXDPI&&e.logicalXDPI&&(t=e.deviceXDPI/e.logicalXDPI):void 0!==window.outerWidth&&void 0!==window.innerWidth&&(t=window.outerWidth/window.innerWidth);t&&(t=t)}();if("single"==t._type){var s=t._icon,u=t._countOfOneRow,h=t._padding;t.group.selectAll("*").remove();var d=e.length,_=d3.max(e,(function(t){return parseFloat(t.value)})),f=i/u,p=n/Math.max(1,d),g=Math.min((f-2*h)/s.width,(p-2*h)/s.height)*t._iconScale*1,v=[],m=[];t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+g+")"),t.group.append("path").attr("class","icon").attr("d",s.path).attr("transform","scale("+g+")");t.group.select(".icon-test").node().getBoundingClientRect(),t.group.select(".icon").node().getBoundingClientRect();var b=t.group.select(".icon-test").node().getBBox(),S=t.group.select(".icon").node().getBBox(),k=s.width*g,w=s.height*g;v.push((S.x-b.x)*g),m.push((S.y-b.y)*g),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove();var C=t.defs,O="icon-"+t.id;C.select("#"+O).empty()&&C.append("path").attr("id",O).attr("d",s.path),C.selectAll("."+rl).remove();var F=C.selectAll("."+rl).data(e,(function(t){return t.name}));F.exit().remove();var L=F.enter().append("clipPath").attr("class",rl).attr("id",(function(e,i){return"icon-clip-"+i+"-"+t.id}));if(L.append("rect"),t._interrupt)L.merge(F).select("rect").attr("x",0).attr("y",-1).attr("height",p).attr("width",(function(e){return t._xScale(e.value)}));else{var P=L.merge(F).select("rect").attr("x",0).attr("y",-1).attr("width",0).attr("height",0).style("fill",(function(t){return t.color}));t._transition&&0==t._moveStyle?P.attr("height",p).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("width",(function(e){return t._xScale(e.value)})):t._transition&&1==t._moveStyle?P.attr("height",p).transition().duration(t._transition?.9*t._duration/e.length:0).delay((function(i,n){return t._startDelay+n*(.9*t._duration/e.length)})).attr("width",(function(e){return t._xScale(e.value)})):P.attr("height",p).attr("width",(function(e){return t._xScale(e.value)}))}var A=t.group.selectAll("."+ol).data(e,(function(t){return t.key}));A.exit().remove(),A.selectAll("*").remove(),e.forEach((function(e,i){var n=""==a?e.color:a;if(n&&/\[/.test(n)){var o=x(n),r=[],l=!0,s=!1,u=void 0;try{for(var c,h=o[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),r.push(_)}}catch(t){s=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(s)throw u}}var p=r.concat(),g=p.pop();t.group.append("linearGradient").attr("id",t.id+"-light-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-number-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var W=A.enter().append("g").attr("class",ol).merge(A).attr("transform",(function(t,e){return"translate(0, "+p*e+")"})).each(t._onTransitionStart).each(t._onTransitionEnd).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),z=W.append("rect").attr("class",ll),M=W.append("g").attr("class",sl).call(o,0,(p-w)/2),D=W.append("g").attr("class",ul).call(o,0,(p-w)/2).attr("clip-path",(function(e,i){return"url(#icon-clip-"+i+"-"+t.id+")"})),R=t.group.append("g").attr("class",cl);z.attr("width",i).attr("height",p).style("opacity",0),M.each((function(e,i){d3.select(this).selectAll("g").data((function(t){return d3.range(u)})).enter().append("g").append("path").attr("d",s.path).attr("transform",(function(t,e){return"translate("+(f*e+(f-k)/2-v[0])+","+-m[0]+") scale("+g+")"})).attr("stroke",(function(n,o){var r=""==a?e.color:a;if(r&&/\[/.test(r))return""==l?"url("+c("#"+t.id+"-light-index-"+i)+")":l;if(r&&/#/.test(r))return""==l?r:l;U(r,0),U(r,1),U(r,2),U(r,3);return""==l?r:l})).style("stroke-width",(t._borderWidth||0)/g).style("fill",(function(n,o){var r=""==a?e.color:a;if(r&&/\[/.test(r))return"url("+c("#"+t.id+"-light-index-"+i)+")";if(r&&/#/.test(r))return r;var l=U(r,0),s=U(r,1),u=U(r,2);return""==a?"rgb("+l+","+s+","+u+")":r})).style("fill-opacity",(function(t){var i=""==a?e.color:a;if(i&&/#/.test(i))return r;var n=U(i,3)||1;return r*n}))})),D.each((function(e,i){d3.select(this).selectAll("g").data((function(t){return d3.range(function(t){return _>=u?u*t.value/_:t.value}(t))})).enter().append("g").append("path").attr("d",s.path).attr("transform",(function(t,e){return"translate("+(f*e+(f-k)/2-v[0])+","+-m[0]+") scale("+g+")"})).style("fill",(function(n,a){return/\[/.test(e.color)?"url("+c("#"+t.id+"-number-index-"+i)+")":e.color})).style("fill-opacity",(function(i,n){if(e.color&&/#/.test(e.color))return t._fillOpacity;var a=U(e.color,3)||1;return t._fillOpacity*a}))}));var N=R.selectAll("text").data(e).enter().append("text").attr("x",(function(e,n){return 0==t._positionChoice?t._xScale(e.value)+5:1==t._positionChoice?i+5:0})).attr("y",(function(t,e){return(e+.5)*p})).attr("dy","0.35em").style("text-anchor","start").style("fill",q(t._numberLabel.color)).style("font-size",t._numberLabel.fontSize).style("font-family",t._numberLabel.fontFamily).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})).style("display",t._numberLabel.show?"block":"none");t._interrupt?N.style("opacity",1):N.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}else{var T=t._svgArr,B=t._icon,G=t._countOfOneRow,X=t._padding;t.group.selectAll("*").remove();for(var j=e.length,I=d3.max(e,(function(t){return parseFloat(t.value)})),Y=i/G,H=n/Math.max(1,j),V=(Math.min((Y-2*X)/B.width,(H-2*X)/B.height),t._iconScale,[]),$=[],Z=[],Q=[],K=[],J=0;J<T.length;J++){var tt=Math.min((Y-2*X)/T[J].width,(H-2*X)/T[J].height)*t._iconScale*1;t.group.append("path").attr("class","icon-test").attr("d","").attr("transform","scale("+tt+")"),t.group.append("path").attr("class","icon").attr("d",T[J].path).attr("transform","scale("+tt+")");t.group.select(".icon-test").node().getBoundingClientRect(),t.group.select(".icon").node().getBoundingClientRect();var et=t.group.select(".icon-test").node().getBBox(),it=t.group.select(".icon").node().getBBox();V.push(tt),$.push(T[J].width*tt),Z.push(T[J].height*tt),Q.push((it.x-et.x)*tt),K.push((it.y-et.y)*tt),t.group.selectAll(".icon").remove(),t.group.selectAll(".icon-test").remove()}var nt=function(t){return I>=G?G*t.value/I:t.value},at=t.defs,ot="icon-"+t.id;at.select("#"+ot).empty()&&at.append("path").attr("id",ot).attr("d",B.path),at.selectAll("."+rl).remove();var rt=at.selectAll("."+rl).data(e,(function(t){return t.name}));rt.exit().remove();var lt=rt.enter().append("clipPath").attr("class",rl).attr("id",(function(e,i){return"icon-clip-"+i+"-"+t.id}));if(lt.append("rect"),t._interrupt)lt.merge(rt).select("rect").attr("x",0).attr("y",-1).attr("height",H).attr("width",(function(t){return Math.round(nt(t))*Y}));else{var st=lt.merge(rt).select("rect").attr("x",0).attr("y",-1).attr("width",0).attr("height",0).style("fill",(function(t){return t.color}));t._transition&&0==t._moveStyle?st.attr("height",H).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("width",(function(e){return t._xScale(e.value)})):t._transition&&1==t._moveStyle?st.attr("height",H).transition().duration(t._transition?.9*t._duration/e.length:0).delay((function(i,n){return t._startDelay+n*(.9*t._duration/e.length)})).attr("width",(function(e){return t._xScale(e.value)})):st.attr("height",H).attr("width",(function(e){return t._xScale(e.value)}))}var ut=t.group.selectAll("."+ol).data(e,(function(t){return t.key}));ut.exit().remove(),ut.selectAll("*").remove(),e.forEach((function(e,i){var n=""==a?e.color:a;if(n&&/\[/.test(n)){var o=x(n),r=[],l=!0,s=!1,u=void 0;try{for(var c,h=o[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){var d=c.value,_=[],f=d.split(":");_.push(q(f[0])),_.push(f[1]),r.push(_)}}catch(t){s=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(s)throw u}}var p=r.concat(),g=p.pop();t.group.append("linearGradient").attr("id",t.id+"-light-index-"+i).attr("x1",y(g[1]).x1+"%").attr("y1",y(g[1]).y1+"%").attr("x2",y(g[1]).x2+"%").attr("y2",y(g[1]).y2+"%").selectAll("stop").data(p).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-number-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var ct=ut.enter().append("g").attr("class",ol).merge(ut).attr("transform",(function(t,e){return"translate(0, "+H*e+")"})).each(t._onTransitionStart).each(t._onTransitionEnd).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),ht=ct.append("rect").attr("class",ll),dt=ct.append("g").attr("class",sl).attr("transform",(function(t,e){return"translate(0,"+(H-Z[e])/2+")"})),_t=ct.append("g").attr("class",ul).attr("transform",(function(t,e){return"translate(0,"+(H-Z[e])/2+")"})).attr("clip-path",(function(e,i){return"url(#icon-clip-"+i+"-"+t.id+")"})),ft=t.group.append("g").attr("class",cl);ht.attr("width",i).attr("height",H).style("opacity",0);dt.each((function(e,i){d3.select(this).selectAll("g").data(d3.range(G)).enter().append("g").append("path").attr("d",T[i].path).attr("transform",(function(t,e){return"translate("+(Y*e+(Y-$[i])/2-Q[i])+","+-K[i]+") scale("+V[i]+")"})).attr("stroke",(function(n,o){var r=""==a?e.color:a;if(r&&/\[/.test(r))return""==l?"url("+c("#"+t.id+"-light-index-"+i)+")":l;if(r&&/#/.test(r))return""==l?r:l;U(r,0),U(r,1),U(r,2),U(r,3);return""==l?r:l})).style("stroke-width",(t._borderWidth||0)/V[i]).style("fill",(function(n,o){var r=""==a?e.color:a;if(r&&/\[/.test(r))return"url("+c("#"+t.id+"-light-index-"+i)+")";if(r&&/#/.test(r))return r;var l=U(r,0),s=U(r,1),u=U(r,2);return""==a?"rgb("+l+","+s+","+u+")":r})).style("fill-opacity",(function(t){var i=""==a?e.color:a;if(i&&/#/.test(i))return r;var n=U(i,3)||1;return r*n}))}));_t.each((function(e,i){d3.select(this).selectAll("g").data((function(t){return d3.range(nt(t))})).enter().append("g").append("path").attr("d",T[i].path).attr("transform",(function(t,e){return"translate("+(Y*e+(Y-$[i])/2-Q[i])+","+-K[i]+") scale("+V[i]+")"})).style("fill",(function(n,a){return/\[/.test(e.color)?"url("+c("#"+t.id+"-number-index-"+i)+")":e.color})).style("fill-opacity",(function(i,n){if(e.color&&/#/.test(e.color))return t._fillOpacity;var a=U(e.color,3)||1;return t._fillOpacity*a}))}));var pt=ft.selectAll("text").data(e).enter().append("text").attr("x",(function(e,n){return 0==t._positionChoice?t._xScale(e.value)+5:1==t._positionChoice?i+5:0})).attr("y",(function(t,e){return(e+.5)*H})).attr("dy","0.35em").style("text-anchor","start").style("fill",q(t._numberLabel.color)).style("font-size",t._numberLabel.fontSize).style("font-family",t._numberLabel.fontFamily).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})).style("display",t._numberLabel.show?"block":"none");t._interrupt?pt.style("opacity",1):pt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)}return t}},{key:"backFill",value:function(t){return arguments.length?(this._backFill=t,this):this._backFill}},{key:"icon",value:function(t){return arguments.length?(this._icon=t,this):this._icon}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"padding",value:function(t){return arguments.length?(this._padding=t,this):this._padding}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"svgArr",value:function(t){return arguments.length?(this._svgArr=t,this):this._svgArr}},{key:"iconScale",value:function(t){return arguments.length?(this._iconScale=t,this):this._iconScale}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"backFillOpacity",value:function(t){return arguments.length?(this._backFillOpacity=t,this):this._backFillOpacity}},{key:"backgroundIconColor",value:function(t){return arguments.length?(this._backgroundIconColor=t,this):this._backgroundIconColor}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"actualNumberWidth",value:function(t){return arguments.length?(this._actualNumberWidth=t,this):this._actualNumberWidth}},{key:"countOfOneRow",value:function(t){return arguments.length?(this._countOfOneRow=t,this):this._countOfOneRow}},{key:"borderType",value:function(t){return arguments.length?(this._borderType=t,this):this._borderType}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),dl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.iconBar=new hl(i.coreGroup),i.yAxis=new mi(i.mainGroup),i.xAxis=new Ur(i.mainGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._icon={name:"male",width:14.57,height:25,path:"m14.57,9.54l0,5.91q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5l-0.91,0l0,12.95q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-6.59l-0.91,0l0,6.59q0,0.65,-0.47,1.12t-1.12,0.47t-1.12,-0.47t-0.47,-1.12l0,-12.95l-0.91,0l0,5q0,0.57,-0.4,0.97t-0.97,0.4t-0.97,-0.4t-0.4,-0.97l0,-5.91q0,-1.14,0.8,-1.93t1.93,-0.8l9.09,0q1.14,0,1.93,0.8t0.8,1.93Zm-4.09,-6.36q0,1.32,-0.93,2.25t-2.25,0.93t-2.25,-0.93t-0.93,-2.25t0.93,-2.25t2.25,-0.93t2.25,0.93t0.93,2.25Z"},i._iconBackFill=null,i._iconPadding=2,i._innerPadding=5,i._iconScale=.9,i._countOfOneRow=10,i._iconBackgroundColor="",i._backgroundOpacity=.7,i._borderWidth=0,i._borderColor="#545454",i._fillOpacity=1,i._borderType="",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",suffix:"",positionOptions:["外部居左","外部居右"],positionChoice:"外部居右"},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!0,i._easeStyle="",i._duration="1.5",i._startDelay=0,i._moveOptions=["横向展开","依次展开"],i._moveStyle="横向展开",i._endPause=0,i._interrupt=!1,i._type="single",i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.iconBar,i=t.tooltip,n=t.activeData,a=(t.widthOfNoMargin,t.heightOfMainGroup),r=t.yAxis,l=[];if(t._pictures)if("single"==t._type){var s=t.group.append("foreignObject").attr("class","path-container");if(t._svgList[0]){s.html(t._svgList[0]).attr("class","svgIcon");var u=t.group.select(".svgIcon svg path").attr("d"),h=(t.group.select(".svgIcon").selectAll("svg").select("path").node().getBBox(),t.group.append("path").attr("d",u).attr("class","icon"),t.group.select(".icon").node().getBBox());t._icon.path=u,t._icon.width=h.width,t._icon.height=h.height}t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}else for(var d=0;d<t._svgList.length;d++){var _=t.group.append("foreignObject"),f={};if(t._svgList[d]){_.html(t._svgList[d]).attr("class","svgIcon");var p=t.group.select(".svgIcon svg path").attr("d"),g=(t.group.select(".svgIcon").selectAll("svg").select("path").node().getBBox(),t.group.append("path").attr("d",p).attr("class","icon"),t.group.select(".icon").node().getBBox());f.path=p,f.width=g.width,f.height=g.height}else f.path="",f.width=1e-4,f.height=1e-4;l.push(f),t.group.selectAll(".svgIcon").remove(),t.group.selectAll(".icon").remove(),t.group.selectAll(".path-container").remove()}var v=t.yScale,m=t._numberLabel,b=t._textLabel,S=n.length?n.map((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})):[""],k=(G(S,m.fontSize,m.fontFamily),0);if(k=G(S,m.fontSize,m.fontFamily),0==m.show&&(k=0),m.show&&"外部居左"==t._numberLabel.positionChoice){var w=t.widthOfNoMargin-t.xAxis.width-5,C=d3.max(n.map((function(t){return t.value})));k=k>w*(1-C/(C<=100?100:d3.max(n.map((function(t){return t.value})))))-m.fontSize?k:0}m.show&&"外部居右"==t._numberLabel.positionChoice&&(k=G(S,m.fontSize,m.fontFamily));var O=b.show?t.xAxis.width:0;if(t.mainGroup.selectAll(".linear-gradient").remove(),t._borderColor&&/\[/.test(t._borderColor)){var F=x(t._borderColor),L=[],P=!0,A=!1,W=void 0;try{for(var z,M=F[Symbol.iterator]();!(P=(z=M.next()).done);P=!0){var D=z.value,R=[],N=D.split(":");R.push(q(N[0])),R.push(N[1]),L.push(R)}}catch(t){A=!0,W=t}finally{try{!P&&M.return&&M.return()}finally{if(A)throw W}}var T=L.concat(),B=T.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(B[1]).x1+"%").attr("y1",y(B[1]).y1+"%").attr("x2",y(B[1]).x2+"%").attr("y2",y(B[1]).y2+"%").selectAll("stop").data(T).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._iconBackgroundColor&&/\[/.test(t._iconBackgroundColor)){var j=x(t._iconBackgroundColor),I=[],Y=!0,H=!1,V=void 0;try{for(var $,U=j[Symbol.iterator]();!(Y=($=U.next()).done);Y=!0){var Z=$.value,Q=[],K=Z.split(":");Q.push(q(K[0])),Q.push(K[1]),I.push(Q)}}catch(t){H=!0,V=t}finally{try{!Y&&U.return&&U.return()}finally{if(H)throw V}}var J=I.concat(),tt=J.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(tt[1]).x1+"%").attr("y1",y(tt[1]).y1+"%").attr("x2",y(tt[1]).x2+"%").attr("y2",y(tt[1]).y2+"%").selectAll("stop").data(J).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).countOfOneRow(t._countOfOneRow).labelShow(t._numberLabel.show).textLabel(t._textLabel).numberLabel(t._numberLabel).positionChoice(t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice)).xScale(v).width(t.widthOfNoMargin-O-k).height(a-r.height).backFill(t._iconBackFill).actualNumberWidth(0).borderType(t._borderType).iconScale(t._iconScale).backgroundIconColor(/\[/.test(t._iconBackgroundColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._iconBackgroundColor).borderWidth(t._borderWidth).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._borderColor).fillOpacity(t._fillOpacity).backFillOpacity(t._backgroundOpacity).icon(t._icon).padding(t._iconPadding).type(t._type).svgArr(l).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveOptions.indexOf(t._moveStyle)).endPause(t._endPause).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onTransitionStart((function(t,e){d3.select(this).append("text").attr("class","hundred-percent-icon-textLabel").attr("x",-8).attr("y",a/(2*n.length||2)).attr("dy","0.35em").style("text-anchor","end").style("fill",q(b.color)).style("font-size",b.fontSize).style("font-family",b.fontFamily).text(X(t.name=="$-"+e?"":t.name,O,b.fontSize,b.fontFamily)).style("display",b.show?"block":"none")})),e.onMouseover((function(e,n){var a=[{text:""+(e.name=="$-"+n?"":e.name),color:e.color},{text:e.valueLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];i.data(a).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t,e){i.hide()})),b.show?t.coreGroup.call(o,t.xAxis.width+t._iconPadding,t.yAxis.titleHeight+.5):t.coreGroup.call(o,0,t.yAxis.titleHeight+.5),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=(t._textLabel,d3.max(e.map((function(t){return t.value}))));i=i<=100?100:d3.max(e.map((function(t){return t.value})));var n=e.length?[0,i]:[],a=e.length?e.map((function(t){return t.name})):[];a.reverse(),t._xDomain=n,t._yDomain=a}},{key:"updateAxis",value:function(){var t=this,e=t.activeData,i=(t._axis,t._numberLabel),n=t._textLabel;t.computeDomain();var a=t.xAxis,o=t.yAxis,r=t.xScale,l=t.yScale,s=t._xType,u=t._yType,c=n.fontSize,h=t.widthOfNoMargin,d=t.heightOfMainGroup;l.domain(t._xDomain),r.domain(t._yDomain),o.scaleFunc(l).allowedMaxTextHeight(.3*d).type(u).orient("bottom").title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStroke).fontSize(c).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).tickFormat((function(t){return t+"%"})).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.scaleFunc(r).allowedMaxTextWidth(.5*h).tickSize(0).type(s).orient("left").title(t._yTitle).lineStroke(t._axisLineStroke).fontSize(c).fontColor(n.fontColor).fontFamily(n.fontFamily).transition(t._transition).duration(t._duration).axisLineShow(!1).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var _=a.titleHeight;o.tickCount(5),o.compute(),a.compute();var f=e.length?e.map((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+"%"})):[""],p=G(f,i.fontSize,i.fontFamily);if(0==i.show&&(p=0),i.show&&"外部居左"==t._numberLabel.positionChoice){var y=t.widthOfNoMargin-a.width-5,x=d3.max(e.map((function(t){return t.value})));p=p>y*(1-x/(x<=100?100:d3.max(e.map((function(t){return t.value})))))-i.fontSize?p:0}i.show&&"外部居右"==t._numberLabel.positionChoice&&(p=G(f,i.fontSize,i.fontFamily)),l.range([0,(n.show?h-a.width:h)-p]),r.range([d-_-o.height,0])}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.pictures,l=t.font;this._fontCopy=l,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=l?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._textLabelShow=!!l||(i.textLabel?i.textLabel.show:this._textLabelShow),this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(e).length&&(this._iconBackgroundColor=e.iconBgColor?q(e.iconBgColor):"",this._iconScale=0==e.iconScale||e.iconScale?e.iconScale:this._iconScale,this._countOfOneRow=0==e.IconsPerRow||e.IconsPerRow?e.IconsPerRow:this._countOfOneRow,this._borderWidth=0==e.iconBorderWidth||e.iconBorderWidth?e.iconBorderWidth:this._borderWidth,this._borderColor=e.iconBorderColor?q(e.iconBorderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._backgroundOpacity=0==e.bgOpacity||e.bgOpacity?e.bgOpacity:this._backgroundOpacity),0!==Object.getOwnPropertyNames(r).length&&(this._pictures=r||null,this._type=r?r.type:"single",this._svgList=r?r.svglist:null),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}}]),e}(Vr),_l=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","lollipop"),i.defs=i.elem.append("defs"),i._transition=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group,n=t._height,a=(t._width,t._axisPositonChoice);i.selectAll("*").remove();var o=parseFloat(t._textLabel.fontSize);e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var r=i.selectAll("g").data(e).enter().append("g").attr("class","lollipops-all").attr("clip-path",(function(e,i){return"url("+c("#"+t.id+"-lollipop-"+i)+")"})),l=r.append("rect").attr("class","lollipop-line"),s=r.append("circle").attr("class","lollipop-circle"),u=i.append("g").selectAll("g").data(e).enter().append("g").attr("class","lollipops-text").append("text").attr("class","lollipop-text");if(1!=a){l.attr("x",(function(e,i){return t._xScale(e.name)+t._xScale.bandwidth()/2-t._lineWidth/2-.5})).attr("y",(function(e){return t._yScale(0)})).attr("width",t._lineWidth).attr("height",(function(e,i){return t._yScale(e.value)+parseFloat(t._rScale(e.value))<0?0:t._yScale(e.value)+parseFloat(t._rScale(e.value))-t._yScale(0)})).style("fill",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})),s.attr("r",(function(e,i){return t._rScale(e.value)})).attr("cx",(function(e,i){return t._xScale(e.name)+t._xScale.bandwidth()/2})).attr("cy",(function(e,i){return t._yScale(e.value)})).style("fill",(function(e,i){var n=""==t._endPointFillColor?e.color:t._endPointFillColor;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-index-"+i)+")":(n&&/#/.test(n),n)})).style("stroke",(function(e,i){var n=""==t._endPointBorderColor?e.color:t._endPointBorderColor;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-index-"+i)+")":(n&&/#/.test(n),n)})).style("stroke-width",t._endPointBorderWidth?t._endPointBorderWidth:"0");var h=u.text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(e,i){return t._xScale(e.name)+t._xScale.bandwidth()/2})).attr("y",(function(e,i){return 0==t._positionChoice?t._yScale(e.value)+.8*o+parseFloat(t._rScale(e.value))+.5*parseFloat(t._endPointBorderWidth)+5:1==t._positionChoice?t._yScale(e.value)+.35*o:void 0})).style("font-size",o).style("text-anchor","middle").style("fill",q(t._textLabel.color)).style("font-family",t._textLabel.fontFamily).style("display",t._labelShow?"block":"none");t.defs.selectAll("clipPath").remove();var d=t.defs.selectAll(".lollipop-clipPaths-all").data(e),_=d.enter().append("clipPath").attr("class","lollipop-clipPaths-all").attr("id",(function(e,i){return t.id+"-lollipop-"+i}));_.append("path");var p=_.merge(d).select("path");return p.attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(0)-parseFloat(t._rScale(e.value))-parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:0,type:"horizontal"})})),t._interrupt?(p.attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(0)-parseFloat(t._rScale(e.value))-parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:t._yScale(e.value)+parseFloat(t._rScale(e.value))<0?0:2*(t._yScale(e.value)+parseFloat(t._rScale(e.value)))-t._yScale(0)+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})),h.style("opacity",1)):(t._transition&&0==t._moveStyle?p.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(0)-parseFloat(t._rScale(e.value))-parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:t._yScale(e.value)+parseFloat(t._rScale(e.value))<0?0:2*(t._yScale(e.value)+parseFloat(t._rScale(e.value)))-t._yScale(0)+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})):t._transition&&1==t._moveStyle?p.transition().duration((function(i,n){return t._transition?.9*t._duration/(e.length?e.length:1):0})).delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length?e.length:1)):0})).attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(0)-parseFloat(t._rScale(e.value))-parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:t._yScale(e.value)+parseFloat(t._rScale(e.value))<0?0:2*(t._yScale(e.value)+parseFloat(t._rScale(e.value)))-t._yScale(0)+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})):p.attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(0)-parseFloat(t._rScale(e.value))-parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:t._yScale(e.value)+parseFloat(t._rScale(e.value))<0?0:2*(t._yScale(e.value)+parseFloat(t._rScale(e.value)))-t._yScale(0)+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})),h.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)),t}l.attr("x",(function(e,i){return t._xScale(e.name)+t._xScale.bandwidth()/2-t._lineWidth/2-.5})).attr("y",(function(e,i){return t._yScale(e.value)+parseFloat(t._rScale(e.value))})).attr("width",t._lineWidth).attr("height",(function(e,i){return-t._yScale(e.value)-parseFloat(t._rScale(e.value))+t._yScale(0)<0?0:-t._yScale(e.value)-parseFloat(t._rScale(e.value))+t._yScale(0)})).style("fill",(function(e,i){return/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})),s.attr("r",(function(e,i){return t._rScale(e.value)})).attr("cx",(function(e,i){return t._xScale(e.name)+t._xScale.bandwidth()/2})).attr("cy",(function(e,i){return t._yScale(e.value)})).style("fill",(function(e,i){var n=""==t._endPointFillColor?e.color:t._endPointFillColor;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-index-"+i)+")":(n&&/#/.test(n),n)})).style("stroke",(function(e,i){var n=""==t._endPointBorderColor?e.color:t._endPointBorderColor;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-index-"+i)+")":(n&&/#/.test(n),n)})).style("stroke-width",t._endPointBorderWidth?t._endPointBorderWidth:"0");var g=u.text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(e,i){return t._xScale(e.name)+t._xScale.bandwidth()/2})).attr("y",(function(e,i){return 0==t._positionChoice?t._yScale(e.value)-parseFloat(t._rScale(e.value))-.5*parseFloat(t._endPointBorderWidth)-5:1==t._positionChoice?t._yScale(e.value)+.35*o:void 0})).style("font-size",o).style("text-anchor","middle").style("fill",q(t._textLabel.color)).style("font-family",t._textLabel.fontFamily).style("display",t._labelShow?"block":"none");t.defs.selectAll("clipPath").remove();var v=t.defs.selectAll(".lollipop-clipPaths-all").data(e),m=v.enter().append("clipPath").attr("class","lollipop-clipPaths-all").attr("id",(function(e,i){return t.id+"-lollipop-"+i}));m.append("path");var b=m.merge(v).select("path");b.attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale.domain()[0]<0?n-(n-t._yScale(0)):n+2*o+parseFloat(t._rScale(e.value))+parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:n-t._yScale(e.value)+parseFloat(t._rScale(e.value))+2*parseFloat(t._endPointBorderWidth)+2*o,type:"horizontal"})})),t._interrupt?(b.attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(e.value)-parseFloat(t._rScale(e.value))-5-2*o-2*parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:n-t._yScale(e.value)+2*parseFloat(t._rScale(e.value))+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})),g.style("opacity",1)):(t._transition&&0==t._moveStyle?b.transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(e.value)-parseFloat(t._rScale(e.value))-5-2*o-2*parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:n-t._yScale(e.value)+2*parseFloat(t._rScale(e.value))+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})):t._transition&&1==t._moveStyle?b.transition().duration((function(i,n){return t._transition?.9*t._duration/(e.length?e.length:1):0})).delay((function(i,n){return t._transition?t._startDelay+n*(.9*t._duration/(e.length?e.length:1)):0})).attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(e.value)-parseFloat(t._rScale(e.value))-5-2*o-2*parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:n-t._yScale(e.value)+2*parseFloat(t._rScale(e.value))+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})):b.attr("d",(function(e,i){return f({x:i*t._xScale.bandwidth()-t._svgWidth/2,y:t._yScale(e.value)-parseFloat(t._rScale(e.value))-5-2*o-2*parseFloat(t._endPointBorderWidth),width:t._xScale.bandwidth()+t._svgWidth,height:n-t._yScale(e.value)+2*parseFloat(t._rScale(e.value))+5+2*o+2*parseFloat(t._endPointBorderWidth),type:"horizontal"})})),g.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1))}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rScale",value:function(t){return arguments.length?(this._rScale=t,this):this._rScale}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"svgWidth",value:function(t){return arguments.length?(this._svgWidth=t,this):this._svgWidth}}]),e}(at),fl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.selectOverlay=new Ni(i.coreGroup),i.lollipop=new _l(i.coreGroup),i.overlay=new te(i.coreGroup),i.clipArea=new Ut(i.defs),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._labelShow=!0,i._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",suffix:"",positionOptions:["外部","内部"],positionChoice:"外部"},i._bubbleSizeType="area",i._lineWidth="2",i._endPointBorderWidth="1",i._endPointBorderColor="",i._endPointFillColor="",i._minRadius="4",i._maxRadius="32",i._transition=!0,i._easeStyle="",i._duration="1.5",i._startDelay=0,i._moveOptions=["纵向同步拉伸","纵向依次拉伸"],i._moveStyle="纵向依次拉伸",i._endPause=0,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._suffix="",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.lollipop,n=t.xScale,a=t.yScale,r=t.tooltip,l=t.overlay,s=t.grid,u=t.selectOverlay,h=t.clipArea,d=t.heightOfCore,_=t.widthOfCore,f=void 0;if(f="diameter"==t._bubbleSizeType?d3.scaleLinear().domain([0,d3.max(e.map((function(t){return t.value})))]).range([t._minRadius,t._maxRadius]):d3.scaleSqrt().domain([0,d3.max(e.map((function(t){return t.value})))]).range([t._minRadius,t._maxRadius]),s.width(_).height(d).planeX(n.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),l.data(n.domain()).isScalePoint(!1).bandX(n.range()[0]).bandWidth(n.step()).bandHeight(d).onMouseover((function(i,a){if(!(e.length<=0)){var o=[{text:""+e[a].name,color:e[a].color},{text:e[a].valueLabel+": "+E(e[a].value,t._numberStyle,t._decimalPlaces)}];r.data(o).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+n(i)+",0)"),r.move([d3.event.offsetX,d3.event.offsetY]).show()}})).onMousemove((function(){r.move([d3.event.offsetX,d3.event.offsetY]),u.show()})).onMouseout((function(){r.hide(),u.hide()})),u.width(n.step()).height(d).shadowColor("#ccc").hide(),t.mainGroup.selectAll(".linear-gradient").remove(),t._endPointFillColor&&/\[/.test(t._endPointFillColor)){var p=x(t._endPointFillColor),g=[],v=!0,m=!1,b=void 0;try{for(var S,k=p[Symbol.iterator]();!(v=(S=k.next()).done);v=!0){var w=S.value,C=[],O=w.split(":");C.push(q(O[0])),C.push(O[1]),g.push(C)}}catch(t){m=!0,b=t}finally{try{!v&&k.return&&k.return()}finally{if(m)throw b}}var F=g.concat(),L=F.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(L[1]).x1+"%").attr("y1",y(L[1]).y1+"%").attr("x2",y(L[1]).x2+"%").attr("y2",y(L[1]).y2+"%").selectAll("stop").data(F).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._endPointBorderColor&&/\[/.test(t._endPointBorderColor)){var P=x(t._endPointBorderColor),A=[],W=!0,z=!1,M=void 0;try{for(var D,R=P[Symbol.iterator]();!(W=(D=R.next()).done);W=!0){var N=D.value,T=[],B=N.split(":");T.push(q(B[0])),T.push(B[1]),A.push(T)}}catch(t){z=!0,M=t}finally{try{!W&&R.return&&R.return()}finally{if(z)throw M}}var G=A.concat(),X=G.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(X[1]).x1+"%").attr("y1",y(X[1]).y1+"%").attr("x2",y(X[1]).x2+"%").attr("y2",y(X[1]).y2+"%").selectAll("stop").data(G).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(e).xScale(n).yScale(a).rScale(f).interrupt(t._interrupt).width(_).height(d).axisPositonChoice("下面"==t._axisPositonChoiceX?1:0).labelShow(t._labelShow).positionChoice(t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice)).textLabel(t._numberLabel).lineWidth(t._lineWidth).endPointBorderWidth(t._endPointBorderWidth).endPointBorderColor(/\[/.test(t._endPointBorderColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._endPointBorderColor).endPointFillColor(/\[/.test(t._endPointFillColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._endPointFillColor).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveOptions.indexOf(t._moveStyle)).endPause(t._endPause).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).svgWidth(t.widthOfNoMargin),"下面"==t._axisPositonChoiceX?(t.coreGroup.call(o,t.yAxis.width+.5,0),s.translate(t.yAxis.width+.5,0)):(t.coreGroup.call(o,t.yAxis.width+.5,t.xAxis.height),s.translate(t.yAxis.width+.5,t.xAxis.height)),0!=t._clipShow.length?(h.width(_).height(d).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+h.id)+")"),h.update()):(h.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),h.update()),(null==t._clipShow[0]&&null==t._clipShow[1]||""==t._clipShow[0]&&""==t._clipShow[1]||null==t._clipShow[0]&&null==t._clipShow[1])&&(h.width(t._width).height(t._height).paddingVertical([0,0]).paddingHorizontal([0,0]).transition(t._transition).duration(t._duration),h.update(),t.coreGroup.attr("clip-path","")),i.update(),u.update(),l.update(),s.update(),i.elem.style("pointer-events","none")}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t._width-t._marginLeft-t._marginRight,h=t.heightOfMainGroup;n.domain(t._xDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),a.domain(t._yDomain),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);for(var d=[],_=[],f=[],p=0;p<t.activeData.length;p++)t.activeData[p].value<0&&f.push(t.activeData[p].value),null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?(d.push(0),_.push(0)):1==t._labelShow&&0==t._positionOptions.indexOf(t._positionChoice)?parseFloat(t.activeData[p].value)>0||0==parseFloat(t.activeData[p].value)?_.push(getTextLengthPx(t.activeData[p].value+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):parseFloat(t.activeData[p].value)<0&&d.push(getTextLengthPx(t.activeData[p].value+t._suffix,t._textLabel.fontSize,t._textLabel.fontFamily)):(d.push(0),_.push(0));i&&i.titleHeight;var y=t._tickCount?t._tickCount:(c-i.allowedMaxTextWidth())/(3*u);e.compute(),i.tickCount(y).compute();var x=0==d.length?0:d3.max(d),g=c-i.width-(0==_.length?0:d3.max(_));i.compute(),n.range([x,g]),e.compute();var v=e._axisStart,m=e._axisEnd,b=0==d.length?0:d3.max(d);v<b&&(x=Math.abs(v)+b>i.width?Math.abs(v)+b-i.width:0),m>g&&(g-=m-g),t.gridStart=x,t.gridEnd=g,n.range([x,g]),a.range([h-e.height,0]);var S=i.width,k=h-e.height,w=i.width+x,C=0;((0==d.length?0:d3.max(d))>0||f.length>0)&&(w=i.width);var O=e.height;"上面"==t._axisPositonChoiceX?(k=O,C=O):k=(t._axisPositonChoiceX,h-O),e.translate(S,k).update(),i.translate(w,C).update()}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e.map((function(t){return t.name})):[0,1],a=e.length?[1.2*Math.min(d3.min(e,(function(t){return+t.value})),0),Math.max(1.2*d3.max(e,(function(t){return+t.value})),0)]:[0,1];"上面"==t._axisPositonChoiceX?t._yDomain=[isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1]),isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0])]:t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])],t._xDomain=n}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range).yRange(a.range).clipShow(a.range).clipShowX(n.range).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o.numberLabel?o.numberLabel.show:this._labelShow,this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel,this._suffix=o.numberLabel&&o.numberLabel.suffix?o.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(e).length&&(this._bubbleSizeType=e.bubbleSizeType?e.bubbleSizeType:this._bubbleSizeType,this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._minRadius=0==e.minRadius||e.minRadius?e.minRadius:this._minRadius,this._maxRadius=0==e.maxRadius||e.maxRadius?e.maxRadius:this._maxRadius,this._endPointBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._endPointBorderWidth,this._endPointBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._endPointFillColor=e.bubbleFillColor?q(e.bubbleFillColor):""),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}}]),e}(Tt),pl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","vertical-dumbbell-plot"),i._xScale=null,i._yScale=null,i._rectObj=null,i._textObj=null,i._fillColor="",i._strokeColor="",i._strokeWidth="",i._fillOpacity=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;t.group.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var a=n.selectAll("g").data(e,(function(t){return t.key}));a.exit().remove();var o=a.enter().append("g").attr("class","vertical-dumbbell-group").merge(a).each((function(i,n){if(0==n){var a=d3.select(this).selectAll("line").data(i.data);a.exit().remove();var o=a.enter().append("line").attr("class","vertical-dumbbell-line").attr("x1",(function(e){return t._xScale(e.name)+t._xScale.step()/2})).attr("y1",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return t._yScale(i.value)})).attr("x2",(function(e){return t._xScale(e.name)+t._xScale.step()/2+1e-4})).attr("y2",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return t._yScale(i.value)})).attr("stroke-width",t._lineWidth).style("stroke",(function(n,a){var o=i.color,r=0;return e.length<=1?o=i.color:d3.max([e[0].data[a].value,e[1].data[a].value])==e[0].data[a].value?(o=e[0].color,r=0):d3.max([e[0].data[a].value,e[1].data[a].value])==e[1].data[a].value&&(o=e[1].color,r=1),(o=t._lineColor||o)&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+r)+")":(o&&/#/.test(o),o)}));t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||2!=t._moveOptions.indexOf(t._moveStyle)?o.attr("y1",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return t._yScale(i.value)})).attr("y2",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return e.length>1?t._yScale(e[1].data[n].value):t._yScale(i.value)})):2==t._moveOptions.indexOf(t._moveStyle)&&o.transition().duration(t._transition?.9*t._duration/(e.length>0?e[0].data.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e[0].data.length:1)*n:0})).attr("y1",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return t._yScale(i.value)})).attr("y2",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return e.length>1?t._yScale(e[1].data[n].value):t._yScale(i.value)}))}var r=d3.select(this).selectAll("circle").data(i.data);r.exit().remove();var l=r.enter().append("circle").attr("class","vertical-dumbbell-circle").attr("cx",(function(e){return t._xScale(e.name)+t._xScale.step()/2})).attr("cy",(function(i,n){return e.length>0?t._yScale(e[0].data[n].value):t._yScale(i.value)})).attr("r",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return t._radius})).attr("stroke-width",(function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return 0}else if(null==e[0].data[n].value)return 0;return t._strokeWidth})).style("stroke",t._strokeColor||(/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":i.color)).style("fill",(function(e,a){return i.color&&/\[/.test(i.color)?"url("+c("#"+t.id+"-index-"+n)+")":(i.color&&/#/.test(i.color),i.color)})).style("opacity",0);t._interrupt||null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||2!=t._moveOptions.indexOf(t._moveStyle)?l.style("opacity",1).attr("cy",(function(e){return t._yScale(e.value)})):2==t._moveOptions.indexOf(t._moveStyle)&&l.transition().duration(t._transition?.9*t._duration/(e.length>0?e[0].data.length:1):0).delay((function(i,n){return t._transition?t._startDelay+.9*t._duration/(e.length>0?e[0].data.length:1)*n:0})).attr("cy",(function(e){return t._yScale(e.value)})).style("opacity",1)})),r=n.append("g").selectAll("g").data(e);r.exit().remove(),r.enter().append("g").attr("class","vertical-dumbbell-textGroup").merge(r).each((function(i,n){var a=d3.select(this).selectAll("text").data(i.data);a.exit().remove();var o=a.enter().append("text").attr("class","vertical-dumbbell-text").merge(a).text((function(i,n){if(e.length>1){if(null==e[0].data[n].value||null==e[1].data[n].value)return""}else if(null==e[0].data[n].value)return"";return E(i.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("text-anchor","middle").attr("fill",t._fontColor).attr("font-size",t._fontSize).attr("font-family",t._fontFamily).attr("x",(function(e){return t._xScale(e.name)+t._xScale.step()/2})).attr("y",(function(i,n){return e.length<=1||d3.max([e[0].data[n].value,e[1].data[n].value])==i.value?t._yScale(i.value)-5-t._strokeWidth-t._radius:t._yScale(i.value)+t._fontSize/1.2+5+t._strokeWidth+t._radius})).style("display",t._labelShow?"block":"none");t._interrupt?o.style("opacity",1):o.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?.9*t._duration+t._startDelay:0).style("opacity",1)})),o.on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),0==t._labelShow||null==t._labelShow||null==t._positionOptions||null==t._positionChoice||-1==t._positionOptions.indexOf(t._positionChoice)?n.selectAll(".vertical-dumbbell-text").style("display","none"):n.selectAll(".vertical-dumbbell-text").style("display","block");for(var l=n.selectAll(".vertical-dumbbell-text"),s=[],u=[],h=0;h<l._groups[0].length;h++){u.push(h);for(var d=h+1;d<l._groups[0].length;d++){p(i(d3.select(l._groups[0][h])),i(d3.select(l._groups[0][d])))&&(s.push(h),d3.select(l._groups[0][h]).style("visibility","hidden"))}}for(var _=new Set(s),f=Array.from(_),g=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(f,u),v=0;v<f.length;v++){for(var m=[],b=0;b<g.length;b++){var S=i(d3.select(l._groups[0][f[v]])),k=i(d3.select(l._groups[0][g[b]]));if(m.push(p(S,k)),p(S,k)){if(f[v]==g[b])continue;d3.select(l._groups[0][f[v]]).style("visibility","hidden")}}0==m.filter((function(t){return 1==t})).length&&g.push(f[v])}for(var w=0;w<g.length;w++)d3.select(l._groups[0][g[w]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"radius",value:function(t){return arguments.length?(this._radius=parseFloat(t),this):this._radius}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=parseFloat(t),this):this._lineWidth}},{key:"lineColor",value:function(t){return arguments.length?(this._lineColor=t,this):this._lineColor}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this._positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this._positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"rectObj",value:function(t){return arguments.length?(this._rectObj=t,this):this._rectObj}},{key:"textObj",value:function(t){return arguments.length?(this._textObj=t,this):this._textObj}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"fillColor",value:function(t){return arguments.length?(this._fillColor=t,this):this._fillColor}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),yl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","vertical-dumbbell-chart"),i.grid=new Jt(i.coreGroup),i.clipArea=new Ut(i.defs),i.xAxis=new jt(i.mainGroup),i.yAxis=new Ht(i.mainGroup),i.xAxis.minTickDistance(5),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.rectPlot=new pl(i.coreGroup),i.selectOverlay=new Ni(i.coreGroup),i.overlay=new te(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleLinear(),i._xType="category",i._yType="number",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._lineWidth=2,i._endPointRadius=3.5,i._endPointBorderWidth=1,i._lineColor=null,i._endPointBorderColor="#FFFFFF",i._labelShow=!1,i._positionOptions=["上下","内部差值"],i._positionChoice="上下",i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向展开","横向展开","阶梯"],i._moveStyle="纵向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=e,n=t.grid,a=t.tooltip,o=t.rectPlot,r=t.overlay,l=t.selectOverlay,s=t.clipArea,u=t.xScale,h=t.yScale,d=(t.xAxis._axisStart,t.xAxis._axisEnd),_=0;d>t.widthOfNoMargin-t.yAxis.width&&(_=d-(t.widthOfNoMargin-t.yAxis.width));var f=t.widthOfCore-_,p=t.heightOfCore;1.1*Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0)<0?(t.group.selectAll(".axis-x-line path").attr("transform","translate(0, "+-(h.range()[0]-h(0))+")"),t.group.selectAll(".axis-x-line line").attr("transform","translate(0, "+-(h.range()[0]-h(0))+")")):(t.group.selectAll(".axis-x-line path").attr("transform","translate(0,0)"),t.group.selectAll(".axis-x-line line").attr("transform","translate(0,0)"));var g=t.defs;g.selectAll("filter").remove();var v=g.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");if(v.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),v.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),v.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),v.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),v.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),r.data(u.domain()).isScalePoint(!1).bandWidth(u.step()).bandHeight(p).bandX(u.range()[0]).onMouseover((function(i,n){var o=i,r=[{text:o=="&-"+(n+1)?"":o}],l=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===o}));l.push({key:e.key,name:e.name,color:e.color,data:n}),r.push({text:(e.name=="$-"+(i+1)?"":e.name)+": "+(isNaN(parseFloat(n[0].value))?"":E(n[0].value,t._numberStyle,t._decimalPlaces)),color:e.color})})),a.data(r).update(),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate("+u(o)+",0)"),a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),l.show()})).onMouseout((function(){a.hide(),l.hide()})),t.mainGroup.selectAll(".linear-gradient").remove(),t._endPointBorderColor&&/\[/.test(t._endPointBorderColor)){var m=x(t._endPointBorderColor),b=[],S=!0,k=!1,w=void 0;try{for(var C,O=m[Symbol.iterator]();!(S=(C=O.next()).done);S=!0){var F=C.value,L=[],P=F.split(":");L.push(q(P[0])),L.push(P[1]),b.push(L)}}catch(t){k=!0,w=t}finally{try{!S&&O.return&&O.return()}finally{if(k)throw w}}var A=b.concat(),W=A.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(W[1]).x1+"%").attr("y1",y(W[1]).y1+"%").attr("x2",y(W[1]).x2+"%").attr("y2",y(W[1]).y2+"%").selectAll("stop").data(A).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._lineColor&&/\[/.test(t._lineColor)){var z=x(t._lineColor),M=[],D=!0,R=!1,N=void 0;try{for(var T,B=z[Symbol.iterator]();!(D=(T=B.next()).done);D=!0){var G=T.value,X=[],j=G.split(":");X.push(q(j[0])),X.push(j[1]),M.push(X)}}catch(t){R=!0,N=t}finally{try{!D&&B.return&&B.return()}finally{if(R)throw N}}var I=M.concat(),Y=I.pop();t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-1").attr("x1",y(Y[1]).x1+"%").attr("y1",y(Y[1]).y1+"%").attr("x2",y(Y[1]).x2+"%").attr("y2",y(Y[1]).y2+"%").selectAll("stop").data(I).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}o.data(i).xScale(u).yScale(h).suffix(t._suffix).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(this._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).lineWidth(t._lineWidth).lineColor(/\[/.test(t._lineColor)?"url("+c("#"+t.id+"-main-border-index-1")+")":t._lineColor).strokeWidth(t._endPointBorderWidth).strokeColor(/\[/.test(t._endPointBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._endPointBorderColor).radius(t._endPointRadius).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).textObj({colorFunc:function(){return q(t._textLabel.color)}}),n.width(f).height(p).planeX(u.range()[0]).xTickLocations(t.xAxis.tickLocations.slice(1)).yTickLocations(t.yAxis.tickLocations.slice(1)).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),s.width(f).height(p).paddingVertical([0,0]).transition(t._transition).duration(t._duration),l.width(u.step()).height(p).shadowColor("#ccc").hide();var H=t.yAxis.width+1;t.coreGroup.attr("transform","translate("+H+",0)"),0!=t._clipShow.length?(s.width(f).height(p).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path","url("+c("#"+s.id)+")"),s.update()):(s.width(t._width).height(t._height).paddingVertical([0,0]).transition(t._transition).duration(t._duration),t.coreGroup.attr("clip-path",""),s.update());var V=t.group.selectAll(".range-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));if(d3.selectAll(V).remove(),o.update(),l.update(),r.update(),n.translate(H,0).update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle))t.coreGroup.select(".vertical-dumbbell-group").attr("clip-path","");else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.coreGroup.selectAll(".vertical-dumbbell-group").attr("clip-path","");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",f+2*parseFloat(t._endPointRadius)-u.range()[0]).attr("y",p+2*parseFloat(t._endPointBorderWidth)+2*parseFloat(t._endPointRadius)+2*t._textLabel.fontSize).attr("x",-parseFloat(t._endPointRadius)+u.range()[0]).attr("height",0).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("y",-parseFloat(t._endPointBorderWidth)-parseFloat(t._endPointRadius)-t._textLabel.fontSize).attr("height",p+2*parseFloat(t._endPointBorderWidth)+2*parseFloat(t._endPointRadius)+2*t._textLabel.fontSize),t.coreGroup.selectAll(".vertical-dumbbell-group").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}else if(1==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.coreGroup.selectAll(".vertical-dumbbell-group").attr("clip-path","");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",0).attr("y",-parseFloat(t._endPointBorderWidth)-2*parseFloat(t._endPointRadius)).attr("x",-parseFloat(t._endPointRadius)+u.range()[0]).attr("height",t._height+2*parseFloat(t._endPointBorderWidth)+2*parseFloat(t._endPointRadius)).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("width",f+2*parseFloat(t._endPointRadius)-u.range()[0]),t.coreGroup.selectAll(".vertical-dumbbell-group").attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient,u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;var d=(h-e.allowedMaxTextHeight())/(2*u);i.tickCount(d),i.compute();var _=0,f=c-i.width;i.compute(),n.range([_,f]),e.compute();var p=e._axisStart,y=e._axisEnd;p<0&&(_=Math.abs(p)>i.width?Math.abs(p)-i.width:0),y>f&&(f-=y-f),n.range([_,f]);var x=t.activeData,g=d3.scaleLinear().range([0,h-e.height]).domain([Math.min(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(x,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]),v=d3.scaleLinear().domain([0,h-e.height]).range([Math.min(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(x,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]),m=0;t._labelShow&&g(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})))<parseFloat(t._textLabel.fontSize)&&(m=v(-parseFloat(t._textLabel.fontSize))),a.domain([Math.min(d3.min(x,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0)+m,1.1*d3.max(x,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]),a.range([h-e.height,0]);var b=i.width,S=h-e.height,k=i.width+_;e.translate(b,S).update(),i.translate(k,0).update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"curve",value:function(t){return arguments.length?(this._curve="function"==typeof t?t:d3.curveCardinal,this):this._curve}},{key:"buildOption",value:function(t,e){var i=new it(t,e),n=$a;return i.dataSolveFunc(n),i}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._lineWidth=0==e.lineWidth||e.lineWidth?e.lineWidth:this._lineWidth,this._endPointRadius=0==e.endPointRadius||e.endPointRadius?e.endPointRadius:this._endPointRadius,this._endPointBorderWidth=0==e.endPointBorderWidth||e.endPointBorderWidth?e.endPointBorderWidth:this._endPointBorderWidth,this._lineColor=e.lineColor?q(e.lineColor):"",this._endPointBorderColor=e.endPointBorderColor?q(e.endPointBorderColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=t._yRange||[],n=e.length?e[0].data.map((function(t){return t.name})):[0,1],a=e.length?[Math.min(d3.min(e,(function(t){return d3.min(t.data,(function(t){return+t.value}))})),0),1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.value}))}))]:[0,1];t._xDomain=n,t._yDomain=[isNaN(parseFloat(i[0]))?a[0]:parseFloat(i[0]),isNaN(parseFloat(i[1]))?isNaN(parseFloat(i[0]))?a[1]:a[1]<i[0]?1.5*i[0]:a[1]:parseFloat(i[1])]}}]),e}(Tt);function xl(t,e){var i=0,n=1,a=2;if(e.forEach((function(t){"typeCol"===t.function?i=t.index:"objCol"===t.function?n=t.index:"vCol"===t.function&&(a=t.index)})),null==i&&(i=n),null==n&&(n=i),P(t,[i,n,a])||!A(t,a))return{nodes:[],valueLabel:""};var o={};t.slice(1).forEach((function(t,e){var r=t[i],l=t[n],s=t[a];o[r]?o[r].children.push({name:null==l?"":l,key:l+"-t-"+e,index:e,value:""==s||isNaN(parseFloat(s))||null==s||null==s?0:Math.abs(s)}):o[r]={name:r,key:r+"-s-"+e,index:e,children:[{name:null==l?"":l,key:l+"-t-"+e,index:e,value:""==s||isNaN(parseFloat(s))||null==s||null==s?0:Math.abs(s)}]}}));var r=[];for(var l in o)r.push(o[l]);return r.forEach((function(t){return t.sum=d3.sum(t.children,(function(t){return t.value}))})),{nodes:r,valueLabel:t[0][a]}}var gl=function(t){function e(t){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return w(e,t),S(e,[{key:"updateCore",value:function(){}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.nodes,i=e.map((function(t,e){return{name:t.name,color:t.color,key:t.name+"-"+e}}));t.legend.data(i).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),i.forEach((function(t){t.key===n.key&&(t.active=!a)})),e.forEach((function(t){t.name===n.name&&(t.active=!a)})),t.onDataChange()}))}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new Re(t,e);return i.dataSolveFunc(xl),i}},{key:"setSelfOption",value:function(t){var e=t.animation,i=t.unitDisplay,n=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._transition=e?e.transition:this._transition,this._duration=e?e.duration:this._duration,this._startDelay=e?e.startDelay:this._startDelay,this._moveStyle=e.moveStyle?e.moveStyle:this._moveStyle,this._endPause=e.endPause?e.endPause:this._endPause),0!==Object.getOwnPropertyNames(i).length&&(this._unitShow=i?i.show:this._unitShow,this._unitWord=i?i.text:this._unitWord,this._unitFontSize=i.fontSize?i.fontSize:this._unitSize,this._unitFontColor=i.color?q(i.color):this._unitColor,this._unitFontFamily=i.fontFamily?i.fontFamily:this._unitFamily,this._unitX=i.xPosition?i.xPosition:this._unitX,this._unitY=i.yPosition?i.yPosition:this._unitY),0!==Object.getOwnPropertyNames(n).length&&(this._sourceShow=n?n.show:this._sourceShow,this._sourceWord=n?n.text:this._sourceWord,this._sourceFontSize=n.fontSize?n.fontSize:this._sourceSize,this._sourceFontColor=n.color?q(n.color):this._sourceColor,this._sourceFontFamily=n.fontFamily?n.fontFamily:this._sourceFamily,this._sourceX=n.xPosition?n.xPosition:this._sourceX,this._sourceY=n.yPosition?n.yPosition:this._sourceY)}},{key:"activeData",get:function(){return{children:this.sortedDataCopy.nodes.filter((function(t){return!1!==t.active}))}}}]),e}(nt),vl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","group-aggregation-bubble"),i._clipId="clip-overlay-"+i.id,i.overlayRect=i.elem.append("defs").append("clipPath").attr("id",i._clipId).append("rect"),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleLinear(),i._width=400,i._height=400,i._paddingInner=0,i._paddingOuter=0,i._stroke="#fff",i._parentFillOpacity=.7,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this;t.group.attr("clip-path","url("+c("#"+t._clipId)+")");var e=t._data,n=t.group,a=t._contentChoice,o=t._contentOption,r=t._positionChoice,l=t._textLabel.fontSize,s=t._textLabel.fontFamily,u=q(t._textLabel.color),h=parseFloat(t._strokeWidth);if(t._labelShow||(l=0),e.children.length<1)return n.selectAll("*").remove(),t;n.selectAll("*").remove();var d=t._width,_=t._height,f=d3.hierarchy(e).sum((function(t){return t.value})),g=d3.max(f.leaves(),(function(t){return t.value})),v=d3.min(f.leaves(),(function(t){return t.value})),m=d3.scaleSqrt().domain([v,g]).range([t._minRadius,t._maxRadius]);"diameter"==t._bubbleSizeType&&(m=d3.scaleLinear().domain([v,g]).range([t._minRadius,t._maxRadius]));var b=d3.hierarchy({children:f.leaves()}).sum((function(t){return t.value})),S=d3.pack().size([d,_]).padding(t._strokeWidth+3).radius((function(t){return m(t.value)}));function k(t,e,i){return R(t,l,s)}if(S(f),S(b),t.overlayRect.attr("x",.5*-t._strokeWidth).attr("y",.5*-t._strokeWidth).attr("width",d+1*t._strokeWidth).attr("height",_+1*t._strokeWidth),"grouping"==t._arrangement){var w=function(t,e){var i=t,n=parseFloat(e),o=void 0;return o=2==a.length?d3.max([1.1*parseFloat(l),n]):d3.max([.6*parseFloat(l),n]),i>_-o?_-o:i<o?o:i},C=function(e,i,n,a){var o=E(a,t._numberStyle,t._decimalPlaces),l=parseFloat(i),s=e,u=0;return 1==r?u=.5*d3.max([k(n),k(o)]):0==r&&(u=1*d3.max([k(n),k(o)])+5+l),s<u?u:s>d-u?d-u:s},O=f.leaves();O.forEach((function(e,i){if(e.parent.data.color&&/\[/.test(e.parent.data.color)){var n=x(e.parent.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));for(var F=d3.forceSimulation(O).force("x",d3.forceX(d/2).strength(.1)).force("y",d3.forceY(_/2).strength(.1)).force("collide",function(){var e=.4,i=2+t._strokeWidth,n=d3.min([_,d])/2.5+t._strokeWidth,a=void 0,o=void 0;function r(){var t=d3.quadtree(a,(function(t){return t.x}),(function(t){return t.y})),r=function(a){var r=a.r+o,l=a.x-r,s=a.y-r,u=a.x+r,c=a.y+r;t.visit((function(t,o,r,h,d){if(!t.length)do{if(t.data!==a){var _=a.r+t.data.r+(a.parent.data.key===t.data.parent.data.key?i:n),f=a.x-t.data.x,p=a.y-t.data.y,y=Math.hypot(f,p);y<_&&(y=(y-_)/y*e,a.x-=f*=y,a.y-=p*=y,t.data.x+=f,t.data.y+=p)}}while(t=t.next);return o>u||h<l||r>c||d<s}))},l=!0,s=!1,u=void 0;try{for(var c,h=a[Symbol.iterator]();!(l=(c=h.next()).done);l=!0){r(c.value)}}catch(t){s=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(s)throw u}}}return r.initialize=function(t){return o=d3.max(a=t,(function(t){return t.r}))+Math.max(i,n)},r}()).stop(),L=t.group.selectAll("circle").data(O).enter().append("circle").attr("r",(function(t){return t.r})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.parent.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.parent.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.parent.data.color&&/\[/.test(e.parent.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.parent.data.color&&/#/.test(e.parent.data.color)?e.parent.data.color:"rgb("+U(e.parent.data.color,0)+","+U(e.parent.data.color,1)+","+U(e.parent.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.parent.data.color&&/#/.test(e.parent.data.color))return t._fillOpacity;var i=U(e.parent.data.color,3)||1;return t._fillOpacity*i})),P=0,A=Math.ceil(Math.log(F.alphaMin())/Math.log(1-F.alphaDecay()));P<A;++P)F.tick();L.attr("cx",(function(t){return C(t.x,t.r,t.data.name,t.value)})).attr("cy",(function(t){return w(t.y,t.r)}));var W=t.group.append("g").selectAll("g").data(O).enter().append("g").attr("class","group-aggregation-bubble-labels"),z=W.append("text").style("fill",u).style("font-family",s).style("font-size",l).attr("x",(function(t){return C(t.x,t.r,t.data.name,t.value)})).attr("y",(function(t){return w(t.y,t.r)})).attr("dy",2==a.length?"0":"0.35em").attr("dx",(function(e,i){return 0!=r?0:2==a.length?k(e.data.name)>=2*e.r||k(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:1==a.length&&0==o.indexOf(a[0])?k(e.data.name)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:void 0})).attr("text-anchor",(function(e){return 0!=r?"middle":2==a.length?k(e.data.name)>=2*e.r||k(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?"end":"start":"middle":1==a.length&&0==o.indexOf(a[0])?k(e.data.name)>=2*e.r?e.x<d/2?"end":"start":"middle":void 0})).text((function(t){return t.data.name})).style("display",t._labelShow?"block":"none"),M=W.append("text").style("fill",u).style("font-family",s).style("font-size",l).attr("x",(function(t){return C(t.x,t.r,t.data.name,t.value)})).attr("y",(function(t){return w(t.y,t.r)})).attr("dy",2==a.length?"1em":"0.35em").attr("dx",(function(e,i){return 0!=r?0:2==a.length?k(e.data.name)>=2*e.r||k(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:1==a.length&&1==o.indexOf(a[0])?k(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:void 0})).attr("text-anchor",(function(e){return 0!=r?"middle":2==a.length?k(e.data.name)>=2*e.r||k(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?"end":"start":"middle":1==a.length&&1==o.indexOf(a[0])?k(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?"end":"start":"middle":void 0})).text((function(e){return E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("display",t._labelShow?"block":"none");1==a.length&&0==o.indexOf(a[0])?M.style("display","none"):1==a.length&&1==o.indexOf(a[0])?z.style("display","none"):0==a.length&&(M.style("display","none"),z.style("display","none")),t._interrupt?L.style("opacity",1):(L.style("opacity",0).transition().duration(t._transition?.9*t._duration/(O.length>0?O.length:1):0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration/(O.length>0?O.length:1)*i:0})).style("opacity",1),z.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),M.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)),L.on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);for(var D=t.group.selectAll(".group-aggregation-bubble-labels"),N=[],T=[],B=0;B<D._groups[0].length;B++){T.push(B);for(var G=B+1;G<D._groups[0].length;G++){p(i(d3.select(D._groups[0][B])),i(d3.select(D._groups[0][G])))&&(N.push(B),d3.select(D._groups[0][B]).style("visibility","hidden"))}}for(var X=new Set(N),j=Array.from(X),I=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(j,T),Y=0;Y<j.length;Y++){for(var H=[],V=0;V<I.length;V++){var $=i(d3.select(D._groups[0][j[Y]])),Z=i(d3.select(D._groups[0][I[V]]));if(H.push(p($,Z)),p($,Z)){if(j[Y]==I[V])continue;d3.select(D._groups[0][j[Y]]).style("visibility","hidden")}}0==H.filter((function(t){return 1==t})).length&&I.push(j[Y])}for(var Q=0;Q<I.length;Q++)d3.select(D._groups[0][I[Q]]).style("visibility","visible")}else{var K=b.leaves();K.forEach((function(e,i){if(e.data.parent.data.color&&/\[/.test(e.data.parent.data.color)){var n=x(e.data.parent.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var J=t.group.selectAll("circle").data(K).enter().append("circle").attr("r",(function(t){return t.r})).style("stroke",(function(e,i){return t._strokeColor||(/\[/.test(e.data.parent.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.parent.data.color)})).style("stroke-width",t._strokeWidth).style("fill",(function(e,i){return e.data.parent.data.color&&/\[/.test(e.data.parent.data.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.data.parent.data.color&&/#/.test(e.data.parent.data.color)?e.data.parent.data.color:"rgb("+U(e.data.parent.data.color,0)+","+U(e.data.parent.data.color,1)+","+U(e.data.parent.data.color,2)+")"})).style("fill-opacity",(function(e){if(e.data.parent.data.color&&/#/.test(e.data.parent.data.color))return t._fillOpacity;var i=U(e.data.parent.data.color,3)||1;return t._fillOpacity*i})).attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})),tt=t.group.append("g").selectAll("g").data(K).enter().append("g").attr("class","group-aggregation-bubble-labels"),et=tt.append("text").style("fill",u).style("font-family",s).style("font-size",l).attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("dy",2==a.length?"0":"0.35em").attr("dx",(function(e,i){return 0!=r?0:2==a.length?k(e.data.data.name)>=2*e.r||k(E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:1==a.length&&0==o.indexOf(a[0])?k(e.data.data.name)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:void 0})).attr("text-anchor",(function(e){return 0!=r?"middle":2==a.length?k(e.data.data.name)>=2*e.r||k(E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?"end":"start":"middle":1==a.length&&0==o.indexOf(a[0])?k(e.data.data.name)>=2*e.r?e.x<d/2?"end":"start":"middle":void 0})).text((function(t){return t.data.data.name})).style("display",t._labelShow?"block":"none"),it=tt.append("text").style("fill",u).style("font-family",s).style("font-size",l).attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})).attr("dy",2==a.length?"1em":"0.35em").attr("dx",(function(e,i){return 0!=r?0:2==a.length?k(e.data.data.name)>=2*e.r||k(E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:1==a.length&&1==o.indexOf(a[0])?k(E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?-e.r-5-h:e.r+5+h:0:void 0})).attr("text-anchor",(function(e){return 0!=r?"middle":2==a.length?k(e.data.data.name)>=2*e.r||k(E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?"end":"start":"middle":1==a.length&&1==o.indexOf(a[0])?k(E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix)>=2*e.r?e.x<d/2?"end":"start":"middle":void 0})).text((function(e){return E(e.data.data.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("display",t._labelShow?"block":"none");1==a.length&&0==o.indexOf(a[0])?it.style("display","none"):1==a.length&&1==o.indexOf(a[0])?et.style("display","none"):0==a.length&&(it.style("display","none"),et.style("display","none")),t._interrupt?J.style("opacity",1):(J.style("opacity",0).transition().duration(t._transition?.9*t._duration/(K.length>0?K.length:1):0).delay((function(e,i){return t._transition?t._startDelay+.9*t._duration/(K.length>0?K.length:1)*i:0})).style("opacity",1),et.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),it.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)),J.on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);for(var nt=t.group.selectAll(".group-aggregation-bubble-labels"),at=[],ot=[],rt=0;rt<nt._groups[0].length;rt++){ot.push(rt);for(var lt=rt+1;lt<nt._groups[0].length;lt++){p(i(d3.select(nt._groups[0][rt])),i(d3.select(nt._groups[0][lt])))&&(at.push(rt),d3.select(nt._groups[0][rt]).style("visibility","hidden"))}}for(var st=new Set(at),ut=Array.from(st),ct=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(ut,ot),ht=0;ht<ut.length;ht++){for(var dt=[],_t=0;_t<ct.length;_t++){var ft=i(d3.select(nt._groups[0][ut[ht]])),pt=i(d3.select(nt._groups[0][ct[_t]]));if(dt.push(p(ft,pt)),p(ft,pt)){if(ut[ht]==ct[_t])continue;d3.select(nt._groups[0][ut[ht]]).style("visibility","hidden")}}0==dt.filter((function(t){return 1==t})).length&&ct.push(ut[ht])}for(var yt=0;yt<ct.length;yt++)d3.select(nt._groups[0][ct[yt]]).style("visibility","visible")}return t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"bubbleSizeType",value:function(t){return arguments.length?(this._bubbleSizeType=t,this):this._bubbleSizeType}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"minRadius",value:function(t){return arguments.length?(this._minRadius=parseFloat(t),this):this._minRadius}},{key:"maxRadius",value:function(t){return arguments.length?(this._maxRadius=parseFloat(t),this):this._maxRadius}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this._contentChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this._contentOption}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=parseFloat(t),this):this._positionChoice}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"arrangement",value:function(t){return arguments.length?(this._arrangement=t,this):this._arrangement}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}}]),e}(at),ml=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","group-aggregation-bubble-chart"),i.bubble=new vl(i.mainGroup),i._sortValue=null,i._labelShow=!0,i._positionOptions=["自动","内部居中"],i._positionChoice="内部居中",i._contentOption=["名称","数值"],i._contentChoice=["名称"],i._textLabel={color:"#313131",fontFamily:"noto",fontSize:12},i._suffix="",i._arrangement="polymerization",i._bubbleSizeType="area",i._bubbleBorderColor="",i._bubbleBorderWidth=1,i._minRadius=0,i._maxRadius=32,i._fillOpacity=.9,i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="依次出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.bubble,i=t.tooltip,n=t.widthOfNoMargin,a=.96*t.heightOfMainGroup;t._data.valueLabel,t._fontSize,t._fontFamily,t.activeData;if(t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var o=x(t._bubbleBorderColor),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,f=[],p=_.split(":");f.push(q(p[0])),f.push(p[1]),r.push(f)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var g=r.concat(),v=g.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).width(n).height(a).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).minRadius(t._minRadius).maxRadius(t._maxRadius).bubbleSizeType(t._bubbleSizeType).arrangement(t._arrangement).strokeWidth(t._bubbleBorderWidth).strokeColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).fillOpacity(t._fillOpacity).contentChoice(t._contentChoice).contentOption(t._contentOption).positionChoice(t._positionOptions.indexOf(t._positionChoice)).textLabel(t._textLabel).labelShow(t._labelShow).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e){var n=[{color:e.data.color||e.parent.data.color||e.data.parent.data.color,text:e.parent.data.name||e.data.parent.data.name},{text:(e.data.name||e.data.data.name)+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){i.hide()})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return e.sum-t.sum||t.index-e.index}))})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return t.sum-e.sum||t.index-e.index}))})),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._arrangement=e.arrangement?e.arrangement:this._arrangement,this._bubbleSizeType=e.bubbleSizeType?e.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._bubbleBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._bubbleBorderWidth,this._minRadius=0==e.minRadius||e.minRadius?e.minRadius:this._minRadius,this._maxRadius=0==e.maxRadius||e.maxRadius?e.maxRadius:this._maxRadius,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._suffix=i.suffix?i.suffix:"")}}]),e}(gl),bl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","triangleScatter"),i._width=400,i._height=400,i._paddingInner=1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,i=t.group;i.selectAll("*").remove();var n=t._rScale,a=t._bubbleBorderColor,o=t._bubbleBorderWidth,r=(t._fillOpacity,t._width),l=t._height,s=t._fontColor,u=t._fontFamily,h=parseFloat(t._fontSize);t._transition,t._duration,t._startDelay,t._moveStyle;t.group.selectAll(".triangle-hover-gradient").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=(p=e.color,new Function("return "+p)()),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("class","triangle-hover-gradient").attr("id",t.id+"-triangle-hover-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var p}));0==t._axisY.labelShow&&t._axisZ.labelShow,t._axisX.labelShow,t._axisX.name;function d(t,e){var i=O(t,2),n=i[0],a=i[1],o=O(e,2),r=o[0],l=o[1];return function(t){return[n+t*(r-n),a+t*(l-a)]}}var _=null==t._axisX.range[1]||null==t._axisX.range[0]?[0,1]:t._axisX.range[1]>1?[0,100]:[0,1],f=null==t._axisX.range[1]||null==t._axisX.range[0]?[0,1]:t._axisY.range[1]>1?[0,100]:[0,1],p=null==t._axisX.range[1]||null==t._axisX.range[0]?[0,1]:t._axisZ.range[1]>1?[0,100]:[0,1],x=(""==t._axisX.name?0:h+6)+(1==t._axisX.labelShow?h+8:0),g=[t._axisX.name,t._axisY.name,t._axisZ.name],v=d3.min([r-10-4*h,.88*l-x])/2,m=(v-Math.sin(30*Math.PI/180)*v)/2,b=[150,30,-90].map((function(e){return[Math.cos(e*Math.PI/180)*(v+m),Math.sin(e*Math.PI/180)*(v+m)+m-(""==t._axisX.name?0:.65*h)+7]})),S=O(b,3),k=S[0],w=S[1],C=S[2],F=d(w,C),L=d(C,k),P=d(k,w),A=1==t._axisX.labelShow?d3.range(0,_[1],_[1]/4).concat(_[1]):[],W=1==t._axisY.labelShow?d3.range(0,f[1],f[1]/4).concat(f[1]):[],z=1==t._axisZ.labelShow?d3.range(0,p[1],p[1]/4).concat(p[1]):[],M=d3.range(0,1,.25);i.append("path").attr("class","triangle-axis-x").attr("d","M"+k+"L"+w).attr("fill","none").attr("stroke",q(t._axisX.axisColor)).attr("stroke-width",t._axisX.axisLineWidth).style("opacity",t._axisX.axisShow?"1":"0"),i.append("path").attr("class","triangle-axis-y").attr("d","M"+w+"L"+C).attr("fill","none").attr("stroke",q(t._axisY.axisColor)).attr("stroke-width",t._axisY.axisLineWidth).style("opacity",t._axisY.axisShow?"1":"0"),i.append("path").attr("class","triangle-axis-z").attr("d","M"+C+"L"+k).attr("fill","none").attr("stroke",q(t._axisZ.axisColor)).attr("stroke-width",t._axisZ.axisLineWidth).style("opacity",t._axisZ.axisShow?"1":"0");var D=0==t._axisX.axisShow?M.map((function(t){return[F(t),L(1-t)]})):M.slice(1).map((function(t){return[F(t),L(1-t)]})),N=0==t._axisY.axisShow?M.map((function(t){return[L(t),P(1-t)]})):M.slice(1).map((function(t){return[L(t),P(1-t)]})),T=0==t._axisZ.axisShow?M.map((function(t){return[P(t),F(1-t)]})):M.slice(1).map((function(t){return[P(t),F(1-t)]}));i.append("g").attr("class","triangle-grid").selectAll(".grid").data([-1!=t._grid.show.indexOf("x")||"all"==t._grid.show?D:[],-1!=t._grid.show.indexOf("y")||"all"==t._grid.show?N:[],-1!=t._grid.show.indexOf("z")||"all"==t._grid.show?T:[]]).enter().append("g").selectAll(".gridlines").data((function(t){return t})).enter().append("line").attr("x1",(function(t){return t[0][0]})).attr("y1",(function(t){return t[0][1]})).attr("x2",(function(t){return t[1][0]})).attr("y2",(function(t){return t[1][1]})).attr("stroke",q(t._grid.color)).style("opacity",(function(e,i){return"all"==t._grid.show?"1":"none"==t._grid.show?"0":void 0})).attr("stroke-width",t._grid.gridLineWidth).style("stroke-dasharray",(function(){return t._grid.lineStyle?"line"==t._grid.lineStyle?"0,0":"dashline"==t._grid.lineStyle?"4,4":"dottedline"==t._grid.lineStyle?"2,4":void 0:"3 3"})).style("pointer-events","none"),M.push("1"),i.append("g").attr("class","triangle-tickLines").selectAll(".tick").data([1==t._axisY.axisShow?M.map((function(t){return{p:F(t),type:"a"}})):[],1==t._axisZ.axisShow?M.map((function(t){return{p:L(t),type:"b"}})):[],1==t._axisX.axisShow?M.map((function(t){return{p:P(t),type:"c"}})):[]]).enter().append("g").selectAll(".ticklines").data((function(t){return t})).enter().append("line").attr("x1",(function(t){return t.p[0]})).attr("y1",(function(t){return t.p[1]})).attr("x2",(function(t){return"a"==t.type?t.p[0]+5:"b"==t.type?t.p[0]-5:t.p[0]})).attr("y2",(function(t){return"c"==t.type?t.p[1]+5:t.p[1]})).attr("stroke",(function(e,i){return"a"==e.type?q(t._axisY.axisColor):"b"==e.type?q(t._axisZ.axisColor):q(t._axisX.axisColor)})).attr("stroke-width",(function(e,i){return"a"==e.type?t._axisY.axisLineWidth:"b"==e.type?t._axisZ.axisLineWidth:t._axisX.axisLineWidth})),i.append("g").attr("class","triangle-tickLabels").selectAll(".axis").data([W.map((function(t){return{tick:t,pos:F(t/f[1]),rot:0,type:"a"}})),z.map((function(t){return{tick:t,pos:L(t/p[1]),rot:0,type:"b"}})),A.map((function(t){return{tick:t,pos:P(t/_[1]),rot:0,type:"c"}}))]).enter().append("g").selectAll(".ticks").data((function(t){return t})).enter().append("text").attr("transform",(function(t){return"translate("+t.pos+") rotate("+t.rot+")"})).attr("text-anchor",(function(t){return"a"==t.type?"start":"b"==t.type?"end":"middle"})).attr("dx",(function(t){return"a"==t.type?9:"b"==t.type?-9:"0"})).attr("dy",(function(e){return"c"==e.type?.9*t._fontSize+8:.35*t._fontSize})).attr("font-size",h).attr("font-family",u).style("fill",s).text((function(e){return"a"==e.type?e.tick+t._axisY.labelSuffix:"b"==e.type?e.tick+t._axisZ.labelSuffix:"c"==e.type?e.tick+t._axisX.labelSuffix:e.tick})),i.append("g").attr("class","triangle-axisLabels").selectAll(".labels").data([{label:g[1],pos:F(.5),rot:60,type:"a"},{label:g[2],pos:L(.5),rot:-60,type:"b"},{label:g[0],pos:P(.5),rot:0,type:"c"}]).enter().append("text").attr("transform",(function(t){return"translate("+t.pos+") rotate("+t.rot+")"})).attr("text-anchor","middle").attr("dy",(function(e){return"c"==e.type?.35*h+14+(t._axisX.labelShow?1.5*h:6):"a"==e.type?.35*h-14-(t._axisY.labelShow?1.9*h:5)-R(t._axisY.labelSuffix,h,u):"b"==e.type?.35*h-14-(t._axisZ.labelShow?1.9*h:5)-R(t._axisZ.labelSuffix,h,u):.35*h})).attr("dx",(function(t,e){return"a"==t.type?"1em":"b"==t.type?"-1em":0})).style("fill",s).attr("font-size",h).attr("font-family",u).text((function(t){return t.label}));var B=i.append("g").attr("class","triangle-circles").selectAll("circle").data(e).enter().append("circle").attr("class","triangle-circle").attr("r",(function(t){return isNaN(n(t.radius))?0:n(t.radius>0?t.radius:0)})).attr("cx",(function(t){var e=isNaN(parseFloat(t.x))?0:parseFloat(t.x),i=isNaN(parseFloat(t.y))?0:parseFloat(t.y),n=isNaN(parseFloat(t.z))?0:parseFloat(t.z),a=e+i+n==0?1:e+i+n,o=e/a,r=i/a,l=n/a,s=k[0]*l+w[0]*o+C[0]*r;return s=isNaN(s)?0:s,t.px=s,s})).attr("cy",(function(t){var e=isNaN(parseFloat(t.x))?0:parseFloat(t.x),i=isNaN(parseFloat(t.y))?0:parseFloat(t.y),n=isNaN(parseFloat(t.z))?0:parseFloat(t.z),a=e+i+n==0?1:e+i+n,o=e/a,r=i/a,l=n/a,s=k[1]*l+w[1]*o+C[1]*r;return s=isNaN(s)?0:s,t.py=s,s})).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-triangle-hover-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",""==a?function(t){return t.color}:a).style("stroke-width",parseFloat(o)<0?"0":o).style("display",(function(t){return t.x<0||t.y<0||t.z<0?"none":"block"})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),G=2*(k[1]-C[1])/3-(k[1]-C[1])/2;return t._interrupt?B.attr("r",(function(t){return isNaN(n(t.radius))?0:n(t.radius>0?t.radius:0)})):t._transition&&0===t._moveStyle?B.style("fill-opacity","0").style("stroke-opacity","0").transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-opacity","1"):t._transition&&1===t._moveStyle?B.attr("cx","0").attr("cy",G||"0").transition().duration(t._transition?t._duration:0).delay(t._transition?t._startDelay:0).attr("cx",(function(t){var e=isNaN(parseFloat(t.x))?0:parseFloat(t.x),i=isNaN(parseFloat(t.y))?0:parseFloat(t.y),n=isNaN(parseFloat(t.z))?0:parseFloat(t.z),a=e+i+n==0?1:e+i+n,o=e/a,r=i/a,l=n/a,s=k[0]*l+w[0]*o+C[0]*r;return s=isNaN(s)?0:s,t.px=s,s})).attr("cy",(function(t){var e=isNaN(parseFloat(t.x))?0:parseFloat(t.x),i=isNaN(parseFloat(t.y))?0:parseFloat(t.y),n=isNaN(parseFloat(t.z))?0:parseFloat(t.z),a=e+i+n==0?1:e+i+n,o=e/a,r=i/a,l=n/a,s=k[1]*l+w[1]*o+C[1]*r;return s=isNaN(s)?0:s,t.py=s,s})):B.attr("r",(function(t){return isNaN(n(t.radius))?0:n(t.radius>0?t.radius:0)})),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"rScale",value:function(t){return arguments.length?(this._rScale=t,this):this._rScale}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"bubbleBorderWidth",value:function(t){return arguments.length?(this._bubbleBorderWidth=t,this):this._bubbleBorderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"grid",value:function(t){return arguments.length?(this._grid=t,this):this._grid}},{key:"axisX",value:function(t){return arguments.length?(this._axisX=t,this):this._axisX}},{key:"axisY",value:function(t){return arguments.length?(this._axisY=t,this):this._axisY}},{key:"axisZ",value:function(t){return arguments.length?(this._axisZ=t,this):this._axisZ}}]),e}(at);function Sl(t,e){var i=0,n=1,a=2,o=3,r=4;e.forEach((function(t){"typeCol"===t.function?i=t.index:"X轴"===t.name?n=t.index:"Y轴"===t.name?a=t.index:"Z轴"===t.name?o=t.index:"半径"===t.name&&(r=t.index)}));var l=[],s=[],u={};t.slice(1).forEach((function(t,e){var c=t[i]||"",h=t[n]||"",d=t[a],_=t[o],f=t[r]||0,p=c+"-"+f+"-"+e;u[c]||""==c||(u[c]=c,l.push(c)),""!=c&&s.push({category:c,x:h,y:d,z:_,radius:f,key:p})}));var c=t[0],h={category:c[i]||"",x:c[n]||"",y:c[a],z:c[o],radius:c[r]||0};return{categories:l,nodes:s,labels:h}}var kl=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=t.categories,i=this.generateColorList(e.length),n={},a=[];return e.forEach((function(t,e){var o=i[e];n[t]=o,a.push({name:t,color:o})})),t.nodes.forEach((function(t){return t.color=n[t.category]})),0==e.length&&t.nodes.forEach((function(t){return t.color=i[0]})),t.legendData=a,t}}]),e}(it),wl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","triangle-scatter-chart"),i.triangle=new bl(i.mainGroup),i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._grid={show:"all",gridLineWidth:"1",color:"#e9e9e9",lineStyle:"dashline"},i._axisX={labelShow:!0,name:"",range:[],axisShow:!0,axisLineWidth:"1",axisColor:"#bfbfbf"},i._axisY={labelShow:!0,name:"",range:[],axisShow:!0,axisLineWidth:"1",axisColor:"#bfbfbf"},i._axisZ={labelShow:!0,name:"",range:[],axisShow:!0,axisLineWidth:"1",axisColor:"#bfbfbf"},i._bubbleSizeType="area",i._bubbleBorderColor=null,i._bubbleBorderWidth="1",i._minRadius="1",i._maxRadius="10",i._fillOpacity="1",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["同步渐现","中心弹出"],i._moveStyle="同步渐现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t,e=this,i=e.activeData,n=e.triangle,a=e.tooltip,o=e._fontSize,r=e._fontFamily,l=e._fontColor,s=e.widthOfNoMargin,u=e.heightOfMainGroup,h=d3.max(i.nodes.map((function(t){return t.radius}))),d=d3.min(i.nodes.map((function(t){return t.radius}))),_=void 0;if(_="area"==e._bubbleSizeType?d3.scaleSqrt().domain([d,h]).range([e._minRadius,e._maxRadius]):d3.scaleLinear().domain([d,h]).range([e._minRadius,e._maxRadius]),e.group.selectAll(".triangle-border-gradient").remove(),e._bubbleBorderColor&&/\[/.test(e._bubbleBorderColor)){var f=(t=e._bubbleBorderColor,new Function("return "+t)()),p=[],x=!0,g=!1,v=void 0;try{for(var m,b=f[Symbol.iterator]();!(x=(m=b.next()).done);x=!0){var S=m.value,k=[],w=S.split(":");k.push(q(w[0])),k.push(w[1]),p.push(k)}}catch(t){g=!0,v=t}finally{try{!x&&b.return&&b.return()}finally{if(g)throw v}}var C=p.concat(),O=C.pop();e.group.append("linearGradient").attr("class","triangle-border-gradient").attr("id",e.id+"-triangle-border-index-0").attr("x1",y(O[1]).x1+"%").attr("y1",y(O[1]).y1+"%").attr("x2",y(O[1]).x2+"%").attr("y2",y(O[1]).y2+"%").selectAll("stop").data(C).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}var F=e.defs;F.selectAll("filter").remove();var L=F.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_pie").attr("filterUnits","objectBoundingBox");L.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),L.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),L.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),L.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),L.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),n.data(i.nodes).width(s).height(u).fontColor(l).fontFamily(r).fontSize(o).transition(e._transition).duration(1e3*e._duration).startDelay(1e3*parseFloat(e._startDelay)).moveStyle(e._moveOptions.indexOf(e._moveStyle)).interrupt(e._interrupt).rScale(_).bubbleBorderColor(/\[/.test(e._bubbleBorderColor)?"url("+c("#"+e.id+"-triangle-border-index-0")+")":e._bubbleBorderColor).bubbleBorderWidth(e._bubbleBorderWidth).fillOpacity(e._fillOpacity).grid(e._grid).axisX(e._axisX).axisY(e._axisY).axisZ(e._axisZ).onMouseover((function(t){var e=[{text:""+t.category,color:t.color},{text:i.labels.x+"："+t.x},{text:i.labels.y+"："+t.y},{text:i.labels.z+"："+t.z},{text:i.labels.radius+"："+t.radius}];a.data(e).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){a.hide()})),n.update().translate(s/2,u/2)}},{key:"setSelfOption",value:function(t){var e=t.display,i=t._axis,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._bubbleSizeType=e?e.bubbleSizeType:this._bubbleSizeType,this._bubbleBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):"",this._bubbleBorderWidth=0==e.bubbleBorderWidth||e.bubbleBorderWidth?e.bubbleBorderWidth:this._bubbleBorderWidth,this._minRadius=0==e.minRadius||e.minRadius?e.minRadius:this._minRadius,this._maxRadius=0==e.maxRadius||e.maxRadius?e.maxRadius:this._maxRadius,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity),0!==Object.getOwnPropertyNames(i).length&&(this._grid=i?i.grid:this._grid,this._axisX=i?i.x:this._axisX,this._axisY=i?i.y:this._axisY,this._axisZ=i?i.z:this._axisZ),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy,i=e.legendData;t.legend.data(i).onClick((function(n){var a=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",a).style("opacity",a?.5:1),i.forEach((function(t){t.name===n.name&&(t.active=!a)})),e.nodes.forEach((function(t){t.category===n.name&&(t.active=!a)})),t.onDataChange()}))}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return e.sum-t.sum||t.index-e.index}))})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return t.sum-e.sum||t.index-e.index}))})),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new kl(t,e);return i.dataSolveFunc(Sl),i}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"activeData",get:function(){var t=this.sortedDataCopy;return{nodes:t.nodes.filter((function(t){return!1!==t.active})),labels:t.labels}}}]),e}(nt),Cl=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polarBar"),e._startAngle=0,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t.group;a.selectAll("*").remove();t._donutCount;var o=t._startAngle,r=t._endAngle,l=t._radius,s=t._transition,u=(t._duration,t._startDelay,t._moveOptions),h=t._moveStyle,d=(t._fillOpacity,t._innerRadius),_=t._strokeWidth,f=t._strokeColor,g=t._barWidthPercent,m=t._barCornerRadius,b=t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice),S=t._numberLabel.fontSize,k=t._numberLabel.fontFamily,w=q(t._numberLabel.color),C=t._sectorCount,O=n.length>0?Math.round(d3.max(n.map((function(t){return parseFloat(t.value)})))):1,F=[0,1.1*O];if(t._isPolar)if(null==t._count)F=v(0,O,Math.ceil(l/t._themeFontSize/3));else if(F=[],0!=t._count){var L=O-0,P=Math.ceil(Math.abs(L/t._count));O+=P;for(var A=0;A<P+1;A++)F.push(0+A*t._count)}else F.push(0);var W=d3.scaleLinear().domain([0,O]).range([d,l]),z=d3.scaleLinear().domain([0,C]).range([o,r]),M=n.length>0?n.map((function(t,e){return t.name=="&-"+(e+1)?"":t.name})):[],R=a.append("g").attr("class","polar-bar-axis");R.append("path").attr("class","polar-bar-xAxis").attr("d",(function(i,n){var a=void 0,o=void 0;return"clockwise"==t._rotateDirection?(a=t._startAngle,o=t._startAngle+t._totalAngle):(a=t._startAngle-t._totalAngle,o=t._startAngle),"内部"==t._axisPositonChoice?e(d-.5*t._xAxisLineWidth,a,o):e(l-.5*t._xAxisLineWidth,a,o)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?R.style("opacity",1):R.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);d3.arc().innerRadius(d).outerRadius(l),d3.pie().value((function(t){return Math.abs(t.value)})).startAngle(o).endAngle(r)([{value:1}]);var N=d3.arc().innerRadius(d).outerRadius(1*l).startAngle(0).endAngle(2*Math.PI);a.selectAll("defs").remove(),a.append("defs").append("clipPath").attr("id","overlay-polor-bar-"+t.id).append("path").attr("d",N()),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-polar-bar-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var T=(r-o)/(C>0?C:1),B=l*Math.cos(z(0)-Math.PI/2),G=l*Math.sin(z(0)-Math.PI/2),I=l*Math.cos(z(1)-Math.PI/2),Y=l*Math.sin(z(1)-Math.PI/2),H=.5*Math.sqrt(Math.pow(B-I,2)+Math.pow(G-Y,2))*g;n.length<=1&&(H=l);var V=a.append("g").attr("class","polar-bar-elems").selectAll(".polar-bars").data(n).enter().append("g").attr("class","polar-bars").append("rect").attr("class","polar-bar").attr("x",-parseFloat(H)/2).attr("y",(function(t){return-W(t.value)})).style("pointer-events","none").attr("rx",m).attr("ry",m).attr("width",parseFloat(H)).attr("height",(function(t){return W(t.value)-d})).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-polar-bar-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke-width",_).style("stroke",""==f?function(t){return t.color}:f).attr("transform",(function(t,e){return"rotate("+180/Math.PI*z(e+.5)+")"})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);t._interrupt||(s&&0==u.indexOf(h)?V.attr("y",-d).attr("height","0").transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("y",(function(t){return-W(t.value)})).attr("height",(function(t){return W(t.value)-d})):s&&1==u.indexOf(h)&&("clockwise"==t._rotateDirection?V.attr("width","0").transition().duration(t._transition?.9*t._duration/(n.length>0?n.length:1):0).delay(t._transition?function(e,i){return t._startDelay+t._duration*i*.9/(n.length>0?n.length:1)}:0).attr("width",parseFloat(H)):V.attr("x",parseFloat(H)/2).attr("width","0").transition().duration(t._transition?.9*t._duration/(n.length>0?n.length:1):0).delay(t._transition?function(e,i){return t._startDelay+t._duration*i*.9/(n.length>0?n.length:1)}:0).attr("x",-parseFloat(H)/2).attr("width",parseFloat(H))));var $=a.append("g").attr("class","polar-bar-labels-groups").selectAll(".polar-bar-label").data(n).enter().append("g").attr("class","polar-bar-label").style("pointer-events","none").append("text").attr("class","polar-bar-number-labels").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).style("pointer-events","none").attr("x",0).attr("y",(function(t,e){var i=180/Math.PI*z(e+.5),n=Math.abs(i/90)>1&&Math.abs(i/90)<3?-1:1;return 0===b?n*(-W(t.value)-parseFloat(S)/2-5):1===b?n*(-W(t.value)+(W(t.value)-d)/2):2===b?n*(-W(t.value)+parseFloat(S)/2+5):0})).style("text-anchor","middle").attr("dy","0.35em").style("font-size",S).style("fill",w).style("font-family",k).style("display",1==t._labelShow?"block":"none").attr("transform",(function(t,e){var i=180/Math.PI*z(e+.5);return Math.abs(i/90)>1&&Math.abs(i/90)<3&&(i-=180),"translate(0,0)rotate("+i+")"}));t._interrupt?$.style("opacity",1):$.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1);var Z=(r-o)/(C||1),Q=[],K=void 0;if(K="外部"==t._axisPositonChoice?l+5:d-5,n.length>0)for(var J=0;J<C+1;J++){var tt=K*Math.sin(o+J*Z),et=-K*Math.cos(o+J*Z);Q.push({x:tt,y:et})}else Q=[{x:K*Math.sin(o),y:-K*Math.cos(o)},{x:K*Math.sin(r),y:-K*Math.cos(r)}];var it=a.selectAll(".area-lines").data(d3.range(n.length>0?C:0));it.exit().remove();var nt=it.enter().append("line").attr("class","area-lines").merge(it).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=o+T*(i+.5);return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?l:d)})).attr("y1",(function(e,i){var n=o+T*(i+.5);return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?l:d)})).attr("x2",(function(e,i){var n=o+T*(i+.5);return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?l+5:d-5)})).attr("y2",(function(e,i){var n=o+T*(i+.5);return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?l+5:d-5)}));a.selectAll(".tick-text").remove();var at=a.append("g").selectAll("text").data(Q);at.exit().remove();var ot=at.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice){if("水平"==t._xLabelDirection){var a=Math.cos(o+T*(i+.5)-Math.PI/2)*(l+10),r=t._mainWidth/2-Math.abs(a);return X(M[i],r,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var s=Math.sin(o+T*(i+.5)-Math.PI/2)*(l+10),u=t._mainHeight/2-Math.abs(s);return null==M[i]?"":j(M[i],u,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection)return X(M[i],(d-10)/2,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(M[i],(d-10)/2,t._themeFontSize,t._themeFontFamily)}})).attr("x",(function(e,i){var n=o+T*(i+.5);return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(l+10):Math.cos(n-Math.PI/2)*(d-10)})).attr("y",(function(e,i){var n=o+T*(i+.5);return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(l+10):Math.sin(n-Math.PI/2)*(d-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)ot.attr("transform",(function(e,i){var n=o+T*(i+.5);return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:.35*t._themeFontSize)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var rt=t.group.append("g").selectAll("text").data(Q);rt.exit().remove();var lt=rt.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(o+T*(e+.5))/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?lt.text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(M[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",l+10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(o+T*(e+.5))/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(o+T*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(l+10)+",0)":null})):lt.text((function(e,i){var n=d-10-parseFloat(t._themeFontSize)>0?d-10-parseFloat(t._themeFontSize):0;return X(M[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",d-10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(o+T*(e+.5))/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(o+T*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(d-10)+",0)":null}))}else{a.selectAll(".tick-text").remove();var st=t.group.selectAll("g.text-group").data(Q);st.exit().remove();st.enter().append("g").attr("class","text-group").merge(st).each((function(i,a){d3.select(this);var r=l+10;"内部"==t._axisPositonChoice&&(r=d-10-t._themeFontSize),r<0&&(r=0);var s=o+T*(a+.5),u=d3.select(this.parentNode),c="arc-path-"+a+"-"+t.id,h=e(r+.5*t._themeFontSize,s+T/2+.015,s-T/2-.015);"clockwise"==t._rotateDirection&&(h=e(r+.6*t._themeFontSize,s-T/2+.015,s+T/2-.015));var _=t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);n.length>0&&D(u,_,M[a],t._themeFontSize,t._themeFontFamily,"52%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none")}))}1==t._interrupt?(nt.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),ot.style("opacity",1).style("display",t._showX?"block":"none")):(nt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),ot.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var ut=0;ut<C+1;ut++){var ct=(ut+.5)*T+o;"外部"==t._axisPositonChoice?0==ct||ct==Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ut]).attr("text-anchor","middle"):ct>Math.PI||ct<0&&ct>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ut]).attr("text-anchor","end"):d3.select(a.selectAll(".tick-text").nodes()[ut]).attr("text-anchor","start"):ct>0&&ct<Math.PI||ct>2*-Math.PI&&ct<-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ut]).attr("text-anchor","end"):ct>Math.PI&&ct<2*Math.PI||ct<0&&ct>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[ut]).attr("text-anchor","start"):d3.select(a.selectAll(".tick-text").nodes()[ut]).attr("text-anchor","middle")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var ht=t.group.selectAll(".tick-text"),dt=[],_t=[],ft=0;ft<ht._groups[0].length;ft++){_t.push(ft);for(var pt=ft+1;pt<ht._groups[0].length;pt++){p(i(d3.select(ht._groups[0][ft])),i(d3.select(ht._groups[0][pt])))&&(dt.push(ft),d3.select(ht._groups[0][ft]).style("opacity","0"))}}for(var yt=new Set(dt),xt=Array.from(yt),gt=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(xt,_t),vt=0;vt<xt.length;vt++){for(var mt=[],bt=0;bt<gt.length;bt++){var St=i(d3.select(ht._groups[0][xt[vt]])),kt=i(d3.select(ht._groups[0][gt[bt]]));if(mt.push(p(St,kt)),p(St,kt)){if(xt[vt]==gt[bt])continue;d3.select(ht._groups[0][xt[vt]]).remove()}}0==mt.filter((function(t){return 1==t})).length&&gt.push(xt[vt])}for(var wt=0;wt<gt.length;wt++)d3.select(ht._groups[0][gt[wt]]).style("opacity","1")}return t}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=t,this):this._sectorCount}}]),n}(at),Ol="rotate-grid-arc-path",Fl="rotate-grid-line",Ll=function(t){function i(t){b(this,i);var e=C(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.elem=t.append("g").attr("class","rotate-polar-grid"),e.group=e.elem.append("g"),e._radius=100,e._startAngle=0,e._endAngle=2*Math.PI,e._donutCount=5,e._sectorCount=5,e._sectorArr=[],e}return w(i,t),S(i,[{key:"update",value:function(){var t=this,i=t._startAngle,n=t._endAngle,a=t._radius,o=t._innerRadius,r=t._sectorArr,l=t.group.style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray);!function(){if(!t._showX)return void l.selectAll("."+Ol).remove();var r=t._donutCount,s=l.selectAll("."+Ol).data(isNaN(Number(r))?r:d3.range(r));s.exit().remove(),s.enter().append("path").attr("class",Ol).merge(s).attr("d",(function(t,l){var s=Math.abs(t);return isNaN(Number(r))||(s=o+(a-o)/r*(l+1)),e(s,i,n)})),isNaN(Number(r))&&Math.round(Math.abs(r[r.length-1]))!=Math.round(a)&&(l.selectAll(".fixed-donut-grid-arc-path").remove(),l.append("path").attr("class","fixed-"+Ol).attr("d",e(a,i,n)))}(),function(){if(!t._showY)return void l.selectAll(".rotate-grid-line").remove();if(r.length>0){var e=l.selectAll(".rotate-grid-line").data(r);e.exit().remove(),e.enter().append("line").attr("class",Fl).merge(e).attr("x1",(function(t,e){return Math.cos(t-Math.PI/2)*o})).attr("y1",(function(t,e){return Math.sin(t-Math.PI/2)*o})).attr("x2",(function(t,e){return Math.cos(t-Math.PI/2)*a})).attr("y2",(function(t,e){return Math.sin(t-Math.PI/2)*a}))}else{var s=t._sectorCount||1,u=(n-i)/s,c=l.selectAll(".rotate-grid-line").data(d3.range(s+1));c.exit().remove(),c.enter().append("line").attr("class",Fl).merge(c).attr("x1",(function(t,e){var n=i+u*e;return Math.cos(n-Math.PI/2)*o})).attr("y1",(function(t,e){var n=i+u*e;return Math.sin(n-Math.PI/2)*o})).attr("x2",(function(t,e){var n=i+u*e;return Math.cos(n-Math.PI/2)*a})).attr("y2",(function(t,e){var n=i+u*e;return Math.sin(n-Math.PI/2)*a}))}}()}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=parseFloat(t),this):this._sectorCount}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}},{key:"sectorArr",value:function(t){return arguments.length?(this._sectorArr=t,this):this._sectorArr}}]),i}(pt),Pl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","polar-bar-chart"),i.grid=new Ll(i.mainGroup),i.overlay=new Ir(i.mainGroup),i.polarBar=new Cl(i.mainGroup),i.radialAxis=new mt(i.mainGroup),i.guideLine=new Et(i.mainGroup),i._transition=!0,i._easeStyle="",i._duration=2,i._startDelay=0,i._moveOptions=["径向展开","顺时针展开"],i._moveStyle="径向展开",i._endPause=0,i._barWidthPercent="0.5",i._innerRadiusRatio="0.38",i._barCornerRadius="0",i._strokeWidth="1",i._strokeColor="#FFFFFF",i._fillOpacity="1",i._axisOpeningAngle="0",i._rotateDirection,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.defs;i.selectAll("filter").remove();var n=i.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),n.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),n.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),n.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),n.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t._interrupt?t.group.selectAll(".rotate-polar-grid").interrupt().style("opacity",1):t.group.selectAll(".rotate-polar-grid").interrupt().style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var a=t.polarBar,o=t.grid,r=t.tooltip,l=t.overlay,s=t.guideLine,u=t.radialAxis,h=1e3*t._transition,d=1e3*t._duration,_=1e3*t._startDelay,f=t._fontSize,p=t.widthOfNoMargin,x=t.heightOfMainGroup,g=0,v=void 0,m=void 0,b=t.activeData.length>0?t.activeData.map((function(t){return t.name})):[""];"水平"==t._xLabelDirection&&1==t._xTickShow?(v=d3.max(b.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),m=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(v=d3.max(b.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),m=d3.max(b.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(v=t._fontSize,m=t._fontSize):(v=0,m=0),v=v<.4*p?v:.4*p,m=m<.4*x?m:.4*x,g="外部"==t._axisPositonChoice?Math.min(p/2-v,x/2-m):Math.min(p,x)/2,"clockwise"==t._rotateDirection?(t._startAngle=t._startAngle,t._endAngle=t._startAngle+t._totalAngle):(t._startAngle=t._startAngle,t._endAngle=t._startAngle-t._totalAngle);var S=Math.round(d3.max(e.map((function(t){return parseFloat(t.value)})))),k=Math.floor(g*(1-t._innerRadiusRatio)/(1.1*f));if("竖排"==t._yLabelDirection&&(k=Math.floor(g*(1-t._innerRadiusRatio)/(S.toString().length*f*1.1))),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=T(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t.group.selectAll(".polar-bar-border-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var w=T(t._strokeColor),C=[],O=!0,F=!1,L=void 0;try{for(var P,A=w[Symbol.iterator]();!(O=(P=A.next()).done);O=!0){var W=P.value,z=[],M=W.split(":");z.push(q(M[0])),z.push(M[1]),C.push(z)}}catch(t){F=!0,L=t}finally{try{!O&&A.return&&A.return()}finally{if(F)throw L}}var D=C.concat(),N=D.pop();t.group.append("linearGradient").attr("class","polar-bar-border-gradient").attr("id",t.id+"-polor-bar-border-0").attr("x1",y(N[1]).x1+"%").attr("y1",y(N[1]).y1+"%").attr("x2",y(N[1]).x2+"%").attr("y2",y(N[1]).y2+"%").selectAll("stop").data(D).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}function T(t){return new Function("return "+t)()}a.data(e).transition(h).duration(d).startDelay(_).moveOptions(t._moveOptions).moveStyle(t._moveStyle).radius(g).totalAngle(t._totalAngle).axisPositonChoice(t._axisPositonChoice).numberLabel(t._numberLabel).labelShow(t._labelShow).donutCount(k).defs(t.defs).sectorCount(e.length>0?e.length:1).translate(p/2,x/2).innerRadius(g*t._innerRadiusRatio).strokeWidth(t._strokeWidth).strokeColor(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-polor-bar-border-0")+")":t._strokeColor).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).fillOpacity(t._fillOpacity).startAngle(t._startAngle).endAngle(t._endAngle).showX(t._xTickShow).showY(t._yTickShow).stroke(t._axisLineStroke).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).rotateDirection(t._rotateDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(p).mainHeight(x).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var B=e.length>0?Math.abs(t._startAngle-t._endAngle)/e.length:0;"clockwise"==t._rotateDirection?(t._startAngleGrid=t._startAngle,t._endAngleGrid=t._startAngle+t._totalAngle):(t._startAngleGrid=t._startAngle-t._totalAngle,t._endAngleGrid=t._startAngle),l.totalAngle(t._totalAngle).innerRadius(g*t._innerRadiusRatio).outerRadius(g).startAngle(t._startAngleGrid+B/2).endAngle(t._endAngleGrid+B/2).data(t.activeData.length>0?t.activeData:[]).translate(p/2,x/2).onMouseover((function(i,n){if(e.length>0){var a=e.length>0?e.length-1:0,o="clockwise"==t._rotateDirection?i.index:a-i.index,l=e[o].name,s=[{text:l=="&-"+(o+1)?"":l,color:e[o].color},{text:(e[o].valueLabel=="&-"+(n+1)?"":e[o].valueLabel)+"："+E(e[o].value,t._numberStyle,t._decimalPlaces)}];r.data(s).update(),r.move([d3.event.offsetX,d3.event.offsetY]).show()}})).onMousemove((function(t,e){r.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t,e){r.hide()})),s.translate(p/2,x/2),l.update(),a.update(),u.data(t.activeData).radius(g).innerRadius(g*t._innerRadiusRatio).startAngle(t._startAngle).endAngle(t._endAngle).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(p).mainHeight(x).suffix(t._yLabelSuffix).maxValue(S).count(t._yCountOfLabel).isPolar(!0).range(t._yRange).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).translate(p/2,x/2),u.update(),t._totalAngle>=2*Math.PI&&0==t._yAxisShow&&u.elem.select("g .polar-axis").selectAll("text").style("text-anchor","middle").attr("dx","clockwise"==t._rotateDirection?8:-8);var G=[];if(t._totalAngle<2*Math.PI&&e.length>0){for(var X=0;X<e.length;X++)G.push(t._startAngleGrid+(X+.5)*B);G.push(t._startAngleGrid+e.length*B),G.unshift(t._startAngleGrid)}o.sectorCount(e.length>0?e.length:1).donutCount(t._isPolar?u._polarCount:6).startAngle(t._totalAngle<2*Math.PI?t._startAngleGrid:t._startAngleGrid+B/2).endAngle(t._totalAngle<2*Math.PI?t._endAngleGrid:t._endAngleGrid+B/2).sectorArr(G).radius(g).innerRadius(g*t._innerRadiusRatio).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth).translate(p/2,x/2),o.update();var j=t.mainGroup.selectAll(".rotate-grid-line").nodes();j.length>0&&t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(j[0]).remove():d3.select(j[j.length-1]).remove());var I=t.mainGroup.selectAll(".rotate-grid-arc-path").nodes();I.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(I[0]).remove():t._xAxisShow&&(t._isPolar&&Math.abs(u._polarCount[u._polarCount.length-1])==g?d3.select(I[I.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;if("single"==t._colors.type){if(e.length>0){var i={},n=[];i.name=e[0].valueLabel,i.color=e[0].color,n.push(i),e=""==i.name||null==i.name||null==i.name?[]:n}else e=[];t.legend.data(e).onClick((function(e){var i=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",i).style("opacity",i?.5:1),t.sortedDataCopy.forEach((function(t){t.active=!i})),t.onDataChange()}))}else t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o?o.numberLabel.show:this._labelShow,this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel,this._suffix=o.numberLabel&&o.numberLabel.suffix?o.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i.transition||0==i.transition?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._strokeWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._strokeWidth,this._strokeColor=e.barborderColor?q(e.barborderColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(0!=a.labelShow&&!a.labelShow||a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}}]),e}(vt),Al=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polarStackRectangular"),e._startAngle=0,e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t.group;a.selectAll("*").remove();t._donutCount;var o=t._startAngle,r=t._endAngle,l=t._radius,s=t._transition,u=t._duration,h=t._startDelay,d=t._moveOptions,_=t._moveStyle,f=t._fillOpacity,g=t._innerRadius,m=t._strokeWidth,b=t._strokeColor,S=t._barWidthPercent,k=t._barCornerRadius,w=t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice),C=t._numberLabel.fontSize,O=t._numberLabel.fontFamily,F=q(t._numberLabel.color),L=t._sectorCount,P=1.1*d3.max(n,(function(t){return d3.max(t.data,(function(t){return+t.total}))})),A=[0,1.1*P];if(t._isPolar)if(null==t._count)A=v(0,P,Math.ceil(l/t._themeFontSize/3));else if(A=[],0!=t._count){var W=P-0,z=Math.ceil(Math.abs(W/t._count));P+=z;for(var M=0;M<z+1;M++)A.push(0+M*t._count)}else A.push(0);var R=d3.scaleLinear().domain([0,P]).range([g,l]),N=d3.scaleLinear().domain([0,L]).range([o,r]),T=n.length>0?n[0].data.map((function(t,e){return t.name=="&-"+(e+1)?"":t.name})):[],B=a.append("g").attr("class","polar-stack-rectangular-axis");B.append("path").attr("class","polar-stack-rectangular-xAxis").attr("d",(function(i,n){var a=void 0,o=void 0;return"clockwise"==t._rotateDirection?(a=t._startAngle,o=t._startAngle+t._totalAngle):(a=t._startAngle-t._totalAngle,o=t._startAngle),"内部"==t._axisPositonChoice?e(g-.5*t._xAxisLineWidth,a,o):e(l-.5*t._xAxisLineWidth,a,o)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none"),1==t._interrupt?B.style("opacity",1):B.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1);var G=d3.arc().innerRadius(g).outerRadius(1*l).startAngle(0).endAngle(2*Math.PI);a.selectAll("defs").remove(),a.append("defs").append("clipPath").attr("id","overlay-polor-stack-rectangular-"+t.id).append("path").attr("d",G()),n.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-polor-stack-rectangular-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var I=(r-o)/(L>0?L:1),Y=l*Math.cos(N(0)-Math.PI/2),H=l*Math.sin(N(0)-Math.PI/2),V=l*Math.cos(N(1)-Math.PI/2),$=l*Math.sin(N(1)-Math.PI/2),Z=.5*Math.sqrt(Math.pow(Y-V,2)+Math.pow(H-$,2))*S;n.length>0&&n[0].data.length<=1&&(Z=l);var Q=a.append("g").selectAll("g").data(n);Q.exit().remove(),Q.enter().append("g").merge(Q).each((function(e,i){var a=d3.select(this).selectAll("rect").data(e.data);a.exit().remove();var o=a.enter().append("rect").attr("class",(function(t,e){return"stackBars"+e})).merge(a).style("fill",(function(e){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-polor-stack-rectangular-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(t){if(t.color&&/#/.test(t.color))return f;var e=U(t.color,3)||1;return f*e})).style("pointer-events","none").style("stroke",(function(t){return""==b?t.color:b})).style("stroke-width",(function(t){return m||0})).attr("x",-parseFloat(Z)/2).attr("width",parseFloat(Z)).attr("y",(function(t){return t.value>0||0==t.value?-R(t.total):t.value<0?-R(t.downtotal-t.value):void 0})).attr("height",(function(t){return t.value>0||0==t.value?R(t.value)-R(0)>0?R(t.value)-R(0):0:t.value<0?R(0)-R(t.value)>0?R(0)-R(t.value):0:void 0})).attr("rx",k).attr("ry",k).attr("transform",(function(t,e){return"rotate("+180/Math.PI*N(e+.5)+")"}));t._interrupt||(s&&0==d.indexOf(_)?o.attr("y",(function(t){return t.value>0||0==t.value?-R(t.total-t.value):t.value<0?-R(t.downtotal):void 0})).attr("height",0).transition().duration(s?.9*u/(n.length>0?n.length:1):0).delay(s?h+i*(.9*u/(n.length>0?n.length:1)):0).attr("y",(function(t){return t.value>0||0==t.value?-R(t.total):t.value<0?-R(t.downtotal-t.value):void 0})).attr("height",(function(t){return t.value>0||0==t.value?R(t.value)-R(0)>0?R(t.value)-R(0):0:t.value<0?R(0)-R(t.value)>0?R(0)-R(t.value):0:void 0})):s&&1==d.indexOf(_)&&("clockwise"==t._rotateDirection?o.attr("width","0").transition().duration(s?.9*u/(n.length>0?n[0].data.length:1):0).delay(s?function(t,e){return h+u*e*.9/(n.length>0?n[0].data.length:1)}:0).attr("width",parseFloat(Z)):o.attr("x",parseFloat(Z)/2).attr("width","0").transition().duration(s?.9*u/(n.length>0?n[0].data.length:1):0).delay(s?function(t,e){return h+u*e*.9/(n.length>0?n[0].data.length:1)}:0).attr("x",-parseFloat(Z)/2).attr("width",parseFloat(Z))))}));var K=a.append("g").selectAll("g").data(n);K.exit().remove(),K.enter().append("g").merge(K).each((function(e,i){var n=d3.select(this).append("g").attr("class","polar-stack-rectangular-labels").selectAll("text").data(e.data);n.exit().remove();var a=n.enter().append("text").merge(n).attr("class","polar-stack-rectangular-label").text((function(e){return 0==e.value?"":E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("fill",F).attr("font-size",C).style("font-family",O).style("pointer-events","none").attr("x",0).attr("y",(function(t,e){if(0!=w)return 0;var i=180/Math.PI*N(e+.5);return t.value>0||0==t.value?(Math.abs(i/90)>1&&Math.abs(i/90)<3?1:-1)*(R(t.total)+(R(0)-R(t.value))/2):t.value<0?(Math.abs(i/90)>1&&Math.abs(i/90)<3?1:-1)*(R(t.downtotal-t.value)+(R(t.value)-R(0))/2):void 0})).attr("text-anchor","middle").attr("dy","0.35em").style("display",(function(e,i){return 1==t._labelShow&&Math.abs(R(0)-R(e.value))>.8*C?"block":"none"})).attr("transform",(function(t,e){var i=180/Math.PI*N(e+.5);return Math.abs(i/90)>1&&Math.abs(i/90)<3&&(i-=180),"translate(0,0)rotate("+i+")"}));t._interrupt?a.style("opacity",1):a.style("opacity",0).transition().duration(s?.1*u:0).delay(s?h+.9*u:0).style("opacity",1)}));var J=(r-o)/(L||1),tt=[],et=void 0;if(et="外部"==t._axisPositonChoice?l+5:g-5,n.length>0)for(var it=0;it<L+1;it++){var nt=et*Math.sin(o+it*J),at=-et*Math.cos(o+it*J);tt.push({x:nt,y:at})}else tt=[{x:et*Math.sin(o),y:-et*Math.cos(o)},{x:et*Math.sin(r),y:-et*Math.cos(r)}];var ot=a.selectAll(".stack-rectangular-lines").data(d3.range(n.length>0?L:0));ot.exit().remove();var rt=ot.enter().append("line").attr("class","stack-rectangular-lines").merge(ot).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=o+I*(i+.5);return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?l:g)})).attr("y1",(function(e,i){var n=o+I*(i+.5);return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?l:g)})).attr("x2",(function(e,i){var n=o+I*(i+.5);return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?l+5:g-5)})).attr("y2",(function(e,i){var n=o+I*(i+.5);return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?l+5:g-5)}));a.selectAll(".tick-text").remove();var lt=a.append("g").selectAll("text").data(tt);lt.exit().remove();var st=lt.enter().append("text").attr("class","tick-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice){if("水平"==t._xLabelDirection){var a=Math.cos(o+I*(i+.5)-Math.PI/2)*(l+10),r=t._mainWidth/2-Math.abs(a);return X(T[i],r,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var s=Math.sin(o+I*(i+.5)-Math.PI/2)*(l+10),u=t._mainHeight/2-Math.abs(s);return null==T[i]?"":j(T[i],u,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection)return X(T[i],(g-10)/2,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(T[i],(g-10)/2,t._themeFontSize,t._themeFontFamily)}})).attr("x",(function(e,i){var n=o+I*(i+.5);return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(l+10):Math.cos(n-Math.PI/2)*(g-10)})).attr("y",(function(e,i){var n=o+I*(i+.5);return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(l+10):Math.sin(n-Math.PI/2)*(g-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)st.attr("transform",(function(e,i){var n=o+I*(i+.5);return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:.35*t._themeFontSize)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".tick-text").remove();var ut=t.group.append("g").selectAll("text").data(tt);ut.exit().remove();var ct=ut.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(o+I*(e+.5))/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?ct.text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(T[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",l+10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(o+I*(e+.5))/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(o+I*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(l+10)+",0)":null})):ct.text((function(e,i){var n=g-10-parseFloat(t._themeFontSize)>0?g-10-parseFloat(t._themeFontSize):0;return X(T[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",g-10).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(o+I*(e+.5))/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(o+I*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(g-10)+",0)":null}))}else{a.selectAll(".tick-text").remove();var ht=t.group.selectAll("g.text-group").data(tt);ht.exit().remove();ht.enter().append("g").attr("class","text-group").merge(ht).each((function(i,a){d3.select(this);var r=l+10;"内部"==t._axisPositonChoice&&(r=g-10-t._themeFontSize),r<0&&(r=0);var s=o+I*(a+.5),u=d3.select(this.parentNode),c="arc-path-"+a+"-"+t.id,h=e(r+.6*t._themeFontSize,s+I/2+.015,s-I/2-.015);"clockwise"==t._rotateDirection&&(h=e(r+.6*t._themeFontSize,s-I/2+.015,s+I/2-.015));var d=t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);n.length>0&&D(u,d,T[a],t._themeFontSize,t._themeFontFamily,"50%").style("pointer-events","none").style("fill",t._themeFontColor).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("display",t._showX?"block":"none")}))}1==t._interrupt?(rt.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),st.style("opacity",1).style("display",t._showX?"block":"none")):(rt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),st.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var dt=0;dt<L+1;dt++){var _t=(dt+.5)*I+o;"外部"==t._axisPositonChoice?0==_t||_t==Math.PI?d3.select(a.selectAll(".tick-text").nodes()[dt]).attr("text-anchor","middle"):_t>Math.PI||_t<0&&_t>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[dt]).attr("text-anchor","end"):d3.select(a.selectAll(".tick-text").nodes()[dt]).attr("text-anchor","start"):_t>0&&_t<Math.PI||_t>2*-Math.PI&&_t<-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[dt]).attr("text-anchor","end"):_t>Math.PI&&_t<2*Math.PI||_t<0&&_t>-Math.PI?d3.select(a.selectAll(".tick-text").nodes()[dt]).attr("text-anchor","start"):d3.select(a.selectAll(".tick-text").nodes()[dt]).attr("text-anchor","middle")}if("水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var ft=t.group.selectAll(".tick-text"),pt=[],yt=[],xt=0;xt<ft._groups[0].length;xt++){yt.push(xt);for(var gt=xt+1;gt<ft._groups[0].length;gt++){p(i(d3.select(ft._groups[0][xt])),i(d3.select(ft._groups[0][gt])))&&(pt.push(xt),d3.select(ft._groups[0][xt]).style("opacity","0"))}}for(var vt=new Set(pt),mt=Array.from(vt),bt=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(mt,yt),St=0;St<mt.length;St++){for(var kt=[],wt=0;wt<bt.length;wt++){var Ct=i(d3.select(ft._groups[0][mt[St]])),Ot=i(d3.select(ft._groups[0][bt[wt]]));if(kt.push(p(Ct,Ot)),p(Ct,Ot)){if(mt[St]==bt[wt])continue;d3.select(ft._groups[0][mt[St]]).remove()}}0==kt.filter((function(t){return 1==t})).length&&bt.push(mt[St])}for(var Ft=0;Ft<bt.length;Ft++)d3.select(ft._groups[0][bt[Ft]]).style("opacity","1")}return t}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=t,this):this._sectorCount}}]),n}(at);function Wl(t,e){var i=0,n=!1,a=[];if(e.forEach((function(t){"objCol"===t.function?(i=t.index,n=t.isLegend):"vCol"===t.function&&0==t.configurable&&a.push(t.index)})),P(t,[i],2))return[];for(var o=z(t,e),r={},l=[],s=o.length,u=o[0],c=[],d=[],_=1;_<s;_++)d.push(o[_].length);d.sort((function(t,e){return e-t}));for(var f=0;f<s;f++)for(var p=0;p<d[0];p++)c.push(isNaN(parseFloat(o[f][p])));if(0==c.filter((function(t,e){return 0==t})).length)return[];if(n){for(var y=[],x=1;x<s;x++)y.push(o[x].length);y.sort((function(t,e){return e-t}));for(var g=1;g<s;g++){var v=o[g],m=v[i];if(""!=m&&null!=m&&null!=m||(m="$-"+g),m){for(var b={name:m,dataScreen:!0,showLegend:m!="$-"+g,data:[]},S=0;S<y[0];S++){var k=u[S];""!=k&&null!=k&&null!=k||(k="&-"+S),S!==i&&b.data.push({name:k,subName:m,showAxisText:k!="&-"+S,value:""==v[S]||isNaN(parseFloat(v[S]))||null==v[S]||null==v[S]?0:v[S],tooltipValueShow:!isNaN(parseFloat(v[S]))})}l.push(b)}}}else{for(var w=[],C=1;C<s;C++)w.push(o[C].length);w.sort((function(t,e){return e-t}));for(var O=1;O<w[0];O++)if(O!==i){var F=u[O];""!=u[O]&&null!=u[O]&&null!=u[O]||(F="$-"+O);var L="";L=1==O?"rainfall":2==O?"volume":"",r[F+"-"+O]={name:F,dataScreen:!0,showLegend:F!="$-"+O,type:L,data:[]}}for(var A=1;A<s;A++){var W=o[A],M=W[i];if(""!=M&&null!=M&&null!=M||(M="&-"+A),M)for(var D=0;D<w[0];D++){var R=u[D];""!=u[D]&&null!=u[D]&&null!=u[D]||(R="$-"+D),D!==i&&R&&r[R+"-"+D].data.push({name:M,subName:R,showAxisText:M!="&-"+A,value:""==W[D]||isNaN(parseFloat(W[D]))||null==W[D]||null==W[D]?0:W[D],tooltipValueShow:!isNaN(parseFloat(W[D]))})}}for(var N in r)l.push(r[N])}return l.forEach((function(t,e){t.key=h(t.name)+"-"+e})),l}var zl=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","polar-stack-rectangular-chart"),i.grid=new Ll(i.mainGroup),i.overlay=new Ir(i.mainGroup),i.polarStackRectangular=new Al(i.mainGroup),i.radialAxis=new mt(i.mainGroup),i.guideLine=new Et(i.mainGroup),i._transition=!0,i._easeStyle="",i._duration=2,i._startDelay=0,i._moveOptions=["径向展开","顺时针展开"],i._moveStyle="径向展开",i._endPause=0,i._barWidthPercent="0.5",i._innerRadiusRatio="0.38",i._barCornerRadius="0",i._strokeWidth="1",i._strokeColor="#FFFFFF",i._fillOpacity="1",i._axisOpeningAngle="0",i._rotateDirection,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.defs;i.selectAll("filter").remove();var n=i.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");n.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),n.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),n.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),n.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),n.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");for(var a=0;a<e.length;a++)for(var o=0;o<e[a].data.length;o++)e[a].data[o].value=parseFloat(e[a].data[o].value),e[a].data[o].total=0==a?parseFloat(e[a].data[o].value):e[a-1].data[o].total+parseFloat(e[a].data[o].value);var r=1.1*d3.max(e,(function(t){return d3.max(t.data,(function(t){return+t.total}))})),l=t.widthOfNoMargin,s=t.heightOfMainGroup,u=0,h=void 0,d=void 0,_=t.activeData.length>0?t.activeData[0].data.map((function(t){return t.name})):[""];"水平"==t._xLabelDirection&&1==t._xTickShow?(h=d3.max(_.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),d=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(h=d3.max(_.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),d=d3.max(_.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(h=t._fontSize,d=t._fontSize):(h=0,d=0),h=h<.4*l?h:.4*l,d=d<.4*s?d:.4*s,u="外部"==t._axisPositonChoice?Math.min(l/2-h,s/2-d):Math.min(l,s)/2,t._interrupt?t.group.selectAll(".rotate-polar-grid").interrupt().style("opacity",1):t.group.selectAll(".rotate-polar-grid").interrupt().style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var f=t.polarStackRectangular,p=t.grid,x=t.tooltip,g=t.overlay,v=t.guideLine,m=t.radialAxis,b=1e3*t._transition,S=1e3*t._duration,k=1e3*t._startDelay,w=t._fontSize;"clockwise"==t._rotateDirection?(t._startAngle=t._startAngle,t._endAngle=t._startAngle+t._totalAngle):(t._startAngle=t._startAngle,t._endAngle=t._startAngle-t._totalAngle);var C=Math.floor(u*(1-t._innerRadiusRatio)/(1.1*w));if("竖排"==t._yLabelDirection&&(C=Math.floor(u*(1-t._innerRadiusRatio)/(r.toString().length*w*1.1))),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=G(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),t.group.selectAll(".polar-stack-rectangular-border-gradient").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var O=G(t._strokeColor),F=[],L=!0,P=!1,A=void 0;try{for(var W,z=O[Symbol.iterator]();!(L=(W=z.next()).done);L=!0){var M=W.value,D=[],N=M.split(":");D.push(q(N[0])),D.push(N[1]),F.push(D)}}catch(t){P=!0,A=t}finally{try{!L&&z.return&&z.return()}finally{if(P)throw A}}var T=F.concat(),B=T.pop();t.group.append("linearGradient").attr("class","polar-stack-rectangular-border-gradient").attr("id",t.id+"-polar-stack-rectangular-border-0").attr("x1",y(B[1]).x1+"%").attr("y1",y(B[1]).y1+"%").attr("x2",y(B[1]).x2+"%").attr("y2",y(B[1]).y2+"%").selectAll("stop").data(T).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}function G(t){return new Function("return "+t)()}f.data(e).transition(b).duration(S).startDelay(k).moveOptions(t._moveOptions).moveStyle(t._moveStyle).radius(u).totalAngle(t._totalAngle).axisPositonChoice(t._axisPositonChoice).numberLabel(t._numberLabel).labelShow(t._labelShow).donutCount(C).defs(t.defs).sectorCount(e.length>0?e[0].data.length:1).translate(l/2,s/2).innerRadius(u*t._innerRadiusRatio).strokeWidth(t._strokeWidth).strokeColor(/\[/.test(t._strokeColor)?"url("+c("#"+t.id+"-polar-stack-rectangular-border-0")+")":t._strokeColor).barWidthPercent(t._barWidthPercent).barCornerRadius(t._barCornerRadius).fillOpacity(t._fillOpacity).startAngle(t._startAngle).endAngle(t._endAngle).showX(t._xTickShow).showY(t._yTickShow).stroke(t._axisLineStroke).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).rotateDirection(t._rotateDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(l).mainHeight(s).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),"clockwise"==t._rotateDirection?(t._startAngleGrid=t._startAngle,t._endAngleGrid=t._startAngle+t._totalAngle):(t._startAngleGrid=t._startAngle-t._totalAngle,t._endAngleGrid=t._startAngle);var X=e.length>0?Math.abs(t._startAngle-t._endAngle)/e[0].data.length:0;g.totalAngle(t._totalAngle).innerRadius(u*t._innerRadiusRatio).outerRadius(u).startAngle(t._startAngleGrid+X/2).endAngle(t._endAngleGrid+X/2).data(t.activeData.length>0?t.activeData[0].data:[]).translate(l/2,s/2).onMouseover((function(i,n){var a=e.length>0?e[0].data.length-1:0,o="clockwise"==t._rotateDirection?i.index:a-i.index,r=e.length>0?e[0].data[o].name:"",l=[{text:r=="&-"+(o+1)?"":r}],s=[];e.forEach((function(e,i){var n=e.data.filter((function(t){return t.name===r}));s.push({name:e.name,color:e.color,data:n}),l.push({text:(e.name=="&-"+(i+1)?"":e.name)+": "+(n[0].tooltipValueShow?E(n[0].value,t._numberStyle,t._decimalPlaces):""),color:e.color})})),x.data(l).update(),x.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(t,e){x.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t,e){x.hide()})),v.translate(l/2,s/2),g.update(),f.update(),m.data(t.activeData).radius(u).innerRadius(u*t._innerRadiusRatio).startAngle(t._startAngle).endAngle(t._endAngle).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).stroke(t._axisLineStroke).showX(t._xTickShow).showY(t._yTickShow).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).rotateDirection(t._rotateDirection).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(l).mainHeight(s).suffix(t._yLabelSuffix).maxValue(r).count(t._yCountOfLabel).isPolar(!0).range(t._yRange).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).translate(l/2,s/2),m.update(),t._totalAngle>=2*Math.PI&&0==t._yAxisShow&&m.elem.select("g .polar-axis").selectAll("text").style("text-anchor","middle").attr("dx","clockwise"==t._rotateDirection?8:-8),t.mainGroup.select(".polar-axis").style("pointer-events","none");var j=[];if(t._totalAngle<2*Math.PI&&e.length>0){j.push(t._startAngleGrid);for(var I=0;I<(e.length>0?e[0].data.length:0);I++)j.push(t._startAngleGrid+(I+.5)*X);j.push(t._startAngleGrid+e[0].data.length*X)}p.sectorCount(e.length>0?e[0].data.length:6).donutCount(t._isPolar?m._polarCount:6).startAngle(t._totalAngle<2*Math.PI?t._startAngleGrid:t._startAngleGrid+X/2).endAngle(t._totalAngle<2*Math.PI?t._endAngleGrid:t._endAngleGrid+X/2).sectorArr(e.length>0?j:[]).radius(u).innerRadius(u*t._innerRadiusRatio).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).showX(t._gridShowX).showY(t._gridShowY).gridLineWidth(t._gridLineWidth).translate(l/2,s/2),p.update();var Y=t.mainGroup.selectAll(".rotate-grid-line").nodes();Y.length>0&&t._yAxisShow&&("clockwise"==t._rotateDirection?d3.select(Y[0]).remove():d3.select(Y[Y.length-1]).remove()),e.length<=0&&t.mainGroup.selectAll(".fixed-rotate-grid-arc-path").remove();var H=t.mainGroup.selectAll(".rotate-grid-arc-path").nodes();H.length>0&&("内部"==t._axisPositonChoice?t._xAxisShow&&d3.select(H[0]).remove():t._xAxisShow&&(t._isPolar&&Math.abs(m._polarCount[m._polarCount.length-1])==u?d3.select(H[H.length-1]).remove():t.mainGroup.select(".fixed-donut-grid-arc-path").remove()))}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=Wl;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(o).length&&(this._labelShow=o?o.numberLabel.show:this._labelShow,this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel,this._suffix=o.numberLabel&&o.numberLabel.suffix?o.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i.transition||0==i.transition?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(e).length&&(this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?e.innerRadiusRatio:this._innerRadiusRatio,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._strokeWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._strokeWidth,this._strokeColor=e.barborderColor?q(e.barborderColor):""),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.polarAxis,n=i.x||{},a=i.y||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(0!=a.labelShow&&!a.labelShow||a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}}]),e}(vt);function Ml(t,e){return t[0]-e[0]||t[1]-e[1]}function Dl(t){for(var e,i,n,a=t.length,o=[0,1],r=2,l=2;l<a;++l){for(;r>1&&(e=t[o[r-2]],i=t[o[r-1]],n=t[l],(i[0]-e[0])*(n[1]-e[1])-(i[1]-e[1])*(n[0]-e[0])<=0);)--r;o[r++]=l}return o.slice(0,r)}var Rl,Nl,Tl=Object.freeze({polygonArea:function(t){for(var e,i=-1,n=t.length,a=t[n-1],o=0;++i<n;)e=a,a=t[i],o+=e[1]*a[0]-e[0]*a[1];return o/2},polygonCentroid:function(t){for(var e,i,n=-1,a=t.length,o=0,r=0,l=t[a-1],s=0;++n<a;)e=l,l=t[n],s+=i=e[0]*l[1]-l[0]*e[1],o+=(e[0]+l[0])*i,r+=(e[1]+l[1])*i;return[o/(s*=3),r/s]},polygonHull:function(t){if((i=t.length)<3)return null;var e,i,n=new Array(i),a=new Array(i);for(e=0;e<i;++e)n[e]=[+t[e][0],+t[e][1],e];for(n.sort(Ml),e=0;e<i;++e)a[e]=[n[e][0],-n[e][1]];var o=Dl(n),r=Dl(a),l=r[0]===o[0],s=r[r.length-1]===o[o.length-1],u=[];for(e=o.length-1;e>=0;--e)u.push(t[n[o[e]][2]]);for(e=+l;e<r.length-s;++e)u.push(t[n[r[e]][2]]);return u},polygonContains:function(t,e){for(var i,n,a=t.length,o=t[a-1],r=e[0],l=e[1],s=o[0],u=o[1],c=!1,h=0;h<a;++h)i=(o=t[h])[0],(n=o[1])>l!=u>l&&r<(s-i)*(l-n)/(u-n)+i&&(c=!c),s=i,u=n;return c},polygonLength:function(t){for(var e,i,n=-1,a=t.length,o=t[a-1],r=o[0],l=o[1],s=0;++n<a;)e=r,i=l,e-=r=(o=t[n])[0],i-=l=o[1],s+=Math.sqrt(e*e+i*i);return s}}),Bl=0,Gl=0,Xl=0,jl=0,Il=0,Yl=0,Hl="object"==typeof performance&&performance.now?performance:Date,El="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Vl(){return Il||(El($l),Il=Hl.now()+Yl)}function $l(){Il=0}function ql(){this._call=this._time=this._next=null}function Ul(t,e,i){var n=new ql;return n.restart(t,e,i),n}function Zl(){Vl(),++Bl;for(var t,e=Rl;e;)(t=Il-e._time)>=0&&e._call.call(null,t),e=e._next;--Bl}function Ql(){Il=(jl=Hl.now())+Yl,Bl=Gl=0;try{Zl()}finally{Bl=0,function(){var t,e,i=Rl,n=1/0;for(;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Rl=e);Nl=t,Jl(n)}(),Il=0}}function Kl(){var t=Hl.now(),e=t-jl;e>1e3&&(Yl-=e,jl=t)}function Jl(t){Bl||(Gl&&(Gl=clearTimeout(Gl)),t-Il>24?(t<1/0&&(Gl=setTimeout(Ql,t-Hl.now()-Yl)),Xl&&(Xl=clearInterval(Xl))):(Xl||(jl=Hl.now(),Xl=setInterval(Kl,1e3)),Bl=1,El(Ql)))}ql.prototype=Ul.prototype={constructor:ql,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?Vl():+i)+(null==e?0:+e),this._next||Nl===this||(Nl?Nl._next=this:Rl=this,Nl=this),this._call=t,this._time=i,Jl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Jl())}};var ts=Object.freeze({now:Vl,timer:Ul,timerFlush:Zl,timeout:function(t,e,i){var n=new ql;return e=null==e?0:+e,n.restart((function(i){n.stop(),t(i+e)}),e,i),n},interval:function(t,e,i){var n=new ql,a=e;return null==e?(n.restart(t,e,i),n):(e=+e,i=null==i?Vl():+i,n.restart((function o(r){r+=a,n.restart(o,a+=e,i),t(r)}),e,i),n)}}),es={value:function(){}};function is(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n)throw new Error("illegal type: "+t);n[t]=[]}return new ns(n)}function ns(t){this._=t}function as(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}function os(t,e){for(var i,n=0,a=t.length;n<a;++n)if((i=t[n]).name===e)return i.value}function rs(t,e,i){for(var n=0,a=t.length;n<a;++n)if(t[n].name===e){t[n]=es,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}ns.prototype=is.prototype={constructor:ns,on:function(t,e){var i,n=this._,a=as(t+"",n),o=-1,r=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<r;)if(i=(t=a[o]).type)n[i]=rs(n[i],t.name,e);else if(null==e)for(i in n)n[i]=rs(n[i],t.name,null);return this}for(;++o<r;)if((i=(t=a[o]).type)&&(i=os(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new ns(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,a=new Array(i),o=0;o<i;++o)a[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,i=(n=this._[t]).length;o<i;++o)n[o].value.apply(e,a)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],a=0,o=n.length;a<o;++a)n[a].value.apply(e,i)}};var ls=Object.freeze({dispatch:is});function ss(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function us(t){let e=t,i=t;function n(t,e,n,a){for(null==n&&(n=0),null==a&&(a=t.length);n<a;){const o=n+a>>>1;i(t[o],e)<0?n=o+1:a=o}return n}return 1===t.length&&(e=(e,i)=>t(e)-i,i=function(t){return(e,i)=>ss(t(e),i)}(t)),{left:n,center:function(t,i,a,o){null==a&&(a=0),null==o&&(o=t.length);const r=n(t,i,a,o-1);return r>a&&e(t[r-1],i)>-e(t[r],i)?r-1:r},right:function(t,e,n,a){for(null==n&&(n=0),null==a&&(a=t.length);n<a;){const o=n+a>>>1;i(t[o],e)>0?a=o:n=o+1}return n}}}function cs(t){return null===t?NaN:+t}const hs=us(ss),ds=hs.right,_s=hs.left,fs=us(cs).center;function ps(t,e){let i=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&++i;else{let n=-1;for(let a of t)null!=(a=e(a,++n,t))&&(a=+a)>=a&&++i}return i}function ys(t){return 0|t.length}function xs(t){return!(t>0)}function gs(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}function vs(t,e){let i,n=0,a=0,o=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(i=e-a,a+=i/++n,o+=i*(e-a));else{let r=-1;for(let l of t)null!=(l=e(l,++r,t))&&(l=+l)>=l&&(i=l-a,a+=i/++n,o+=i*(l-a))}if(n>1)return o/(n-1)}function ms(t,e){const i=vs(t,e);return i?Math.sqrt(i):i}function bs(t,e){let i,n;if(void 0===e)for(const e of t)null!=e&&(void 0===i?e>=e&&(i=n=e):(i>e&&(i=e),n<e&&(n=e)));else{let a=-1;for(let o of t)null!=(o=e(o,++a,t))&&(void 0===i?o>=o&&(i=n=o):(i>o&&(i=o),n<o&&(n=o)))}return[i,n]}class Ss{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let i=0;for(let n=0;n<this._n&&n<32;n++){const a=e[n],o=t+a,r=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);r&&(e[i++]=r),t=o}return e[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let e,i,n,a=this._n,o=0;if(a>0){for(o=t[--a];a>0&&(e=o,i=t[--a],o=e+i,n=i-(o-e),!n););a>0&&(n<0&&t[a-1]<0||n>0&&t[a-1]>0)&&(i=2*n,e=o+i,i==e-o&&(o=e))}return o}}class ks extends Map{constructor(t=[],e=Ls){super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}});for(const[e,i]of t)this.set(e,i)}get(t){return super.get(Cs(this,t))}has(t){return super.has(Cs(this,t))}set(t,e){return super.set(Os(this,t),e)}delete(t){return super.delete(Fs(this,t))}}class ws extends Set{constructor(t=[],e=Ls){super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}});for(const e of t)this.add(e)}has(t){return super.has(Cs(this,t))}add(t){return super.add(Os(this,t))}delete(t){return super.delete(Fs(this,t))}}function Cs({_intern:t,_key:e},i){const n=e(i);return t.has(n)?t.get(n):i}function Os({_intern:t,_key:e},i){const n=e(i);return t.has(n)?t.get(n):(t.set(n,i),i)}function Fs({_intern:t,_key:e},i){const n=e(i);return t.has(n)&&(i=t.get(i),t.delete(n)),i}function Ls(t){return null!==t&&"object"==typeof t?t.valueOf():t}function Ps(t){return t}function As(t,...e){return Ms(t,Ps,Ps,e)}function Ws(t,e,...i){return Ms(t,Ps,e,i)}function zs(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function Ms(t,e,i,n){return function t(a,o){if(o>=n.length)return i(a);const r=new ks,l=n[o++];let s=-1;for(const t of a){const e=l(t,++s,a),i=r.get(e);i?i.push(t):r.set(e,[t])}for(const[e,i]of r)r.set(e,t(i,o));return e(r)}(t,0)}function Ds(t,e){return Array.from(e,(e=>t[e]))}function Rs(t,...e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[i=ss]=e;if(1===i.length||e.length>1){const n=Uint32Array.from(t,((t,e)=>e));return e.length>1?(e=e.map((e=>t.map(e))),n.sort(((t,i)=>{for(const n of e){const e=ss(n[t],n[i]);if(e)return e}}))):(i=t.map(i),n.sort(((t,e)=>ss(i[t],i[e])))),Ds(t,n)}return t.sort(i)}var Ns=Array.prototype.slice;function Ts(t){return function(){return t}}var Bs=Math.sqrt(50),Gs=Math.sqrt(10),Xs=Math.sqrt(2);function js(t,e,i){var n,a,o,r,l=-1;if(i=+i,(t=+t)===(e=+e)&&i>0)return[t];if((n=e<t)&&(a=t,t=e,e=a),0===(r=Is(t,e,i))||!isFinite(r))return[];if(r>0)for(t=Math.ceil(t/r),e=Math.floor(e/r),o=new Array(a=Math.ceil(e-t+1));++l<a;)o[l]=(t+l)*r;else for(r=-r,t=Math.ceil(t*r),e=Math.floor(e*r),o=new Array(a=Math.ceil(e-t+1));++l<a;)o[l]=(t+l)/r;return n&&o.reverse(),o}function Is(t,e,i){var n=(e-t)/Math.max(0,i),a=Math.floor(Math.log(n)/Math.LN10),o=n/Math.pow(10,a);return a>=0?(o>=Bs?10:o>=Gs?5:o>=Xs?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(o>=Bs?10:o>=Gs?5:o>=Xs?2:1)}function Ys(t,e,i){let n;for(;;){const a=Is(t,e,i);if(a===n||0===a||!isFinite(a))return[t,e];a>0?(t=Math.floor(t/a)*a,e=Math.ceil(e/a)*a):a<0&&(t=Math.ceil(t*a)/a,e=Math.floor(e*a)/a),n=a}}function Hs(t){return Math.ceil(Math.log(ps(t))/Math.LN2)+1}function Es(){var t=Ps,e=bs,i=Hs;function n(n){Array.isArray(n)||(n=Array.from(n));var a,o,r=n.length,l=new Array(r);for(a=0;a<r;++a)l[a]=t(n[a],a,n);var s=e(l),u=s[0],c=s[1],h=i(l,u,c);if(!Array.isArray(h)){const t=c,i=+h;if(e===bs&&([u,c]=Ys(u,c,i)),(h=js(u,c,i))[h.length-1]>=c)if(t>=c&&e===bs){const t=Is(u,c,i);isFinite(t)&&(t>0?c=(Math.floor(c/t)+1)*t:t<0&&(c=(Math.ceil(c*-t)+1)/-t))}else h.pop()}for(var d=h.length;h[0]<=u;)h.shift(),--d;for(;h[d-1]>c;)h.pop(),--d;var _,f=new Array(d+1);for(a=0;a<=d;++a)(_=f[a]=[]).x0=a>0?h[a-1]:u,_.x1=a<d?h[a]:c;for(a=0;a<r;++a)u<=(o=l[a])&&o<=c&&f[ds(h,o,0,d)].push(n[a]);return f}return n.value=function(e){return arguments.length?(t="function"==typeof e?e:Ts(e),n):t},n.domain=function(t){return arguments.length?(e="function"==typeof t?t:Ts([t[0],t[1]]),n):e},n.thresholds=function(t){return arguments.length?(i="function"==typeof t?t:Array.isArray(t)?Ts(Ns.call(t)):Ts(t),n):i},n}function Vs(t,e){let i;if(void 0===e)for(const e of t)null!=e&&(i<e||void 0===i&&e>=e)&&(i=e);else{let n=-1;for(let a of t)null!=(a=e(a,++n,t))&&(i<a||void 0===i&&a>=a)&&(i=a)}return i}function $s(t,e){let i;if(void 0===e)for(const e of t)null!=e&&(i>e||void 0===i&&e>=e)&&(i=e);else{let n=-1;for(let a of t)null!=(a=e(a,++n,t))&&(i>a||void 0===i&&a>=a)&&(i=a)}return i}function qs(t,e,i=0,n=t.length-1,a=ss){for(;n>i;){if(n-i>600){const o=n-i+1,r=e-i+1,l=Math.log(o),s=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*s*(o-s)/o)*(r-o/2<0?-1:1);qs(t,e,Math.max(i,Math.floor(e-r*s/o+u)),Math.min(n,Math.floor(e+(o-r)*s/o+u)),a)}const o=t[e];let r=i,l=n;for(Us(t,i,e),a(t[n],o)>0&&Us(t,i,n);r<l;){for(Us(t,r,l),++r,--l;a(t[r],o)<0;)++r;for(;a(t[l],o)>0;)--l}0===a(t[i],o)?Us(t,i,l):(++l,Us(t,l,n)),l<=e&&(i=l+1),e<=l&&(n=l-1)}return t}function Us(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function Zs(t,e,i){if(n=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let i=-1;for(let n of t)null!=(n=e(n,++i,t))&&(n=+n)>=n&&(yield n)}}(t,i))).length){if((e=+e)<=0||n<2)return $s(t);if(e>=1)return Vs(t);var n,a=(n-1)*e,o=Math.floor(a),r=Vs(qs(t,o).subarray(0,o+1));return r+($s(t.subarray(o+1))-r)*(a-o)}}function Qs(t,e){let i,n=-1,a=-1;if(void 0===e)for(const e of t)++a,null!=e&&(i<e||void 0===i&&e>=e)&&(i=e,n=a);else for(let o of t)null!=(o=e(o,++a,t))&&(i<o||void 0===i&&o>=o)&&(i=o,n=a);return n}function Ks(t,e){let i,n=-1,a=-1;if(void 0===e)for(const e of t)++a,null!=e&&(i>e||void 0===i&&e>=e)&&(i=e,n=a);else for(let o of t)null!=(o=e(o,++a,t))&&(i>o||void 0===i&&o>=o)&&(i=o,n=a);return n}function Js(t,e){return[t,e]}function tu(t,e=ss){if(1===e.length)return Ks(t,e);let i,n=-1,a=-1;for(const o of t)++a,(n<0?0===e(o,o):e(o,i)<0)&&(i=o,n=a);return n}var eu=iu(Math.random);function iu(t){return function(e,i=0,n=e.length){let a=n-(i=+i);for(;a;){const n=t()*a--|0,o=e[a+i];e[a+i]=e[n+i],e[n+i]=o}return e}}function nu(t){if(!(a=t.length))return[];for(var e=-1,i=$s(t,au),n=new Array(i);++e<i;)for(var a,o=-1,r=n[e]=new Array(a);++o<a;)r[o]=t[o][e];return n}function au(t){return t.length}function ou(t){return t instanceof Set?t:new Set(t)}function ru(t,e){const i=t[Symbol.iterator](),n=new Set;for(const t of e){if(n.has(t))continue;let e,a;for(;({value:e,done:a}=i.next());){if(a)return!1;if(n.add(e),Object.is(t,e))break}}return!0}var lu=Object.freeze({bisect:ds,bisectRight:ds,bisectLeft:_s,bisectCenter:fs,ascending:ss,bisector:us,count:ps,cross:function(...t){const e="function"==typeof t[t.length-1]&&function(t){return e=>t(...e)}(t.pop()),i=(t=t.map(gs)).map(ys),n=t.length-1,a=new Array(n+1).fill(0),o=[];if(n<0||i.some(xs))return o;for(;;){o.push(a.map(((e,i)=>t[i][e])));let r=n;for(;++a[r]===i[r];){if(0===r)return e?o.map(e):o;a[r--]=0}}},cumsum:function(t,e){var i=0,n=0;return Float64Array.from(t,void 0===e?t=>i+=+t||0:a=>i+=+e(a,n++,t)||0)},descending:function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},deviation:ms,extent:bs,fsum:function(t,e){const i=new Ss;if(void 0===e)for(let e of t)(e=+e)&&i.add(e);else{let n=-1;for(let a of t)(a=+e(a,++n,t))&&i.add(a)}return+i},Adder:Ss,group:As,groups:function(t,...e){return Ms(t,Array.from,Ps,e)},index:function(t,...e){return Ms(t,Ps,zs,e)},indexes:function(t,...e){return Ms(t,Array.from,zs,e)},rollup:Ws,rollups:function(t,e,...i){return Ms(t,Array.from,e,i)},groupSort:function(t,e,i){return(1===e.length?Rs(Ws(t,e,i),(([t,e],[i,n])=>ss(e,n)||ss(t,i))):Rs(As(t,i),(([t,i],[n,a])=>e(i,a)||ss(t,n)))).map((([t])=>t))},bin:Es,histogram:Es,thresholdFreedmanDiaconis:function(t,e,i){return Math.ceil((i-e)/(2*(Zs(t,.75)-Zs(t,.25))*Math.pow(ps(t),-1/3)))},thresholdScott:function(t,e,i){return Math.ceil((i-e)/(3.5*ms(t)*Math.pow(ps(t),-1/3)))},thresholdSturges:Hs,max:Vs,maxIndex:Qs,mean:function(t,e){let i=0,n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++i,n+=e);else{let a=-1;for(let o of t)null!=(o=e(o,++a,t))&&(o=+o)>=o&&(++i,n+=o)}if(i)return n/i},median:function(t,e){return Zs(t,.5,e)},merge:function(t){return Array.from(function*(t){for(const e of t)yield*e}(t))},min:$s,minIndex:Ks,nice:Ys,pairs:function(t,e=Js){const i=[];let n,a=!1;for(const o of t)a&&i.push(e(n,o)),n=o,a=!0;return i},permute:Ds,quantile:Zs,quantileSorted:function(t,e,i=cs){if(n=t.length){if((e=+e)<=0||n<2)return+i(t[0],0,t);if(e>=1)return+i(t[n-1],n-1,t);var n,a=(n-1)*e,o=Math.floor(a),r=+i(t[o],o,t);return r+(+i(t[o+1],o+1,t)-r)*(a-o)}},quickselect:qs,range:function(t,e,i){t=+t,e=+e,i=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+i;for(var n=-1,a=0|Math.max(0,Math.ceil((e-t)/i)),o=new Array(a);++n<a;)o[n]=t+n*i;return o},least:function(t,e=ss){let i,n=!1;if(1===e.length){let a;for(const o of t){const t=e(o);(n?ss(t,a)<0:0===ss(t,t))&&(i=o,a=t,n=!0)}}else for(const a of t)(n?e(a,i)<0:0===e(a,a))&&(i=a,n=!0);return i},leastIndex:tu,greatest:function(t,e=ss){let i,n=!1;if(1===e.length){let a;for(const o of t){const t=e(o);(n?ss(t,a)>0:0===ss(t,t))&&(i=o,a=t,n=!0)}}else for(const a of t)(n?e(a,i)>0:0===e(a,a))&&(i=a,n=!0);return i},greatestIndex:function(t,e=ss){if(1===e.length)return Qs(t,e);let i,n=-1,a=-1;for(const o of t)++a,(n<0?0===e(o,o):e(o,i)>0)&&(i=o,n=a);return n},scan:function(t,e){const i=tu(t,e);return i<0?void 0:i},shuffle:eu,shuffler:iu,sum:function(t,e){let i=0;if(void 0===e)for(let e of t)(e=+e)&&(i+=e);else{let n=-1;for(let a of t)(a=+e(a,++n,t))&&(i+=a)}return i},ticks:js,tickIncrement:Is,tickStep:function(t,e,i){var n=Math.abs(e-t)/Math.max(0,i),a=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),o=n/a;return o>=Bs?a*=10:o>=Gs?a*=5:o>=Xs&&(a*=2),e<t?-a:a},transpose:nu,variance:vs,zip:function(){return nu(arguments)},every:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let i=-1;for(const n of t)if(!e(n,++i,t))return!1;return!0},some:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let i=-1;for(const n of t)if(e(n,++i,t))return!0;return!1},filter:function(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");const i=[];let n=-1;for(const a of t)e(a,++n,t)&&i.push(a);return i},map:function(t,e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof e)throw new TypeError("mapper is not a function");return Array.from(t,((i,n)=>e(i,n,t)))},reduce:function(t,e,i){if("function"!=typeof e)throw new TypeError("reducer is not a function");const n=t[Symbol.iterator]();let a,o,r=-1;if(arguments.length<3){if(({done:a,value:i}=n.next()),a)return;++r}for(;({done:a,value:o}=n.next()),!a;)i=e(i,o,++r,t);return i},reverse:function(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()},sort:Rs,difference:function(t,...e){t=new Set(t);for(const i of e)for(const e of i)t.delete(e);return t},disjoint:function(t,e){const i=e[Symbol.iterator](),n=new Set;for(const e of t){if(n.has(e))return!1;let t,a;for(;({value:t,done:a}=i.next())&&!a;){if(Object.is(e,t))return!1;n.add(t)}}return!0},intersection:function(t,...e){t=new Set(t),e=e.map(ou);t:for(const i of t)for(const n of e)if(!n.has(i)){t.delete(i);continue t}return t},subset:function(t,e){return ru(e,t)},superset:ru,union:function(...t){const e=new Set;for(const i of t)for(const t of i)e.add(t);return e},InternMap:ks,InternSet:ws});function su(t,e){return t[0]-e[0]||t[1]-e[1]}function uu(t){const e=t.length,i=[0,1];let n,a=2;for(n=2;n<e;++n){for(;a>1&&(o=t[i[a-2]],r=t[i[a-1]],l=t[n],(r[0]-o[0])*(l[1]-o[1])-(r[1]-o[1])*(l[0]-o[0])<=0);)--a;i[a++]=n}var o,r,l;return i.slice(0,a)}var cu=Object.freeze({polygonArea:function(t){for(var e,i=-1,n=t.length,a=t[n-1],o=0;++i<n;)e=a,a=t[i],o+=e[1]*a[0]-e[0]*a[1];return o/2},polygonCentroid:function(t){for(var e,i,n=-1,a=t.length,o=0,r=0,l=t[a-1],s=0;++n<a;)e=l,l=t[n],s+=i=e[0]*l[1]-l[0]*e[1],o+=(e[0]+l[0])*i,r+=(e[1]+l[1])*i;return[o/(s*=3),r/s]},polygonHull:function(t){if((i=t.length)<3)return null;var e,i,n=new Array(i),a=new Array(i);for(e=0;e<i;++e)n[e]=[+t[e][0],+t[e][1],e];for(n.sort(su),e=0;e<i;++e)a[e]=[n[e][0],-n[e][1]];var o=uu(n),r=uu(a),l=r[0]===o[0],s=r[r.length-1]===o[o.length-1],u=[];for(e=o.length-1;e>=0;--e)u.push(t[n[o[e]][2]]);for(e=+l;e<r.length-s;++e)u.push(t[n[r[e]][2]]);return u},polygonContains:function(t,e){for(var i,n,a=t.length,o=t[a-1],r=e[0],l=e[1],s=o[0],u=o[1],c=!1,h=0;h<a;++h)i=(o=t[h])[0],(n=o[1])>l!=u>l&&r<(s-i)*(l-n)/(u-n)+i&&(c=!c),s=i,u=n;return c},polygonLength:function(t){for(var e,i,n=-1,a=t.length,o=t[a-1],r=o[0],l=o[1],s=0;++n<a;)e=r,i=l,e-=r=(o=t[n])[0],i-=l=o[1],s+=Math.hypot(e,i);return s}}),hu=Aa((function(t,e){!function(t,e,i){var n=1e-10;function a(t){return t<=n&&t>=-n}function o(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function r(t,e){return a(t.x*e.y-t.y*e.x)&&a(t.y*e.z-t.z*e.y)&&a(t.z*e.x-t.x*e.z)}function l(t){var e,i,n,a,o,r,l;if(n=t[t.length-2],a=t[t.length-1],o=t[0],i=u(s(n,a),r=s(a,o)),e=Math.sign(i),n=a,i=u(r,r=s(a=o,o=t[1])),Math.sign(i)===e){for(l=2;l<t.length-1;l++)if(n=a,i=u(r,r=s(a=o,o=t[l])),Math.sign(i)!==e)return;return e}}function s(t,e){return[e[0]-t[0],e[1]-t[1]]}function u(t,e){return t[0]*e[1]-t[1]*e[0]}function c(t,e){this.face=t,this.vert=e,this.nextf=null,this.prevf=null,this.nextv=null,this.prevv=null}function h(t){this.forFace=t,this.head=null}function d(t,e,i,a,o,r){this.x=t,this.y=e,this.weight=n,this.index=0,this.conflicts=new h(!1),this.neighbours=null,this.nonClippedPolygon=null,this.polygon=null,this.originalObject=null,this.isDummy=!1,void 0!==o&&(this.originalObject=o),null!=r&&(this.isDummy=r),null!=a&&(this.weight=a),this.z=null!=i?i:this.projectZ(this.x,this.y,this.weight)}function _(t){var e=t.verts[0],i=t.verts[1],n=t.verts[2];this.a=e.y*(i.z-n.z)+i.y*(n.z-e.z)+n.y*(e.z-i.z),this.b=e.z*(i.x-n.x)+i.z*(n.x-e.x)+n.z*(e.x-i.x),this.c=e.x*(i.y-n.y)+i.x*(n.y-e.y)+n.x*(e.y-i.y),this.d=-1*(e.x*(i.y*n.z-n.y*i.z)+i.x*(n.y*e.z-e.y*n.z)+n.x*(e.y*i.z-i.y*e.z))}function f(t,e){this.x=t,this.y=e}function p(t,e,i){this.x=t,this.y=e,this.z=i}function y(t,e,i){this.next=null,this.prev=null,this.twin=null,this.orig=t,this.dest=e,this.iFace=i}function x(t){this.message=t,this.stack=(new Error).stack}function g(t,e,i,n){this.conflicts=new h(!0),this.verts=[t,e,i],this.marked=!1;var a=t.subtract(e).crossproduct(e.subtract(i));this.normal=new p(-a.x,-a.y,-a.z),this.normal.normalize(),this.createEdges(),this.dualPoint=null,null!=n&&this.orient(n)}function v(){this.points=[],this.facets=[],this.created=[],this.horizon=[],this.visible=[],this.current=0}function m(t,e){for(var i,n,a,o,r,l,s,u=k(e),c=-1,h=t.length-k(t),d=t[h-1];++c<h;){for(i=e.slice(),e.length=0,o=t[c],r=i[(a=i.length-u)-1],n=-1;++n<a;)b(l=i[n],d,o)?(b(r,d,o)||(s=S(r,l,d,o),isFinite(s[0])&&e.push(s)),e.push(l)):b(r,d,o)&&(s=S(r,l,d,o),isFinite(s[0])&&e.push(s)),r=l;u&&e.push(e[0]),d=o}return e}function b(t,e,i){return(i[0]-e[0])*(t[1]-e[1])<(i[1]-e[1])*(t[0]-e[0])}function S(t,e,i,n){var a=t[0],o=i[0],r=e[0]-a,l=n[0]-o,s=t[1],u=i[1],c=e[1]-s,h=n[1]-u,d=(l*(s-u)-h*(a-o))/(h*r-l*c);return[a+d*r,s+d*c]}function k(t){var e=t[0],i=t[t.length-1];return!(e[0]-i[0]||e[1]-i[1])}function w(t){var e=[],i=t,n=t.dest.originalObject,a=[];do{var o=(i=i.twin.prev).orig.originalObject;o.isDummy||a.push(o);var r=i.iFace;r.isVisibleFromBelow()&&e.push(r)}while(i!==t);return n.neighbours=a,e}function C(t,e,a){var o=new v;o.clear(),o.init(e,t);for(var r=o.compute(t),l=[],s=[],u=r.length,c=0;c<u;c++){var h=r[c];if(h.isVisibleFromBelow())for(var d=0;d<3;d++){var _=h.edges[d],f=_.dest,p=f.originalObject;if(!s[f.index]){if(s[f.index]=!0,p.isDummy)continue;for(var y=w(_),x=[],g=null,b=null,S=1,k=1,C=0;C<y.length;C++){var O=y[C].getDualPoint(),F=O.x,L=O.y;null!==g&&((S=g-F)<0&&(S=-S),(k=b-L)<0&&(k=-k)),(S>n||k>n)&&(x.push([F,L]),g=F,b=L)}if(p.nonClippedPolygon=x.reverse(),!p.isDummy&&i.polygonLength(p.nonClippedPolygon)>0){var P=m(a,p.nonClippedPolygon);p.polygon=P,P.site=p,P.length>0&&l.push(P)}}}}return l}function O(){var t=function(t){return t.x},a=function(t){return t.y},o=function(t){return t.weight},r=[[0,0],[0,1],[1,1],[1,0]],s=[[0,0],[1,1]],u=[1,1];function c(e){return C(e.map((function(e){return new d(t(e),a(e),null,o(e),e,!1)})),h(),r)}function h(){var t,e,i,a,o,r,l,u,c,h,_=[],f=[];l=(t=s[0][0])-(o=(e=s[1][0])-t),u=e+o,c=(i=s[0][1])-(r=(a=s[1][1])-i),h=a+r,_[0]=[l,c],_[1]=[l,h],_[2]=[u,h],_[3]=[u,c];for(var p=0;p<4;p++)f.push(new d(_[p][0],_[p][1],null,n,new d(_[p][0],_[p][1],null,n,null,!0),!0));return f}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(a=t,c):a},c.weight=function(t){return arguments.length?(o=t,c):o},c.clip=function(t){var n,a,o;return arguments.length?(a=e.extent(t.map((function(t){return t[0]}))),o=e.extent(t.map((function(t){return t[1]}))),n=l(t),r=void 0===n?i.polygonHull(t):1===n?t.reverse():t,s=[[a[0],o[0]],[a[1],o[1]]],u=[a[1]-a[0],o[1]-o[0]],c):r},c.extent=function(t){return arguments.length?(r=[t[0],[t[0][0],t[1][1]],t[1],[t[1][0],t[0][1]]],s=t,u=[t[1][0]-t[0][0],t[1][1]-t[0][1]],c):s},c.size=function(t){return arguments.length?(r=[[0,0],[0,t[1]],[t[0],t[1]],[t[0],0]],s=[[0,0],t],u=t,c):u},c}h.prototype.add=function(t){null===this.head?this.head=t:this.forFace?(this.head.prevv=t,t.nextv=this.head,this.head=t):(this.head.prevf=t,t.nextf=this.head,this.head=t)},h.prototype.isEmpty=function(){return null===this.head},h.prototype.fill=function(t){if(!this.forFace){var e=this.head;do{t.push(e.face),e.face.marked=!0,e=e.nextf}while(null!==e)}},h.prototype.removeAll=function(){if(this.forFace){var t=this.head;do{null===t.prevf?null===t.nextf?t.vert.conflicts.head=null:(t.nextf.prevf=null,t.vert.conflicts.head=t.nextf):(null!=t.nextf&&(t.nextf.prevf=t.prevf),t.prevf.nextf=t.nextf),null!=(t=t.nextv)&&(t.prevv=null)}while(null!=t)}else{t=this.head;do{null==t.prevv?null==t.nextv?t.face.conflicts.head=null:(t.nextv.prevv=null,t.face.conflicts.head=t.nextv):(null!=t.nextv&&(t.nextv.prevv=t.prevv),t.prevv.nextv=t.nextv),null!=(t=t.nextf)&&(t.prevf=null)}while(null!=t)}},h.prototype.getVertices=function(){for(var t=[],e=this.head;null!==e;)t.push(e.vert),e=e.nextv;return t},d.prototype.projectZ=function(t,e,i){return t*t+e*e-i},d.prototype.setWeight=function(t){this.weight=t,this.z=this.projectZ(this.x,this.y,this.weight)},d.prototype.subtract=function(t){return new d(t.x-this.x,t.y-this.y,t.z-this.z)},d.prototype.crossproduct=function(t){return new d(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},d.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},_.prototype.getNormZPlane=function(){return[this.a/this.c*-1,this.b/this.c*-1,this.d/this.c*-1]},_.prototype.getDualPointMappedToPlane=function(){var t=this.getNormZPlane();return new f(t[0]/2,t[1]/2)},p.prototype.negate=function(){this.x*=-1,this.y*=-1,this.z*=-1},p.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);t>0&&(this.x/=t,this.y/=t,this.z/=t)},y.prototype.isHorizon=function(){return null!==this.twin&&!this.iFace.marked&&this.twin.iFace.marked},y.prototype.findHorizon=function(t){if(this.isHorizon()){if(t.length>0&&this===t[0])return;t.push(this),this.next.findHorizon(t)}else null!==this.twin&&this.twin.next.findHorizon(t)},y.prototype.isEqual=function(t,e){return this.orig.equals(t)&&this.dest.equals(e)||this.orig.equals(e)&&this.dest.equals(t)},x.prototype.name="d3WeightedVoronoiError",x.prototype=new Error,g.prototype.getDualPoint=function(){if(null==this.dualPoint){var t=new _(this);this.dualPoint=t.getDualPointMappedToPlane()}return this.dualPoint},g.prototype.isVisibleFromBelow=function(){return this.normal.z<-1.4259414393190911e-9},g.prototype.createEdges=function(){this.edges=[],this.edges[0]=new y(this.verts[0],this.verts[1],this),this.edges[1]=new y(this.verts[1],this.verts[2],this),this.edges[2]=new y(this.verts[2],this.verts[0],this),this.edges[0].next=this.edges[1],this.edges[0].prev=this.edges[2],this.edges[1].next=this.edges[2],this.edges[1].prev=this.edges[0],this.edges[2].next=this.edges[0],this.edges[2].prev=this.edges[1]},g.prototype.orient=function(t){if(!(o(this.normal,t)<o(this.normal,this.verts[0]))){var e=this.verts[1];this.verts[1]=this.verts[2],this.verts[2]=e,this.normal.negate(),this.createEdges()}},g.prototype.getEdge=function(t,e){for(var i=0;i<3;i++)if(this.edges[i].isEqual(t,e))return this.edges[i];return null},g.prototype.link=function(t,e,i){if(t instanceof g){if(null===(n=t.getEdge(e,i)))throw new x("when linking, twin is null");if(null===(a=this.getEdge(e,i)))throw new x("when linking, twin is null");n.twin=a,a.twin=n}else{var n=t,a=this.getEdge(n.orig,n.dest);n.twin=a,a.twin=n}},g.prototype.conflict=function(t){return o(this.normal,t)>o(this.normal,this.verts[0])+n},g.prototype.getHorizon=function(){for(var t=0;t<3;t++)if(null!==this.edges[t].twin&&this.edges[t].twin.isHorizon())return this.edges[t];return null},g.prototype.removeConflict=function(){this.conflicts.removeAll()},v.prototype.init=function(t,e){this.points=[];for(var i=0;i<e.length;i++)this.points[i]=new d(e[i].x,e[i].y,e[i].z,null,e[i],!1);this.points=this.points.concat(t)},v.prototype.permutate=function(){for(var t=this.points.length-1;t>0;t--){var e=Math.floor(Math.random()*t),i=this.points[e];i.index=t;var n=this.points[t];n.index=e,this.points.splice(e,1,n),this.points.splice(t,1,i)}},v.prototype.prep=function(){if(this.points.length<=3)throw new x("Less than 4 points");for(var t=0;t<this.points.length;t++)this.points[t].index=t;var e,i,n,a,l,s,u,c,h;for(e=this.points[0],i=this.points[1],n=a=null,t=2;t<this.points.length;t++)if(!r(e,this.points[t])||!r(i,this.points[t])){(n=this.points[t]).index=2,this.points[2].index=t,this.points.splice(t,1,this.points[2]),this.points.splice(2,1,n);break}if(null===n)throw new x("v2 is null");for(c=new g(e,i,n),t=3;t<this.points.length;t++)if(o(c.normal,c.verts[0])!==o(c.normal,this.points[t])){(a=this.points[t]).index=3,this.points[3].index=t,this.points.splice(t,1,this.points[3]),this.points.splice(3,1,a);break}if(null===a)throw new x("v3 is null");for(c.orient(a),l=new g(e,n,a,i),s=new g(e,i,a,n),u=new g(i,n,a,e),this.addFacet(c),this.addFacet(l),this.addFacet(s),this.addFacet(u),c.link(l,e,n),c.link(s,e,i),c.link(u,i,n),l.link(s,e,a),l.link(u,n,a),s.link(u,a,i),this.current=4,t=this.current;t<this.points.length;t++)h=this.points[t],c.conflict(h)&&this.addConflict(c,h),l.conflict(h)&&this.addConflict(l,h),s.conflict(h)&&this.addConflict(s,h),u.conflict(h)&&this.addConflict(u,h)},v.prototype.addConflicts=function(t,e,i){var n,a,o,r=t.conflicts.getVertices(),l=e.conflicts.getVertices(),s=[];for(u=o=0;u<r.length||o<l.length;)u<r.length&&o<l.length?(n=r[u],a=l[o],n.index===a.index?(s.push(n),u++,o++):n.index>a.index?(s.push(n),u++):(s.push(a),o++)):u<r.length?s.push(r[u++]):s.push(l[o++]);for(var u=s.length-1;u>=0;u--)n=s[u],i.conflict(n)&&this.addConflict(i,n)},v.prototype.addConflict=function(t,e){var i=new c(t,e);t.conflicts.add(i),e.conflicts.add(i)},v.prototype.removeConflict=function(t){t.removeConflict();var e=t.index;if(t.index=-1,e!==this.facets.length-1){if(!(e>=this.facets.length||e<0)){var i=this.facets.splice(this.facets.length-1,1);i[0].index=e,this.facets.splice(e,1,i[0])}}else this.facets.splice(this.facets.length-1,1)},v.prototype.addFacet=function(t){t.index=this.facets.length,this.facets.push(t)},v.prototype.compute=function(){for(this.prep();this.current<this.points.length;){var t=this.points[this.current];if(t.conflicts.isEmpty())this.current++;else{var e;this.created=[],this.horizon=[],this.visible=[],t.conflicts.fill(this.visible);for(var i=0;i<this.visible.length;i++)if(null!==(e=this.visible[i].getHorizon())){e.findHorizon(this.horizon);break}for(var n=null,a=null,o=0;o<this.horizon.length;o++){var r=this.horizon[o],l=new g(t,r.orig,r.dest,r.twin.next.dest);l.conflicts=new h(!0),this.addFacet(l),this.created.push(l),this.addConflicts(r.iFace,r.twin.iFace,l),l.link(r),null!==n&&l.link(n,t,r.orig),n=l,null===a&&(a=l)}if(null!==a&&null!==n&&n.link(a,t,this.horizon[0].orig),0!=this.created.length){for(var s=0;s<this.visible.length;s++)this.removeConflict(this.visible[s]);this.current++,this.created=[]}}}return this.facets},v.prototype.clear=function(){this.points=[],this.facets=[],this.created=[],this.horizon=[],this.visible=[],this.current=0},t.weightedVoronoi=O,t.d3WeightedVoronoiError=x,Object.defineProperty(t,"__esModule",{value:!0})}(e,lu,cu)}));Pa(hu);var du=Aa((function(t,e){!function(t,e,i,n,a){function o(){this.growthChangesLength=r,this.totalAvailableArea=NaN,this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this.growthChangeWeights=s(this.growthChangesLength),this.growthChangeWeightsSum=u(this.growthChangeWeights)}var r=10;function l(t,e){return t>=e?1:-1}function s(t){for(var e=1,i=1,n=3,a=[],o=0;o<t;o++)a.push(n),(n-=e)<i&&(n=i);return a}function u(t){for(var e=0,i=0;i<t.length;i++)e+=t[i];return e}function c(){var t,i,n,a,o,r,l,s;function u(a,r,u,h){var d,_,f=!1;for(t!==h.clip()&&(t=h.clip(),i=h.extent(),f=!0),f&&c(),d=n+l*h.prng()(),_=o+s*h.prng()();!e.polygonContains(t,[d,_]);)d=n+l*h.prng()(),_=o+s*h.prng()();return[d,_]}function c(){n=i[0][0],a=i[1][0],o=i[0][1],r=i[1][1],l=a-n,s=r-o}return u}function h(){var t,i,n,a,o,r,l=0;function s(e,n,s,c){var h=!1;return t!==c.clip()&&(t=c.clip(),h|=!0),i!==s&&(i=s,h|=!0),h&&u(),[a[0]+Math.cos(l+n*r)*o+.001*(c.prng()()-.5),a[1]+Math.sin(l+n*r)*o+.001*(c.prng()()-.5)]}function u(){a=e.polygonCentroid(t),o=c(a,t)/2,n=i.length,r=2*Math.PI/n}function c(t,e){for(var i,n=1/0,a=0,o=e[e.length-1],r=e[a];a<e.length;)(i=h(t,o,r))<n&&(n=i),o=r,r=e[++a];return n}function h(t,e,i){var n,a,o=t[0],r=t[1],l=e[0],s=e[1],u=i[0],c=i[1],h=u-l,d=c-s,_=h*h+d*d,f=-1;0!=_&&(f=((o-l)*h+(r-s)*d)/_),f<0?(n=l,a=s):f>1?(n=u,a=c):(n=l+f*h,a=s+f*d);var p=o-n,y=r-a;return Math.sqrt(p*p+y*y)}return s.startAngle=function(t){return arguments.length?(l=t,s):l},s}function d(){var t,i,n,a,o;function r(e,n,a,r){var s=!1;return t!==r.clip()&&(t=r.clip(),s|=!0),i!==a&&(i=a,s|=!0),s&&l(),o}function l(){n=i.length,a=e.polygonArea(t),o=a/n/2}return r}function _(t){this.message=t,this.stack=(new Error).stack}function f(t){var r,l,s,u,h,f,p,y,x=.01,g=50,v=.01,m=Math.random,b=c(),S=d(),k=1e-10,w=function(t){return t.weight},C=x,O=g,F=v,L=m,P=b,A=S,W=a.weightedVoronoi(),z=new o,M=!0,D=i.timer(j),R=n.dispatch("tick","end");const N=1,T=1e3;var B;function G(t){return Math.pow(t,2)}function X(t,e){return G(e.x-t.x)+G(e.y-t.y)}function j(){I(),R.call("tick",y),p&&(D.stop(),R.call("end",y))}function I(){p||(M&&Y(),h=V(h,z.ratio()),u++,f=Q(h),z.add(f),p=f<s||u>=O)}function Y(){K(),r=t.length,l=Math.abs(e.polygonArea(W.clip())),s=C*l,z.clear().totalArea(l),u=0,h=H(t,y),p=!1,M=!1}function H(t,e){var i,n=t.reduce((function(t,e){return Math.max(t,w(e))}),-1/0)*F;return i=E(t.map((function(t,i,a){return{index:i,weight:Math.max(w(t),n),initialPosition:P(t,i,a,e),initialWeight:A(t,i,a,e),originalData:t}})),e),B(i),W(i)}function E(t,i){var n,a=t.reduce((function(t,e){return t+e.weight}),0);return t.map((function(t,o,r){return n=t.initialPosition,e.polygonContains(W.clip(),n)||(n=b(t,o,r,i)),{index:t.index,targetedArea:l*t.weight/a,data:t,x:n[0],y:n[1],weight:t.initialWeight}}))}function V(t,e){var i;if($(t,e),i=t.map((function(t){return t.site.originalObject})),(t=W(i)).length<r)throw new _("at least 1 site has no area, which is not supposed to arise");if(q(t,e),i=t.map((function(t){return t.site.originalObject})),(t=W(i)).length<r)throw new _("at least 1 site has no area, which is not supposed to arise");return t}function $(t,i){var n,a,o,l,s,u,c=[];n=1-.5*i;for(var h=0;h<r;h++)o=(a=t[h]).site.originalObject,s=(l=e.polygonCentroid(a))[0]-o.x,u=l[1]-o.y,s*=n,u*=n,o.x+=s,o.y+=u,c.push(o);B(c)}function q(t,i){var n,a,o,l,s,u,c=[],h=.1;n=h*i;for(var d=0;d<r;d++)o=(a=t[d]).site.originalObject,l=e.polygonArea(a),s=o.targetedArea/l,s=Math.max(s,1-h+n),s=Math.min(s,1+h-n),u=o.weight*s,u=Math.max(u,k),o.weight=u,c.push(o);B(c)}function U(t){var e,i,n,a,o,l,s,u=0;do{if(u>T)throw new _("handleOverweighted0 is looping too much");e=!1;for(var c=0;c<r;c++){i=t[c];for(var h=c+1;h<r;h++)if(n=t[h],i.weight>n.weight?(a=i,o=n):(a=n,o=i),(l=X(i,n))<a.weight-o.weight){s=l+o.weight/2,s=Math.max(s,k),a.weight=s,e=!0,u++;break}if(e)break}}while(e)}function Z(t){var e,i,n,a,o,l,s,u=0;do{if(u>T)throw new _("handleOverweighted1 is looping too much");e=!1;for(var c=0;c<r;c++){i=t[c];for(var h=c+1;h<r;h++)if(n=t[h],i.weight>n.weight?(a=i,o=n):(a=n,o=i),(l=X(i,n))<a.weight-o.weight){s=a.weight-o.weight-l,o.weight+=s+k,e=!0,u++;break}if(e)break}}while(e)}function Q(t){for(var i,n,a,o=0,l=0;l<r;l++)n=(i=t[l]).site.originalObject,a=e.polygonArea(i),o+=Math.abs(n.targetedArea-a);return o}function K(){switch(N){case 0:B=U;break;case 1:B=Z;break;default:console.error("unknown 'handleOverweighted' variant; using variant #1"),B=U}}return y={tick:I,restart:function(){return D.restart(j),y},stop:function(){return D.stop(),y},weight:function(t){return arguments.length?(w=t,M=!0,y):w},convergenceRatio:function(t){return arguments.length?(C=t,M=!0,y):C},maxIterationCount:function(t){return arguments.length?(O=t,y):O},minWeightRatio:function(t){return arguments.length?(F=t,M=!0,y):F},clip:function(t){return arguments.length?(W.clip(t),M=!0,y):W.clip()},extent:function(t){return arguments.length?(W.extent(t),M=!0,y):W.extent()},size:function(t){return arguments.length?(W.size(t),M=!0,y):W.size()},prng:function(t){return arguments.length?(L=t,M=!0,y):L},initialPosition:function(t){return arguments.length?(P=t,M=!0,y):P},initialWeight:function(t){return arguments.length?(A=t,M=!0,y):A},state:function(){return M&&Y(),{ended:p,iterationCount:u,convergenceRatio:f/l,polygons:h}},on:function(t,e){return 1===arguments.length?R.on(t):(R.on(t,e),y)}}}o.prototype.reset=function(){return this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this.growthChangesLength=r,this.growthChangeWeights=s(this.growthChangesLength),this.growthChangeWeightsSum=u(this.growthChangeWeights),this.totalAvailableArea=NaN,this},o.prototype.clear=function(){return this.lastAreaError=NaN,this.lastGrowth=NaN,this.growthChanges=[],this},o.prototype.length=function(t){return arguments.length?(parseInt(t)>0?(this.growthChangesLength=Math.floor(parseInt(t)),this.growthChangeWeights=s(this.growthChangesLength),this.growthChangeWeightsSum=u(this.growthChangeWeights)):console.warn("FlickeringMitigation.length() accepts only positive integers; unable to handle "+t),this):this.growthChangesLength},o.prototype.totalArea=function(t){return arguments.length?(parseFloat(t)>0?this.totalAvailableArea=parseFloat(t):console.warn("FlickeringMitigation.totalArea() accepts only positive numbers; unable to handle "+t),this):this.totalAvailableArea},o.prototype.add=function(t){var e,i;return e=this.lastAreaError,this.lastAreaError=t,isNaN(e)||(i=this.lastGrowth,this.lastGrowth=l(this.lastAreaError,e)),isNaN(i)||this.growthChanges.unshift(this.lastGrowth!=i),this.growthChanges.length>this.growthChangesLength&&this.growthChanges.pop(),this},o.prototype.ratio=function(){var t=0;if(this.growthChanges.length<this.growthChangesLength)return 0;if(this.lastAreaError>this.totalAvailableArea/10)return 0;for(var e=0;e<this.growthChangesLength;e++)this.growthChanges[e]&&(t+=this.growthChangeWeights[e]);return t/this.growthChangeWeightsSum},_.prototype.name="d3VoronoiMapError",_.prototype=new Error,t.voronoiMapSimulation=f,t.voronoiMapInitialPositionRandom=c,t.voronoiMapInitialPositionPie=h,t.d3VoronoiMapError=_,Object.defineProperty(t,"__esModule",{value:!0})}(e,Tl,ts,ls,hu)}));Pa(du);var _u=Aa((function(t,e){!function(t,e){function i(){var t=.01,i=50,n=.01,a=Math.random,o=[[0,0],[0,1],[1,1],[1,0]],r=[[0,0],[1,1]],l=[1,1],s=t,u=i,c=n,h=a,d=[{weight:1},{weight:1}],_=e.voronoiMapSimulation(d).stop();function f(t){p(o,t)}function p(t,i){var n;if(i.polygon=t,0!=i.height){for(var a=(n=e.voronoiMapSimulation(i.children).clip(t).weight((function(t){return t.value})).convergenceRatio(s).maxIterationCount(u).minWeightRatio(c).prng(h).stop()).state();!a.ended;)n.tick(),a=n.state();a.polygons.forEach((function(t){p(t,t.site.originalObject.data.originalData)}))}}return f.convergenceRatio=function(t){return arguments.length?(s=t,f):s},f.maxIterationCount=function(t){return arguments.length?(u=t,f):u},f.minWeightRatio=function(t){return arguments.length?(c=t,f):c},f.clip=function(t){return arguments.length?(_.clip(t),o=_.clip(),r=_.extent(),l=_.size(),f):o},f.extent=function(t){return arguments.length?(_.extent(t),o=_.clip(),r=_.extent(),l=_.size(),f):r},f.size=function(t){return arguments.length?(_.size(t),o=_.clip(),r=_.extent(),l=_.size(),f):l},f.prng=function(t){return arguments.length?(h=t,f):h},f}e="default"in e?e.default:e,t.voronoiTreemap=i,Object.defineProperty(t,"__esModule",{value:!0})}(e,du)}));Pa(_u);var fu=_u.voronoiTreemap,pu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","soap-bubble"),i._clipId="clip-overlay-"+i.id,i.overlayRect=i.elem.append("defs").append("clipPath").attr("id",i._clipId).append("rect"),i.xScale=d3.scaleLinear(),i.yScale=d3.scaleLinear(),i._width=400,i._height=400,i._paddingInner=0,i._paddingOuter=0,i._stroke="#fff",i._parentFillOpacity=.7,i._transition=!1,i._duration=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group,a={children:[]};if(a.children=e.children.filter((function(t){return 0!=t.sum})),a.children.length<1)return n.selectAll("*").remove(),t;n.selectAll("*").remove();var r=t._width,l=t._height;"fixed"==t._shapeType?n.call(o,r-l>0?(r-l)/2:0,l-r>0?(l-r)/2:0):n.call(o,0,0);var s=Math.min(r,l),u=d3.hierarchy(a).sum((function(t){return t.value})),h=d3.range(200).map((function(t){var e=t/200*2*Math.PI;return[s/2+s/2*Math.cos(e),s/2+s/2*Math.sin(e)]}));"auto"==t._shapeType&&(h=d3.range(200).map((function(t){var e=t/200*2*Math.PI;return[r/2+r/2*Math.cos(e),l/2+l/2*Math.sin(e)]}))),"triangle"==t._shapeChoice?(h=[[s/2,0],[s,s],[0,s]],"auto"==t._shapeType&&(h=[[r/2,0],[r,l],[0,l]])):"rectangle"==t._shapeChoice?(h=[[0,0],[s,0],[s,s],[0,s]],"auto"==t._shapeType&&(h=[[0,0],[r,0],[r,l],[0,l]])):"diamond"==t._shapeChoice?(h=d3.range(4).map((function(t){var e=t/4*2*Math.PI;return[s/2+s/2*Math.cos(e),s/2+s/2*Math.sin(e)]})),"auto"==t._shapeType&&(h=d3.range(4).map((function(t){var e=t/4*2*Math.PI;return[r/2+r/2*Math.cos(e),l/2+l/2*Math.sin(e)]})))):"pentagon"==t._shapeChoice?(h=d3.range(5).map((function(t){var e=108*Math.PI/360+t/5*2*Math.PI;return[s/2+s/2*Math.cos(e),s/2+s/2*Math.sin(e)]})),"auto"==t._shapeType&&(h=d3.range(5).map((function(t){var e=108*Math.PI/360+t/5*2*Math.PI;return[r/2+r/2*Math.cos(e),l/2+l/2*Math.sin(e)]})))):"hexagon"==t._shapeChoice?(h=d3.range(6).map((function(t){var e=t/6*2*Math.PI;return[s/2+s/2*Math.cos(e),s/2+s/2*Math.sin(e)]})),"auto"==t._shapeType&&(h=d3.range(6).map((function(t){var e=t/6*2*Math.PI;return[r/2+r/2*Math.cos(e),l/2+l/2*Math.sin(e)]})))):"octagon"==t._shapeChoice?(h=d3.range(8).map((function(t){var e=t/8*2*Math.PI;return[s/2+s/2*Math.cos(e),s/2+s/2*Math.sin(e)]})),"auto"==t._shapeType&&(h=d3.range(8).map((function(t){var e=t/8*2*Math.PI;return[r/2+r/2*Math.cos(e),l/2+l/2*Math.sin(e)]})))):(h=d3.range(200).map((function(t){var e=t/200*2*Math.PI;return[s/2+s/2*Math.cos(e),s/2+s/2*Math.sin(e)]})),"auto"==t._shapeType&&(h=d3.range(200).map((function(t){var e=t/200*2*Math.PI;return[r/2+r/2*Math.cos(e),l/2+l/2*Math.sin(e)]})))),Math.seed=5,Math.seededRandom=function(t,e){return t=t||1,e=e||0,Math.seed=(9301*Math.seed+49297)%233280,e+Math.seed/233280*(t-e)};fu().prng((function(){return Math.seededRandom()})).clip(h)(u);var d=u.descendants().sort((function(t,e){return e.depth-t.depth})),_=d3.line().curve(d3.curveBasisClosed),f=n.selectAll("path").data(d).enter().append("path").attr("class",(function(e){return"voronoi-"+t.id+"-"+e.data.key})).attr("d",(function(e){var i=e.polygon;return 0==e.height?(i=function(e){for(var i=-1,n=e.length,a=e[n-1],o=a[0],r=a[1],l=void 0,s=void 0,u=void 0,c=[];++i<n;){s=(l=e[i])[0],u=l[1];var h,d=Math.sqrt(Math.pow(s-o,2)+Math.pow(u-r,2)),_=t._cornerRadius/d;h=_>=.5?.5:_,c.push([o+(s-o)*h,r+(u-r)*h],[o+(s-o)*(1-h),r+(u-r)*(1-h)],l),a=l,o=s,r=u}return c}(e.polygon.map((function(t){return{X:t[0],Y:t[1]}})).map((function(t){return[t.X,t.Y]}))),_(i)+"z"):d3.line()(i)+"z"})).style("fill",(function(e,i){if(0==e.depth)return"none";if(0==e.height){if(e.parent.data.color&&/\[/.test(e.parent.data.color)){var n=x(e.parent.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-index-"+i)+")"}return e.parent.data.color&&/#/.test(e.parent.data.color)?e.parent.data.color:"rgb("+U(e.parent.data.color,0)+","+U(e.parent.data.color,1)+","+U(e.parent.data.color,2)+")"}return"none"})).style("fill-opacity",(function(e){if(0==e.height){if(e.parent.data.color&&/#/.test(e.parent.data.color))return t._fillOpacity;var i=U(e.parent.data.color,3)||1;return t._fillOpacity*i}return 0})).style("stroke",(function(e,i){if(null==t._bubbleBorderColor){if(0==e.depth)return"none";if(0==e.height){if(e.parent.data.color&&/\[/.test(e.parent.data.color)){var n=x(e.parent.data.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var h=s.value,d=[],_=h.split(":");d.push(q(_[0])),d.push(_[1]),a.push(d)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var f=a.concat(),p=f.pop();return t.group.append("linearGradient").attr("id",t.id+"-border-index-"+i).attr("x1",y(p[1]).x1+"%").attr("y1",y(p[1]).y1+"%").attr("x2",y(p[1]).x2+"%").attr("y2",y(p[1]).y2+"%").selectAll("stop").data(f).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]})),"url("+c("#"+t.id+"-border-index-"+i)+")"}return e.parent.data.color}return"none"}return t._bubbleBorderColor})).style("stroke-width",(function(e){return 0==e.depth?t._outerCircleBorderWidth:0==e.height?t._secondLevelBorderWidth:t._firstLevelBorderWidth}));f.filter((function(t){return 2===t.depth})).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),t._interrupt?f.style("opacity",1):f.style("opacity",0).transition().duration(t._transition?.9*t._duration/d.length:0).delay((function(e,i){return t._transition?t._startDelay+i*(.9*t._duration/d.length):0})).style("opacity",1);n.append("g").attr("class","text-group").selectAll("text").data(d.filter((function(t){return 2===t.depth}))).enter().append("text").attr("dy",t._numberLabel.show?"-0.05em":"0.4em").attr("text-anchor","middle").text((function(e){var n=i(t.group.select(".voronoi-"+t.id+"-"+e.data.key)).width;return X(e.data.name,n,t._textLabel.fontSize,t._textLabel.fontFamily)})).attr("x",(function(t){return t.polygon.site.x})).attr("y",(function(t){return t.polygon.site.y})).attr("fill",q(t._textLabel.color)).style("font-size",t._textLabel.fontSize).style("font-family",t._textLabel.fontFamily).style("display",t._textLabel.show?"block":"none"),n.append("g").attr("class","number-group").selectAll("text").data(d.filter((function(t){return 2===t.depth}))).enter().append("text").attr("dy",t._textLabel.show?"1.05em":"0.4em").attr("text-anchor","middle").text((function(e){return X(E(e.data.value,t._numberStyle,t._decimalPlaces)+t._suffix,i(t.group.select(".voronoi-"+t.id+"-"+e.data.key)).width,t._textLabel.fontSize,t._textLabel.fontFamily)})).attr("x",(function(t){return t.polygon.site.x})).attr("y",(function(t){return t.polygon.site.y})).attr("fill",q(t._numberLabel.color)).style("font-size",t._numberLabel.fontSize).style("font-family",t._numberLabel.fontFamily).style("display",t._numberLabel.show?"block":"none");return t._interrupt?(n.select(".text-group").style("opacity",1),n.select(".number-group").style("opacity",1)):(n.select(".text-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),n.select(".number-group").style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1)),t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=parseFloat(t),this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"firstLevelBorderWidth",value:function(t){return arguments.length?(this._firstLevelBorderWidth=t,this):this._firstLevelBorderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"secondLevelBorderWidth",value:function(t){return arguments.length?(this._secondLevelBorderWidth=t,this):this._secondLevelBorderWidth}},{key:"outerCircleBorderWidth",value:function(t){return arguments.length?(this._outerCircleBorderWidth=parseFloat(t),this):this._outerCircleBorderWidth}},{key:"bubbleBorderColor",value:function(t){return arguments.length?(this._bubbleBorderColor=t,this):this._bubbleBorderColor}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"shapeChoice",value:function(t){return arguments.length?(this._shapeChoice=t,this):this._shapeChoice}},{key:"shapeType",value:function(t){return arguments.length?(this._shapeType=t,this):this._shapeType}}]),e}(at),yu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","soap-bubble-chart"),i.bubble=new pu(i.mainGroup),i._sortValue=null,i._fillOpacity=1,i._bubbleBorderColor=null,i._firstLevelBorderWidth=0,i._secondLevelBorderWidth=0,i._outerCircleBorderWidth=0,i._cornerRadius=0,i._shapeOption=["oval","triangle","rectangle","diamond","pentagon","hexagon","octagon"],i._shapeChoice="oval",i._shapeType="auto",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["内部居中"],positionChoice:"内部居中"},i._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",suffix:"",positionOptions:["内部居中"],positionChoice:"内部居中"},i._suffix="",i._textPositionChoice="内部居中",i._numberPositionChoice="内部居中",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveStyle="依次出现",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.bubble,i=t.tooltip,n=t.widthOfNoMargin,a=t.heightOfMainGroup;t._data.valueLabel,t._fontSize,t._fontFamily,t.activeData;if(t._bubbleBorderColor&&/\[/.test(t._bubbleBorderColor)){var o=x(t._bubbleBorderColor),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,f=[],p=_.split(":");f.push(q(p[0])),f.push(p[1]),r.push(f)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var g=r.concat(),v=g.pop();t.mainGroup.selectAll(".linear-gradient").remove(),t.mainGroup.append("linearGradient").attr("class","linear-gradient").attr("id",t.id+"-main-border-index-0").attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}e.data(t.activeData).width(n>0?n:5).height(a>0?a:5).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fillOpacity(t._fillOpacity).firstLevelBorderWidth(t._firstLevelBorderWidth).secondLevelBorderWidth(t._secondLevelBorderWidth).outerCircleBorderWidth(t._outerCircleBorderWidth).bubbleBorderColor(/\[/.test(t._bubbleBorderColor)?"url("+c("#"+t.id+"-main-border-index-0")+")":t._bubbleBorderColor).cornerRadius(t._cornerRadius).shapeChoice(t._shapeChoice).shapeType(t._shapeType).textLabel(t._textLabel).numberLabel(t._numberLabel).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e){var n=[{color:e.parent.data.color,text:e.parent.data.name},{text:e.data.name+"："+E(e.value,t._numberStyle,t._decimalPlaces)}];i.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){i.hide()})),e.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"sortData",value:function(){var t=this._data.nodes;-1===this._sortValue?t.sort((function(t,e){return e.sum-t.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return e.sum-t.sum||t.index-e.index}))})):1===this._sortValue&&t.sort((function(t,e){return t.sum-e.sum||t.index-e.index})).forEach((function(t){t.children.sort((function(t,e){return t.sum-e.sum||t.index-e.index}))})),this._sortedDataCopy=this._data}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:"1",this._bubbleBorderColor=e.bubbleBorderColor?q(e.bubbleBorderColor):null,this._firstLevelBorderWidth=0==e.firstLevelBorderWidth||e.firstLevelBorderWidth?e.firstLevelBorderWidth:0,this._secondLevelBorderWidth=0==e.secondLevelBorderWidth||e.secondLevelBorderWidth?e.secondLevelBorderWidth:0,this._outerCircleBorderWidth=0==e.outerCircleBorderWidth||e.outerCircleBorderWidth?e.outerCircleBorderWidth:0,this._cornerRadius=0==e.cornerRadius||e.cornerRadius?e.cornerRadius:0,this._shapeChoice=e.outerShape_v?e.outerShape_v:"oval",this._shapeType=e.scaleType?e.scaleType:"auto"),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:"",this._textPositionChoice=i.textLabel&&i.textLabel.positionChoice?i.textLabel.positionChoice:this._textPositionChoice,this._numberPositionChoice=i.numberLabel&&i.numberLabel.positionChoice?i.numberLabel.positionChoice:this._numberPositionChoice)}}]),e}(gl),xu=function(t){function n(t){b(this,n);var e=C(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return e.elem.attr("class","polar-thermal"),e._stroke="#fff",e._strokeWidth=1,e._barWidthPercent="1",e._startAngle=0,e._endAngle=2*Math.PI,e._sortMethod=null,e._radius=0,e._cornerRadius=0,e.arcFunc=d3.arc(),e.pieFunc=d3.pie(),e}return w(n,t),S(n,[{key:"update",value:function(){var t=this,n=t._data,a=t.group;a.selectAll("*").remove();var o=t._startAngle,r=t._endAngle,l=t._radius,s=t._transition,u=t._duration,c=t._startDelay,h=(t._moveOptions,t._moveStyle),d=t._fillOpacity,_=t._innerRadius,f=t._strokeWidth,y=t._strokeColor,x=parseFloat(t._numberLabel.fontSize),g=t._numberLabel.fontFamily,v=q(t._numberLabel.color),m=t._rotateDirection,b=t._sectorCount,S=(t._donutCount,n.length>0?n[0].data.map((function(t){return t.name})):[]),k=(n.length>0&&n.map((function(t){return t.name})),(r-o)/b),w=(d3.scaleBand().domain(S).range([0,l]),b),C=Math.abs(r-o)==2*Math.PI?(r-o)/(w||1):(r-o)/(w-1||1);t._startAngle>Math.PI/2&&t._startAngle<1.5*Math.PI&&(parseFloat(t._yLabelAngle)<=0?t._yLabelAngle=parseFloat(t._yLabelAngle)+180:t._yLabelAngle=parseFloat(t._yLabelAngle)-180);var O=S,F=O,L=d3.scaleBand().domain(S).range([l-_,0]),P=(d3.max(O,(function(e){return R(e,t._themeFontSize,t._themeFontFamily)})),t._themeFontSize),A=[];if("横排"==t._yLabelDirection){F=F.map((function(e){return X(e,l,t._themeFontSize,t._themeFontFamily)}));var W=d3.max(F,(function(e){return R(e,t._themeFontSize,t._themeFontFamily)}))||0,z=t._themeFontSize,M=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),D=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180));F.forEach((function(e){var i=R(e,t._themeFontSize,t._themeFontFamily)/(90==Math.abs(t._yLabelAngle)?2:1);A.push(z*D+i*M)})),P=z*D+W*M}else{F=F.map((function(e){return j(e,l,t._themeFontSize,t._themeFontFamily)}));var N=d3.max(F,(function(e){return B(e,t._themeFontSize,t._themeFontFamily)}))||0,T=t._themeFontSize,G=Math.abs(Math.sin(Math.abs(t._yLabelAngle)*Math.PI/180)),I=Math.abs(Math.cos(Math.abs(t._yLabelAngle)*Math.PI/180));F.forEach((function(e){var i=B(e,t._themeFontSize,t._themeFontFamily)/(Math.abs(t._yLabelAngle)%180==0?2:1);A.push(i*I+T*G)})),P=N*I+T*G}var H=l/O.length;Math.min(.9*t._mainWidth,.9*t._mainHeight);if("clockwise"==t._rotateDirection?"横排"==t._yLabelDirection?t._yLabelAngle:t._yLabelAngle<=0&&t._yLabelAngle>-90||t._yLabelAngle>90&&t._yLabelAngle:"横排"==t._yLabelDirection?t._yLabelAngle:t._yLabelAngle>=0&&t._yLabelAngle<90||t._yLabelAngle<-90&&t._yLabelAngle,t._polarCount=O.length-1>0?O.length-1:0,P>H){var V=Math.ceil(P/H);O=O.filter((function(t,e){return e%V==0})),F=F.filter((function(t,e){return e%V==0})),A=A.filter((function(t,e){return e%V==0})),t._polarCount=O.length-1>0?O.length-1:0}var $=d3.axisRight().tickSizeOuter(-.5).tickValues(O).scale(L);"clockwise"==t._rotateDirection&&($=d3.axisLeft().tickSizeOuter(-.5).tickValues(O).scale(L));var U=d3.arc().innerRadius((function(t){return t.innerRadius})).outerRadius((function(t){return t.outerRadius})).startAngle((function(t){return t.startAngleT})).endAngle((function(t){return t.endAngleT})),Z=t.group.append("g").selectAll("g.polar-thermal-group").data(n);Z.exit().remove();Z.enter().append("g").attr("class","polar-thermal-group").merge(Z).each((function(e,i){var a=e.data;a.forEach((function(t){t.innerRadius=l-(L(t.name)+L.bandwidth()),t.outerRadius=l-L(t.name),t.startAngleT=o+i*k,t.endAngleT=o+(i+1)*k}));var r=d3.select(this).selectAll("path").data(a);r.exit().remove();var _=r.enter().append("path").attr("class","polar-thermal-box").merge(r).style("stroke-width",f).style("stroke",(function(t){return""==y?t.color:y})).style("fill",(function(t){return t.color})).style("fill-opacity",d).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout);t._interrupt?_.attr("d",(function(t){return U(t)})):s&&0==h?_.transition().duration(s?.9*u/(n.length>0?n[0].data.length:1):0).ease(d3.easeLinear).delay(s?function(t,e){return c+e*(.9*u)/(n.length>0?n[0].data.length:1)}:0).attrTween("d",(function(t){var e=d3.interpolateNumber(t.innerRadius,t.outerRadius);return function(i){var n=e(i);return U.outerRadius(n),U(t)}})):s&&1==h&&_.transition().duration(s?.9*u/(n.length>0?n[0].data.length:1):0).ease(d3.easeLinear).delay(s?c+i*(.9*u)/(n.length>0?n[0].data.length:1):0).attrTween("d",(function(t){var e=d3.interpolateNumber(t.startAngleT,t.endAngleT);return function(i){var n=e(i);return U.endAngle(n),U(t)}}))}));var Q=t.group.append("g").selectAll("g.polar-thermal-label-group").data(n);Q.exit().remove();Q.enter().append("g").attr("class","polar-thermal-label-group").merge(Q).each((function(i,n){var a=i.data;a.forEach((function(t){t.radius=l-(L(t.name)+.5*L.bandwidth()),t.startAngleT=o+n*k,t.endAngleT=o+(n+1)*k}));var r=d3.select(this).selectAll("g").data(a);r.exit().remove();for(var h=r.enter().append("g"),d=0;d<a.length;d++){var _="arc-path-"+d+"-"+n+"-"+t.id,f=void 0;f="clockwise"==m?e(a[d].radius,a[d].startAngleT,a[d].endAngleT):e(a[d].radius,a[d].endAngleT,a[d].startAngleT);t._defs.select("#"+_).empty()?t._defs.append("path").attr("d",f).attr("id",_):t._defs.select("#"+_).attr("d",f)}var p=h.append("text").style("text-anchor","middle").style("font-size",x).style("font-family",g).style("fill",v).attr("dy","0.35em");p.append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#arc-path-"+i+"-"+n+"-"+t.id})).text((function(e,i){var a=t._defs.select("#arc-path-"+i+"-"+n+"-"+t.id).node().getTotalLength();return X(E(e.value.toString(),t._numberStyle,t._decimalPlaces)+t._suffix,a,x,g)})).style("display",t._labelShow?"block":"none").style("opacity",x>L.bandwidth()?0:1).on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout),t._interrupt?p.style("opacity",x>L.bandwidth()?0:1):p.style("opacity",0).interrupt().transition().duration(s?.1*u:0).delay((function(t,e){return s?c+.9*u:0})).style("opacity",x>L.bandwidth()?0:1)}));var K=[],J=void 0;if(J="外部"==t._axisPositonChoice?l+5:_-5,n.length>0)for(var tt=0;tt<w;tt++){var et=J*Math.sin(o+tt*C),it=-J*Math.cos(o+tt*C);K.push({x:et,y:it})}else K=[{x:J*Math.sin(o),y:-J*Math.cos(o)},{x:J*Math.sin(r),y:-J*Math.cos(r)}];a.append("path").attr("class","xAxis-path").attr("d",(function(i,n){var a=void 0,o=void 0;return"clockwise"==t._rotateDirection?(a=t._startAngle,o=t._startAngle+t._totalAngle):(a=t._startAngle-t._totalAngle,o=t._startAngle),"内部"==t._axisPositonChoice?e(_-.5*t._xAxisLineWidth,a,o):e(l-.5*t._xAxisLineWidth,a,o)})).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none").attr("fill","none");var nt=a.selectAll(".xAxis-lines").data(d3.range(b+1));nt.exit().remove();var at=nt.enter().append("line").attr("class","xAxis-lines").merge(nt).style("fill","none").style("stroke",t._stroke).attr("x1",(function(e,i){var n=o+k*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?l:_)})).attr("y1",(function(e,i){var n=o+k*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?l:_)})).attr("x2",(function(e,i){var n=o+k*i;return Math.cos(n-Math.PI/2)*("外部"==t._axisPositonChoice?l+5:_-5)})).attr("y2",(function(e,i){var n=o+k*i;return Math.sin(n-Math.PI/2)*("外部"==t._axisPositonChoice?l+5:_-5)})),ot=n.length>0?n.map((function(t,e){return t.name=="$-"+(e+1)?"":t.name})):[];a.selectAll(".xAxis-text").remove();var rt=a.append("g").selectAll("text").data(K);rt.exit().remove();var lt=rt.enter().append("text").attr("class","xAxis-text").text((function(e,i){if(n.length>0)if("外部"==t._axisPositonChoice){if("水平"==t._xLabelDirection){var a=Math.cos(o+k*(i+.5)-Math.PI/2)*(l+10),r=t._mainWidth/2-Math.abs(a);return X(ot[i],r,t._themeFontSize,t._themeFontFamily)}if("径向"==t._xLabelDirection){var s=Math.sin(o+k*(i+.5)-Math.PI/2)*(l+10),u=t._mainHeight/2-Math.abs(s);return null==ot[i]?"":j(ot[i],u,t._themeFontSize,t._themeFontFamily)}}else{if("水平"==t._xLabelDirection)return X(ot[i],(_-10)/2,t._themeFontSize,t._themeFontFamily);if("径向"==t._xLabelDirection)return j(ot[i],(_-10)/2,t._themeFontSize,t._themeFontFamily)}})).style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).attr("x",(function(e,i){var n=o+k*(i+.5);return"外部"==t._axisPositonChoice?Math.cos(n-Math.PI/2)*(l+10):Math.cos(n-Math.PI/2)*(_-10)})).attr("y",(function(e,i){var n=o+k*(i+.5);return"外部"==t._axisPositonChoice?Math.sin(n-Math.PI/2)*(l+10):Math.sin(n-Math.PI/2)*(_-10)})).attr("text-anchor","middle");if("水平"==t._xLabelDirection)lt.attr("transform",(function(e,i){var n=o+k*(i+.5);return n>1.5*Math.PI&&n<=2*Math.PI||n<Math.PI/2&&n>=0||n>-Math.PI/2&&n<=0||n<1.5*-Math.PI&&n>=2*-Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?0:.4*t._themeFontSize)+")":Math.abs(n)==Math.PI/2||Math.abs(n)==1.5*Math.PI?"translate(0,"+("外部"==t._axisPositonChoice?.5*t._themeFontSize:0)+")":"translate(0,"+("外部"==t._axisPositonChoice?.8*t._themeFontSize:.2*t._themeFontSize)+")"}));else if("径向"==t._xLabelDirection){t.group.selectAll(".xAxis-text").remove();var st=t.group.append("g").selectAll("text").data(K);st.exit().remove();var ut=st.enter().append("g").attr("transform",(function(t,e){return"rotate("+(180*(o+k*(e+.5))/Math.PI-90)+")"})).append("text").attr("class","radial-text").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("display",t._showX?"block":"none");"外部"==t._axisPositonChoice?ut.text((function(e,i){var n=.4*Math.min(t._mainWidth,t._mainHeight);return X(ot[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",l+5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(o+k*(e+.5))/Math.PI;return i-90<270&&i-90>90?"end":null})).attr("transform",(function(t,e){var i=180*(o+k*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(l+5)+",0)":null})):ut.text((function(e,i){var n=_-5-parseFloat(t._themeFontSize)>0?_-5-parseFloat(t._themeFontSize):0;return X(ot[i],n,t._themeFontSize,t._themeFontFamily)})).attr("x",_-5).attr("dy",".35em").style("text-anchor",(function(t,e){var i=180*(o+k*(e+.5))/Math.PI;return i-90<270&&i-90>90?null:"end"})).attr("transform",(function(t,e){var i=180*(o+k*(e+.5))/Math.PI;return i-90<270&&i-90>90?"rotate(180 "+(_-5)+",0)":null}))}else{a.selectAll(".xAxis-text").remove();var ct=t.group.selectAll("g.text-group").data(K);ct.exit().remove();ct.enter().append("g").attr("class","text-group").merge(ct).each((function(i,a){var r=d3.select(this),s=o+k*(a+.5),u=l+10;"内部"==t._axisPositonChoice&&(u=_-10-t._themeFontSize),u<0&&(u=0);var c="arc-path-"+a+"-"+t.id,h=e(u+.5*t._themeFontSize,s+k/2+.015,s-k/2-.015);"clockwise"==t._rotateDirection&&(h=e(u+.6*t._themeFontSize,s-k/2+.015,s+k/2-.015));t._defs.select("#"+c).empty()?t._defs.append("path").attr("d",h).attr("id",c):t._defs.select("#"+c).attr("d",h);var d=r.append("text").style("text-anchor","middle").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).attr("dy","0.35em");d.append("textPath").attr("startOffset","50%").attr("xlink:href",(function(e,i){return"#arc-path-"+a+"-"+t.id})).text((function(e,i){var o=n.length>0?n[a].name=="&-"+(a+1)?"":n[a].name:"",r=t._defs.select("#arc-path-"+a+"-"+t.id).node().getTotalLength();return X(o.toString(),r,t._themeFontSize,t._themeFontFamily)})),1==t._interrupt?d.style("opacity",1).style("display",t._showX?"block":"none"):d.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none")}))}1==t._interrupt?(at.style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),lt.style("opacity",1).style("display",t._showX?"block":"none")):(at.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("stroke",t._axisLineStrokeX).style("stroke-width",t._xAxisLineWidth).style("display",t._xAxisShow?"block":"none"),lt.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1).style("display",t._showX?"block":"none"));for(var ht=0;ht<b;ht++){var dt=(ht+.5)*k+o;"外部"==t._axisPositonChoice?0==dt||dt==Math.PI?d3.select(a.selectAll(".xAxis-text").nodes()[ht]).attr("text-anchor","middle"):dt>Math.PI||dt<0&&dt>-Math.PI?d3.select(a.selectAll(".xAxis-text").nodes()[ht]).attr("text-anchor","end"):d3.select(a.selectAll(".xAxis-text").nodes()[ht]).attr("text-anchor","start"):dt>0&&dt<Math.PI||dt>2*-Math.PI&&dt<-Math.PI?d3.select(a.selectAll(".xAxis-text").nodes()[ht]).attr("text-anchor","end"):dt>Math.PI&&dt<2*Math.PI||dt<0&&dt>-Math.PI?d3.select(a.selectAll(".xAxis-text").nodes()[ht]).attr("text-anchor","start"):d3.select(a.selectAll(".xAxis-text").nodes()[ht]).attr("text-anchor","middle")}var _t=a.append("g").attr("class","polar-thermal-axis").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).call($);if(1==t._interrupt?_t.style("opacity",1):_t.style("opacity",0).transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay:0).style("opacity",1),a.select(".polar-thermal-axis").attr("transform","translate(-0.5, "+-l+") rotate("+180*t._startAngle/Math.PI+" 0.5 "+l+")"),a.selectAll(".polar-thermal-axis .tick line").style("stroke",t._axisLineStrokeY).style("stroke-width",t._yAxisLineWidth).style("display",t._yAxisShow?"block":"none"),"横排"==t._yLabelDirection?(a.selectAll(".polar-thermal-axis .tick text").remove(),a.selectAll(".polar-thermal-axis .tick").append("text").text((function(t,e){return F[e]})).attr("transform",(function(e,i){var n=Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right"),a="clockwise"==t._rotateDirection?-10:10,o=.4*t._themeFontSize;return"translate("+(a+n.x)+","+(o+n.y)+")rotate("+t._yLabelAngle+")"})).style("pointer-events","none").style("font-size",t._themeFontSize).style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("text-anchor",Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right").anchor).style("display",t._showY?"block":"none")):(a.selectAll(".polar-thermal-axis .tick text").remove(),a.selectAll(".polar-thermal-axis .tick").append("text").text((function(t,e){return F[e]})).each((function(e,i){for(var n,a=d3.select(this),o=a.text().split("").reverse(),r=[],l=0,s=0,u=+a.attr("x"),c=+a.attr("y"),h=a.text(null).append("tspan").attr("x",u).attr("y",c);n=o.pop();)r.push(n),h.text(r.join("")),h.node().getComputedTextLength()>0&&(0==s||++l,r.pop(),h.text(r.join("")),r=[n],h=a.append("tspan").attr("x",u).attr("y",l*parseFloat(.9*t._themeFontSize*1.2)+c).text(n)),s++})).attr("transform",(function(e,i){var n=Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right",F[i]);return"translate("+n.x+","+n.y+")rotate("+t._yLabelAngle+")"})).style("font-size",t._themeFontSize).style("pointer-events","none").style("font-family",t._themeFontFamily).style("fill",t._themeFontColor).style("text-anchor",(function(e,i){return Y(t._themeFontSize,t._themeFontFamily,t._yLabelAngle,t._yLabelDirection,"clockwise"==t._rotateDirection?"left":"right",F[i]).anchor})).style("display",t._showY?"block":"none")),a.select(".polar-thermal-axis path").style("stroke",t._axisLineStrokeY).style("stroke-width",t._yAxisLineWidth).style("display",t._yAxisShow?"block":"none"),"水平"==t._xLabelDirection||"径向"==t._xLabelDirection){for(var ft=t.group.selectAll(".xAxis-text"),pt=[],yt=[],xt=0;xt<ft._groups[0].length;xt++){yt.push(xt);for(var gt=xt+1;gt<ft._groups[0].length;gt++){p(i(d3.select(ft._groups[0][xt])),i(d3.select(ft._groups[0][gt])))&&(pt.push(xt),d3.select(ft._groups[0][xt]).style("opacity","0"))}}for(var vt=new Set(pt),mt=Array.from(vt),bt=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(mt,yt),St=0;St<mt.length;St++){for(var kt=[],wt=0;wt<bt.length;wt++){var Ct=i(d3.select(ft._groups[0][mt[St]])),Ot=i(d3.select(ft._groups[0][bt[wt]]));if(kt.push(p(Ct,Ot)),p(Ct,Ot)){if(mt[St]==bt[wt])continue;d3.select(ft._groups[0][mt[St]]).remove()}}0==kt.filter((function(t){return 1==t})).length&&bt.push(mt[St])}for(var Ft=0;Ft<bt.length;Ft++)d3.select(ft._groups[0][bt[Ft]]).style("opacity","1")}return t}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"radius",value:function(t){return arguments.length?(this._radius=t,this):this._radius}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"donutCount",value:function(t){return arguments.length?(this._donutCount=t,this):this._donutCount}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"showX",value:function(t){return arguments.length?(this._showX=t,this):this._showX}},{key:"showY",value:function(t){return arguments.length?(this._showY=t,this):this._showY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"endAngle",value:function(t){return arguments.length?(this._endAngle=t,this):this._endAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"themeFontColor",value:function(t){return arguments.length?(this._themeFontColor=t,this):this._themeFontColor}},{key:"themeFontSize",value:function(t){return arguments.length?(this._themeFontSize=t,this):this._themeFontSize}},{key:"themeFontFamily",value:function(t){return arguments.length?(this._themeFontFamily=t,this):this._themeFontFamily}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"mainWidth",value:function(t){return arguments.length?(this._mainWidth=t,this):this._mainWidth}},{key:"mainHeight",value:function(t){return arguments.length?(this._mainHeight=t,this):this._mainHeight}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"range",value:function(t){return arguments.length?(this._range=t,this):this._range}},{key:"count",value:function(t){return arguments.length?(this._count=t,this):this._count}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"sectorCount",value:function(t){return arguments.length?(this._sectorCount=t,this):this._sectorCount}}]),n}(at),gu=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]),e=d3.min(t.map((function(t){var e=t.data;return d3.min(e.map((function(t){return t.value})))}))),i=d3.max(t.map((function(t){var e=t.data;return d3.max(e.map((function(t){return t.value})))}))),n=this.generateColorList(),a=[],o=[];if(1==n.length)if(n[0]&&/\[/.test(n[0])){var r=x(n[0]),l=[],s=[],u=!0,c=!1,h=void 0;try{for(var d,_=r[Symbol.iterator]();!(u=(d=_.next()).done);u=!0){var f=d.value.split(":");l.push(q(f[0])),s.push(f[1])}}catch(t){c=!0,h=t}finally{try{!u&&_.return&&_.return()}finally{if(c)throw h}}var p=l.concat();p.pop();var y=s.concat();y.pop(),a=p,o=y}else a.push(n[0]),a.push(n[0]);else a=n;var g=a.length,v=(i-e)/(g-1),m=d3.range(g).map((function(t){return e+v*t})),b=d3.scaleLinear().domain(m).range(a);return 1==n.length&&n[0]&&/\[/.test(n[0])&&(m=o.map((function(t,n){return e+(i-e)*t})),b=d3.scaleLinear().domain(m).range(a)),t.forEach((function(t){t.data.forEach((function(t){return t.color=b(t.value)}))})),{data:t,colorScale:b,offset:o,maxValue:i,minValue:e}}}]),e}(it),vu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","polar-thermal-chart"),i.core=i.rose=new xu(i.mainGroup),i.grid=new gt(i.mainGroup),i.legend=new Mi(i.group),i._startAngle=0,i._endAngle=2*Math.PI,i._sortMethod=null,i._labelRadiusRatio=.65,i._innerRadiusRatio=.3,i._strokeWidth=0,i._stroke="#fff",i._barWidthPercent="1",i._fillOpacity=1,i._labelShow=!1,i._textLabelShow=!1,i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["径向展开","顺时针展开"],i._moveStyle="径向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData;t._interrupt?t.mainGroup.style("opacity",1):t.mainGroup.style("opacity",0).transition().duration(t._transition?.1*t._duration*1e3:0).delay(t._transition?1e3*t._startDelay:0).style("opacity",1);var i=t.rose,n=(t.grid,t.tooltip);"clockwise"==t._rotateDirection?(t._startAngle=t._startAngle,t._endAngle=t._startAngle+t._totalAngle):(t._startAngle=t._startAngle,t._endAngle=t._startAngle-t._totalAngle);t._fontSize,Math.round(d3.max(e.map((function(t){return t.value}))));var a=t.widthOfNoMargin,o=t.heightOfMainGroup,r=0,l=void 0,s=void 0,u=t.activeData.length>0?e.map((function(t){return t.name})):"";"水平"==t._xLabelDirection&&1==t._xTickShow?(l=d3.max(u.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),s=t._fontSize):"径向"==t._xLabelDirection&&1==t._xTickShow?(l=d3.max(u.map((function(e){return R(e,t._fontSize,t._fontFamily)}))),s=d3.max(u.map((function(e){return R(e,t._fontSize,t._fontFamily)})))):"周向"==t._xLabelDirection&&1==t._xTickShow?(l=t._fontSize,s=t._fontSize):(l=0,s=0),l=l<.4*a?l:.4*a,s=s<.4*o?s:.4*o,r="外部"==t._axisPositonChoice?Math.min(a/2-l,o/2-s):Math.min(a,o)/2;var h,d=t._innerRadius||(t._innerRadiusRatio?t._innerRadiusRatio*r:0);this.radius=r,this.innerRadius=d;for(var _=0;_<(0==e.length?0:e[0].data.length);_++)for(var f=0;f<e.length;f++)parseFloat(e[f].data[_].value);if(t.mainGroup.selectAll(".polar-thermal-border-gradient").remove(),t._stroke&&/\[/.test(t._stroke)){var p=(h=t._stroke,new Function("return "+h)()),x=[],g=!0,v=!1,m=void 0;try{for(var b,S=p[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),x.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=x.concat(),F=O.pop();t.mainGroup.append("linearGradient").attr("class","polar-thermal-border-gradient").attr("id",t.id+"-polar-thermal-border-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}i.data(e).transition(t._transition).duration(1e3*t._duration).startDelay(1e3*t._startDelay).moveStyle(t._moveOptions.indexOf(t._moveStyle)).radius(r).totalAngle(t._totalAngle).axisPositonChoice(t._axisPositonChoice).numberLabel(t._numberLabel).labelShow(t._labelShow).donutCount(e.length>0?e[0].data.length:1).defs(t.defs).sectorCount(e.length>0?e.map((function(t){return t.name})).length:1).translate(a/2,o/2).innerRadius(r*t._innerRadiusRatio).strokeWidth(t._strokeWidth).strokeColor(/\[/.test(t._stroke)?"url("+c("#"+t.id+"-polar-thermal-border-0")+")":t._stroke).fillOpacity(t._fillOpacity).startAngle(t._startAngle).endAngle(t._endAngle).showX(t._xTickShow).showY(t._yTickShow).stroke(t._axisLineStroke).xAxisShow(t._xAxisShow).yAxisShow(t._yAxisShow).xAxisLineWidth(t._xAxisLineWidth).yAxisLineWidth(t._yAxisLineWidth).axisLineStrokeX(t._axisLineStrokeX).axisLineStrokeY(t._axisLineStrokeY).rotateDirection(t._rotateDirection).themeFontSize(t._fontSize).themeFontColor(t._fontColor).themeFontFamily(t._fontFamily).xLabelDirection(t._xLabelDirection).yLabelDirection(t._yLabelDirection).yLabelAngle(t._yLabelAngle).mainWidth(a).mainHeight(o).interrupt(t._interrupt).range(t._yRange).count(t._yCountOfLabel).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(i,a){if(e.length>0){var o=[{text:-1!=String(i.name).indexOf("&-")?"":i.name,color:i.color},{text:(-1!=String(i.subName).indexOf("$-")?"":i.subName)+"："+E(i.value,t._numberStyle,t._decimalPlaces)}];n.data(o).update(),n.move([d3.event.offsetX,d3.event.offsetY]).show()}})).onMousemove((function(){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t){n.hide()}));var L=t.defs;L.selectAll("filter").remove();var P=L.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_rose").attr("filterUnits","objectBoundingBox");P.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),P.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),P.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),P.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),P.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var A=a/2,W=o/2;i.translate(A,W).update(),t._totalAngle>=2*Math.PI&&0==t._yAxisShow&&t.mainGroup.select(".polar-thermal-axis").selectAll("text").style("text-anchor","middle").attr("dx","clockwise"==t._rotateDirection?8:-8)}},{key:"updateLegend",value:function(){var t=this,e=t.legend,i=t.widthOfNoMargin;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(i).horizontalAlign(t._legendX).rectWidth(i/5).rectHeight(i/5/10).fontSize(t._legendFontSize).fontFamily(t._legendFontFamily).fontColor(t._legendFontColor),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.colorList(e.colorScale.range()).offsetList(e.offset).startText(E(e.minValue,t._numberStyle,t._decimalPlaces)).endText(E(e.maxValue,t._numberStyle,t._decimalPlaces)).title("")}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new gu(t,e);return i.dataSolveFunc(Wl),i}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t._axis,n=i.circular||{},a=i.radial||{};this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTickShow(0!=n.labelShow&&!n.labelShow||n.labelShow).yTickShow(!(0!=a.labelShow&&!a.labelShow)&&a.labelShow).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!(0!=n.axisShow&&!n.axisShow)&&n.axisShow).yAxisShow(!(0!=a.axisShow&&!a.axisShow)&&a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"周向").axisPositonChoice(n.axisPositonChoice?n.axisPositonChoice:"外部").startAngle(n.startAngle?n.startAngle*Math.PI/180:0).totalAngle(n.totalAngle||0==n.totalAngle?n.totalAngle*Math.PI/180:2*Math.PI).rotateDirection(n.rotateDirection?n.rotateDirection:"clockwise").yRange(a.range?a.range:[]).yLabelDirection(a.labelDirection?a.labelDirection:"横排").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:"横排"==this._yLabelDirection?0:90).yLabelSuffix(a.labelSuffix?a.labelSuffix:"").yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null),this.isPolar(!(!a.labelDirection&&null!==a.labelDirection))}},{key:"sortData",value:function(){var t=this._data.data;1===this._sortValue?t.sort((function(t,e){return t.year-e.year})):-1===this._sortValue&&t.sort((function(t,e){return e.year-t.year})),this._sortedDataCopy=this._data}},{key:"yCountOfLabel",value:function(t){return arguments.length?(this._yCountOfLabel=t,this):this._yCountOfLabel}},{key:"isPolar",value:function(t){return arguments.length?(this._isPolar=t,this):this._isPolar}},{key:"xLabelDirection",value:function(t){return arguments.length?(this._xLabelDirection=t,this):this._xLabelDirection}},{key:"axisPositonChoice",value:function(t){return arguments.length?(this._axisPositonChoice=t,this):this._axisPositonChoice}},{key:"startAngle",value:function(t){return arguments.length?(this._startAngle=t,this):this._startAngle}},{key:"totalAngle",value:function(t){return arguments.length?(this._totalAngle=t,this):this._totalAngle}},{key:"rotateDirection",value:function(t){return arguments.length?(this._rotateDirection=t,this):this._rotateDirection}},{key:"yRange",value:function(t){return arguments.length?(this._yRange=t,this):this._yRange}},{key:"yLabelDirection",value:function(t){return arguments.length?(this._yLabelDirection=t,this):this._yLabelDirection}},{key:"yLabelAngle",value:function(t){return arguments.length?(this._yLabelAngle=t,this):this._yLabelAngle}},{key:"yLabelSuffix",value:function(t){return arguments.length?(this._yLabelSuffix=t,this):this._yLabelSuffix}},{key:"axisLineStrokeX",value:function(t){return arguments.length?(this._axisLineStrokeX=t,this):this._axisLineStrokeX}},{key:"axisLineStrokeY",value:function(t){return arguments.length?(this._axisLineStrokeY=t,this):this._axisLineStrokeY}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"xAxisShow",value:function(t){return arguments.length?(this._xAxisShow=t,this):this._xAxisShow}},{key:"yAxisShow",value:function(t){return arguments.length?(this._yAxisShow=t,this):this._yAxisShow}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;t.font;this._fontCopy=null!=i.display&&null!=i.display,0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=this._fontCopy?i?i.display:this._labelShow:i.numberLabel?i.numberLabel.show:this._labelShow,this._numberLabel=i.numberLabel?i.numberLabel:this._numberLabel,this._suffix=i.numberLabel&&i.numberLabel.suffix?i.numberLabel.suffix:""),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._stroke=e.borderColor?q(e.borderColor):"",this._strokeWidth=0==e.borderWidth||e.borderWidth?d(e.borderWidth):this._borderWidth,this._innerRadiusRatio=0==e.innerRadiusRatio||e.innerRadiusRatio?d(e.innerRadiusRatio):this._innerRadiusRatio,this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity)}},{key:"stroke",value:function(t){return arguments.length?(this._stroke=t,this):this._stroke}},{key:"sortMethod",value:function(t){return arguments.length?(this._sortMethod=t,this):this._sortMethod}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"innerRadiusRatio",value:function(t){return arguments.length?(this._innerRadiusRatio=t,this):this._innerRadiusRatio}},{key:"activeData",get:function(){return this.sortedDataCopy.data}}]),e}(vt),mu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","descartes-thermal"),i._xScale=null,i._yScale=null,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t._xScale,a=t._yScale,o=t._width,r=t._height,l=t._borderColor,s=t._borderWidth,u=t._fillOpacity,c=t._cornerRadius,h=t._gapDistance,d=t._transition,_=t._duration,f=(t._easeStyle,t._startDelay),g=t._moveOptions,v=t._moveStyle,m=e.length>0?o/e[0].data.length:0,b=e.length>0?r/e.length:0,S=t.group;S.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-descartes-thermal-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}})),function(){var i=S.append("g").selectAll("g").data(e);i.exit().remove(),i.enter().append("g").merge(i).each((function(i,o){var r=d3.select(this).selectAll("rect").data(i.data);r.exit().remove();var p=r.enter().append("rect").attr("class","descartes-thermal-rect").merge(r).style("fill","none").style("stroke",""==l?function(t){return t.color}:l).style("stroke-width",s||1).attr("rx",c).attr("ry",c).attr("x",(function(t){return n(t.name)+h/2})).attr("y",a(i.name)+h/2).attr("width",m-h).attr("height",b-h);1==t._interrupt||null==v||0==d||-1==g.indexOf(v)||(0==g.indexOf(v)?p.style("stroke-opacity",0).transition().duration(d?.4*_:0).ease(d3.easeLinear).delay(d?f:0).style("stroke-opacity","1"):1==g.indexOf(v)?p.style("fill-opacity",0).transition().duration(d?.9*_:0).ease(d3.easeLinear).delay(d?f:0).style("fill-opacity",u):2==g.indexOf(v)?p.attr("width",0).transition().duration(d?.9*_/(e.length>0?e[0].data.length:1):0).ease(d3.easeLinear).delay(d?function(t,i){return f+i*_*.9/(e.length>0?e[0].data.length:1)}:0).attr("width",m-h):3==g.indexOf(v)&&p.attr("height",0).attr("y",a(i.name)+a.bandwidth()).transition().duration(d?.9*_/(e.length>0?e.length:1):0).ease(d3.easeLinear).delay(d?function(t,i){return f+o*_*.9/(e.length>0?e.length:1)}:0).attr("height",b-h).attr("y",a(i.name)+h/2))}))}(),function(){var i=S.append("g").selectAll("g").data(e);i.exit().remove(),i.enter().append("g").merge(i).each((function(i,o){var r=d3.select(this).selectAll("rect").data(i.data);r.exit().remove();var l=r.enter().append("rect").attr("class","descartes-thermal-rect").merge(r).style("fill",(function(t){return t.color})).style("fill-opacity",u).attr("rx",c).attr("ry",c).attr("x",(function(t){return n(t.name)+s/2+h/2})).attr("y",a(i.name)+s/2+h/2).attr("width",m-s-h).attr("height",b-s-h),p=d3.select(this).selectAll("text").data(i.data);p.exit().remove();var y=p.enter().append("text").attr("class","descartes-thermal-text").merge(p).text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix})).attr("x",(function(t,e){return n(t.name)+n.bandwidth()/2})).attr("y",a(i.name)+a.bandwidth()/2).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("text-anchor","middle").attr("dy","0.4em").style("display",t._labelShow?"block":"none");t._interrupt?y.style("opacity",1):y.style("opacity",0).transition().duration(d?.1*_:0).delay(d?f+.9*_:0).style("opacity",1),1==t._interrupt||null==v||0==d||-1==g.indexOf(v)||(0==g.indexOf(v)?l.style("fill-opacity",0).transition().duration(d?.5*_:0).ease(d3.easeLinear).delay(d?f+.4*_:0).style("fill-opacity",u):1==g.indexOf(v)?l.style("fill-opacity",0).transition().duration(d?.9*_:0).ease(d3.easeLinear).delay(d?f:0).style("fill-opacity",u):2==g.indexOf(v)?l.attr("width",0).transition().duration(d?.9*_/(e.length>0?e[0].data.length:1):0).ease(d3.easeLinear).delay(d?function(t,i){return f+i*_*.9/(e.length>0?e[0].data.length:1)}:0).attr("width",m-s-h):3==g.indexOf(v)&&l.attr("height",0).attr("y",a(i.name)+a.bandwidth()+s/2).transition().duration(d?.9*_/(e.length>0?e.length:1):0).ease(d3.easeLinear).delay(d?function(t,i){return f+o*_*.9/(e.length>0?e.length:1)}:0).attr("height",b-s-h).attr("y",a(i.name)+s/2+h/2)),l.on("mouseover",t._onMouseover).on("mousemove",t._onMousemove).on("mouseout",t._onMouseout)}))}();for(var k=t.group.selectAll(".bubble-text"),w=[],C=[],O=0;O<k._groups[0].length;O++){C.push(O);for(var F=O+1;F<k._groups[0].length;F++){var L=d3.select(k._groups[0][O])._groups[0][0].__data__,P=d3.select(k._groups[0][F])._groups[0][0].__data__;p(i(d3.select(k._groups[0][O])),i(d3.select(k._groups[0][F])))&&(parseFloat(L.value)<parseFloat(P.value)?(w.push(O),d3.select(k._groups[0][O]).style("visibility","hidden")):(w.push(F),d3.select(k._groups[0][F]).style("visibility","hidden")))}}for(var A=new Set(w),W=Array.from(A),z=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(W,C),M=0;M<W.length;M++){for(var D=[],R=0;R<z.length;R++){var N=d3.select(k._groups[0][W[M]])._groups[0][0].__data__,T=d3.select(k._groups[0][W[R]])._groups[0][0].__data__,B=i(d3.select(k._groups[0][W[M]])),G=i(d3.select(k._groups[0][z[R]]));if(D.push(p(B,G)),p(B,G)){if(W[M]==z[R])continue;parseFloat(N.value)<parseFloat(T.value)?d3.select(k._groups[0][W[M]]).style("visibility","hidden"):d3.select(k._groups[0][W[R]]).style("visibility","hidden")}}0==D.filter((function(t){return 1==t})).length&&z.push(W[M])}for(var X=0;X<z.length;X++)d3.select(k._groups[0][z[X]]).style("visibility","visible");return t}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=parseFloat(t),this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"onMouseover",value:function(t){return arguments.length?(this._onMouseover="function"==typeof t?t:function(){},this):this._onMouseover}},{key:"onMousemove",value:function(t){return arguments.length?(this._onMousemove="function"==typeof t?t:function(){},this):this._onMousemove}},{key:"onMouseout",value:function(t){return arguments.length?(this._onMouseout="function"==typeof t?t:function(){},this):this._onMouseout}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"borderColor",value:function(t){return arguments.length?(this._borderColor=t,this):this._borderColor}},{key:"borderWidth",value:function(t){return arguments.length?(this._borderWidth=t,this):this._borderWidth}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"cornerRadius",value:function(t){return arguments.length?(this._cornerRadius=t,this):this._cornerRadius}},{key:"gapDistance",value:function(t){return arguments.length?(this._gapDistance=t,this):this._gapDistance}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}}]),e}(at),bu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","descartes-thermal-chart"),i.grid=new Jt(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.yAxis=new Fi(i.mainGroup),i.legend=new Mi(i.group),i.coreGroup=i.mainGroup.append("g").attr("class","core-group"),i.descartesThermal=new mu(i.coreGroup),i.xScale=d3.scaleBand(),i.yScale=d3.scaleBand(),i._xType="category",i._yType="category",i._xOrient="bottom",i._yOrient="left",i._sortValue=0,i._labelShow=!1,i._numberLabel={show:!1,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规"},i._suffix="",i._borderColor="#fff",i._borderWidth="1",i._fillOpacity="1",i._cornerRadius="0",i._gapDistance="0",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["淡入","同步出现","横向出现","纵向出现"],i._moveStyle="淡入",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=(t.grid,t.tooltip),n=t.descartesThermal,a=t.xScale,r=t.yScale,l=(t.xAxis._axisStart,t.xAxis._axisEnd),s=0;l>t.widthOfNoMargin-t.yAxis.width&&(s=l-(t.widthOfNoMargin-t.yAxis.width));var u=t.widthOfCore-s,h=t.heightOfCore,d=t.defs;d.selectAll("filter").remove();var _,f=d.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");if(f.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),f.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),f.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),f.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),f.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".descartes-thermal-border-gradient").remove(),t._borderColor&&/\[/.test(t._borderColor)){var p=(_=t._borderColor,new Function("return "+_)()),x=[],g=!0,v=!1,m=void 0;try{for(var b,S=p[Symbol.iterator]();!(g=(b=S.next()).done);g=!0){var k=b.value,w=[],C=k.split(":");w.push(q(C[0])),w.push(C[1]),x.push(w)}}catch(t){v=!0,m=t}finally{try{!g&&S.return&&S.return()}finally{if(v)throw m}}var O=x.concat(),F=O.pop();t.mainGroup.append("linearGradient").attr("class","descartes-thermal-border-gradient").attr("id",t.id+"-descartes-thermal-border-0").attr("x1",y(F[1]).x1+"%").attr("y1",y(F[1]).y1+"%").attr("x2",y(F[1]).x2+"%").attr("y2",y(F[1]).y2+"%").selectAll("stop").data(O).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}n.data(e).xScale(a).yScale(r).width(u).height(h).fontSize(t._numberLabel.fontSize).fontColor(q(t._numberLabel.color)).fontFamily(t._numberLabel.fontFamily).labelShow(t._labelShow).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).borderColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-descartes-thermal-border-0")+")":t._borderColor).borderWidth(t._borderWidth).fillOpacity(t._fillOpacity).cornerRadius(t._cornerRadius).gapDistance(t._gapDistance).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(n,a){if(e.length>0){var o=[{text:""+(-1!=String(n.subName).indexOf("$-")?"":n.subName),color:n.color},{text:n.name+"："+E(n.value,t._numberStyle,t._decimalPlaces)}];i.data(o).update(),i.move([d3.event.offsetX,d3.event.offsetY]).show()}})).onMousemove((function(t,e){i.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(t){i.hide()})),"下面"==t._axisPositonChoiceX?t.coreGroup.call(o,t.yAxis.width+1,0):t.coreGroup.call(o,t.yAxis.width+1,t.xAxis.height);var L=t.group.selectAll(".grouped-bar-chart .axis-x-line .tick text").nodes().filter((function(t,e){return t.__data__=="&-"+(e+1)}));t.mainGroup.selectAll(".axis-x-line line").attr("transform","translate("+-a.bandwidth()/2+",0)"),t.mainGroup.selectAll(".axis-y-horizontal line").attr("transform","translate(0,"+-r.bandwidth()/2+")"),d3.selectAll(L).remove(),n.update()}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"updateLegend",value:function(){var t=this,e=t.legend,i=t.widthOfNoMargin;if(!t._legendShow)return e.hide();e.show(),e.limitedWidth(i).horizontalAlign(t._legendX).rectWidth(i/5).rectHeight(i/5/10).fontSize(t._legendFontSize).fontFamily(t._legendFontFamily).fontColor(t._legendFontColor),this.configLegend(),e.update()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy;t.legend.colorList(e.colorScale.range()).offsetList(e.offset).startText(E(e.minValue,t._numberStyle,t._decimalPlaces)).endText(E(e.maxValue,t._numberStyle,t._decimalPlaces)).title("")}},{key:"sortData",value:function(){var t=this._data.data;1===this._sortValue?t.sort((function(t,e){return t.year-e.year})):-1===this._sortValue&&t.sort((function(t,e){return e.year-t.year})),this._sortedDataCopy=this._data}},{key:"buildOption",value:function(t,e){var i=new gu(t,e),n=M;return i.dataSolveFunc(n),i}},{key:"updateAxis",value:function(){var t=this;t.computeDomain();var e=t.xAxis,i=t.yAxis,n=t.xScale,a=t.yScale,o=t._xType,r=t._yType,l=t._xOrient,s=t._yOrient;l="上面"==t._axisPositonChoiceX?"top":"bottom";var u=t._fontSize,c=t.widthOfNoMargin,h=t.heightOfMainGroup;n.domain(t._xDomain),a.domain(t._yDomain),e.scaleFunc(n).allowedMaxTextHeight(.5*h).type(o).orient(l).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),i.scaleFunc(a).allowedMaxTextWidth(.5*c).type(r).orient(s).title(t._yTitle).tickShow(t._yTickShow).lineStroke(t._axisLineStrokeY).fontSize(u).fontColor(t._fontColor).fontFamily(t._fontFamily).yRange(t._yRange).transition(t._transition).duration(t._duration).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);i.titleHeight;i.compute();var d=0,_=c-i.width;i.compute(),n.range([d,_]),e.compute();var f=e._axisStart,p=e._axisEnd;f<0&&(d=Math.abs(f)>i.width?Math.abs(f)-i.width:0),p>_&&(_-=p-_),n.range([d,_]),a.range([h-e.height,0]);var y=i.width,x=h-e.height,g=i.width+d,v=0;"上面"==t._axisPositonChoiceX?(x=e.height,v=e.height):x=(t._axisPositonChoiceX,h-e.height),e.translate(y,x).update(),i.translate(g,v).update()}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this.axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面"),this.axisLineStroke(q(i.color)).axisLineStrokeX(q(n.axisColor)||q(i.color)).axisLineStrokeY(q(a.axisColor)||q(i.color)).xTitle(n.name).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).xRange(n.range?n.range:[]).yRange(a.range?a.range:[]).clipShow(a.range?a.range:[]).clipShowX(n.range?n.range:[]).xAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xLabelDirection(n.labelDirection?n.labelDirection:"自动").xLabelAngle(0==n.labelAngle||n.labelAngle?n.labelAngle:0).xCountOfLabel(0==n.stepOfLabel||n.stepOfLabel?n.stepOfLabel:null).xLabelSuffix(n.labelSuffix?n.labelSuffix:"").yLabelDirection(a.labelDirection?a.labelDirection:"自动").yLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).yCountOfLabel(0==a.stepOfLabel||a.stepOfLabel?a.stepOfLabel:null).yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}},{key:"setSelfOption",value:function(t){var e=t.label,i=t.display,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(i).length&&(this._borderColor=i.borderColor?q(i.borderColor):"",this._borderWidth=0==i.borderWidth||i.borderWidth?i.borderWidth:this._borderWidth,this._fillOpacity=0==i.fillOpacity||i.fillOpacity?i.fillOpacity:this._fillOpacity,this._cornerRadius=0==i.cornerRadius||i.cornerRadius?i.cornerRadius:this._cornerRadius,this._gapDistance=0==i.gapDistance||i.gapDistance?i.gapDistance:this._gapDistance),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(e).length&&(this._labelShow=e?e.numberLabel.show:this._labelShow,this._numberLabel=e.numberLabel?e.numberLabel:this._numberLabel,this._suffix=e.numberLabel&&e.numberLabel.suffix?e.numberLabel.suffix:"")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=e.length?e[0].data.map((function(t){return t.name})):[0,1],n=e.length?e.map((function(t){return t.name})):[0,1];t._xDomain=i,t._yDomain=n}},{key:"activeData",get:function(){return this.sortedDataCopy.data}}]),e}(Tt),Su=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","areaPyramid"),i._width=400,i._height=400,i}return w(e,t),S(e,[{key:"update",value:function(){for(var t=this,e=t._data,i=(t._paddingInner,t.group),n=t._width,a=.92*t._height,o=t._contentChoice,r=t._suffix,l=0,s=0;s<e.length;s++)l+=e[s].value;var u=0;e.forEach((function(i,n){i.percent=E(i.value/l*100,t._numberStyle,null==t._decimalPlaces?2:t._decimalPlaces)+"%",n>0?(u+=e.length>0?e[n-1].value:0,i.base=1-u/l,i.base2=i.base-i.value/l):0==n&&(i.base=1,i.base2=i.base-i.value/l)}));var h,d=e.map((function(e){return E(e.value,t._numberStyle,null==t._decimalPlaces?2:t._decimalPlaces)+r})),_=e.map((function(t){return t.name})),f=e.map((function(e){return E(e.value/l*100,t._numberStyle,null==t._decimalPlaces?2:t._decimalPlaces)+"%"})),p=d.map((function(e){return R(e,t._fontSize,t._fontFamily)})),g=_.map((function(e){return R(e,t._fontSize,t._fontFamily)})),v=f.map((function(e){return R(e,t._fontSize,t._fontFamily)})),m=void 0,b=[],S=[],k=0,w=!1,C=void 0;if(t._labelShow&&1==t._positionOptions.indexOf(t._positionChoice)){for(var O=0;O<e.length;O++)3==o.length?m=Math.max(g[O],p[O]+v[O])+10:2==o.length?o.includes("名称")&&o.includes("数值")?m=Math.max(g[O],p[O]):o.includes("名称")&&o.includes("百分比")?m=Math.max(g[O],v[O]):o.includes("百分比")&&o.includes("数值")&&(m=Math.max(p[O],v[O])):1==o.length&&("名称"==o[0]?m=g[O]:"数值"==o[0]?m=p[O]:"百分比"==o[0]&&(m=v[O])),S.push(m);var F=d3.max(S);F>.81*n?k=1:(w=(k=.81*n-F)/2*Math.sqrt(3)>a,k=k/2*Math.sqrt(3)>a?2*a/Math.sqrt(3):k)}else if(t._labelShow&&2==t._positionOptions.indexOf(t._positionChoice)){for(var L=0;L<e.length;L++)3==o.length?m=Math.max(g[L],p[L]+v[L])+10:2==o.length?o.includes("名称")&&o.includes("数值")?m=Math.max(g[L],p[L]):o.includes("名称")&&o.includes("百分比")?m=Math.max(g[L],v[L]):o.includes("百分比")&&o.includes("数值")&&(m=Math.max(p[L],v[L])):1==o.length&&("名称"==o[0]?m=g[L]:"数值"==o[0]?m=p[L]:"百分比"==o[0]&&(m=v[L])),S.push(m),b.push((.78*n-m)/e[L].base);1==e.length?k=2*d3.min(b):e.length>=2&&(k=d3.min(b)/((e[0].base+e[1].base)/2)),w=(k=k<1?1:k)/2*Math.sqrt(3)>a,k=k/2*Math.sqrt(3)>a?2*a/Math.sqrt(3):k}else.9*n>=2*a/Math.sqrt(3)?(w=!0,k=2*a/Math.sqrt(3)):C=.05*n+.5*(k=.9*n)+(.9*n-k)/2;C=e.length>0?.05*n+.5*k:0,h=.96*t._height,t.group.selectAll("*").remove(),t.group.selectAll(".area-pyramid-groups").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));var P=i.selectAll("polygon").data(e);P.exit().remove();var A=P.enter().append("g").attr("class","area-pyramid-groups");if(null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||0==t._moveOptions.indexOf(t._moveStyle))A.append("polygon").merge(P).attr("class","area-pyramid").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return""==t._strokeColor?e.color:t._strokeColor})).style("stroke-width",t._strokeWidth||0).attr("points",(function(i,n){return n==e.length-1?-k/2*e[n].base+","+(-a*(1-e[n].base)-t._paddingInner/2)+"\n                    "+k/2*e[n].base+","+(-a*(1-e[n].base)-t._paddingInner/2)+"\n                    0,"+-a:-k/2*e[n].base+","+(-a*(1-e[n].base)-(0==n?0:t._paddingInner/2))+"\n                    "+k/2*e[n].base+","+(-a*(1-e[n].base)-(0==n?0:t._paddingInner/2))+"\n                    "+k/2*e[n+1].base+","+(-a*(1-e[n+1].base)+t._paddingInner/2)+"\n                    "+-k/2*e[n+1].base+","+(-a*(1-e[n+1].base)+t._paddingInner/2)})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);else if(1==t._moveOptions.indexOf(t._moveStyle)){var W=A.append("polygon").merge(P).attr("class","area-pyramid").style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e){return""==t._strokeColor?e.color:t._strokeColor})).style("stroke-width",t._strokeWidth||0).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout);t._interrupt?W.attr("points",(function(i,n){return n==e.length-1?-k/2*e[n].base+","+(-a*(1-e[n].base)-t._paddingInner/2)+"\n                    "+k/2*e[n].base+","+(-a*(1-e[n].base)-t._paddingInner/2)+"\n                    0,"+-a:-k/2*e[n].base+","+(-a*(1-e[n].base)-(0==n?0:t._paddingInner/2))+"\n                    "+k/2*e[n].base+","+(-a*(1-e[n].base)-(0==n?0:t._paddingInner/2))+"\n                    "+k/2*e[n+1].base+","+(-a*(1-e[n+1].base)+t._paddingInner/2)+"\n                    "+-k/2*e[n+1].base+","+(-a*(1-e[n+1].base)+t._paddingInner/2)})):W.attr("points",(function(i,n){return n==e.length-1?"0,"+-a+"\n                      0,"+-a+"\n                      0,"+-a:"0,"+(-a*(1-e[n+1].base)-(0==n?0:t._paddingInner/2))+"\n                      0,"+(-a*(1-e[n+1].base)-(0==n?0:t._paddingInner/2))+"\n                      0,"+(-a*(1-e[n+1].base)+t._paddingInner/2)+"\n                      0,"+(-a*(1-e[n+1].base)+t._paddingInner/2)})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("points",(function(i,n){return n==e.length-1?-k/2*e[n].base+","+(-a*(1-e[n].base)-t._paddingInner/2)+"\n                      "+k/2*e[n].base+","+(-a*(1-e[n].base)-t._paddingInner/2)+"\n                      0,"+-a:-k/2*e[n].base+","+(-a*(1-e[n].base)-(0==n?0:t._paddingInner/2))+"\n                      "+k/2*e[n].base+","+(-a*(1-e[n].base)-(0==n?0:t._paddingInner/2))+"\n                      "+k/2*e[n+1].base+","+(-a*(1-e[n+1].base)+t._paddingInner/2)+"\n                      "+-k/2*e[n+1].base+","+(-a*(1-e[n+1].base)+t._paddingInner/2)}))}i.selectAll(".area-pyramid-labels-group").remove();var z=A.append("g").merge(P).attr("class","area-pyramid-labels-group").style("opacity",0).style("pointer-events","none");if(1==t._positionOptions.indexOf(t._positionChoice)){z.append("line").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x1",(function(t){return(t.base+t.base2)*k/4})).attr("y1",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("x2",k/2+.09*n).attr("y2",(function(t){return-a*(1-t.base/2-t.base2/2)})).style("stroke","#bfbfbf").style("stroke-width","1").style("display",t._labelShow?"block":"none");var M=z.append("text").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",k/2+.09*n).attr("y",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("text-anchor","start").attr("dy","-0.25em").style("display",t._labelShow?"block":"none"),D=z.append("text").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",k/2+.09*n).attr("y",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("text-anchor","start").attr("dy","0.95em").style("display",t._labelShow?"block":"none");3==o.length?(M.text((function(e,i){return e.name=="$-"+i?"":X(e.name,.81*n,t._fontSize,t._fontFamily)})),D.text((function(e,i){return X(e.percent+"  "+E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.81*n,t._fontSize,t._fontFamily)}))):2==o.length&&o.includes("名称")&&o.includes("数值")?(M.text((function(e,i){return e.name=="$-"+i?"":X(e.name,.81*n,t._fontSize,t._fontFamily)})),D.text((function(e,i){return X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.81*n,t._fontSize,t._fontFamily)}))):2==o.length&&o.includes("名称")&&o.includes("百分比")?(M.text((function(e,i){return e.name=="$-"+i?"":X(e.name,.81*n,t._fontSize,t._fontFamily)})),D.text((function(e,i){return X(e.percent,.81*n,t._fontSize,t._fontFamily)}))):2==o.length&&o.includes("数值")&&o.includes("百分比")?(M.text((function(e,i){return X(e.percent,.81*n,t._fontSize,t._fontFamily)})),D.text((function(e,i){return X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.81*n,t._fontSize,t._fontFamily)}))):1==o.length&&"名称"==o[0]?M.attr("dy","0.35em").text((function(e,i){return e.name=="$-"+i?"":X(e.name,.81*n,t._fontSize,t._fontFamily)})):1==o.length&&"数值"==o[0]?M.attr("dy","0.35em").text((function(e,i){return X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.81*n,t._fontSize,t._fontFamily)})):1==o.length&&"百分比"==o[0]&&M.attr("dy","0.35em").text((function(e,i){return X(e.percent,.81*n,t._fontSize,t._fontFamily)}))}else if(2==t._positionOptions.indexOf(t._positionChoice)){z.append("line").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x1",(function(t){return(t.base+t.base2)*k/4})).attr("y1",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("x2",(function(t){return(t.base+t.base2)*k/4+.12*n})).attr("y2",(function(t){return-a*(1-t.base/2-t.base2/2)})).style("stroke","#bfbfbf").style("stroke-width","1").style("display",t._labelShow?"block":"none");var N=z.append("text").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(t){return(t.base+t.base2)*k/4+.12*n})).attr("y",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("text-anchor","start").attr("dy","-0.25em").style("display",t._labelShow?"block":"none"),T=z.append("text").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",(function(t){return(t.base+t.base2)*k/4+.12*n})).attr("y",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("text-anchor","start").attr("dy","0.95em").style("display",t._labelShow?"block":"none");3==o.length?(N.text((function(e,i){return e.name=="$-"+i?"":X(e.name,.83*n,t._fontSize,t._fontFamily)})),T.text((function(e,i){return X(e.percent+"  "+E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.83*n,t._fontSize,t._fontFamily)}))):2==o.length&&o.includes("名称")&&o.includes("数值")?(N.text((function(e,i){return e.name=="$-"+i?"":X(e.name,.83*n,t._fontSize,t._fontFamily)})),T.text((function(e,i){return X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.83*n,t._fontSize,t._fontFamily)}))):2==o.length&&o.includes("名称")&&o.includes("百分比")?(N.text((function(e,i){return e.name=="$-"+i?"":X(e.name,.83*n,t._fontSize,t._fontFamily)})),T.text((function(e,i){return X(e.percent,.83*n,t._fontSize,t._fontFamily)}))):2==o.length&&o.includes("数值")&&o.includes("百分比")?(N.text((function(e,i){return X(e.percent,.83*n,t._fontSize,t._fontFamily)})),T.text((function(e,i){return X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.83*n,t._fontSize,t._fontFamily)}))):1==o.length&&"名称"==o[0]?N.attr("dy","0.35em").text((function(e,i){return e.name=="$-"+i?"":X(e.name,.83*n,t._fontSize,t._fontFamily)})):1==o.length&&"数值"==o[0]?N.attr("dy","0.35em").text((function(e,i){return X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.83*n,t._fontSize,t._fontFamily)})):1==o.length&&"百分比"==o[0]&&N.attr("dy","0.35em").text((function(e,i){return X(e.percent,.83*n,t._fontSize,t._fontFamily)}))}else{var B=z.append("text").style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).attr("x",0).attr("y",(function(t){return-a*(1-t.base/2-t.base2/2)})).attr("text-anchor","middle").attr("dy","0.35em").style("display",t._labelShow?"block":"none");3==o.length?B.text((function(e,i){return e.name=="$-"+i?"":X((e.name=="$-"+i?"":e.name)+"  "+e.percent+"  "+E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.9*n,t._fontSize,t._fontFamily)})):2==o.length&&o.includes("名称")&&o.includes("数值")?B.text((function(e,i){return e.name=="$-"+i?"":X((e.name=="$-"+i?"":e.name)+"  "+E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.9*n,t._fontSize,t._fontFamily)})):2==o.length&&o.includes("名称")&&o.includes("百分比")?B.text((function(e,i){return e.name=="$-"+i?"":X((e.name=="$-"+i?"":e.name)+"  "+e.percent,.9*n,t._fontSize,t._fontFamily)})):2==o.length&&o.includes("数值")&&o.includes("百分比")?B.text((function(e,i){return e.name=="$-"+i?"":X(e.percent+"  "+E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.9*n,t._fontSize,t._fontFamily)})):1==o.length&&"名称"==o[0]?B.text((function(e,i){return e.name=="$-"+i?"":X(e.name=="$-"+i?"":e.name,.9*n,t._fontSize,t._fontFamily)})):1==o.length&&"数值"==o[0]?B.text((function(e,i){return e.name=="$-"+i?"":X(E(e.value,t._numberStyle,t._decimalPlaces)+t._suffix,.9*n,t._fontSize,t._fontFamily)})):1==o.length&&"百分比"==o[0]&&B.text((function(e,i){return e.name=="$-"+i?"":X(e.percent,.9*n,t._fontSize,t._fontFamily)}))}if(t._interrupt?z.style("opacity",1):z.transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity",1),w)if(t._labelShow&&1==t._positionOptions.indexOf(t._positionChoice)){var G=S.map((function(t,i){return t+.09*n+(e[i].base+e[i].base2)/4*k})),j=d3.max(G.map((function(t){return t})))+k/2;i.attr("transform","translate("+(C+(.9*n/2-j/2))+","+h+")")}else if(t._labelShow&&2==t._positionOptions.indexOf(t._positionChoice)){var I=S.map((function(t,i){return t+.12*n+(e[i].base+e[i].base2)/4*k})),Y=d3.max(I.map((function(t){return t})))+k/2;i.attr("transform","translate("+(C+(.9*n/2-Y/2))+","+h+")")}else i.attr("transform","translate("+n/2+","+h+")");else i.attr("transform","translate("+C+","+h+")");return t}},{key:"defs",value:function(t){return arguments.length?(this.defs=t,this):this.defs}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"labelShow",value:function(t){return arguments.length?(this._labelShow=t,this):this._labelShow}},{key:"positionOptions",value:function(t){return arguments.length?(this._positionOptions=t,this):this.positionOptions}},{key:"positionChoice",value:function(t){return arguments.length?(this._positionChoice=t,this):this.positionChoice}},{key:"contentOption",value:function(t){return arguments.length?(this._contentOption=t,this):this.contentOption}},{key:"contentChoice",value:function(t){return arguments.length?(this._contentChoice=t,this):this.contentChoice}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=parseFloat(t),this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=parseFloat(t),this):this._startDelay}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=parseFloat(t),this):this._endPause}},{key:"defs",value:function(t){return arguments.length?(this._defs=t,this):this._defs}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=parseFloat(t),this):this._fillOpacity}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=parseFloat(t),this):this._strokeWidth}},{key:"paddingInner",value:function(t){return arguments.length?(this._paddingInner=parseFloat(t),this):this._paddingInner}},{key:"suffix",value:function(t){return arguments.length?(this._suffix=t,this):this._suffix}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"data",value:function(t){return arguments.length?(this._data=t,this):this._data}}]),e}(at),ku=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","area-pyramid-chart"),i.areaPyramid=new Su(i.mainGroup),i.AnimationArea=new Zt(i.defs),i._suffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._labelShow=!0,i._positionOptions=["内部","外部对齐","外部跟随"],i._positionChoice="内部",i._contentOption=["名称","百分比","数值"],i._contentChoice=["名称"],i._textLabel={color:"#FFFFFF",fontFamily:"noto",fontSize:12},i._suffix="",i._borderWidth=1,i._borderColor="#FFFFFF",i._fillOpacity=1,i._gap=0,i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["纵向展开","横向同步展开"],i._moveStyle="纵向展开",i._endPause=0,i._interrupt=!1,i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData.filter((function(t,e){return t.value>0||0==t.value})),i=t.areaPyramid,n=(t.AnimationArea,t.widthOfNoMargin),a=t.heightOfMainGroup,o=t.defs;o.selectAll("filter").remove();var r,l=o.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_funnel").attr("filterUnits","objectBoundingBox");if(l.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),l.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),l.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),l.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),l.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.group.selectAll(".area-pyramid-border-gradient").remove(),t._borderColor&&/\[/.test(t._borderColor)){var s=(r=t._borderColor,new Function("return "+r)()),u=[],h=!0,d=!1,_=void 0;try{for(var f,p=s[Symbol.iterator]();!(h=(f=p.next()).done);h=!0){var x=f.value,g=[],v=x.split(":");g.push(q(v[0])),g.push(v[1]),u.push(g)}}catch(t){d=!0,_=t}finally{try{!h&&p.return&&p.return()}finally{if(d)throw _}}var m=u.concat(),b=m.pop();t.group.append("linearGradient").attr("class","area-pyramid-border-gradient").attr("id",t.id+"-area-pyramid-border-0").attr("x1",y(b[1]).x1+"%").attr("y1",y(b[1]).y1+"%").attr("x2",y(b[1]).x2+"%").attr("y2",y(b[1]).y2+"%").selectAll("stop").data(m).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(i.data(e).width(n).height(a).labelShow(t._labelShow).positionOptions(t._positionOptions).positionChoice(t._positionChoice).contentOption(t._contentOption).contentChoice(t._contentChoice).defs(t.defs).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).interrupt(t._interrupt).fontSize(t._textLabel.fontSize).fontColor(q(t._textLabel.color)).fontFamily(t._textLabel.fontFamily).strokeWidth(t._borderWidth).strokeColor(/\[/.test(t._borderColor)?"url("+c("#"+t.id+"-area-pyramid-border-0")+")":t._borderColor).fillOpacity(t._fillOpacity).paddingInner(t._gap).suffix(t._suffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){d3.select(this).transition().duration(30).style("opacity",.8);var n=[{text:""+(e.name=="$-"+i?"":e.name),color:e.color},{text:e.valueLabel+": "+E(e.value,t._numberStyle,t._decimalPlaces)}];t.tooltip.data(n).update().move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){t.tooltip.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(e){d3.select(this).transition().duration(30).style("opacity",1),t.tooltip.hide()})),t.areaPyramid.update(),null==t._moveStyle||0==t._transition||-1==t._moveOptions.indexOf(t._moveStyle)||1==t._moveOptions.indexOf(t._moveStyle));else if(0==t._moveOptions.indexOf(t._moveStyle)){if(t._interrupt)t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",t.heightOfMainGroup),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")");else t.mainGroup.selectAll(".animation-defs").remove(),t.mainGroup.append("defs").attr("class","animation-defs").append("clipPath").attr("id","animation-overlay-"+t.id).append("rect").attr("width",t._width).attr("height",0).transition().duration(t._transition?1e3*t._duration:0).delay(t._transition?1e3*t._startDelay:0).attr("height",t.heightOfMainGroup),t.mainGroup.attr("clip-path","url("+c("#animation-overlay-"+t.id)+")")}}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.label,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay;0!==Object.getOwnPropertyNames(e).length&&(this._borderWidth=0==e.borderWidth||e.borderWidth?e.borderWidth:this._borderWidth,this._borderColor=e.borderColor?q(e.borderColor):"",this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._gap=0==e.gapDistance||e.gapDistance?e.gapDistance:this._gap),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY),0!==Object.getOwnPropertyNames(i).length&&(this._labelShow=i?i.display:this._labelShow,this._textLabel=i.textLabel?i.textLabel:this._textLabel,this._positionChoice=i.positionChoice?i.positionChoice:this._positionChoice,this._contentChoice=i.contentChoice?i.contentChoice:this._contentChoice,this._suffix=i.suffix?i.suffix:"")}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}}]),e}(nt),wu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","butterfly-bar"),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=parseFloat(t._rightMove),a=t.group;if(a.selectAll("*").remove(),a.selectAll(".butterfly-bar-border-gradient-left").remove(),a.selectAll(".butterfly-bar-border-gradient-right").remove(),t._strokeColor&&/\[/.test(t._strokeColor)){var o=z(t._strokeColor),r=[],l=!0,s=!1,u=void 0;try{for(var h,d=o[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var _=h.value,x=[],g=_.split(":");x.push(q(g[0])),x.push(g[1]),r.push(x)}}catch(t){s=!0,u=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}var v=r.concat(),m=v.pop();a.append("linearGradient").attr("class","butterfly-bar-border-gradient-left").attr("id",t.id+"-butterfly-bar-border-0-left").attr("x1",y(m[1]).x2+"%").attr("y1",y(m[1]).y1+"%").attr("x2",y(m[1]).x1+"%").attr("y2",y(m[1]).y2+"%").selectAll("stop").data(v).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._strokeColor&&/\[/.test(t._strokeColor)){var b=z(t._strokeColor),S=[],k=!0,w=!1,C=void 0;try{for(var O,F=b[Symbol.iterator]();!(k=(O=F.next()).done);k=!0){_=O.value;var L=[],P=_.split(":");L.push(q(P[0])),L.push(P[1]),S.push(L)}}catch(t){w=!0,C=t}finally{try{!k&&F.return&&F.return()}finally{if(w)throw C}}var A=S.concat(),W=A.pop();a.append("linearGradient").attr("class","butterfly-bar-border-gradient-right").attr("id",t.id+"-butterfly-bar-border-0-right").attr("x1",y(W[1]).x1+"%").attr("y1",y(W[1]).y1+"%").attr("x2",y(W[1]).x2+"%").attr("y2",y(W[1]).y2+"%").selectAll("stop").data(A).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}function z(t){return new Function("return "+t)()}if(e.length>0){if(e[0].color&&/\[/.test(e[0].color)){var M=z(e[0].color),D=[],R=!0,N=!1,T=void 0;try{for(var B,G=M[Symbol.iterator]();!(R=(B=G.next()).done);R=!0){var X=B.value,j=[],I=X.split(":");j.push(q(I[0])),j.push(I[1]),D.push(j)}}catch(t){N=!0,T=t}finally{try{!R&&G.return&&G.return()}finally{if(N)throw T}}var Y=D.concat(),H=Y.pop();t.group.append("linearGradient").attr("id",t.id+"-index-left").attr("x1",y(H[1]).x1+"%").attr("y1",y(H[1]).y1+"%").attr("x2",y(H[1]).x2+"%").attr("y2",y(H[1]).y2+"%").selectAll("stop").data(Y).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(e[1].color&&/\[/.test(e[1].color)){var V=z(e[1].color),$=[],Z=!0,Q=!1,K=void 0;try{for(var J,tt=V[Symbol.iterator]();!(Z=(J=tt.next()).done);Z=!0){var et=J.value,it=[],nt=et.split(":");it.push(q(nt[0])),it.push(nt[1]),$.push(it)}}catch(t){Q=!0,K=t}finally{try{!Z&&tt.return&&tt.return()}finally{if(Q)throw K}}var at=$.concat(),ot=at.pop();t.group.append("linearGradient").attr("id",t.id+"-index-right").attr("x1",y(ot[1]).x1+"%").attr("y1",y(ot[1]).y1+"%").attr("x2",y(ot[1]).x2+"%").attr("y2",y(ot[1]).y2+"%").selectAll("stop").data(at).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}var rt=t._yScale,lt=t._xlScale,st=t._xrScale,ut=lt.domain()[0]<0?0:lt.domain()[0],ct=st.domain()[0]<0?0:st.domain()[0],ht=t._barWidthPercent,dt=t._strokeWidth,_t=t._barCornerRadius,ft=t._strokeColor,pt=(t._fillOpacity,t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice)),yt=a.append("g").attr("class","butterfly-bar-rects-left").selectAll("rect").data(e[0].data);yt.exit().remove();var xt=yt.enter().append("path").merge(yt).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-left")+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){if(0!=e.value){var n=""==ft?e.color:ft;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-butterfly-bar-border-0-left")+")":n}})).style("stroke-width",dt).attr("d",(function(t){return f({x:lt(t.value),y:rt(t.name)+rt.bandwidth()*(1-ht)/2,width:lt(ut)-lt(t.value),height:rt.bandwidth()*ht,cornerRadius:_t||0,roundCorners:[0,1,2,3],type:"horizontal"})})).style("display",0==e[0].active?"none":"block"),gt=a.append("g").attr("class","butterfly-bar-rects-right").selectAll("rect").data(e[1].data);gt.exit().remove();var vt=gt.enter().append("path").merge(gt).style("fill",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-right")+")":e.color&&/#/.test(e.color)?e.color:"rgb("+U(e.color,0)+","+U(e.color,1)+","+U(e.color,2)+")"})).style("fill-opacity",(function(e){if(e.color&&/#/.test(e.color))return t._fillOpacity;var i=U(e.color,3)||1;return t._fillOpacity*i})).style("stroke",(function(e,i){var n=""==ft?e.color:ft;return n&&/\[/.test(n)?"url("+c("#"+t.id+"-butterfly-bar-border-0-right")+")":n})).style("stroke-width",dt).attr("d",(function(t){return f({x:st(ct),y:rt(t.name)+rt.bandwidth()*(1-ht)/2,width:st(t.value)-st(ct),height:rt.bandwidth()*ht,cornerRadius:_t||0,roundCorners:[0,1,2,3],type:"horizontal"})})).style("display",0==e[1].active?"none":"block").attr("transform","translate("+((t._width+t._midGap)/2-n)+",0)"),mt=a.append("g").attr("class","butterfly-bar-label-left").selectAll("text").data(e[0].data);mt.exit().remove();var bt=mt.enter().append("text").attr("class","butterfly-bar-labels").merge(mt).attr("x",(function(t){return 0==pt?(lt(t.value)+lt(ut))/2:2==pt?lt(ut)-5:lt(t.value)-5})).attr("y",(function(t){return rt(t.name)+rt.bandwidth()/2})).style("fill",q(t._numberLabel.color)).style("font-size",t._numberLabel.fontSize).style("font-family",t._numberLabel.fontFamily).style("pointer-events","none").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._numberLabel.suffix})).attr("text-anchor",0==pt?"middle":"end").attr("dy","0.35em").style("display",0==e[0].active?"none":1==t._numberLabel.show?"block":"none"),St=a.append("g").attr("class","butterfly-bar-label-right").selectAll("text").data(e[1].data);St.exit().remove();var kt=St.enter().append("text").attr("class","butterfly-bar-labels").merge(St).attr("x",(function(t){return 0==pt?(st(t.value)+st(ct))/2:2==pt?st(ct)+5:st(t.value)+5})).attr("y",(function(t){return rt(t.name)+rt.bandwidth()/2})).style("pointer-events","none").text((function(e){return E(e.value,t._numberStyle,t._decimalPlaces)+t._numberLabel.suffix})).attr("text-anchor",0==pt?"middle":"start").attr("dy","0.35em").attr("dx",(t._width+t._midGap)/2-n).style("fill",t._numberLabel.color).style("font-size",t._numberLabel.fontSize).style("font-family",t._numberLabel.fontFamily).style("display",0==e[1].active?"none":1==t._numberLabel.show?"block":"none");t._interrupt||(t._transition&&0==t._moveOptions.indexOf(t._moveStyle)?(xt.style("opacity","0").transition().duration(t._transition?.9*t._duration/(e.length>0?e[0].data.length:1):0).delay(t._transition?function(i,n){return t._startDelay+(e.length>0?e[0].data.length-n:0)*t._duration*.9/(e.length>0?e[0].data.length:1)}:0).style("opacity","1"),vt.style("opacity","0").transition().duration(t._transition?.9*t._duration/(e.length>0?e[0].data.length:1):0).delay(t._transition?function(i,n){return t._startDelay+(e.length>0?e[0].data.length-n:0)*t._duration*.9/(e.length>0?e[0].data.length:1)}:0).style("opacity","1")):t._transition&&1==t._moveOptions.indexOf(t._moveStyle)?(xt.style("opacity","0").transition().duration(t._transition?.9*t._duration/(e.length>0?e[0].data.length:1):0).delay(t._transition?function(i,n){return t._startDelay+n*t._duration*.9/(e.length>0?e[0].data.length:1)}:0).style("opacity","1"),vt.style("opacity","0").transition().duration(t._transition?.9*t._duration/(e.length>0?e[0].data.length:1):0).delay(t._transition?function(i,n){return t._startDelay+n*t._duration*.9/(e.length>0?e[0].data.length:1)}:0).style("opacity","1")):t._transition&&2==t._moveOptions.indexOf(t._moveStyle)&&(xt.attr("d",(function(t){return f({x:lt(ut),y:rt(t.name)+rt.bandwidth()*(1-ht)/2,width:0,height:rt.bandwidth()*ht,cornerRadius:_t||0,roundCorners:[0,1,2,3],type:"horizontal"})})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t){return f({x:lt(t.value),y:rt(t.name)+rt.bandwidth()*(1-ht)/2,width:lt(ut)-lt(t.value),height:rt.bandwidth()*ht,cornerRadius:_t||0,roundCorners:[0,1,2,3],type:"horizontal"})})),vt.attr("d",(function(t){return f({x:st(ct),y:rt(t.name)+rt.bandwidth()*(1-ht)/2,width:0,height:rt.bandwidth()*ht,cornerRadius:_t||0,roundCorners:[0,1,2,3],type:"horizontal"})})).transition().duration(t._transition?.9*t._duration:0).delay(t._transition?t._startDelay:0).attr("d",(function(t){return f({x:st(ct),y:rt(t.name)+rt.bandwidth()*(1-ht)/2,width:st(t.value)-st(ct),height:rt.bandwidth()*ht,cornerRadius:_t||0,roundCorners:[0,1,2,3],type:"horizontal"})})))),!t._interrupt&&t._transition&&(bt.style("opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity","1"),kt.style("opacity","0").transition().duration(t._transition?.1*t._duration:0).delay(t._transition?t._startDelay+.9*t._duration:0).style("opacity","1"));for(var wt=a.selectAll(".butterfly-bar-labels"),Ct=[],Ot=[],Ft=0;Ft<wt._groups[0].length;Ft++){Ot.push(Ft);for(var Lt=Ft+1;Lt<wt._groups[0].length;Lt++){p(i(d3.select(wt._groups[0][Ft])),i(d3.select(wt._groups[0][Lt])))&&(Ct.push(Ft),d3.select(wt._groups[0][Ft]).style("visibility","hidden"))}}for(var Pt=new Set(Ct),At=Array.from(Pt),Wt=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(At,Ot),zt=0;zt<At.length;zt++){for(var Mt=[],Dt=0;Dt<Wt.length;Dt++){var Rt=i(d3.select(wt._groups[0][At[zt]])),Nt=i(d3.select(wt._groups[0][Wt[Dt]]));if(Mt.push(p(Rt,Nt)),p(Rt,Nt)){if(At[zt]==Wt[Dt])continue;d3.select(wt._groups[0][At[zt]]).style("visibility","hidden")}}0==Mt.filter((function(t){return 1==t})).length&&Wt.push(At[zt])}for(var Tt=0;Tt<Wt.length;Tt++)d3.select(wt._groups[0][Wt[Tt]]).style("visibility","visible");return t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=t,this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=t,this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"barWidthPercent",value:function(t){return arguments.length?(this._barWidthPercent=t,this):this._barWidthPercent}},{key:"strokeWidth",value:function(t){return arguments.length?(this._strokeWidth=t,this):this._strokeWidth}},{key:"barCornerRadius",value:function(t){return arguments.length?(this._barCornerRadius=t,this):this._barCornerRadius}},{key:"strokeColor",value:function(t){return arguments.length?(this._strokeColor=t,this):this._strokeColor}},{key:"fillOpacity",value:function(t){return arguments.length?(this._fillOpacity=t,this):this._fillOpacity}},{key:"yScale",value:function(t){return arguments.length?(this._yScale=t,this):this._yScale}},{key:"xlScale",value:function(t){return arguments.length?(this._xlScale=t,this):this._xlScale}},{key:"xrScale",value:function(t){return arguments.length?(this._xrScale=t,this):this._xrScale}},{key:"midGap",value:function(t){return arguments.length?(this._midGap=t,this):this._midGap}},{key:"numberLabel",value:function(t){return arguments.length?(this._numberLabel=t,this):this._numberLabel}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}},{key:"rightMove",value:function(t){return arguments.length?(this._rightMove=t,this):this._rightMove}}]),e}(at),Cu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.elem=t.append("g").attr("class","butterfly-grid"),i.group=i.elem.append("g"),i._width=400,i._height=400,i._planeX=0,i._halfWidth=200,i._transHeight=0,i._transition=!1,i._duration=0,i._type="",i._tickTextLengthLeft=0,i._tickTextLengthRight=0,i._xTickLocationsLeft=[],i._xTickLocationsRight=[],i._yTickLocationsLeft=[],i._yTickLocationsRight=[],i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._width,i=t._height,n=t._halfWidth,a=t._planeX,o=t._tickTextLengthLeft,r=t._tickTextLengthRight,l=t.group.attr("class",t._type).style("fill","none").style("stroke",t._stroke).style("stroke-width",t._gridLineWidth).style("stroke-dasharray",t._strokeDasharray).style("pointer-events","none");!function(){if(!t._showX)return void l.selectAll(".grid-x-lineLeft").remove();var e=l.selectAll(".grid-x-lineLeft").data(t._yTickLocationsLeft);e.exit().remove(),e.enter().append("line").attr("class","grid-x-lineLeft").merge(e).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x1",o).attr("y1",(function(t){return t+.5-a})).attr("x2",n).attr("y2",(function(t){return t+.5-a}))}(),function(){if(!t._showX)return void l.selectAll(".grid-x-lineRight").remove();var i=l.selectAll(".grid-x-lineRight").data(t._yTickLocationsRight);i.exit().remove(),i.enter().append("line").attr("class","grid-x-lineRight").merge(i).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("x1",e-n).attr("y1",(function(t){return t+.5-a})).attr("x2",e-r).attr("y2",(function(t){return t+.5-a}))}(),function(){if(!t._showY)return void l.selectAll(".grid-y-lineleft").remove();var e=l.selectAll(".grid-y-lineleft").data(t._xTickLocationsLeft);e.exit().remove(),e.enter().append("line").attr("class","grid-y-lineleft").merge(e).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("y1",0).attr("x1",(function(t){return t})).attr("y2",i).attr("x2",(function(t){return t}))}(),function(){if(!t._showY)return void l.selectAll(".grid-y-lineright").remove();var e=l.selectAll(".grid-y-lineright").data(t._xTickLocationsRight);e.exit().remove(),e.enter().append("line").attr("class","grid-y-lineright").merge(e).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).attr("y1",0).attr("x1",(function(t){return t-r})).attr("y2",i).attr("x2",(function(t){return t-r}))}()}},{key:"width",value:function(t){return arguments.length?(this._width=parseFloat(t),this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=parseFloat(t),this):this._height}},{key:"planeX",value:function(t){return arguments.length?(this._planeX=parseFloat(t),this):this._planeX}},{key:"xTickLocationsLeft",value:function(t){return arguments.length?(this._xTickLocationsLeft=t,this):this._xTickLocationsLeft}},{key:"xTickLocationsRight",value:function(t){return arguments.length?(this._xTickLocationsRight=t,this):this._xTickLocationsRight}},{key:"yTickLocationsLeft",value:function(t){return arguments.length?(this._yTickLocationsLeft=t,this):this._yTickLocationsLeft}},{key:"yTickLocationsRight",value:function(t){return arguments.length?(this._yTickLocationsRight=t,this):this._yTickLocationsRight}},{key:"type",value:function(t){return arguments.length?(this._type=t,this):this._type}},{key:"gridLineWidth",value:function(t){return arguments.length?(this._gridLineWidth=t,this):this._gridLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"halfWidth",value:function(t){return arguments.length?(this._halfWidth=parseFloat(t),this):this._halfWidth}},{key:"tickTextLengthLeft",value:function(t){return arguments.length?(this._tickTextLengthLeft=parseFloat(t),this):this._tickTextLengthLeft}},{key:"tickTextLengthRight",value:function(t){return arguments.length?(this._tickTextLengthRight=parseFloat(t),this):this._tickTextLengthRight}}]),e}(pt);function Ou(t,e){var i=1,n=2;e.forEach((function(t){"objCol"===t.function?t.isLegend:"左值"===t.name?i=t.index:"右值"===t.name&&(n=t.index)}));var a=[],o=t.slice(1),r=t[0];if(t.length<=0||null==r||o.length<=0)return a;var l={},s=[],u={},c=[];return o.forEach((function(t,e){e>0?-1==s.map((function(t){return t.name})).indexOf(o[e][0])&&(s.push({name:o[e][0]||"$-"+e,value:isNaN(t[i])||""==t[i]?0:t[i]}),c.push({name:o[e][0]||"$-"+e,value:isNaN(t[n])||""==t[n]?0:t[n]})):(s.push({name:o[e][0]||"$-"+e,value:isNaN(t[i])||""==t[i]?0:t[i]}),c.push({name:o[e][0]||"$-"+e,value:isNaN(t[n])||""==t[n]?0:t[n]}))})),r&&(l.key=r[i],l.name=r[i],l.data=s,l.showLegend=""!=r[i]&&null!=r[i]&&null!=r[i],u.key=r[n],u.name=r[n],u.data=c,u.showLegend=""!=r[n]&&null!=r[n]&&null!=r[n],a.push(l),a.push(u)),console.log(a),a}var Fu="axis-group",Lu="x-title",Pu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-x-butterfly-line"),i._orient="bottom",i._type="category",i._allowedMaxTextHeight=30,i._width=1,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i._chartType,i._isLeft=!1,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._orient,i=t._scaleFunc,n=t.group,a=t._fontSize,r=t._tickTextRotate,l=t._tickValueTexts,s=void 0;(s=t.axisFunc="top"===e?d3.axisTop(i):d3.axisBottom(i)).tickValues(t._tickValues).tickSizeInner(t._tickSize).tickSizeOuter(.5).tickPadding(t._tickPadding).tickFormat(t._tickFormat);var u=n.select(".axis-group").empty()?n.append("g").attr("class",Fu):n.select(".axis-group"),c=t._labelAngle;"自动"==t._labelDirection&&(c=r),u.style("font-size",a+"px").style("font-family",t._fontFamily).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).call(s).on("start",(function(i,n){u.selectAll(".tick text").remove(),u.selectAll(".tick line").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),u.select("path").style("stroke",t._lineStroke).style("stroke-width",t._xAxisLineWidth).style("display",t._axisLineShow?"block":"none"),"竖排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i,n){var a=B(l[n],t._fontSize,t._fontFamily)-t._fontSize,o=I(t._fontSize,c,0,t._labelDirection,e),r=Math.sin(Math.abs(o.angle)*Math.PI/180)*a,s=Math.cos(Math.abs(o.angle)*Math.PI/180)*a;return"top"==e?"translate("+(o.x+(o.angle<0?-r+(-90==o.angle?a/2:0):r-(90==o.angle?a/2:0)))+","+(o.y-s)+")":"translate("+(o.x+(o.angle<0?-(-90==o.angle?a/2:0):90==o.angle?a/2:0))+","+o.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).each((function(i,n){var o=d3.select(this),r=o.text().split("").reverse();"rev"==I(t._fontSize,c,0,t._labelDirection,e).flag&&(r=o.text().split(""));for(var l,s=[],u=0,h=0,d=+o.attr("x"),_=+o.attr("y"),f=o.text(null).append("tspan").attr("x",d).attr("y",_);l=r.pop();)s.push(l),f.text(s.join("")),f.node().getComputedTextLength()>0&&(0==h||++u,s.pop(),f.text(s.join("")),s=[l],f=o.append("tspan").attr("x",d).attr("y",u*parseFloat(.9*a*1.2)+_).text(l)),h++})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"横排"==t._labelDirection?u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,t._labelDirection,e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).style("text-anchor",(function(i){return I(t._fontSize,c,0,t._labelDirection,e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,t._labelDirection,e).angle+")"})):"自动"==t._labelDirection&&u.selectAll(".tick").filter((function(e,i){return-1!=t._tickValues.indexOf(e)})).append("g").attr("transform",(function(i){var n=I(t._fontSize,c,0,"横排",e);return"translate("+n.x+","+n.y+")"})).append("text").text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})).style("text-anchor",(function(i){return I(t._fontSize,c,0,"横排",e).anchor})).attr("opacity",1).style("display",t._tickShow?"block":"none").style("fill",t._fontColor).attr("transform",(function(i){return"translate("+(t._textTransX?t._textTransX:0)+",0) rotate("+I(t._fontSize,c,0,"横排",e).angle+")"}))}));var h=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)})),d=t.group.selectAll(".axis-x-line .tick text").nodes().filter((function(t,e){return"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove(),d3.selectAll(d).remove();var _=Math.abs(i.range()[0]-i.range()[1]);if(t._titleShow&&t._title){var f=n.select(".x-title").empty()?n.append("g").attr("class",Lu):n.select(".x-title"),p=f.select("text").empty()?f.append("text"):f.select("text");l.length,d3.max(l,(function(e){return R(e,a,t._fontFamily)}));"top"===e?(f.call(o,0==t._isLeft?_/2+Math.abs(i.range()[0]):_/2-Math.abs(i.range()[1]),-(this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0))),p.attr("class",0==t._isLeft?"title-right":"title-left").attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",-6-.2*a).text(t._title)):(f.call(o,0==t._isLeft?_/2+Math.abs(i.range()[0]):0,this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)),p.attr("class",0==t._isLeft?"title-right":"title-left").attr("text-anchor","middle").style("font-size",a+"px").style("font-family",t._fontFamily).style("fill",t._fontColor).attr("dy",a+6).text(t._title))}else n.select(".x-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0,a=0,o=0,r=0,l=!1,s=t._scaleFunc.range()[0],u=t._scaleFunc.range()[1];function c(){t._tickTextRotate=n,t._tickValues=e,t._tickValueTexts=i,t._tickTextHeight=a,t._tickTextWidth=o,t._rotateFlag=l,t._axisStart=s,t._axisEnd=u}var h=t._scaleFunc,d=t._type,_=t._fontSize,f=(t._minTickDistance,t._allowedMaxTextHeight);if("自动"==t._labelDirection){var p=t._width,y=void 0,x=void 0;if(e="category"===d?h.domain():h.ticks(t._tickCount),"number"===d&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor,i=e,"number"===d||"histogram"==t._chartType){for(var g=[],v=0;v<e.length;v++)"pyramid"==t._chartType?g.push(E(Math.abs(e[v]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):g.push(E(e[v],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=g}if(function(){var l=!1;if(y=p/e.length,"number"===d||"histogram"==t._chartType){for(var s=[],u=0;u<e.length;u++)"pyramid"==t._chartType?s.push(E(Math.abs(e[u]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):s.push(E(e[u],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=s}return(x=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0)<.8*y&&(n=0,a=0==x?0:1.125*_,o=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,r=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))/2||0,t._tickShow||(o=0),c(),l=!0),l}())return t;n="top"===t._orient?45:-45,n=I(t._fontSize,n,0,"横排",t._orient).angle;var m=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0,b=m?_:0,S=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),k=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),w=m*k+b*S,C=b*k+m*S;if(x=w,C<f)a=C,i=i,o=w,r=w,t._tickShow||(o=0),l=!1;else{a=f,i=i.map((function(e){return X(e,a/S,_,t._fontFamily)}));var O=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,F=O*k+b*S;o=F,r=F,a=b*k+O*S,t._tickShow||(o=0),l=!0}var L=(p-r)/e.length;if("category"===d&&2*_>L){var P=Math.ceil(2*_/L);e=e.filter((function(t,e){return e%P==0})),i=i.filter((function(t,e){return e%P==0}))}return s=e.length>0?h(e[0])-o:s,c(),t}if("横排"==t._labelDirection){var A=t._width;e="category"===d?h.domain():h.ticks(t._tickCount),"number"===d&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor;new Array;var W=[];if("number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var z=h.domain()[0],M=(Math.abs(parseFloat(z))>1?Math.round(parseFloat(z)):z)||0,D=h.domain()[1]||1;if(0!=t._countOfLabel){var N=D-M,T=t._countOfLabel,G=Math.ceil(Math.abs(N/t._countOfLabel)),j=Math.ceil(A/_*2),Y=d3.tickStep(M,D,j);t._countOfLabel<Y&&(G=Math.ceil(Math.abs(N/Y)),T=Y),D+=G;for(var H=0;H<G+1;H++)W.push(M+H*T)}else W.push(M);"number"===d&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||W.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||W.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(W[W.length-1]>t._xRange[1]&&W.pop(),W.push(t._xRange[1]))),W=Array.from(new Set(W)),console.log(W)),0!=t._countOfLabel&&h.domain([d3.min(W),d3.max(W)]);var V=[];W.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;V.push(i)}})),V=V.filter((function(t){return t<=8})),W=W.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(V)&&(t=parseFloat(t).toFixed(d3.max(V)))}return t}))}if(i=e,"number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=W),"number"==d||"histogram"==t._chartType){for(var $=[],q=0;q<e.length;q++)"pyramid"==t._chartType?$.push(E(Math.abs(e[q]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):$.push(E(e[q],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=$}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var U=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,_,t._fontFamily)}))||0,Z=U?_:0,Q=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,K=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),J=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),tt=U*J+Z*K,et=Z*J+U*K;if(et<f)a=et,i=i,o=tt,r=tt,t._tickShow||(o=0),l=!0;else{a=f,i=i.map((function(e){return X(e,a/K,_,t._fontFamily)}));var it=d3.max(i,(function(e){return R(e,t._fontSize,t._fontFamily)}))||0,nt=it*J+Z*K;o=nt,r=nt,a=Z*J+it*K,t._tickShow||(o=0),l=!0}Q%180!=0&&90!=Math.abs(n)||(o/=2,r/=2);var at=(A-r)/e.length;if(("category"===d||null==t._countOfLabel)&&r*(Q%180==0||90==Math.abs(n)?2:1)>at){var ot=Math.ceil(r*(Q%180==0||90==Math.abs(n)?2:1)*1.2/at);e=e.filter((function(t,e){return e%ot==0})),i=i.filter((function(t,e){return e%ot==0}))}if("top"==t._orient){var rt=1.05;(n>90||n<0&&n>-90)&&(rt=-1.05);var lt=[],st=[],ut=0;if("category"===d&&(ut=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*J+Z*K,Q%180!=0&&90!=Math.abs(n)||(o/=2),lt.push(h(e)-o*rt+ut),st.push(h(e)-o*rt+ut)})),s=t._tickShow&&e.length>0?d3.min(lt):s,u=t._tickShow&&e.length>0?d3.max(st):u,n%180==0||90==Math.abs(n)){var ct=[],ht=[];e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*J+Z*K,Q%180!=0&&90!=Math.abs(n)||(o/=2),ct.push(h(e)-o+ut),ht.push(h(e)+o+ut)})),s=t._tickShow&&e.length>0?d3.min(ct):s,u=t._tickShow&&e.length>0?d3.max(ht):u}}else{var dt=-1.05;(n>90||n<0&&n>-90)&&(dt=1.05);var _t=[],ft=[],pt=0;if("category"===d&&(pt=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*J+Z*K,Q%180!=0&&90!=Math.abs(n)||(o/=2),_t.push(h(e)-o*dt+pt),ft.push(h(e)-o*dt+pt)})),s=t._tickShow&&e.length>0?d3.min(_t):s,u=t._tickShow&&e.length>0?d3.max(ft):u,n%180==0||90==Math.abs(n)){var yt=[],xt=[];e.forEach((function(e,a){var o=R(i[a],t._fontSize,t._fontFamily)||0;o=o*J+Z*K,Q%180!=0&&90!=Math.abs(n)||(o/=2),yt.push(h(e)-o+pt),xt.push(h(e)+o+pt)})),s=t._tickShow&&e.length>0?d3.min(yt):s,u=t._tickShow&&e.length>0?d3.max(xt):u}}return c(),t}if("竖排"==t._labelDirection){var gt,vt=t._width;e="category"===d?h.domain():h.ticks(t._tickCount),"number"===d&&0!=t._xRange.length&&null!=t._xRange[0]&&t._xRange[0].constructor!==Object&&(e.shift(),e.unshift(t._xRange[0]));new Array;var mt=[];if("number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var bt=h.domain()[0],St=(Math.abs(parseFloat(bt))>1?Math.round(parseFloat(bt)):bt)||0,kt=h.domain()[1]||1;if(0!=t._countOfLabel){var wt=kt-St,Ct=t._countOfLabel,Ot=Math.ceil(Math.abs(wt/t._countOfLabel)),Ft=Math.ceil(vt/_*2),Lt=d3.tickStep(St,kt,Ft);t._countOfLabel<Lt&&(Ot=Math.ceil(Math.abs(wt/Lt)),Ct=Lt),kt+=Ot;for(var Pt=0;Pt<Ot+1;Pt++)mt.push(St+Pt*Ct)}else mt.push(St);"number"===d&&0!=t._xRange.length&&(1==t._xRange.length?isNaN(t._xRange[0])||null==t._xRange[0]||mt.unshift(t._xRange[0]):(isNaN(t._xRange[0])||null==t._xRange[0]||mt.unshift(t._xRange[0]),isNaN(t._xRange[1])||null==t._xRange[1]||(mt[mt.length-1]>t._xRange[1]&&mt.pop(),mt.push(t._xRange[1]))),mt=Array.from(new Set(mt))),0!=t._countOfLabel&&h.domain([d3.min(mt),d3.max(mt)]);var At=[];mt.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;At.push(i)}})),At=At.filter((function(t){return t<=8})),mt=mt.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(At)&&(t=parseFloat(t).toFixed(d3.max(At)))}return t}))}if(i=e,"number"===d&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=mt),"number"==d||"histogram"==t._chartType){for(var Wt=[],zt=0;zt<e.length;zt++)"pyramid"==t._chartType?Wt.push(E(Math.abs(e[zt]),t._numberStyle,t._decimalPlaces)+t._labelSuffix):Wt.push(E(e[zt],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=Wt}n=I(t._fontSize,t._labelAngle,0,this._labelDirection,t._orient).angle;var Mt=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,Dt=Mt?_:0,Rt=I(t._fontSize,t._labelAngle,0,t._labelDirection,t._orient).angle,Nt=Math.abs(Math.sin(Math.abs(n)*Math.PI/180)),Tt=Math.abs(Math.cos(Math.abs(n)*Math.PI/180)),Bt=Dt*Tt+Mt*Nt,Gt=Mt*Tt+Dt*Nt;if(gt=Bt,Gt<f)a=Gt,i=i,o=Bt,r=Bt,t._tickShow||(o=0),l=!0;else{a=f,i=i.map((function(e){return function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sans-serif",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"...";if(B(t,i,n)<=e)return t;if(B(a,i,n)>=e)return"";for(var o=String(t).split(""),r=o.length,l="",s=0;s<r;s++)if(B((l+=o[s])+a,i,n)>e)return 0===s?"":l.slice(0,s)+a}(e,a/Tt,_,t._fontFamily)}));var Xt=d3.max(i,(function(e){return B(e,t._fontSize,t._fontFamily)}))||0,jt=Dt*Tt+Xt*Nt;o=jt,r=jt,a=Xt*Tt+Dt*Nt,t._tickShow||(o=0),l=!0}0==Rt&&(o/=2,r/=2),90==Math.abs(Rt)&&(a=0==gt?0:_,o/=2,r/=2);var It=(vt-r)/e.length;if(("category"===d||null==t._countOfLabel)&&r*(0==Math.abs(Rt)||90==Math.abs(Rt)?2:1)>It){var Yt=Math.ceil(r*(0==Math.abs(Rt)||90==Math.abs(Rt)?2:1)*1.2/It);e=e.filter((function(t,e){return e%Yt==0})),i=i.filter((function(t,e){return e%Yt==0}))}if("top"==t._orient){var Ht=1.05;n>0&&n<90&&(Ht=-1.05);var Et=[],Vt=[],$t=0;if("category"===d&&($t=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Dt*Tt+o*Nt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Et.push(h(e)-o*Ht+$t),Vt.push(h(e)-o*Ht+$t)})),s=t._tickShow&&e.length>0?d3.min(Et):s,u=t._tickShow&&e.length>0?d3.max(Vt):u,0==Math.abs(n)||90==Math.abs(n)){var qt=[],Ut=[];e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Dt*Tt+o*Nt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),qt.push(h(e)-o+$t),Ut.push(h(e)+o+$t)})),s=t._tickShow&&e.length>0?d3.min(qt):s,u=t._tickShow&&e.length>0?d3.max(Ut):u}}else{var Zt=-1.05;n>0&&n<90&&(Zt=1.05);var Qt=[],Kt=[],Jt=0;if("category"===d&&(Jt=0==h.bandwidth()?.1*h.step():h.step()/2),e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Dt*Tt+o*Nt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),Qt.push(h(e)-o*Zt+Jt),Kt.push(h(e)-o*Zt+Jt)})),s=t._tickShow&&e.length>0?d3.min(Qt):s,u=t._tickShow&&e.length>0?d3.max(Kt):u,0==Math.abs(n)||90==Math.abs(n)){var te=[],ee=[];e.forEach((function(e,a){var o=B(i[a],t._fontSize,t._fontFamily)||0;o=Dt*Tt+o*Nt,0!=Math.abs(n)&&90!=Math.abs(n)||(o/=2),te.push(h(e)-o+Jt),ee.push(h(e)+o+Jt)})),s=t._tickShow&&e.length>0?d3.min(te):s,u=t._tickShow&&e.length>0?d3.max(ee):u}}return c(),t}}},{key:"isLeft",value:function(t){return arguments.length?(this._isLeft=t,this):this._isLeft}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"allowedMaxTextHeight",value:function(t){return arguments.length?(this._allowedMaxTextHeight=t,this):this._allowedMaxTextHeight}},{key:"textTransX",value:function(t){return arguments.length?(this._textTransX=t,this):this._textTransX}},{key:"xAxisLineWidth",value:function(t){return arguments.length?(this._xAxisLineWidth=t,this):this._xAxisLineWidth}},{key:"chartType",value:function(t){return arguments.length?(this._chartType=t,this):this._chartType}},{key:"height",get:function(){var t=this,e=this._scaleFunc,i=(Math.abs(e.range()[0]-e.range()[1]),this._tickValueTexts.length,d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),0);return this.isShow&&(i=this._tickSize+this._tickPadding+(this._tickShow?this._tickTextHeight:0)+(this._title&&this._titleShow?this._titlePadding+1.125*this._fontSize:0)),i}}]),e}(Bt),Au="axis-group",Wu="y-title",zu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","axis-y-line"),i._orient="left",i._type="number",i._allowedMaxTextWidth=100,i._tickTextWidth=0,i._tickPadding=6,i._countOfLabel=null,i._labelSuffix="",i._picPadding=0,i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=this,i=e._orient,n=e._scaleFunc,a=e.group,r=e._fontSize,l=e._tickValueTexts,s=void 0;s=e.axisFunc="right"===i?d3.axisRight(n):d3.axisLeft(n);var u=null;"number"===e._type&&e._tickValues.every((function(t){return 0===Math.abs(t)||Math.abs(t)>1}))&&(u=d3.format("d")),s.tickValues(e._tickValues).tickSizeInner(e._tickSize).tickSizeOuter(-.5).tickPadding(e._tickPadding).tickFormat(u);var c=a.select(".axis-group").empty()?a.append("g").attr("class",Au):a.select(".axis-group");c.transition().duration(e._transition?e._duration:0).ease(d3.easeLinear).call(s).on("start",(function(){c.selectAll(".tick text").remove(),c.selectAll(".tick").filter((function(t,i){return-1!=e._tickValues.indexOf(t)})).append("text").style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).attr("dx",(function(t,e){return-8})).attr("dy",.4*r).text((function(t,e){var i=String(l[e]);return-1==i.indexOf("$-")&&-1==i.indexOf("&-")?i:""})),c.selectAll(".tick line").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none"),c.select("path").style("stroke",e._lineStroke).style("stroke-width",e._yAxisLineWidth).style("display",e._axisLineShow?"block":"none"),c.selectAll(".tick text").style("display",e._tickShow?"block":"none")}));var h=e.group.selectAll(".axis-y-line .tick text").nodes().filter((function(t,e){return"&-"==String(t.__data__).slice(0,2)||"$-"==String(t.__data__).slice(0,2)}));d3.selectAll(h).remove();var d=Math.abs(n.range()[0]-n.range()[1]);if(e._titleShow&&e._title){var _=a.select(".y-title").empty()?a.append("g").attr("class",Wu):a.select(".y-title"),f=_.select("text").empty()?_.append("text"):_.select("text"),p=(R(e._title,r,e._fontFamily),d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})));_.call(o,-(this._tickShow?(p?this._tickSize+this._tickPadding:5)+this._tickTextWidth:0!=parseFloat(e._yAxisLineWidth)&&e._yAxisLineWidth&&e._axisLineShow?5:0),d/2),f.attr("y",-9-e._picPadding).style("font-size",r+"px").style("font-family",e._fontFamily).style("fill",e._fontColor).attr("transform","rotate(-90)").style("text-anchor","middle").text(e._title)}else a.select(".y-title").remove()}},{key:"compute",value:function(){var t=this,e=[],i=[],n=0;var a=t._scaleFunc,o=t._type,r=t._fontSize,l=(t._minTickDistance,t._allowedMaxTextWidth);Math.abs(a.range()[0]-a.range()[1]);e="category"===o?a.domain():a.ticks(t._tickCount),"number"===o&&0!=t._yRange.length&&null!=t._yRange[0]&&t._yRange[0].constructor!==Object&&(t._yRange[0]==e[0]&&e.shift(),e.unshift(-1==String(t._yRange[0]).indexOf(".")?t._yRange[0]:t._yRange[0].toFixed(0)),e=Array.from(new Set(e)));new Array;var s=[];if("number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)){var u=a.domain()[0],c=(Math.abs(parseFloat(u))>1?Math.round(parseFloat(u)):u)||0,h=a.domain()[1]||1;if(0!=t._countOfLabel){var d=h-c,_=t._countOfLabel,f=Math.ceil(Math.abs(d/t._countOfLabel)),p=8*Math.ceil(t._tickCount),y=d3.tickStep(c,h,p);t._countOfLabel<y&&(f=Math.ceil(Math.abs(d/y)),_=y),h+=f;for(var x=0;x<f+1;x++)s.push(c+x*_)}else s.push(c);"number"===o&&0!=t._yRange.length&&(1==t._yRange.length?isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]):(isNaN(t._yRange[0])||null==t._yRange[0]||s.unshift(t._yRange[0]),isNaN(t._yRange[1])||null==t._yRange[1]||(s[s.length-1]>t._yRange[1]&&s.pop(),s.push(t._yRange[1]))),s=Array.from(new Set(s))),0!=t._countOfLabel&&a.domain([d3.min(s),d3.max(s)]);var g=[];s.forEach((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1,i=String(t).length-e;g.push(i)}})),g=g.filter((function(t){return t<=8})),s=s.map((function(t){if(-1!=String(t).indexOf(".")){var e=String(t).indexOf(".")+1;String(t).length-e>d3.max(g)&&(t=parseFloat(t).toFixed(d3.max(g)))}return t}))}if(i=e,"number"===o&&null!=t._countOfLabel&&0==isNaN(t._countOfLabel)&&(e=s),"number"==o){for(var v=[],m=0;m<e.length;m++)v.push(E(e[m],t._numberStyle,t._decimalPlaces)+t._labelSuffix);i=v}var b=d3.max(i.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,r,t._fontFamily)}))||0;return b<=l?(i=i,n=b):(i=i.map((function(e){return X(e,l,r,t._fontFamily)})),n=l),t._tickValues=e,t._tickValueTexts=i,t._tickTextWidth=n,t}},{key:"allowedMaxTextWidth",value:function(t){return arguments.length?(this._allowedMaxTextWidth=t,this):this._allowedMaxTextWidth}},{key:"labelSuffix",value:function(t){return arguments.length?(this._labelSuffix=t,this):this._labelSuffix}},{key:"yAxisLineWidth",value:function(t){return arguments.length?(this._yAxisLineWidth=t,this):this._yAxisLineWidth}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=parseFloat(t),this):this._duration}},{key:"picPadding",value:function(t){return arguments.length?(this._picPadding=parseFloat(t),this):this._picPadding}},{key:"width",get:function(){var t=this,e=d3.max(this._tickValueTexts.filter((function(t,e){return t!="$-"+e&&t!="&-"+(e+1)})),(function(e){return R(e,t._fontSize,t._fontFamily)})),i=0;return this.isShow&&(i=this._tickShow?(e?this._tickSize+this._tickPadding:0)+this._tickTextWidth+(this._titleShow&&this._title?1.125*this._fontSize+3:0):this._titleShow&&this._title?1.125*this._fontSize+3+(0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0):0!=parseFloat(this._yAxisLineWidth)&&this._yAxisLineWidth&&this._axisLineShow?5:0),i}}]),e}(Bt),Mu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","butterfly-bar-chart"),i.grid=new Cu(i.coreGroup),i.ButterflyBar=new wu(i.coreGroup),i.selectOverlay=new Ni(i.mainGroup),i.overlay=new te(i.mainGroup),i.xAxisLeft=new Pu(i.mainGroup),i.xAxisRight=new Pu(i.mainGroup),i.yAxisLeft=new zu(i.mainGroup),i.yAxisRight=new zu(i.mainGroup),i.xScale=d3.scaleLinear(),i.xScaleRight=d3.scaleLinear(),i.yScale=d3.scaleBand(),i._xType="number",i._yType="category",i._xOrient="bottom",i._yOrientLeft="right",i._yOrientRight="left",i._yDomain=[0,1],i._xlDomain=[0,1],i._xrDomain=[0,1],i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["从上至下","从下至上","左右拉伸"],i._moveStyle="依次出现",i._endPause=0,i._interrupt=!1,i._barWidthPercent="0.7",i._strokeWidth="0",i._barCornerRadius="0",i._strokeColor=null,i._fillOpacity="1",i._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",suffix:"",positionOptions:["内部居中","外部","内部靠轴"],positionChoice:"外部"},i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.grid,n=t.ButterflyBar,a=t.tooltip,o=t.overlay,r=t.selectOverlay;e.length<=0?e.push({data:[]},{data:[]}):1==e.length&&e.push({data:[]});var l=t.widthOfNoMargin,s=t.heightOfCore,u=d3.max(t._yDomain.map((function(e){return R(e,t._fontSize,t._fontFamily)})))+16,c=t.defs;c.selectAll("filter").remove();var h=c.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");h.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),h.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),h.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),h.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),h.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over");var d=t.widthOfNoMargin,_=t.yScale;t.mainGroup.selectAll(".butterfly-bar-textLabel").remove();var f=t.mainGroup.append("g").attr("class","butterfly-bar-textLabel").selectAll("text").data(e[0].data);f.exit().remove();f.enter().append("text").merge(f).attr("x",d/2).attr("y",(function(t){return _(t.name)+_.bandwidth()/2})).style("fill",t._fontColor).style("font-size",t._fontSize).style("font-family",t._fontFamily).style("pointer-events","none").text((function(t){return-1==String(t.name).indexOf("$-")?t.name:""})).attr("text-anchor","middle").attr("dy","0.35em").style("display",1==t._yTickShow?"block":"none");var p=0,y=0;"下面"==t._axisPositonChoiceXL&&"下面"==t._axisPositonChoiceXR?y=Math.max(t.xAxisLeft.height,t.xAxisRight.height):"上面"==t._axisPositonChoiceXL&&"上面"==t._axisPositonChoiceXR?p=Math.max(t.xAxisLeft.height,t.xAxisRight.height):"上面"==t._axisPositonChoiceXL&&"下面"==t._axisPositonChoiceXR?(p=t.xAxisLeft.height,y=t.xAxisRight.height):"下面"==t._axisPositonChoiceXL&&"上面"==t._axisPositonChoiceXR&&(y=t.xAxisLeft.height,p=t.xAxisRight.height);var x=t.yAxisLeft.tickLocations,g=t.yAxisRight.tickLocations,v=t.xAxisLeft.tickLocations,m=t.xAxisRight.tickLocations.map((function(e){return e+u+(t.widthOfNoMargin-u)/2})),b=t._numberLabel.show,S=t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice),k=0,w=0;if(b&&1==S&&(w=e[0].data.length>0?d3.max(e[0].data.map((function(e){return 0==e.value?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+t._numberLabel.suffix+8,t._numberLabel.fontSize,t._numberLabel.fontFamily)}))):0,k=e[0].data.length>0?d3.max(e[1].data.map((function(e){return 0==e.value?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+t._numberLabel.suffix+8,t._numberLabel.fontSize,t._numberLabel.fontFamily)}))):0),i.width(t.widthOfNoMargin).height(t.heightOfMainGroup-y-p).planeX(p).halfWidth((t.widthOfNoMargin-u)/2).tickTextLengthLeft(w).tickTextLengthRight(k).xTickLocationsLeft(v).xTickLocationsRight(m).yTickLocationsLeft(x).yTickLocationsRight(g).showX(t._gridShowX).showY(t._gridShowY).stroke(t._gridStroke).strokeDasharray(t._gridStrokeDasharray).gridLineWidth(t._gridLineWidth),n.data(e).width(t.widthOfNoMargin).height(t.heightOfMainGroup-y-p).midGap(u).rightMove(k).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).barWidthPercent(t._barWidthPercent).strokeWidth(t._strokeWidth).barCornerRadius(t._barCornerRadius).strokeColor(t._strokeColor).fillOpacity(t._fillOpacity).yScale(t.yScale).xlScale(t.xScale).xrScale(t.xScaleRight).numberLabel(t._numberLabel).interrupt(t._interrupt).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces),o.data(t.yScale.domain().reverse()).isScalePoint(!1).isHorizontal(!0).bandWidth(t.widthOfNoMargin).bandHeight(t.yScale.step()).onMouseover((function(i,n){var o=i,r=[],l=e[0].data.length,s=e[0].data.length>0?{text:e[0].name+"："+E(e[0].data[l-n-1].value,t._numberStyle,t._decimalPlaces),color:e[0].color}:{},u=e[1].data.length>0?{text:e[1].name+"："+E(e[1].data[l-n-1].value,t._numberStyle,t._decimalPlaces),color:e[1].color}:{};r=[{text:-1==String(o).indexOf("$-")?o:""}],null!=e[0].name&&r.push(s),null!=e[1].name&&r.push(u),t.group.selectAll(".selectOverlay-rect").transition().duration(300).attr("transform","translate(0,"+(e[0].data.length>0?t.yScale(e[0].data[l-n-1].name):0)+")"),a.data(r).update(),e[0].data.length>0&&a.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){a.move([d3.event.offsetX,d3.event.offsetY]),r.show()})).onMouseout((function(){a.hide(),r.hide()})),r.width(t.widthOfNoMargin).height(t.yScale.step()).shadowColor("#ccc").hide(),o.translate(0,p),i.translate(0,p).update(),n.update(),(e[0].data.length>0||e[1].data.length>0)&&r.update(),o.update(),0!=t._xrRange.length||0!=t._xlRange)if(0==isNaN(parseFloat(t._xrRange[0]))||0==isNaN(parseFloat(t._xrRange[1]))||0==isNaN(parseFloat(t._xlRange[0]))||0==isNaN(parseFloat(t._xlRange[1]))){t.mainGroup.selectAll(".clip-defs").remove();var C=t.mainGroup.append("defs");C.append("clipPath").attr("class","clip-defs").attr("id","clip-overlay-left-"+t.id).append("rect").attr("x",w).attr("height",s).attr("width",(l-u)/2-w),C.append("clipPath").attr("class","clip-defs").attr("id","clip-overlay-right-"+t.id).append("rect").attr("x",(l+u)/2).attr("height",s).attr("width",(l-u)/2-k);t.coreGroup.select(".butterfly-bar .butterfly-bar-rects-left").attr("clip-path","url(#clip-overlay-left-"+t.id+")"),t.coreGroup.select(".butterfly-bar .butterfly-bar-label-left").attr("clip-path","url(#clip-overlay-left-"+t.id+")"),t.coreGroup.select(".butterfly-bar .butterfly-bar-rects-right").attr("clip-path","url(#clip-overlay-right-"+t.id+")"),t.coreGroup.select(".butterfly-bar .butterfly-bar-label-right").attr("clip-path","url(#clip-overlay-right-"+t.id+")")}else t.coreGroup.attr("clip-path","")}},{key:"updateAxis",value:function(){var t=this,e=t.activeData;t.computeDomain();var i=d3.max(t._yDomain.map((function(e){return R(e,t._fontSize,t._fontFamily)})))+16,n=t.xAxisLeft,a=t.xAxisRight,o=t.yAxisLeft,r=t.yAxisRight,l=t.xScale,s=t.yScale,u=t.xScaleRight,c=t._xType,h=t._yType,d="上面"==t._axisPositonChoiceXL?"top":"bottom",_="上面"==t._axisPositonChoiceXR?"top":"bottom",f=t._yOrientLeft,p=t._yOrientRight,y=t._fontSize,x=t.widthOfNoMargin,g=t.heightOfMainGroup;l.domain(t._xlDomain),s.domain(t._yDomain),u.domain(t._xrDomain);var v=t._numberLabel.show,m=t._numberLabel.positionOptions.indexOf(t._numberLabel.positionChoice),b=0,S=0;v&&1==m&&(S=e.length>0?d3.max(e[0].data.map((function(e){return 0==e.value?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+t._numberLabel.suffix+8,t._numberLabel.fontSize,t._numberLabel.fontFamily)}))):0,b=e.length>0?d3.max(e[1].data.map((function(e){return 0==e.value?0:R(E(e.value,t._numberStyle,t._decimalPlaces)+t._numberLabel.suffix+8,t._numberLabel.fontSize,t._numberLabel.fontFamily)}))):0),n.xRange(t._xlRange).width((x-i)/2).scaleFunc(l).allowedMaxTextHeight(.3*g).type(c).orient(d).title(t._xlTitle).tickShow(t._xlTickShow).lineStroke(t._axisLineStrokeXL).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xlAxisLineWidth).axisLineShow(t._xlAxisShow).labelDirection(t._xlLabelDirection).labelAngle(t._xlLabelAngle).countOfLabel(t._countOfLabelXL).labelSuffix(t._xlLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).isLeft(!0).tickCount(4),a.xRange(t._xrRange).width((x-i)/2).scaleFunc(u).allowedMaxTextHeight(.3*g).type(c).orient(_).title(t._xrTitle).tickShow(t._xrTickShow).lineStroke(t._axisLineStrokeXR).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xrAxisLineWidth).axisLineShow(t._xrAxisShow).labelDirection(t._xrLabelDirection).labelAngle(t._xrLabelAngle).countOfLabel(t._countOfLabelXR).labelSuffix(t._xrLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).tickCount(4),o.scaleFunc(s).allowedMaxTextWidth(0).type(h).orient(f).title(t._yTitle).tickShow(!1).lineStroke(t._axisLineStrokeY).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange([g-n.height,0]).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).tickShow(!1),r.scaleFunc(s).allowedMaxTextWidth(.5*x).type(h).orient(p).title(t._yTitle).tickShow(!1).lineStroke(t._axisLineStrokeY).fontSize(y).fontColor(t._fontColor).fontFamily(t._fontFamily).transition(t._transition).duration(t._duration).yRange([g-n.height,0]).yAxisLineWidth(t._yAxisLineWidth).axisLineShow(t._yAxisShow).labelDirection(t._yLabelDirection).labelAngle(t._yLabelAngle).countOfLabel(t._yCountOfLabel).labelSuffix(t._yLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);o.titleHeight;n.compute(),a.compute(),o.compute(),r.compute(),l.range([(x-i)/2,S]),u.range([b,(x-i)/2+(S-b)/2]);var k=0,w=0;"下面"==t._axisPositonChoiceXL&&"下面"==t._axisPositonChoiceXR?w=Math.max(t.xAxisLeft.height,t.xAxisRight.height):"上面"==t._axisPositonChoiceXL&&"上面"==t._axisPositonChoiceXR?k=Math.max(t.xAxisLeft.height,t.xAxisRight.height):"上面"==t._axisPositonChoiceXL&&"下面"==t._axisPositonChoiceXR?(k=t.xAxisLeft.height,w=t.xAxisRight.height):"下面"==t._axisPositonChoiceXL&&"上面"==t._axisPositonChoiceXR&&(w=t.xAxisLeft.height,k=t.xAxisRight.height),s.range([g-w,k]);var C=(x-i)/2;n.translate(0,"下面"==t._axisPositonChoiceXL?g-w:k).update(),a.translate((x+i)/2-b,"下面"==t._axisPositonChoiceXR?g-w:k).update(),o.translate(C,0).update(),r.translate(C+i,0).update(),t.mainGroup.select(".title-left").attr("transform","translate("+(x/4-i/4+S/2)+",0)")}},{key:"computeDomain",value:function(){var t=this,e=t.activeData,i=e.length?e[0].data.map((function(t){return t.name})):[0,1],n=this._xlRange||[],a=this._xrRange||[],o=d3.extent(e[0]?e[0].data:[],(function(t){return parseFloat(t.value)})),r=d3.extent(e[1]?e[1].data:[],(function(t){return parseFloat(t.value)})),l=[Math.min(0,o[0]||0),Math.max(1,o[1]||0)],s=[Math.min(0,r[0]||0),Math.max(1,r[1]||0)],u=[isNaN(parseFloat(n[0]))?l[0]:parseFloat(n[0]),isNaN(parseFloat(n[1]))?isNaN(parseFloat(n[0]))?l[1]:l[1]<n[0]?1.5*n[0]:l[1]:parseFloat(n[1])],c=[isNaN(parseFloat(a[0]))?s[0]:parseFloat(a[0]),isNaN(parseFloat(a[1]))?isNaN(parseFloat(a[0]))?s[1]:s[1]<a[0]?1.5*a[0]:s[1]:parseFloat(a[1])];t._yDomain=i,t._xlDomain=u,t._xrDomain=c}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"onDataChange",value:function(){this._interrupt=!1,this.removeLabelText(),this.updateAxis(),this.updateCore()}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"buildOption",value:function(t,e){var i=new Ii(t,e),n=Ou;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.display,i=t.animation,n=t.unitDisplay,a=t.sourceDisplay,o=t.label;0!==Object.getOwnPropertyNames(e).length&&(this._fillOpacity=0==e.fillOpacity||e.fillOpacity?e.fillOpacity:this._fillOpacity,this._barWidthPercent=0==e.barWidthPercent||e.barWidthPercent?e.barWidthPercent:this._barWidthPercent,this._barCornerRadius=0==e.barCornerRadius||e.barCornerRadius?e.barCornerRadius:this._barCornerRadius,this._strokeWidth=0==e.barborderWidth||e.barborderWidth?e.barborderWidth:this._strokeWidth,this._strokeColor=e.barborderColor?q(e.barborderColor):""),0!==Object.getOwnPropertyNames(o).length&&(this._numberLabel=o.numberLabel?o.numberLabel:this._numberLabel),0!==Object.getOwnPropertyNames(i).length&&(this._transition=i?i.transition:this._transition,this._easeStyle=i.easeStyle?i.easeStyle:this._easeStyle,this._duration=i?i.duration:this._duration,this._startDelay=i?i.startDelay:this._startDelay,this._moveStyle=i.moveStyle?i.moveStyle:this._moveStyle,this._moveOptions=i.moveOptions?i.moveOptions:this._moveOptions,this._endPause=i.endPause?i.endPause:this._endPause),0!==Object.getOwnPropertyNames(n).length&&(this._unitShow=n?n.show:this._unitShow,this._unitWord=n?n.text:this._unitWord,this._unitFontSize=n.fontSize?n.fontSize:this._unitSize,this._unitFontColor=n.color?q(n.color):this._unitColor,this._unitFontFamily=n.fontFamily?n.fontFamily:this._unitFamily,this._unitX=n.xPosition?n.xPosition:this._unitX,this._unitY=n.yPosition?n.yPosition:this._unitY),0!==Object.getOwnPropertyNames(a).length&&(this._sourceShow=a?a.show:this._sourceShow,this._sourceWord=a?a.text:this._sourceWord,this._sourceFontSize=a.fontSize?a.fontSize:this._sourceSize,this._sourceFontColor=a.color?q(a.color):this._sourceColor,this._sourceFontFamily=a.fontFamily?a.fontFamily:this._sourceFamily,this._sourceX=a.xPosition?a.xPosition:this._sourceX,this._sourceY=a.yPosition?a.yPosition:this._sourceY)}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t._axis,n=(i.x,i.y||{}),a=i.xl||{},o=i.xr||{};this.axisLineStrokeXL(q(a.axisColor)||q(i.color)).axisLineStrokeXR(q(o.axisColor)||q(i.color)).xlTitle(a.name).xrTitle(o.name).xlRange(a.range?a.range:[]).xrRange(o.range?o.range:[]).xlTickShow(a.labelShow).xrTickShow(o.labelShow).clipShowXL(a.range?a.range:[]).clipShowXR(o.range?o.range:[]).xlAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xrAxisLineWidth(0==o.axisLineWidth||o.axisLineWidth?o.axisLineWidth:1).xlAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).xrAxisShow(0!=o.axisShow&&!o.axisShow||o.axisShow).countOfLabelXL(parseFloat(a.stepOfLabel)<2?2:parseFloat(a.stepOfLabel)).countOfLabelXR(parseFloat(o.stepOfLabel)<2?2:parseFloat(o.stepOfLabel)).axisPositonChoiceXL(a.axisPositonChoice?a.axisPositonChoice:"下面").axisPositonChoiceXR(o.axisPositonChoice?o.axisPositonChoice:"下面").xlLabelDirection(a.labelDirection?a.labelDirection:"自动").xrLabelDirection(o.labelDirection?o.labelDirection:"自动").xlLabelSuffix(a.labelSuffix?a.labelSuffix:"").xrLabelSuffix(o.labelSuffix?o.labelSuffix:"").xlLabelAngle(0==a.labelAngle||a.labelAngle?a.labelAngle:0).xrLabelAngle(0==o.labelAngle||o.labelAngle?o.labelAngle:0),this.axisLineStrokeY(q(n.axisColor)||q(i.color)).yTitle(n.name).yTickShow(n.labelShow).clipShow(n.range?n.range:[]).yAxisLineWidth(0==n.axisLineWidth||n.axisLineWidth?n.axisLineWidth:1).yAxisShow(0!=n.axisShow&&!n.axisShow||n.axisShow).yLabelSuffix(n.labelSuffix?n.labelSuffix:"")}},{key:"axisLineStrokeXL",value:function(t){return arguments.length?(this._axisLineStrokeXL=t,this):this._axisLineStrokeXL}},{key:"axisLineStrokeXR",value:function(t){return arguments.length?(this._axisLineStrokeXR=t,this):this._axisLineStrokeXR}},{key:"xlTitle",value:function(t){return arguments.length?(this._xlTitle=t,this):this._xlTitle}},{key:"xrTitle",value:function(t){return arguments.length?(this._xrTitle=t,this):this._xrTitle}},{key:"xlRange",value:function(t){return arguments.length?(this._xlRange=t,this):this._xlRange}},{key:"xrRange",value:function(t){return arguments.length?(this._xrRange=t,this):this._xrRange}},{key:"xlTickShow",value:function(t){return arguments.length?(this._xlTickShow=t,this):this._xlTickShow}},{key:"xrTickShow",value:function(t){return arguments.length?(this._xrTickShow=t,this):this._xrTickShow}},{key:"clipShowXL",value:function(t){return arguments.length?(this._clipShowXL=t,this):this._clipShowXL}},{key:"clipShowXR",value:function(t){return arguments.length?(this._clipShowXR=t,this):this._clipShowXR}},{key:"xlAxisLineWidth",value:function(t){return arguments.length?(this._xlAxisLineWidth=t,this):this._xlAxisLineWidth}},{key:"xrAxisLineWidth",value:function(t){return arguments.length?(this._xrAxisLineWidth=t,this):this._xrAxisLineWidth}},{key:"xlAxisLineWidth",value:function(t){return arguments.length?(this._xlAxisLineWidth=t,this):this._xlAxisLineWidth}},{key:"xrAxisLineWidth",value:function(t){return arguments.length?(this._xrAxisLineWidth=t,this):this._xrAxisLineWidth}},{key:"xlAxisShow",value:function(t){return arguments.length?(this._xlAxisShow=t,this):this._xlAxisShow}},{key:"xrAxisShow",value:function(t){return arguments.length?(this._xrAxisShow=t,this):this._xrAxisShow}},{key:"countOfLabelXL",value:function(t){return arguments.length?(this._countOfLabelXL=t,this):this._countOfLabelXL}},{key:"countOfLabelXR",value:function(t){return arguments.length?(this._countOfLabelXR=t,this):this._countOfLabelXR}},{key:"axisPositonChoiceXL",value:function(t){return arguments.length?(this._axisPositonChoiceXL=t,this):this._axisPositonChoiceXL}},{key:"axisPositonChoiceXR",value:function(t){return arguments.length?(this._axisPositonChoiceXR=t,this):this._axisPositonChoiceXR}},{key:"xlLabelDirection",value:function(t){return arguments.length?(this._xlLabelDirection=t,this):this._xlLabelDirection}},{key:"xrLabelDirection",value:function(t){return arguments.length?(this._xrLabelDirection=t,this):this._xrLabelDirection}},{key:"xlLabelSuffix",value:function(t){return arguments.length?(this._xlLabelSuffix=t,this):this._xlLabelSuffix}},{key:"xrLabelSuffix",value:function(t){return arguments.length?(this._xrLabelSuffix=t,this):this._xrLabelSuffix}},{key:"xlLabelAngle",value:function(t){return arguments.length?(this._xlLabelAngle=t,this):this._xlLabelAngle}},{key:"xrLabelAngle",value:function(t){return arguments.length?(this._xrLabelAngle=t,this):this._xrLabelAngle}},{key:"activeData",get:function(){return this.sortedDataCopy}}]),e}(Tt),Du=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","parallel-line"),i}return w(e,t),S(e,[{key:"update",value:function(){var t=this,e=t._data,n=t.group;n.selectAll("*").remove(),e.forEach((function(e,i){if(e.color&&/\[/.test(e.color)){var n=x(e.color),a=[],o=!0,r=!1,l=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,h=[],d=c.split(":");h.push(q(d[0])),h.push(d[1]),a.push(h)}}catch(t){r=!0,l=t}finally{try{!o&&u.return&&u.return()}finally{if(r)throw l}}var _=a.concat(),f=_.pop();t.group.append("linearGradient").attr("id",t.id+"-index-"+i).attr("x1",y(f[1]).x1+"%").attr("y1",y(f[1]).y1+"%").attr("x2",y(f[1]).x2+"%").attr("y2",y(f[1]).y2+"%").selectAll("stop").data(_).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}}));for(var a=t._xScale,o=t._height,r=(t._width,t._lineWidth),l=t._endPointRadius,s=t._endPointBorderWidth,u=t._endPointBorderColor,h=t._endPointFillColor,d=t._textLabel,_=d.positionChoice,f=t._axisLaberShowY,g=t._axisShowY,v=t._axisLineWidthY,m=t._axisColorY,b=t._labelSuffixY,S=(n.append("g").attr("class","parallel-axis"),a.domain()),k=(o-t._xAxis.height-t._fontSize/2-6)/(3*t._fontSize),w=void 0,C=void 0,O=[],F=[],L=[],P=function(i){var r=d3.max(e.map((function(t){return parseFloat(t.data[i].value)}))),l=d3.min(e.map((function(t){return parseFloat(t.data[i].value)}))),s=d3.ticks(l>0?0:l,r,k);w=d3.scaleLinear().domain([1.05*(l>0?0:l),1.05*r]).range([o-t._xAxis.height-t._fontSize/2-6,0]),O.push(w),0==i&&(F=s),i==S.length-1&&(L=s),C="左侧"==t._axisPositonChoiceY?d3.axisLeft().tickValues(s).scale(w).ticks(k).tickSizeInner(5).tickSizeOuter(-.5).tickPadding(6).tickFormat((function(e){return E(e,t._numberStyle,t._decimalPlaces)+b})):d3.axisRight().tickValues(s).scale(w).ticks(k).tickSizeInner(5).tickSizeOuter(-.5).tickPadding(6).tickFormat((function(e){return E(e,t._numberStyle,t._decimalPlaces)+b}));var u=n.append("g").attr("class","parallel-axis-"+i);u.style("font-size",t._fontSize).style("font-family",t._fontFamily).style("fill",m).attr("transform","translate("+i*a.step()+",0)").call(C),u.selectAll(".tick line").style("stroke",m).style("stroke-width",v).style("display",1==g?"block":"none"),u.select("path").style("stroke",m).style("stroke-width",v).style("display",1==g?"block":"none"),u.selectAll(".tick text").style("fill",t._fontColor).style("display",1==f?"block":"none")},A=0;A<S.length;A++)P(A);var W=d3.line().x((function(t,e){return a.step()*e})).y((function(t,e){return O[e](t.value)})).defined((function(t){return!isNaN(parseFloat(t.value))}));"curve"==t._lineType&&W.curve(d3.curveCardinal);var z=n.selectAll(".line").data(e);z.exit().remove();var M=z.enter().append("path").attr("class","line").merge(z).style("fill","none").style("stroke",(function(e,i){return e.color&&/\[/.test(e.color)?"url("+c("#"+t.id+"-index-"+i)+")":e.color})).style("stroke-width",r).attr("d",(function(t){return W(t.data)})).attr("stroke-dasharray",(function(){return this.getTotalLength()})).attr("stroke-dashoffset",(function(){return this.getTotalLength()})).on("mouseover",this._onMouseover).on("mousemove",this._onMousemove).on("mouseout",this._onMouseout),D=n.append("g").attr("class","parallel-text-labels").selectAll(".line").data(e);D.exit().remove();D.enter().append("text").attr("class","text-label").style("fill",q(d.color)).style("font-size",d.fontSize).style("font-family",d.fontFamily).attr("dy","0.35em").attr("x",(function(t,e){return"左侧"==_?-5-parseFloat(l/2):5+a.step()*(a.domain().length-1)+parseFloat(l/2)})).attr("y",(function(t,e){return isNaN(t.data[0].value)||isNaN(t.data[O.length-1].value)?0:"左侧"==_?O.length>0?O[0](t.data[0].value):0:O.length>0?O[O.length-1](t.data[O.length-1].value):0})).style("display",1==d.show?"block":"none").style("text-anchor","左侧"==_?"end":"start").text((function(e,i){var n=e.name=="$-"+(i+1)||O.length<=0?"":e.name;if(isNaN(e.data[0].value)||isNaN(e.data[O.length-1].value))return"";var a=0;a="左侧"==_?O.length>0?O[0](e.data[0].value):0:O.length>0?O[O.length-1](e.data[O.length-1].value):0;var o=[];return"左侧"==t._axisPositonChoiceY?F.forEach((function(t){o.push(O.length>0?O[0](t):0)})):L.forEach((function(t){o.push(O.length>0?O[O.length-1](t):0)})),_==t._axisPositonChoiceY&&o.forEach((function(e){a<e+parseFloat(t._fontSize)/2+parseFloat(d.fontSize)/2&&a>e-parseFloat(t._fontSize)/2-parseFloat(d.fontSize)/2&&(n="")})),n}));var R=n.append("g").attr("class","parallel-points").selectAll(".points").data(e);R.exit().remove();R.enter().append("g").attr("class","points").each((function(i,n){var o=d3.select(this).selectAll("circle").data(i.data);o.exit().remove();var r=o.enter().append("circle").attr("class","plot").merge(o).attr("cx",(function(t,e){return e*a.step()})).attr("cy",(function(t,e){return isNaN(parseFloat(t.value))?0:O[e](t.value)})).attr("r",l).style("stroke-width",s).style("stroke",(function(e,a){var o=""==u?i.color:u;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+n)+")":o})).style("fill",(function(e,a){var o=""==h?i.color:h;return o&&/\[/.test(o)?"url("+c("#"+t.id+"-index-"+n)+")":o})).style("display",(function(t){return isNaN(parseFloat(t.value))?"none":"block"}));t._interrupt?r.attr("r",l):t._transition&&0==t._moveOptions.indexOf(t._moveStyle)?r.attr("r",0).transition().duration(t._transition?t._duration/(e.length>0?e.length:1):0).ease(d3.easeLinear).delay(t._transition?t._startDelay+n*t._duration/(e.length>0?e.length:1):0).attr("r",l):t._transition&&1==t._moveOptions.indexOf(t._moveStyle)?r.attr("r",0).transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).delay(t._transition?t._startDelay:0).attr("r",l):r.attr("r",l)}));t._interrupt?M.attr("stroke-dashoffset",0):t._transition&&0==t._moveOptions.indexOf(t._moveStyle)?M.transition().duration(t._transition?t._duration/(e.length>0?e.length:1):0).ease(d3.easeLinear).delay(t._transition?function(i,n){return t._startDelay+n*t._duration/(e.length>0?e.length:1)}:0).attr("stroke-dashoffset",0):t._transition&&1==t._moveOptions.indexOf(t._moveStyle)?M.transition().duration(t._transition?t._duration:0).ease(d3.easeLinear).delay(t._transition?t._startDelay:0).attr("stroke-dashoffset",0):M.attr("stroke-dashoffset",0);var N=n.selectAll(".text-label"),T=[],B=[];for(A=0;A<N._groups[0].length;A++){B.push(A);for(var G=A+1;G<N._groups[0].length;G++){p(i(d3.select(N._groups[0][A])),i(d3.select(N._groups[0][G])))&&(T.push(A),d3.select(N._groups[0][A]).style("visibility","hidden"))}}for(var X=new Set(T),j=Array.from(X),I=function(t,e){for(var i=e,n=[],a=t.concat(i),o={},r=0;r<a.length;r++)a[r]in o?o[a[r]]++:o[a[r]]=1;for(var l in o)1==o[l]&&n.push(Number(l));return n}(j,B),Y=0;Y<j.length;Y++){for(var H=[],V=0;V<I.length;V++){var $=i(d3.select(N._groups[0][j[Y]])),U=i(d3.select(N._groups[0][I[V]]));if(H.push(p($,U)),p($,U)){if(j[Y]==I[V])continue;d3.select(N._groups[0][j[Y]]).style("visibility","hidden")}}0==H.filter((function(t){return 1==t})).length&&I.push(j[Y])}for(var Z=0;Z<I.length;Z++)d3.select(N._groups[0][I[Z]]).style("visibility","visible");return t}},{key:"width",value:function(t){return arguments.length?(this._width=t,this):this._width}},{key:"height",value:function(t){return arguments.length?(this._height=t,this):this._height}},{key:"transition",value:function(t){return arguments.length?(this._transition=t,this):this._transition}},{key:"duration",value:function(t){return arguments.length?(this._duration=t,this):this._duration}},{key:"easeStyle",value:function(t){return arguments.length?(this._easeStyle=t,this):this._easeStyle}},{key:"startDelay",value:function(t){return arguments.length?(this._startDelay=t,this):this._startDelay}},{key:"moveOptions",value:function(t){return arguments.length?(this._moveOptions=t,this):this._moveOptions}},{key:"moveStyle",value:function(t){return arguments.length?(this._moveStyle=t,this):this._moveStyle}},{key:"endPause",value:function(t){return arguments.length?(this._endPause=t,this):this._endPause}},{key:"interrupt",value:function(t){return arguments.length?(this._interrupt=t,this):this._interrupt}},{key:"textLabel",value:function(t){return arguments.length?(this._textLabel=t,this):this._textLabel}},{key:"lineWidth",value:function(t){return arguments.length?(this._lineWidth=t,this):this._lineWidth}},{key:"endPointRadius",value:function(t){return arguments.length?(this._endPointRadius=t,this):this._endPointRadius}},{key:"endPointBorderWidth",value:function(t){return arguments.length?(this._endPointBorderWidth=t,this):this._endPointBorderWidth}},{key:"endPointBorderColor",value:function(t){return arguments.length?(this._endPointBorderColor=t,this):this._endPointBorderColor}},{key:"endPointFillColor",value:function(t){return arguments.length?(this._endPointFillColor=t,this):this._endPointFillColor}},{key:"xAxis",value:function(t){return arguments.length?(this._xAxis=t,this):this._xAxis}},{key:"xScale",value:function(t){return arguments.length?(this._xScale=t,this):this._xScale}},{key:"midGap",value:function(t){return arguments.length?(this._midGap=t,this):this._midGap}},{key:"fontSize",value:function(t){return arguments.length?(this._fontSize=t,this):this._fontSize}},{key:"fontColor",value:function(t){return arguments.length?(this._fontColor=t,this):this._fontColor}},{key:"fontFamily",value:function(t){return arguments.length?(this._fontFamily=t,this):this._fontFamily}},{key:"axisPositonChoiceY",value:function(t){return arguments.length?(this._axisPositonChoiceY=t,this):this._axisPositonChoiceY}},{key:"lineType",value:function(t){return arguments.length?(this._lineType=t,this):this._lineType}},{key:"axisLaberShowY",value:function(t){return arguments.length?(this._axisLaberShowY=t,this):this._axisLaberShowY}},{key:"axisShowY",value:function(t){return arguments.length?(this._axisShowY=t,this):this._axisShowY}},{key:"axisLineWidthY",value:function(t){return arguments.length?(this._axisLineWidthY=t,this):this._axisLineWidthY}},{key:"axisColorY",value:function(t){return arguments.length?(this._axisColorY=t,this):this._axisColorY}},{key:"labelSuffixY",value:function(t){return arguments.length?(this._labelSuffixY=t,this):this._labelSuffixY}},{key:"numberStyle",value:function(t){return arguments.length?(this._numberStyle=t,this):this._numberStyle}},{key:"decimalPlaces",value:function(t){return arguments.length?(this._decimalPlaces=t,this):this._decimalPlaces}}]),e}(at),Ru=function(t){function e(t,i){return b(this,e),C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return w(e,t),S(e,[{key:"data",get:function(){var t=this._dataSolveFunc(this._dataSrc.data[0],this._columnMap[0]);return $(t,this.generateColorList(t.length))}},{key:"dataLabel",get:function(){return this._dataSrc.data[0][0]}}]),e}(it),Nu=function(t){function e(t){b(this,e);var i=C(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.elem.attr("class","parallel-line-chart"),i.parallelLine=new Du(i.coreGroup),i.xAxis=new jt(i.mainGroup),i.xScale=d3.scalePoint(),i._xType="category",i._xOrient="bottom",i._allowedMaxTextHeight=30,i._tickTextRotate=0,i._tickTextHeight=0,i._labelDirection="自动",i._labelAngle=0,i._countOfLabel=8,i._labelSuffix="",i._unitShow=!1,i._unitWord="",i._unitFontSize="12",i._unitFontColor="#8C8C8C",i._unitFontFamily="Noto Sans",i._unitX="left",i._unitY="top",i._sourceShow=!1,i._sourceWord="",i._sourceFontSize="12",i._sourceFontColor="#5c6066",i._sourceFontFamily="Noto Sans",i._sourceX="left",i._sourceY="bottom",i._transition=!1,i._easeStyle="",i._duration=0,i._startDelay=0,i._moveOptions=["依次绘制","同时绘制"],i._moveStyle="依次绘制",i._endPause=0,i._interrupt=!1,i._lineWidth="2",i._endPointRadius="3.5",i._endPointBorderWidth="1",i._endPointBorderColor="#FFFFFF",i._endPointFillColor=null,i._lineType="",i.dataLabel=[],i._axisPositonChoiceY="左侧",i._textLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",positionOptions:["左侧","右侧"],positionChoice:"左侧"},i._numberLabel={show:!0,fontSize:"14",color:"#545454",fontFamily:"阿里巴巴普惠体 常规",suffix:""},i}return w(e,t),S(e,[{key:"updateCore",value:function(){var t=this,e=t.activeData,i=t.parallelLine,n=t.tooltip,a=t.defs;a.selectAll("filter").remove();var o=a.append("filter").attr("x","-10%").attr("y","-10%").attr("width","180%").attr("height","180%").attr("id","Drop_Shadow_groupBar").attr("filterUnits","objectBoundingBox");if(o.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation",0).attr("result","blurredAlpha"),o.append("feOffset").attr("in","blurredAlpha").attr("dx",.5).attr("dy",.7).attr("result","offsetBlurredAlpha"),o.append("feFlood").attr("result","flooded").style("flood-color","#FFF").style("flood-opacity","0.5"),o.append("feComposite").attr("in","flooded").attr("in2","offsetBlurredAlpha").attr("operator","in").attr("result","coloredShadow"),o.append("feComposite").attr("in","SourceGraphic").attr("in2","coloredShadow").attr("operator","over"),t.mainGroup.selectAll(".parallel-line-border-gradient").remove(),t.mainGroup.selectAll(".parallel-line-fill-gradient").remove(),t._endPointBorderColor&&/\[/.test(t._endPointBorderColor)){var r=W(t._endPointBorderColor),l=[],s=!0,u=!1,h=void 0;try{for(var d,_=r[Symbol.iterator]();!(s=(d=_.next()).done);s=!0){var f=d.value,p=[],x=f.split(":");p.push(q(x[0])),p.push(x[1]),l.push(p)}}catch(t){u=!0,h=t}finally{try{!s&&_.return&&_.return()}finally{if(u)throw h}}var g=l.concat(),v=g.pop();t.mainGroup.append("linearGradient").attr("class","parallel-line-border-gradient").attr("id",t.id+"-parallel-line-border-0").attr("x1",y(v[1]).x1+"%").attr("y1",y(v[1]).y1+"%").attr("x2",y(v[1]).x2+"%").attr("y2",y(v[1]).y2+"%").selectAll("stop").data(g).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}if(t._endPointFillColor&&/\[/.test(t._endPointFillColor)){var m=W(t._endPointFillColor),b=[],S=!0,k=!1,w=void 0;try{for(var C,O=m[Symbol.iterator]();!(S=(C=O.next()).done);S=!0){f=C.value;var F=[],L=f.split(":");F.push(q(L[0])),F.push(L[1]),b.push(F)}}catch(t){k=!0,w=t}finally{try{!S&&O.return&&O.return()}finally{if(k)throw w}}var P=b.concat(),A=P.pop();t.mainGroup.append("linearGradient").attr("class","parallel-line-fill-gradient").attr("id",t.id+"-parallel-line-fill-0").attr("x1",y(A[1]).x1+"%").attr("y1",y(A[1]).y1+"%").attr("x2",y(A[1]).x2+"%").attr("y2",y(A[1]).y2+"%").selectAll("stop").data(P).enter().append("stop").attr("offset",(function(t){return t[1]})).attr("stop-color",(function(t){return t[0]}))}function W(t){return new Function("return "+t)()}i.data(e).width(t.widthOfNoMargin).height(t.heightOfMainGroup).transition(t._transition).duration(1e3*t._duration).easeStyle(t._easeStyle).startDelay(1e3*parseFloat(t._startDelay)).moveOptions(t._moveOptions).moveStyle(t._moveStyle).endPause(t._endPause).lineWidth(t._lineWidth).endPointRadius(t._endPointRadius).endPointBorderWidth(t._endPointBorderWidth).endPointBorderColor(/\[/.test(t._endPointBorderColor)?"url("+c("#"+t.id+"-parallel-line-border-0")+")":t._endPointBorderColor).endPointFillColor(/\[/.test(t._endPointFillColor)?"url("+c("#"+t.id+"-parallel-line-fill-0")+")":t._endPointFillColor).xAxis(t.xAxis).xScale(t.xScale).textLabel(t._textLabel).interrupt(t._interrupt).fontSize(t._fontSize).fontColor(t._fontColor).fontFamily(t._fontFamily).axisPositonChoiceY(t._axisPositonChoiceY).axisLaberShowY(t._yTickShow).axisShowY(t._yAxisShow).axisLineWidthY(t._yAxisLineWidth).axisColorY(t._axisLineStrokeY).labelSuffixY(t._yLabelSuffix).lineType(t._lineType).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces).onMouseover((function(e,i){var a=e.name,o=[{text:a=="$-"+(i+1)?"":a,color:e.color}];e.data.forEach((function(e,i){o.push({text:e.name+"："+E(isNaN(parseFloat(e.value))?"":e.value,t._numberStyle,t._decimalPlaces),color:"none"})})),n.data(o).update(),n.move([d3.event.offsetX,d3.event.offsetY]).show()})).onMousemove((function(){n.move([d3.event.offsetX,d3.event.offsetY])})).onMouseout((function(){n.hide()})),i.update()}},{key:"updateAxis",value:function(){var t=this,e=t.activeData;t.computeDomain();var i=t.xAxis,n=t.xScale,a=t._xType,r=t._xOrient;r="下面"==t._axisPositonChoiceX?"bottom":"top";var l=t._fontSize,s=t.widthOfNoMargin,u=t.heightOfMainGroup;n.domain(t._xDomain),i.scaleFunc(n).allowedMaxTextHeight(.5*u).type(a).orient(r).title(t._xTitle).tickShow(t._xTickShow).lineStroke(t._axisLineStrokeX).fontSize(l).fontColor(t._fontColor).fontFamily(t._fontFamily).xRange(t._xRange).transition(t._transition).duration(t._duration).xAxisLineWidth(t._xAxisLineWidth).axisLineShow(t._xAxisShow).labelDirection(t._xLabelDirection).labelAngle(t._xLabelAngle).countOfLabel(t._xCountOfLabel).labelSuffix(t._xLabelSuffix).numberStyle(t._numberStyle).decimalPlaces(t._decimalPlaces);var c=0,h=s,d=e.length>0?d3.max(e.map((function(e){return R(e.name,t._textLabel.fontSize,t._textLabel.fontFamily)}))):0,_=e.length>0?e[0].data.map((function(t){return t.name})):[];if("左侧"==t._axisPositonChoiceY){var f=d3.max(e.map((function(e){return R(e.data.length?e.data[0].value:"",t._fontSize,t._fontFamily)})))+14;c=d3.max(["左侧"==t._textLabel.positionChoice?5+d+parseFloat(t._endPointRadius)/2:0,R(_[0],t._fontSize,t._fontFamily)/2,f]),h=s-d3.max([R(_[_.length-1],t._fontSize,t._fontFamily)/2,"左侧"==t._textLabel.positionChoice?0:5+d+parseFloat(t._endPointRadius)/2])}else{c=d3.max([R(_[0],t._fontSize,t._fontFamily)/2,"左侧"==t._textLabel.positionChoice?5+d+parseFloat(t._endPointRadius)/2:0]);var p=d3.max(e.map((function(e){return R(e.data.length>0?e.data[e.data.length-1].value:"",t._fontSize,t._fontFamily)})))+14;h=s-d3.max(["左侧"==t._textLabel.positionChoice?0:5+d+parseFloat(t._endPointRadius)/2,R(_[_.length-1],t._fontSize,t._fontFamily)/2,p])}n.range([c,h]),i.compute(),n.range([c,h]);var y=0;y="下面"==t._axisPositonChoiceX?u-i.height-10:i.height,i.translate(0,y).update(),"上面"==t._axisPositonChoiceX?t.coreGroup.call(o,c,i.height+10):t.coreGroup.call(o,c,0)}},{key:"configLegend",value:function(){var t=this,e=t.sortedDataCopy.filter((function(t,e){return 1==t.showLegend}));t.legend.data(e).onClick((function(i){var n=!d3.select(this).classed("clicked");d3.select(this).classed("clicked",n).style("opacity",n?.5:1),e.forEach((function(t){t.key===i.key&&(t.active=!n)})),t.onDataChange()}))}},{key:"computeDomain",value:function(){var t=this.activeData,e=t.length>0?t[0].data.map((function(t){return t.name})):[];this._xDomain=e}},{key:"onInterruptChange",value:function(t){this._interrupt=!0,this.updateCore()}},{key:"buildOption",value:function(t,e){var i=new Ru(t,e),n=ee;return i.dataSolveFunc(n),i}},{key:"setSelfOption",value:function(t){var e=t.dataLabel,i=t.display,n=t.animation,a=t.unitDisplay,o=t.sourceDisplay,r=t.label;this.dataLabel=e,0!==Object.getOwnPropertyNames(i).length&&(this._lineWidth=0==i.lineWidth||i.lineWidth?i.lineWidth:this._lineWidth,this._endPointRadius=0==i.endPointRadius||i.endPointRadius?i.endPointRadius:this._endPointRadius,this._endPointBorderWidth=0==i.endPointBorderWidth||i.endPointBorderWidth?i.endPointBorderWidth:this._endPointBorderWidth,this._endPointBorderColor=i.endPointBorderColor?q(i.endPointBorderColor):"",this._endPointFillColor=i.endPointFillColor?q(i.endPointFillColor):"",this._lineType=i.lineType?i.lineType:this._lineType),0!==Object.getOwnPropertyNames(r).length&&(this._textLabel=r.textLabel?r.textLabel:this._textLabel),0!==Object.getOwnPropertyNames(n).length&&(this._transition=n?n.transition:this._transition,this._easeStyle=n.easeStyle?n.easeStyle:this._easeStyle,this._duration=n?n.duration:this._duration,this._startDelay=n?n.startDelay:this._startDelay,this._moveStyle=n.moveStyle?n.moveStyle:this._moveStyle,this._moveOptions=n.moveOptions?n.moveOptions:this._moveOptions,this._endPause=n.endPause?n.endPause:this._endPause),0!==Object.getOwnPropertyNames(a).length&&(this._unitShow=a?a.show:this._unitShow,this._unitWord=a?a.text:this._unitWord,this._unitFontSize=a.fontSize?a.fontSize:this._unitSize,this._unitFontColor=a.color?q(a.color):this._unitColor,this._unitFontFamily=a.fontFamily?a.fontFamily:this._unitFamily,this._unitX=a.xPosition?a.xPosition:this._unitX,this._unitY=a.yPosition?a.yPosition:this._unitY),0!==Object.getOwnPropertyNames(o).length&&(this._sourceShow=o?o.show:this._sourceShow,this._sourceWord=o?o.text:this._sourceWord,this._sourceFontSize=o.fontSize?o.fontSize:this._sourceSize,this._sourceFontColor=o.color?q(o.color):this._sourceColor,this._sourceFontFamily=o.fontFamily?o.fontFamily:this._sourceFamily,this._sourceX=o.xPosition?o.xPosition:this._sourceX,this._sourceY=o.yPosition?o.yPosition:this._sourceY)}},{key:"setPublicOption",value:function(t){k(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setPublicOption",this).call(this,t);var i=t.axis,n=i.x||{},a=i.y||{};this._axisPositonChoiceY=a.axisPositonChoice?a.axisPositonChoice:"左侧",this.axisLineStrokeY(q(a.axisColor)||q(i.color)).yTitle(a.name).xTickShow(n.labelShow).yTickShow(a.labelShow).yAxisLineWidth(0==a.axisLineWidth||a.axisLineWidth?a.axisLineWidth:1).xAxisShow(!1).yAxisShow(0!=a.axisShow&&!a.axisShow||a.axisShow).axisPositonChoiceX(n.axisPositonChoice?n.axisPositonChoice:"下面").xLabelDirection(n.labelDirection?n.labelDirection:"自动").yLabelSuffix(a.labelSuffix?a.labelSuffix:"")}}]),e}(Tt),Tu=new Date;Tu.toLocaleDateString(),console.log("【d3Chart】 update"+Tu),t.ArcDiagramChart=Xn,t.BarProgressChart=yn,t.BasicHorizontalBarChart=In,t.BasicScatterChart=Nr,t.BeeLineChart=fa,t.BulletChart=lo,t.ButterflyChart=Mu,t.CalendarHeatmapChart=Di,t.ChangeWaterfallHistogramChart=Vi,t.ChordChart=We,t.ContrastiveFunnelChart=Xa,t.DeformedBarChart=co,t.DeformedPieChart=ca,t.DescartesHeatmapChart=bu,t.DonutChart=ha,t.DynamicBarChart=$o,t.DynamicLineChart=ir,t.DynamicRankLineChart=rr,t.ForceDiagramArrowChart=al,t.ForceDiagramChart=Jr,t.FormWaterfallHistogramChart=qi,t.FunnelChart=_a,t.GanttChart=La,t.GroupAggregationBubbleChart=ml,t.GroupedBarChart=qn,t.GroupedHorizontalBarChart=Zn,t.GroupingBubbleChart=Li,t.HalfPieChart=on,t.HalfProgressPieChart=nn,t.HistogramChart=Mr,t.HollowChart=Ti,t.HundredPercentBarChart=dr,t.HundredPercentIconBarChart=dl,t.IconBarChart=Pt,t.IconPieChart=Me,t.LollipopChart=fl,t.MixLineBarChart=la,t.MultipleBarChart=bi,t.MultipleBubbleChart=_o,t.MultipleLineChart=re,t.NegativeHorizontalBarChart=Kn,t.OneLevelTreemapChart=Ie,t.OverlapAreaChart=ie,t.PackChart=Do,t.ParallelLineChart=Nu,t.PercentageAreaChart=Nn,t.PercentageBarChart=zn,t.PictographBarChart=ur,t.PieChart=ut,t.PolarAreaChart=Yr,t.PolarBarChart=Pl,t.PolarBubbleChart=go,t.PolarHeatmapChart=vu,t.PolarLineChart=Er,t.PolarStackBarChart=eo,t.PolarStackDonutBarChart=io,t.PolarStackRectangularChart=zl,t.PolygonRadarChart=Sn,t.ProgressRoundPieChart=tn,t.PunchBubbleChart=mo,t.PyramidChart=_i,t.QuarterRoseChart=St,t.RadarChart=ci,t.RadialBarChart=Rt,t.RadialLineChart=Nt,t.RainfallVolumeAreaChart=wo,t.RainfallVolumeLineChart=Ao,t.RangeAreaChart=qa,t.RangeBarChart=Za,t.RangeHorizontalBarChart=Ka,t.RankingChangeChart=Fn,t.RelativeRadarChart=Ra,t.ReverseFunnelChart=ku,t.ReverseLineChart=gr,t.ReverseOverlapAreaChart=kr,t.ReverseStackedAreaChart=Ar,t.RoseChart=bt,t.RoseDonutChart=no,t.RoundCornerDonutChart=st,t.RoundCornerPieChart=ct,t.SankeyChart=we,t.SimpleBarChart=Zi,t.SimpleLineChart=ka,t.SimpleSankeyChart=Ce,t.SlopeChart=fn,t.SmoothLineChart=ya,t.SoapBubbleChart=yu,t.StackBarChart=Hn,t.StackCircleChart=Ia,t.StackHorizontalBarChart=Vn,t.StackedChart=Xi,t.StackedLinearChart=pa,t.StepLineChart=le,t.StreamgraphChart=si,t.SunburstChart=Ze,t.SymmetricChart=va,t.TableChart=Xr,t.TernaryChart=wl,t.TreeChart=ei,t.TwoLevelDonutChart=Be,t.TwoLevelTreemapChart=He,t.VerticalDumbbellChart=yl,t.VerticalSankeyChart=Fe,t.WaveCircleChart=dt,t.WeightedTreeChart=ni,t.WordCloudChart=Ma,t.setUserMd=function(t){window.userId=t},Object.defineProperty(t,"__esModule",{value:!0})}));
